var P=Object.defineProperty;var E=(p,t,s)=>t in p?P(p,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):p[t]=s;var S=(p,t,s)=>(E(p,typeof t!="symbol"?t+"":t,s),s);import{d as q,o as W,a as G,f as K,r as w,H as D,L as U,c as X,g as Y,X as Z,Y as J,Z as Q,$ as tt,n as st,j as et,k as $,l,V as R,a0 as ot,m as x,A as I,F as O,s as N,W as rt,t as C,q as V,v as it,x as y,z as j,p as nt,w as lt,R as at,_ as ct,B as ht}from"./index-055648d2.js";import{s as T}from"./search-ac5b21e0.js";import{v as ut}from"./index-480ec8d0.js";const dt="/acchymns-dev/assets/filter-outline.svg";class z{constructor(t,s,e){S(this,"r",0);S(this,"g",0);S(this,"b",0);this.set(t,s,e)}toString(){return`rgb(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)})`}set(t,s,e){this.r=this.clamp(t),this.g=this.clamp(s),this.b=this.clamp(e)}hueRotate(t=0){t=t/180*Math.PI;const s=Math.sin(t),e=Math.cos(t);this.multiply([.213+e*.787-s*.213,.715-e*.715-s*.715,.072-e*.072+s*.928,.213-e*.213+s*.143,.715+e*.285+s*.14,.072-e*.072-s*.283,.213-e*.213-s*.787,.715-e*.715+s*.715,.072+e*.928+s*.072])}grayscale(t=1){this.multiply([.2126+.7874*(1-t),.7152-.7152*(1-t),.0722-.0722*(1-t),.2126-.2126*(1-t),.7152+.2848*(1-t),.0722-.0722*(1-t),.2126-.2126*(1-t),.7152-.7152*(1-t),.0722+.9278*(1-t)])}sepia(t=1){this.multiply([.393+.607*(1-t),.769-.769*(1-t),.189-.189*(1-t),.349-.349*(1-t),.686+.314*(1-t),.168-.168*(1-t),.272-.272*(1-t),.534-.534*(1-t),.131+.869*(1-t)])}saturate(t=1){this.multiply([.213+.787*t,.715-.715*t,.072-.072*t,.213-.213*t,.715+.285*t,.072-.072*t,.213-.213*t,.715-.715*t,.072+.928*t])}multiply(t){const s=this.clamp(this.r*t[0]+this.g*t[1]+this.b*t[2]),e=this.clamp(this.r*t[3]+this.g*t[4]+this.b*t[5]),r=this.clamp(this.r*t[6]+this.g*t[7]+this.b*t[8]);this.r=s,this.g=e,this.b=r}brightness(t=1){this.linear(t)}contrast(t=1){this.linear(t,-(.5*t)+.5)}linear(t=1,s=0){this.r=this.clamp(this.r*t+s*255),this.g=this.clamp(this.g*t+s*255),this.b=this.clamp(this.b*t+s*255)}invert(t=1){this.r=this.clamp((t+this.r/255*(1-2*t))*255),this.g=this.clamp((t+this.g/255*(1-2*t))*255),this.b=this.clamp((t+this.b/255*(1-2*t))*255)}hsl(){const t=this.r/255,s=this.g/255,e=this.b/255,r=Math.max(t,s,e),c=Math.min(t,s,e);let u=0,b=0;const m=(r+c)/2;if(r===c)u=b=0;else{const d=r-c;switch(b=m>.5?d/(2-r-c):d/(r+c),r){case t:u=(s-e)/d+(s<e?6:0);break;case s:u=(e-t)/d+2;break;case e:u=(t-s)/d+4;break}u/=6}return{h:u*100,s:b*100,l:m*100}}clamp(t){return t>255?t=255:t<0&&(t=0),t}}class pt{constructor(t){S(this,"target");S(this,"targetHSL");S(this,"reusedColor");this.target=t,this.targetHSL=t.hsl(),this.reusedColor=new z(0,0,0)}solve(){const t=this.solveNarrow(this.solveWide());return{values:t.values,loss:t.loss,filter:this.css(t.values??[])}}solveWide(){const e=[60,180,18e3,600,1.2,1.2];let r={loss:1/0};for(let c=0;r.loss>25&&c<3;c++){const u=[50,20,3750,50,100,100],b=this.spsa(5,e,15,u,1e3);b.loss<r.loss&&(r=b)}return r}solveNarrow(t){const s=t.loss,e=2,r=s+1,c=[.25*r,.25*r,r,.25*r,.2*r,.2*r];return this.spsa(s,c,e,t.values,500)}spsa(t,s,e,r,c){const b=.16666666666666666;let m=null,d=1/0;const M=new Array(6),v=new Array(6),A=new Array(6);for(let h=0;h<c;h++){const g=e/Math.pow(h+1,b);for(let a=0;a<6;a++)M[a]=Math.random()>.5?1:-1,v[a]=r[a]+g*M[a],A[a]=r[a]-g*M[a];const f=this.loss(v)-this.loss(A);for(let a=0;a<6;a++){const L=f/(2*g)*M[a],i=s[a]/Math.pow(t+h+1,1);r[a]=F(r[a]-i*L,a)}const B=this.loss(r);B<d&&(m=r.slice(0),d=B)}return{values:m,loss:d};function F(h,g){let f=100;return g===2?f=7500:(g===4||g===5)&&(f=200),g===3?h>f?h%=f:h<0&&(h=f+h%f):h<0?h=0:h>f&&(h=f),h}}loss(t){const s=this.reusedColor;s.set(0,0,0),s.invert(t[0]/100),s.sepia(t[1]/100),s.saturate(t[2]/100),s.hueRotate(t[3]*3.6),s.brightness(t[4]/100),s.contrast(t[5]/100);const e=s.hsl();return Math.abs(s.r-this.target.r)+Math.abs(s.g-this.target.g)+Math.abs(s.b-this.target.b)+Math.abs(e.h-this.targetHSL.h)+Math.abs(e.s-this.targetHSL.s)+Math.abs(e.l-this.targetHSL.l)}css(t){function s(e,r=1){return Math.round(t[e]*r)}return`filter: invert(${s(0)}%) sepia(${s(1)}%) saturate(${s(2)}%) hue-rotate(${s(3,3.6)}deg) brightness(${s(4)}%) contrast(${s(5)}%);`}}function mt(p){const t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;p=p.replace(t,(e,r,c,u)=>r+r+c+c+u+u);const s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(p);return s?[parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16)]:null}const ft={class:"search-bar"},_t={class:"filters"},bt={class:"dropdown-content-wrapper"},gt=["src"],kt=["onClick"],vt={class:"dropdown-content-item"},wt=["src"],yt={class:"dropdown-content-text"},Mt={key:0,style:{"margin-top":"10px","margin-bottom":"10px"}},St={class:"songlist"},$t={class:"song__title"},At={class:"book__title"},Ct={class:"booktext--right"},Ft={class:"song__number"},H=50,Rt=q({__name:"SearchView",setup(p){W((i,o)=>{ht(o.fullPath)});const t=G(),s=K("searchParams",{search:"",bookFilters:[]}),e=w(s.value.search),r=D(()=>T(e.value));U(e,i=>{s.value.search=i});const c=w([]),u=w([]),b=w(new Map),m=D(()=>s.value.bookFilters.length>0?c.value.filter(i=>{var o,n;return(((o=i.stripped_title)==null?void 0:o.includes(r.value))||((n=i==null?void 0:i.stripped_first_line)==null?void 0:n.includes(r.value))||(i==null?void 0:i.number)==r.value)&&s.value.bookFilters.find(k=>k==i.book.name.short)}).sort((i,o)=>i.title.replace(/[.,/#!$%^&*;:{}=\-_'"`~()]/g,"").localeCompare(o.title.replace(/[.,/#!$%^&*;:{}=\-_'"`~()]/g,""))):e.value===""?[]:c.value.filter(i=>{var o,n;return((o=i.stripped_title)==null?void 0:o.includes(r.value))||((n=i==null?void 0:i.stripped_first_line)==null?void 0:n.includes(r.value))||(i==null?void 0:i.number)==r.value}).sort((i,o)=>i.title.replace(/[.,/#!$%^&*;:{}=\-_'"`~()]/g,"").localeCompare(o.title.replace(/[.,/#!$%^&*;:{}=\-_'"`~()]/g,"")))),d=w(H),M=D(()=>m.value.length-d.value<H?m.value:m.value.slice(0,d.value));X(async()=>{const i=await Y(),o=await Z();u.value.push(...Object.values(i));for(const n of Object.keys(o))for(const k of Object.keys(o[n])){let _=o[n][k];_.title==null&&(_.title=""),c.value.push({title:(_==null?void 0:_.title)??"",number:k,book:i[n],stripped_title:T((_==null?void 0:_.title)??""),stripped_first_line:T((_==null?void 0:_.first_line)??"")})}J.concat(Object.keys(Q)).forEach(async n=>{let k=await tt(n);k!=null&&b.value.set(n,k)}),await st(),et(t.fullPath)});const v=w(!1),A=w(!1);function F(){A.value=!1,setTimeout(()=>{v.value=!1},200)}function h(){v.value?F():(v.value=!0,A.value=!0)}let g=w([]);function f(i){if(v.value=!0,s.value.bookFilters.includes(i)){let o=s.value.bookFilters.findIndex(n=>n==i);s.value.bookFilters.splice(o,1)}else s.value.bookFilters.push(i)}function B(){s.value.bookFilters=[]}function a(i){return i?"./assets/checkmark-circle.svg":"./assets/ellipse-outline.svg"}function L(i){const o=mt(i??"#000000");return(o==null?void 0:o.length)!==3?"":new pt(new z(o[0],o[1],o[2])).solve().filter}return(i,o)=>(y(),$(O,null,[o[7]||(o[7]=l("h1",{class:"pagetitle"},"Search",-1)),l("div",ft,[R(l("input",{"onUpdate:modelValue":o[0]||(o[0]=n=>e.value=n),placeholder:"Search for a song title or number...","aria-label":"Search through site content"},null,512),[[ot,e.value]]),o[3]||(o[3]=l("button",{disabled:""},[l("svg",{viewBox:"0 0 1024 1024"},[l("path",{class:"path1",d:"M848.471 928l-263.059-263.059c-48.941 36.706-110.118 55.059-177.412 55.059-171.294 0-312-140.706-312-312s140.706-312 312-312c171.294 0 312 140.706 312 312 0 67.294-24.471 128.471-55.059 177.412l263.059 263.059-79.529 79.529zM189.623 408.078c0 121.364 97.091 218.455 218.455 218.455s218.455-97.091 218.455-218.455c0-121.364-103.159-218.455-218.455-218.455-121.364 0-218.455 97.091-218.455 218.455z"})])],-1))]),R((y(),$("div",_t,[l("a",{onClick:o[1]||(o[1]=n=>h()),class:"dropdown"},o[4]||(o[4]=[l("p",{class:"dropdown-text"},"Filters",-1),l("img",{class:"ionicon filter-icon",src:dt},null,-1)])),R(l("div",bt,[l("div",{class:I(["dropdown-content",{"dropdown-content-active":A.value}])},[l("a",null,[l("div",{class:"dropdown-content-top-item",onClick:B},[l("img",{class:"ionicon checkmark-icon",src:a(x(s).bookFilters.length==0)},null,8,gt),o[5]||(o[5]=l("div",{class:"dropdown-content-text"},"All Hymnals",-1))])]),l("div",{class:I({"dropdown-content-organizer":u.value.length>6})},[(y(!0),$(O,null,N(u.value,n=>(y(),$("a",{key:n.name.medium,onClick:k=>f(n.name.short),ref_for:!0,ref_key:"book_filters",ref:g},[l("div",vt,[l("img",{class:"ionicon",src:a(x(s).bookFilters.includes(n.name.short)),style:j(L(n.primaryColor))},null,12,wt),l("div",yt,C(n.name.medium),1)])],8,kt))),128))],2)],2)],512),[[rt,v.value]])])),[[x(ut),F]]),m.value.length>0?(y(),$("h2",Mt,"Search Results ("+C(m.value.length)+")",1)):V("",!0),l("div",St,[(y(!0),$(O,null,N(M.value,n=>(y(),nt(x(at),{key:n.title+n.number+n.book.name.short,to:`/display/${n.book.name.short}/${n.number}`,class:"song",style:j(`background: linear-gradient(135deg, ${n.book.primaryColor}, ${n.book.secondaryColor})`)},{default:lt(()=>[l("div",null,[l("div",$t,C(n.title),1),l("div",At,C(n.book.name.medium),1)]),l("div",Ct,[l("div",Ft,"#"+C(n.number),1)])]),_:2},1032,["to","style"]))),128)),M.value.length<m.value.length?(y(),$("div",{key:0,onClick:o[2]||(o[2]=n=>d.value+=H),class:"song",style:{background:"var(--blue)","justify-content":"center",cursor:"pointer"}},o[6]||(o[6]=[l("div",{class:"song__title"},"Show more",-1)]))):V("",!0)]),it(ct,{current_page:"search"})],64))}});export{Rt as default};
