var ot=Object.defineProperty;var rt=(s,t,e)=>t in s?ot(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var L=(s,t,e)=>(rt(s,typeof t!="symbol"?t+"":t,e),e);import{Z as it,$ as lt,a0 as at,a1 as ct,a2 as ut,r as y,L as B,H as P,a3 as M,m as T,d as dt,o as ft,a as ht,f as pt,c as mt,g as vt,a4 as gt,a5 as bt,a6 as _t,a7 as kt,n as wt,j as yt,k as D,l as p,X as x,a8 as St,F as W,s as Y,Y as Mt,t as F,q as j,p as K,x as $,z as X,w as At,R as $t,B as Ct,_ as Ot}from"./index-da7e3611.js";import{s as H,K as U}from"./index-e2b75c2a.js";const Lt="/assets/filter-outline.svg";class Q{constructor(t,e,n){L(this,"r",0);L(this,"g",0);L(this,"b",0);this.set(t,e,n)}toString(){return`rgb(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)})`}set(t,e,n){this.r=this.clamp(t),this.g=this.clamp(e),this.b=this.clamp(n)}hueRotate(t=0){t=t/180*Math.PI;const e=Math.sin(t),n=Math.cos(t);this.multiply([.213+n*.787-e*.213,.715-n*.715-e*.715,.072-n*.072+e*.928,.213-n*.213+e*.143,.715+n*.285+e*.14,.072-n*.072-e*.283,.213-n*.213-e*.787,.715-n*.715+e*.715,.072+n*.928+e*.072])}grayscale(t=1){this.multiply([.2126+.7874*(1-t),.7152-.7152*(1-t),.0722-.0722*(1-t),.2126-.2126*(1-t),.7152+.2848*(1-t),.0722-.0722*(1-t),.2126-.2126*(1-t),.7152-.7152*(1-t),.0722+.9278*(1-t)])}sepia(t=1){this.multiply([.393+.607*(1-t),.769-.769*(1-t),.189-.189*(1-t),.349-.349*(1-t),.686+.314*(1-t),.168-.168*(1-t),.272-.272*(1-t),.534-.534*(1-t),.131+.869*(1-t)])}saturate(t=1){this.multiply([.213+.787*t,.715-.715*t,.072-.072*t,.213-.213*t,.715+.285*t,.072-.072*t,.213-.213*t,.715-.715*t,.072+.928*t])}multiply(t){const e=this.clamp(this.r*t[0]+this.g*t[1]+this.b*t[2]),n=this.clamp(this.r*t[3]+this.g*t[4]+this.b*t[5]),o=this.clamp(this.r*t[6]+this.g*t[7]+this.b*t[8]);this.r=e,this.g=n,this.b=o}brightness(t=1){this.linear(t)}contrast(t=1){this.linear(t,-(.5*t)+.5)}linear(t=1,e=0){this.r=this.clamp(this.r*t+e*255),this.g=this.clamp(this.g*t+e*255),this.b=this.clamp(this.b*t+e*255)}invert(t=1){this.r=this.clamp((t+this.r/255*(1-2*t))*255),this.g=this.clamp((t+this.g/255*(1-2*t))*255),this.b=this.clamp((t+this.b/255*(1-2*t))*255)}hsl(){const t=this.r/255,e=this.g/255,n=this.b/255,o=Math.max(t,e,n),h=Math.min(t,e,n);let v=0,r=0;const d=(o+h)/2;if(o===h)v=r=0;else{const f=o-h;switch(r=d>.5?f/(2-o-h):f/(o+h),o){case t:v=(e-n)/f+(e<n?6:0);break;case e:v=(n-t)/f+2;break;case n:v=(t-e)/f+4;break}v/=6}return{h:v*100,s:r*100,l:d*100}}clamp(t){return t>255?t=255:t<0&&(t=0),t}}class Dt{constructor(t){L(this,"target");L(this,"targetHSL");L(this,"reusedColor");this.target=t,this.targetHSL=t.hsl(),this.reusedColor=new Q(0,0,0)}solve(){const t=this.solveNarrow(this.solveWide());return{values:t.values,loss:t.loss,filter:this.css(t.values??[])}}solveWide(){const n=[60,180,18e3,600,1.2,1.2];let o={loss:1/0};for(let h=0;o.loss>25&&h<3;h++){const v=[50,20,3750,50,100,100],r=this.spsa(5,n,15,v,1e3);r.loss<o.loss&&(o=r)}return o}solveNarrow(t){const e=t.loss,n=2,o=e+1,h=[.25*o,.25*o,o,.25*o,.2*o,.2*o];return this.spsa(e,h,n,t.values,500)}spsa(t,e,n,o,h){const r=.16666666666666666;let d=null,f=1/0;const _=new Array(6),k=new Array(6),S=new Array(6);for(let g=0;g<h;g++){const l=n/Math.pow(g+1,r);for(let m=0;m<6;m++)_[m]=Math.random()>.5?1:-1,k[m]=o[m]+l*_[m],S[m]=o[m]-l*_[m];const u=this.loss(k)-this.loss(S);for(let m=0;m<6;m++){const C=u/(2*l)*_[m],a=e[m]/Math.pow(t+g+1,1);o[m]=O(o[m]-a*C,m)}const b=this.loss(o);b<f&&(d=o.slice(0),f=b)}return{values:d,loss:f};function O(g,l){let u=100;return l===2?u=7500:(l===4||l===5)&&(u=200),l===3?g>u?g%=u:g<0&&(g=u+g%u):g<0?g=0:g>u&&(g=u),g}}loss(t){const e=this.reusedColor;e.set(0,0,0),e.invert(t[0]/100),e.sepia(t[1]/100),e.saturate(t[2]/100),e.hueRotate(t[3]*3.6),e.brightness(t[4]/100),e.contrast(t[5]/100);const n=e.hsl();return Math.abs(e.r-this.target.r)+Math.abs(e.g-this.target.g)+Math.abs(e.b-this.target.b)+Math.abs(n.h-this.targetHSL.h)+Math.abs(n.s-this.targetHSL.s)+Math.abs(n.l-this.targetHSL.l)}css(t){function e(n,o=1){return Math.round(t[n]*o)}return`filter: invert(${e(0)}%) sepia(${e(1)}%) saturate(${e(2)}%) hue-rotate(${e(3,3.6)}deg) brightness(${e(4)}%) contrast(${e(5)}%);`}}function Et(s){const t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;s=s.replace(t,(n,o,h,v)=>o+o+h+h+v+v);const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(s);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null}function tt(s){return it()?(lt(s),!0):!1}const et=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Ft=Object.prototype.toString,Tt=s=>Ft.call(s)==="[object Object]",R=()=>{},G=It();function It(){var s,t;return et&&((s=window==null?void 0:window.navigator)==null?void 0:s.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((t=window==null?void 0:window.navigator)==null?void 0:t.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function N(s){return Array.isArray(s)?s:[s]}function Pt(...s){if(s.length!==1)return at(...s);const t=s[0];return typeof t=="function"?ct(ut(()=>({get:t,set:R}))):y(t)}function Rt(s,t,e){return B(s,t,{...e,immediate:!0})}const st=et?window:void 0;function I(s){var t;const e=M(s);return(t=e==null?void 0:e.$el)!=null?t:e}function E(...s){const t=[],e=()=>{t.forEach(r=>r()),t.length=0},n=(r,d,f,_)=>(r.addEventListener(d,f,_),()=>r.removeEventListener(d,f,_)),o=P(()=>{const r=N(M(s[0])).filter(d=>d!=null);return r.every(d=>typeof d!="string")?r:void 0}),h=Rt(()=>{var r,d;return[(d=(r=o.value)==null?void 0:r.map(f=>I(f)))!=null?d:[st].filter(f=>f!=null),N(M(o.value?s[1]:s[0])),N(T(o.value?s[2]:s[1])),M(o.value?s[3]:s[2])]},([r,d,f,_])=>{if(e(),!(r!=null&&r.length)||!(d!=null&&d.length)||!(f!=null&&f.length))return;const k=Tt(_)?{..._}:_;t.push(...r.flatMap(S=>d.flatMap(O=>f.map(g=>n(S,O,g,k)))))},{flush:"post"}),v=()=>{h(),e()};return tt(e),v}let Z=!1;function J(s,t,e={}){const{window:n=st,ignore:o=[],capture:h=!0,detectIframe:v=!1}=e;if(!n)return R;if(G&&!Z){Z=!0;const l={passive:!0};Array.from(n.document.body.children).forEach(u=>E(u,"click",R,l)),E(n.document.documentElement,"click",R,l)}let r=!0;const d=l=>M(o).some(u=>{if(typeof u=="string")return Array.from(n.document.querySelectorAll(u)).some(b=>b===l.target||l.composedPath().includes(b));{const b=I(u);return b&&(l.target===b||l.composedPath().includes(b))}});function f(l){const u=M(l);return u&&u.$.subTree.shapeFlag===16}function _(l,u){const b=M(l),m=b.$.subTree&&b.$.subTree.children;return m==null||!Array.isArray(m)?!1:m.some(C=>C.el===u.target||u.composedPath().includes(C.el))}const k=l=>{const u=I(s);if(l.target!=null&&!(!(u instanceof Element)&&f(s)&&_(s,l))&&!(!u||u===l.target||l.composedPath().includes(u))){if(l.detail===0&&(r=!d(l)),!r){r=!0;return}t(l)}};let S=!1;const O=[E(n,"click",l=>{S||(S=!0,setTimeout(()=>{S=!1},0),k(l))},{passive:!0,capture:h}),E(n,"pointerdown",l=>{const u=I(s);r=!d(l)&&!!(u&&!l.composedPath().includes(u))},{passive:!0}),v&&E(n,"blur",l=>{setTimeout(()=>{var u;const b=I(s);((u=n.document.activeElement)==null?void 0:u.tagName)==="IFRAME"&&!(b!=null&&b.contains(n.document.activeElement))&&t(l)},0)},{passive:!0})].filter(Boolean);return()=>O.forEach(l=>l())}const Bt={mounted(s,t){const e=!t.modifiers.bubble;if(typeof t.value=="function")s.__onClickOutside_stop=J(s,t.value,{capture:e});else{const[n,o]=t.value;s.__onClickOutside_stop=J(s,n,Object.assign({capture:e},o))}},unmounted(s){s.__onClickOutside_stop()}};function V(s){return typeof Window<"u"&&s instanceof Window?s.document.documentElement:typeof Document<"u"&&s instanceof Document?s.documentElement:s}function nt(s){const t=window.getComputedStyle(s);if(t.overflowX==="scroll"||t.overflowY==="scroll"||t.overflowX==="auto"&&s.clientWidth<s.scrollWidth||t.overflowY==="auto"&&s.clientHeight<s.scrollHeight)return!0;{const e=s.parentNode;return!e||e.tagName==="BODY"?!1:nt(e)}}function xt(s){const t=s||window.event,e=t.target;return nt(e)?!1:t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)}const q=new WeakMap;function Wt(s,t=!1){const e=y(t);let n=null,o="";B(Pt(s),r=>{const d=V(M(r));if(d){const f=d;if(q.get(f)||q.set(f,f.style.overflow),f.style.overflow!=="hidden"&&(o=f.style.overflow),f.style.overflow==="hidden")return e.value=!0;if(e.value)return f.style.overflow="hidden"}},{immediate:!0});const h=()=>{const r=V(M(s));!r||e.value||(G&&(n=E(r,"touchmove",d=>{xt(d)},{passive:!1})),r.style.overflow="hidden",e.value=!0)},v=()=>{const r=V(M(s));!r||!e.value||(G&&(n==null||n()),r.style.overflow=o,q.delete(r),e.value=!1)};return tt(v),P({get(){return e.value},set(r){r?h():v()}})}function jt(){let s=!1;const t=y(!1);return(e,n)=>{if(t.value=n.value,s)return;s=!0;const o=Wt(e,n.value);B(t,h=>o.value=h)}}jt();const Ht={class:"search-bar"},Nt={class:"filters"},Vt={class:"dropdown-content-wrapper"},qt={class:"dropdown-content"},zt=["src"],Gt=["onClick"],Yt={class:"dropdown-content-item"},Kt=["src"],Xt={class:"dropdown-content-text"},Ut={key:0,style:{"margin-top":"10px","margin-bottom":"10px"}},Zt={class:"songlist"},Jt={class:"song__title"},Qt={class:"book__title"},te={class:"booktext--right"},ee={class:"song__number"},z=50,re=dt({__name:"SearchView",setup(s){ft((a,i)=>{Ct(i.fullPath)});const t=ht(),e=pt("searchParams",{search:"",bookFilters:[]}),n=y(e.value.search),o=P(()=>H(n.value));B(n,a=>{e.value.search=a});const h=y([]),v=y([]),r=y(new Map),d=P(()=>e.value.bookFilters.length>0?h.value.filter(a=>{var i,c;return(((i=a.stripped_title)==null?void 0:i.includes(o.value))||((c=a==null?void 0:a.stripped_first_line)==null?void 0:c.includes(o.value))||(a==null?void 0:a.number)==o.value)&&e.value.bookFilters.find(A=>A==a.book.name.short)}).sort((a,i)=>a.title.replace(/[.,/#!$%^&*;:{}=\-_'"`~()]/g,"").localeCompare(i.title.replace(/[.,/#!$%^&*;:{}=\-_'"`~()]/g,""))):n.value===""?[]:h.value.filter(a=>{var i,c;return((i=a.stripped_title)==null?void 0:i.includes(o.value))||((c=a==null?void 0:a.stripped_first_line)==null?void 0:c.includes(o.value))||(a==null?void 0:a.number)==o.value}).sort((a,i)=>a.title.replace(/[.,/#!$%^&*;:{}=\-_'"`~()]/g,"").localeCompare(i.title.replace(/[.,/#!$%^&*;:{}=\-_'"`~()]/g,"")))),f=y(z),_=P(()=>d.value.length-f.value<z?d.value:d.value.slice(0,f.value));mt(async()=>{const a=await vt(),i=await gt();v.value.push(...Object.values(a));for(const c of Object.keys(i))for(const A of Object.keys(i[c])){let w=i[c][A];w.title==null&&(w.title=""),h.value.push({title:(w==null?void 0:w.title)??"",number:A,book:a[c],stripped_title:H((w==null?void 0:w.title)??""),stripped_first_line:H((w==null?void 0:w.first_line)??"")})}bt.concat(Object.keys(_t)).forEach(async c=>{let A=await kt(c);A!=null&&r.value.set(c,A)}),await wt(),yt(t.fullPath)});const k=y(!1);function S(){k.value=!1}function O(){k.value=!k.value}let g=y([]);function l(a){if(k.value=!0,e.value.bookFilters.includes(a)){let i=e.value.bookFilters.findIndex(c=>c==a);e.value.bookFilters.splice(i,1)}else e.value.bookFilters.push(a)}function u(){e.value.bookFilters=[]}function b(a){return a?"./assets/checkmark-circle.svg":"./assets/ellipse-outline.svg"}function m(a){const i=Et(a??"#000000");return(i==null?void 0:i.length)!==3?"":new Dt(new Q(i[0],i[1],i[2])).solve().filter}const C=y(!1);return U.addListener("keyboardDidShow",()=>{C.value=!0}),U.addListener("keyboardDidHide",()=>{C.value=!1}),(a,i)=>($(),D(W,null,[i[7]||(i[7]=p("h1",{class:"pagetitle"},"Search",-1)),p("div",Ht,[x(p("input",{"onUpdate:modelValue":i[0]||(i[0]=c=>n.value=c),placeholder:"Search for a song title or number...","aria-label":"Search through site content"},null,512),[[St,n.value]]),i[3]||(i[3]=p("button",{disabled:""},[p("svg",{viewBox:"0 0 1024 1024"},[p("path",{class:"path1",d:"M848.471 928l-263.059-263.059c-48.941 36.706-110.118 55.059-177.412 55.059-171.294 0-312-140.706-312-312s140.706-312 312-312c171.294 0 312 140.706 312 312 0 67.294-24.471 128.471-55.059 177.412l263.059 263.059-79.529 79.529zM189.623 408.078c0 121.364 97.091 218.455 218.455 218.455s218.455-97.091 218.455-218.455c0-121.364-103.159-218.455-218.455-218.455-121.364 0-218.455 97.091-218.455 218.455z"})])],-1))]),x(($(),D("div",Nt,[p("a",{onClick:i[1]||(i[1]=c=>O()),class:"dropdown"},i[4]||(i[4]=[p("p",{class:"dropdown-text"},"Filters",-1),p("img",{class:"ionicon filter-icon",src:Lt},null,-1)])),x(p("div",Vt,[p("div",qt,[p("a",null,[p("div",{class:"dropdown-content-top-item",onClick:u},[p("img",{class:"ionicon checkmark-icon",src:b(T(e).bookFilters.length==0)},null,8,zt),i[5]||(i[5]=p("div",{class:"dropdown-content-text"},"All Hymnals",-1))])]),($(!0),D(W,null,Y(v.value,c=>($(),D("a",{key:c.name.medium,onClick:A=>l(c.name.short),ref_for:!0,ref_key:"book_filters",ref:g},[p("div",Yt,[p("img",{class:"ionicon",src:b(T(e).bookFilters.includes(c.name.short)),style:X(m(c.primaryColor))},null,12,Kt),p("div",Xt,F(c.name.medium),1)])],8,Gt))),128))])],512),[[Mt,k.value]])])),[[T(Bt),S]]),d.value.length>0?($(),D("h2",Ut,"Search Results ("+F(d.value.length)+")",1)):j("",!0),p("div",Zt,[($(!0),D(W,null,Y(_.value,c=>($(),K(T($t),{key:c.title+c.number+c.book.name.short,to:`/display/${c.book.name.short}/${c.number}`,class:"song",style:X(`background: linear-gradient(135deg, ${c.book.primaryColor}, ${c.book.secondaryColor})`)},{default:At(()=>[p("div",null,[p("div",Jt,F(c.title),1),p("div",Qt,F(c.book.name.medium),1)]),p("div",te,[p("div",ee,"#"+F(c.number),1)])]),_:2},1032,["to","style"]))),128)),_.value.length<d.value.length?($(),D("div",{key:0,onClick:i[2]||(i[2]=c=>f.value+=z),class:"song",style:{background:"var(--blue)","justify-content":"center"}},i[6]||(i[6]=[p("div",{class:"song__title"},"Show more",-1)]))):j("",!0)]),C.value?j("",!0):($(),K(Ot,{key:1,current_page:"search"}))],64))}});export{re as default};
