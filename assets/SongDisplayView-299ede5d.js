var ar=Object.defineProperty;var cr=(s,e,t)=>e in s?ar(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var st=(s,e,t)=>(cr(s,typeof e!="symbol"?e+"":e,t),t),$t=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var w=(s,e,t)=>($t(s,e,"read from private field"),t?t.call(s):e.get(s)),se=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},Ae=(s,e,t,n)=>($t(s,e,"write to private field"),n?n.call(s,t):e.set(s,t),t),pt=(s,e,t,n)=>({set _(r){Ae(s,e,r,t)},get _(){return w(s,e,n)}}),me=(s,e,t)=>($t(s,e,"access private method"),t);import{_ as _imports_0$1}from"./chevron-back-outline-3b18af6c.js";import{d as defineComponent,r as ref,c as onMounted,K as Capacitor,h as createElementBlock,s as openBlock,L as useMediaQuery,b as useLocalStorage,G as computed,M as readonly,g as getAllBookMetaData,N as onUpdated,j as unref,k as createBlock,l as isRef,O as normalizeClass,m as createCommentVNode,y as pushScopeId,z as popScopeId,i as createBaseVNode,E as _export_sfc,u as useRouter,e as getSongMetaData,P as onUnmounted,t as toDisplayString,F as Fragment,C as _imports_2,q as createVNode,Q as _imports_2$1}from"./index-ab43040b.js";import{_ as _imports_3}from"./bookmark-22c9903e.js";import{_ as _imports_0}from"./wifi_off-0a29b492.js";import{T as Toast}from"./index-d17c0802.js";import{u as useCapacitorPreferences}from"./preferences-89016953.js";const _imports_1="/acchymns-dev/assets/musical-notes-outline.svg";var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function getAugmentedNamespace(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var t=function n(){if(this instanceof n){var r=[null];r.push.apply(r,arguments);var i=Function.bind.apply(e,r);return new i}return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var r=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return s[n]}})}),t}var wheel$1={exports:{}};wheel$1.exports=addWheelListener;wheel$1.exports.addWheelListener=addWheelListener;wheel$1.exports.removeWheelListener=removeWheelListener;function addWheelListener(s,e,t){s.addEventListener("wheel",e,t)}function removeWheelListener(s,e,t){s.removeEventListener("wheel",e,t)}var wheelExports=wheel$1.exports,amator={exports:{}},NEWTON_ITERATIONS=4,NEWTON_MIN_SLOPE=.001,SUBDIVISION_PRECISION=1e-7,SUBDIVISION_MAX_ITERATIONS=10,kSplineTableSize=11,kSampleStepSize=1/(kSplineTableSize-1),float32ArraySupported=typeof Float32Array=="function";function A(s,e){return 1-3*e+3*s}function B(s,e){return 3*e-6*s}function C(s){return 3*s}function calcBezier(s,e,t){return((A(e,t)*s+B(e,t))*s+C(e))*s}function getSlope(s,e,t){return 3*A(e,t)*s*s+2*B(e,t)*s+C(e)}function binarySubdivide(s,e,t,n,r){var i,o,a=0;do o=e+(t-e)/2,i=calcBezier(o,n,r)-s,i>0?t=o:e=o;while(Math.abs(i)>SUBDIVISION_PRECISION&&++a<SUBDIVISION_MAX_ITERATIONS);return o}function newtonRaphsonIterate(s,e,t,n){for(var r=0;r<NEWTON_ITERATIONS;++r){var i=getSlope(e,t,n);if(i===0)return e;var o=calcBezier(e,t,n)-s;e-=o/i}return e}function LinearEasing(s){return s}var src=function(e,t,n,r){if(!(0<=e&&e<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&n===r)return LinearEasing;for(var i=float32ArraySupported?new Float32Array(kSplineTableSize):new Array(kSplineTableSize),o=0;o<kSplineTableSize;++o)i[o]=calcBezier(o*kSampleStepSize,e,n);function a(u){for(var l=0,c=1,h=kSplineTableSize-1;c!==h&&i[c]<=u;++c)l+=kSampleStepSize;--c;var d=(u-i[c])/(i[c+1]-i[c]),p=l+d*kSampleStepSize,f=getSlope(p,e,n);return f>=NEWTON_MIN_SLOPE?newtonRaphsonIterate(u,p,e,n):f===0?p:binarySubdivide(u,l,l+kSampleStepSize,e,n)}return function(l){return l===0?0:l===1?1:calcBezier(a(l),t,r)}},BezierEasing=src,animations={ease:BezierEasing(.25,.1,.25,1),easeIn:BezierEasing(.42,0,1,1),easeOut:BezierEasing(0,0,.58,1),easeInOut:BezierEasing(.42,0,.58,1),linear:BezierEasing(0,0,1,1)};amator.exports=animate$1;amator.exports.makeAggregateRaf=makeAggregateRaf;amator.exports.sharedScheduler=makeAggregateRaf();function animate$1(s,e,t){var n=Object.create(null),r=Object.create(null);t=t||{};var i=typeof t.easing=="function"?t.easing:animations[t.easing];i||(t.easing&&console.warn("Unknown easing function in amator: "+t.easing),i=animations.ease);var o=typeof t.step=="function"?t.step:noop$2,a=typeof t.done=="function"?t.done:noop$2,u=getScheduler(t.scheduler),l=Object.keys(e);l.forEach(function(y){n[y]=s[y],r[y]=e[y]-s[y]});var c=typeof t.duration=="number"?t.duration:400,h=Math.max(1,c*.06),d,p=0;return d=u.next(g),{cancel:f};function f(){u.cancel(d),d=0}function g(){var y=i(p/h);p+=1,v(y),p<=h?(d=u.next(g),o(s)):(d=0,setTimeout(function(){a(s)},0))}function v(y){l.forEach(function(x){s[x]=r[x]*y+n[x]})}}function noop$2(){}function getScheduler(s){if(!s){var e=typeof window<"u"&&window.requestAnimationFrame;return e?rafScheduler():timeoutScheduler()}if(typeof s.next!="function")throw new Error("Scheduler is supposed to have next(cb) function");if(typeof s.cancel!="function")throw new Error("Scheduler is supposed to have cancel(handle) function");return s}function rafScheduler(){return{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}}function timeoutScheduler(){return{next:function(s){return setTimeout(s,1e3/60)},cancel:function(s){return clearTimeout(s)}}}function makeAggregateRaf(){var s=new Set,e=new Set,t=0;return{next:r,cancel:r,clearAll:n};function n(){s.clear(),e.clear(),cancelAnimationFrame(t),t=0}function r(a){e.add(a),i()}function i(){t||(t=requestAnimationFrame(o))}function o(){t=0;var a=e;e=s,s=a,s.forEach(function(u){u()}),s.clear()}}var amatorExports=amator.exports,ngraph_events=function(e){validateSubject(e);var t=createEventsStorage(e);return e.on=t.on,e.off=t.off,e.fire=t.fire,e};function createEventsStorage(s){var e=Object.create(null);return{on:function(t,n,r){if(typeof n!="function")throw new Error("callback is expected to be a function");var i=e[t];return i||(i=e[t]=[]),i.push({callback:n,ctx:r}),s},off:function(t,n){var r=typeof t>"u";if(r)return e=Object.create(null),s;if(e[t]){var i=typeof n!="function";if(i)delete e[t];else for(var o=e[t],a=0;a<o.length;++a)o[a].callback===n&&o.splice(a,1)}return s},fire:function(t){var n=e[t];if(!n)return s;var r;arguments.length>1&&(r=Array.prototype.splice.call(arguments,1));for(var i=0;i<n.length;++i){var o=n[i];o.callback.apply(o.ctx,r)}return s}}}function validateSubject(s){if(!s)throw new Error("Eventify cannot use falsy object as events subject");for(var e=["on","fire","off"],t=0;t<e.length;++t)if(s.hasOwnProperty(e[t]))throw new Error("Subject cannot be eventified, since it already has property '"+e[t]+"'")}var kinetic_1=kinetic$1;function kinetic$1(s,e,t){typeof t!="object"&&(t={});var n=typeof t.minVelocity=="number"?t.minVelocity:5,r=typeof t.amplitude=="number"?t.amplitude:.25,i=typeof t.cancelAnimationFrame=="function"?t.cancelAnimationFrame:getCancelAnimationFrame(),o=typeof t.requestAnimationFrame=="function"?t.requestAnimationFrame:getRequestAnimationFrame(),a,u,l=342,c,h,d,p,f,g,v,y;return{start:R,stop:m,cancel:x};function x(){i(c),i(y)}function R(){a=s(),p=v=h=f=0,u=new Date,i(c),i(y),c=o(k)}function k(){var I=Date.now(),_=I-u;u=I;var S=s(),T=S.x-a.x,E=S.y-a.y;a=S;var L=1e3/(1+_);h=.8*T*L+.2*h,f=.8*E*L+.2*f,c=o(k)}function m(){i(c),i(y);var I=s();d=I.x,g=I.y,u=Date.now(),(h<-n||h>n)&&(p=r*h,d+=p),(f<-n||f>n)&&(v=r*f,g+=v),y=o(b)}function b(){var I=Date.now()-u,_=!1,S=0,T=0;p&&(S=-p*Math.exp(-I/l),S>.5||S<-.5?_=!0:S=p=0),v&&(T=-v*Math.exp(-I/l),T>.5||T<-.5?_=!0:T=v=0),_&&(e(d+S,g+T),y=o(b))}}function getCancelAnimationFrame(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function getRequestAnimationFrame(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(s){return setTimeout(s,16)}}var createTextSelectionInterceptor_1=createTextSelectionInterceptor$1;function createTextSelectionInterceptor$1(s){if(s)return{capture:noop$1,release:noop$1};var e,t,n,r=!1;return{capture:i,release:o};function i(a){r=!0,t=window.document.onselectstart,n=window.document.ondragstart,window.document.onselectstart=disabled,e=a,e.ondragstart=disabled}function o(){r&&(r=!1,window.document.onselectstart=t,e&&(e.ondragstart=n))}}function disabled(s){return s.stopPropagation(),!1}function noop$1(){}var transform,hasRequiredTransform;function requireTransform(){if(hasRequiredTransform)return transform;hasRequiredTransform=1,transform=s;function s(){this.x=0,this.y=0,this.scale=1}return transform}var svgController={exports:{}},hasRequiredSvgController;function requireSvgController(){if(hasRequiredSvgController)return svgController.exports;hasRequiredSvgController=1,svgController.exports=s,svgController.exports.canAttach=e;function s(t,n){if(!e(t))throw new Error("svg element is required for svg.panzoom to work");var r=t.ownerSVGElement;if(!r)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");n.disableKeyboardInteraction||r.setAttribute("tabindex",0);var i={getBBox:a,getScreenCTM:u,getOwner:o,applyTransform:c,initTransform:l};return i;function o(){return r}function a(){var h=t.getBBox();return{left:h.x,top:h.y,width:h.width,height:h.height}}function u(){var h=r.getCTM();return h||r.getScreenCTM()}function l(h){var d=t.getCTM();d===null&&(d=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),h.x=d.e,h.y=d.f,h.scale=d.a,r.removeAttributeNS(null,"viewBox")}function c(h){t.setAttribute("transform","matrix("+h.scale+" 0 0 "+h.scale+" "+h.x+" "+h.y+")")}}function e(t){return t&&t.ownerSVGElement&&t.getCTM}return svgController.exports}var domController={exports:{}},hasRequiredDomController;function requireDomController(){if(hasRequiredDomController)return domController.exports;hasRequiredDomController=1,domController.exports=s,domController.exports.canAttach=e;function s(t,n){var r=e(t);if(!r)throw new Error("panzoom requires DOM element to be attached to the DOM tree");var i=t.parentElement;t.scrollTop=0,n.disableKeyboardInteraction||i.setAttribute("tabindex",0);var o={getBBox:u,getOwner:a,applyTransform:l};return o;function a(){return i}function u(){return{left:0,top:0,width:t.clientWidth,height:t.clientHeight}}function l(c){t.style.transformOrigin="0 0 0",t.style.transform="matrix("+c.scale+", 0, 0, "+c.scale+", "+c.x+", "+c.y+")"}}function e(t){return t&&t.parentElement&&t.style}return domController.exports}var wheel=wheelExports,animate=amatorExports,eventify=ngraph_events,kinetic=kinetic_1,createTextSelectionInterceptor=createTextSelectionInterceptor_1,domTextSelectionInterceptor=createTextSelectionInterceptor(),fakeTextSelectorInterceptor=createTextSelectionInterceptor(!0),Transform=requireTransform(),makeSvgController=requireSvgController(),makeDomController=requireDomController(),defaultZoomSpeed=1,defaultDoubleTapZoomSpeed=1.75,doubleTapSpeedInMS=300,clickEventTimeInMS=200,panzoom=createPanZoom,initialWidth=0,initialHeight=0;function createPanZoom(s,e){initialWidth=s.offsetWidth,initialHeight=s.offsetHeight,e=e||{};var t=e.controller;if(t||(makeSvgController.canAttach(s)?t=makeSvgController(s,e):makeDomController.canAttach(s)&&(t=makeDomController(s,e))),!t)throw new Error("Cannot create panzoom for the current type of dom element");var n=t.getOwner(),r={x:0,y:0},i=!1,o=new Transform;t.initTransform&&t.initTransform(o);var a=typeof e.filterKey=="function"?e.filterKey:noop,u=typeof e.pinchSpeed=="number"?e.pinchSpeed:1,l=e.bounds,c=typeof e.maxZoom=="number"?e.maxZoom:Number.POSITIVE_INFINITY,h=typeof e.minZoom=="number"?e.minZoom:0,d=typeof e.boundsPadding=="number"?e.boundsPadding:.05,p=typeof e.zoomDoubleClickSpeed=="number"?e.zoomDoubleClickSpeed:defaultDoubleTapZoomSpeed,f=e.beforeWheel||noop,g=e.beforeMouseDown||noop,v=typeof e.zoomSpeed=="number"?e.zoomSpeed:defaultZoomSpeed,y=parseTransformOrigin(e.transformOrigin),x=e.enableTextSelection?fakeTextSelectorInterceptor:domTextSelectionInterceptor;validateBounds(l),e.autocenter&&Ee();var R,k=0,m=0,b=0,I=null,_=new Date,S,T=!1,E=!0,L=!0,$=!1,Y,V,j,G,X,q;"smoothScroll"in e&&!e.smoothScroll?q=rigidScroll():q=kinetic(Ve,et,e.smoothScroll);var Z,J,ve,K=!1;M();var O={dispose:fe,moveBy:Fe,moveTo:Ge,smoothMoveTo:Re,centerOn:oe,zoomTo:At,zoomAbs:ce,smoothZoom:lt,smoothZoomAbs:ht,showRectangle:ie,pause:ee,resume:re,isPaused:ye,getTransform:Oe,getMinZoom:Ie,setMinZoom:we,getMaxZoom:Ue,setMaxZoom:Ne,setVerticalPan:ue,setHorizontalPan:pe,getInitWidth:U,getInitHeight:D,getTransformOrigin:be,setTransformOrigin:de,getZoomSpeed:Te,setZoomSpeed:_e};eventify(O);var N=typeof e.initialX=="number"?e.initialX:o.x,F=typeof e.initialY=="number"?e.initialY:o.y,z=typeof e.initialZoom=="number"?e.initialZoom:o.scale;return(N!=o.x||F!=o.y||z!=o.scale)&&ce(N,F,z),O;function D(){return initialHeight}function U(){return initialWidth}function ee(){ne(),K=!0}function re(){K&&(M(),K=!1)}function pe(Ce){E=Ce}function ue(Ce){L=Ce}function ye(){return K}function ie(Ce){var De=n.getBoundingClientRect(),Be=ge(De.width,De.height),Xe=Ce.right-Ce.left,rt=Ce.bottom-Ce.top;if(!Number.isFinite(Xe)||!Number.isFinite(rt))throw new Error("Invalid rectangle");var it=Be.x/Xe,ot=Be.y/rt,ut=Math.min(it,ot);o.x=-(Ce.left+Xe/2)*ut+Be.x/2,o.y=-(Ce.top+rt/2)*ut+Be.y/2,o.scale=ut}function ge(Ce,De){if(t.getScreenCTM){var Be=t.getScreenCTM(),Xe=Be.a,rt=Be.d,it=Be.e,ot=Be.f;r.x=Ce*Xe-it,r.y=De*rt-ot}else r.x=Ce,r.y=De;return r}function Ee(){var Ce,De,Be=0,Xe=0,rt=Ze();if(rt)Be=rt.left,Xe=rt.top,Ce=rt.right-rt.left,De=rt.bottom-rt.top;else{var it=n.getBoundingClientRect();Ce=it.width,De=it.height}var ot=t.getBBox();if(!(ot.width===0||ot.height===0)){var ut=De/ot.height,St=Ce/ot.width,vt=Math.min(St,ut);o.x=-(ot.left+ot.width/2)*vt+Ce/2+Be,o.y=-(ot.top+ot.height/2)*vt+De/2+Xe,o.scale=vt}}function Oe(){return o}function Ie(){return h}function we(Ce){h=Ce}function Ue(){return c}function Ne(Ce){c=Ce}function be(){return y}function de(Ce){y=parseTransformOrigin(Ce)}function Te(){return v}function _e(Ce){if(!Number.isFinite(Ce))throw new Error("Zoom speed should be a number");v=Ce}function Ve(){return{x:o.x,y:o.y}}function Ge(Ce,De){o.x=Ce,o.y=De,$e(),bt("pan"),Ye()}function Ke(Ce,De){Ge(E?o.x+Ce:o.x,L?o.y+De:o.y)}function $e(){var Ce=Ze();if(Ce){var De=!1,Be=Qe(),Xe=Ce.left-Be.right;return Xe>0&&(o.x+=Xe,De=!0),Xe=Ce.right-Be.left,Xe<0&&(o.x+=Xe,De=!0),L&&(Xe=Ce.top-Be.bottom,Xe>0&&(o.y+=Xe,De=!0),Xe=Ce.bottom-Be.top,Xe<0&&(o.y+=Xe,De=!0)),De}}function Ze(){if(l){if(typeof l=="boolean"){var Ce=n.getBoundingClientRect(),De=Ce.width,Be=Ce.height;return{left:De*d,top:Be*d,right:De*(1-d),bottom:Be*(1-d)}}return l}}function Qe(){var Ce=t.getBBox(),De=qe(Ce.left,Ce.top);return{left:De.x,top:De.y,right:Ce.width*o.scale+De.x,bottom:Ce.height*o.scale+De.y}}function qe(Ce,De){return{x:Ce*o.scale+o.x,y:De*o.scale+o.y}}function Ye(){i=!0,R=window.requestAnimationFrame(he)}function Se(Ce,De,Be){if(isNaN$1(Ce)||isNaN$1(De)||isNaN$1(Be))throw new Error("zoom requires valid numbers");var Xe=o.scale*Be;if(Xe<h){if(o.scale===h)return;Be=h/o.scale}if(Xe>c){if(o.scale===c)return;Be=c/o.scale}var rt=ge(Ce,De);if(o.x=rt.x-Be*(rt.x-o.x),o.y=rt.y-Be*(rt.y-o.y),l&&d===1&&h===1)o.scale*=Be,$e();else{var it=$e();it||(o.scale*=Be)}bt("zoom"),Ye()}function ce(Ce,De,Be){var Xe=Be/o.scale;Se(Ce,De,Xe)}function oe(Ce){var De=Ce.ownerSVGElement;if(!De)throw new Error("ui element is required to be within the scene");var Be=Ce.getBoundingClientRect(),Xe=Be.left+Be.width/2,rt=Be.top+Be.height/2,it=De.getBoundingClientRect(),ot=it.width/2-Xe,ut=it.height/2-rt;Fe(ot,ut,!0)}function Re(Ce,De){Fe(Ce-o.x,De-o.y,!0)}function Fe(Ce,De,Be){if(!Be)return Ke(Ce,De);Z&&Z.cancel();var Xe={x:0,y:0},rt={x:Ce,y:De},it=0,ot=0;Z=animate(Xe,rt,{step:function(ut){Ke(ut.x-it,ut.y-ot),it=ut.x,ot=ut.y}})}function et(Ce,De){gt(),Ge(Ce,De)}function fe(){ne()}function M(){n.addEventListener("mousedown",ze,{passive:!1}),n.addEventListener("dblclick",Le,{passive:!1}),n.addEventListener("touchstart",Q,{passive:!1}),n.addEventListener("keydown",W,{passive:!1}),wheel.addWheelListener(n,nt,{passive:!1}),Ye()}function ne(){wheel.removeWheelListener(n,nt),n.removeEventListener("mousedown",ze),n.removeEventListener("keydown",W),n.removeEventListener("dblclick",Le),n.removeEventListener("touchstart",Q),R&&(window.cancelAnimationFrame(R),R=0),q.cancel(),tt(),at(),x.release(),zt()}function he(){i&&ae()}function ae(){i=!1,t.applyTransform(o),bt("transform"),R=0}function W(Ce){var De=0,Be=0,Xe=0;if(Ce.keyCode===38?Be=1:Ce.keyCode===40?Be=-1:Ce.keyCode===37?De=1:Ce.keyCode===39?De=-1:Ce.keyCode===189||Ce.keyCode===109?Xe=1:(Ce.keyCode===187||Ce.keyCode===107)&&(Xe=-1),!a(Ce,De,Be,Xe)){if(De||Be){Ce.preventDefault(),Ce.stopPropagation();var rt=n.getBoundingClientRect(),it=Math.min(rt.width,rt.height),ot=.05,ut=it*ot*De,St=it*ot*Be;Fe(ut,St)}if(Xe){var vt=_t(Xe*100),it=y?dt():P();At(it.x,it.y,vt)}}}function P(){var Ce=n.getBoundingClientRect();return{x:Ce.width/2,y:Ce.height/2}}function Q(Ce){if(H(Ce),We(),Ce.touches.length===1)return le(Ce,Ce.touches[0]);Ce.touches.length===2&&(X=Me(Ce.touches[0],Ce.touches[1]),ve=!0,xe())}function H(Ce){e.onTouch&&!e.onTouch(Ce)||(Ce.stopPropagation(),Ce.preventDefault())}function te(Ce){We(),!(e.onDoubleClick&&!e.onDoubleClick(Ce))&&(Ce.preventDefault(),Ce.stopPropagation())}function le(Ce){m=new Date;var De=Ce.touches[0],Be=ct(De);S=Be;var Xe=ge(Be.x,Be.y);Y=Xe.x,V=Xe.y,j=Y,G=V,q.cancel(),xe()}function xe(){T||(T=!0,document.addEventListener("touchmove",Pe),document.addEventListener("touchend",He),document.addEventListener("touchcancel",He))}function Pe(Ce){if(Ce.touches.length===1){Ce.stopPropagation();var De=Ce.touches[0],Be=ct(De),Xe=ge(Be.x,Be.y),rt=Xe.x-Y,it=Xe.y-V;rt!==0&&it!==0&&bn(),Y=Xe.x,V=Xe.y,Fe(rt,it)}else if(Ce.touches.length===2){ve=!0;var ot=Ce.touches[0],ut=Ce.touches[1],St=Me(ot,ut),vt=1+(St/X-1)*u,Sn=ct(ot),Tn=ct(ut);if(Y=(Sn.x+Tn.x)/2,V=(Sn.y+Tn.y)/2,y){var Be=dt();Y=Be.x,V=Be.y}At(Y,V,vt),X=St,Ce.stopPropagation(),Ce.preventDefault()}}function We(){b&&(clearTimeout(b),b=0)}function ke(Ce){if(e.onClick){We();var De=Y-j,Be=V-G,Xe=Math.sqrt(De*De+Be*Be);Xe>5||(b=setTimeout(function(){b=0,e.onClick(Ce)},doubleTapSpeedInMS))}}function He(Ce){if(We(),Ce.touches.length>0){var De=ct(Ce.touches[0]),Be=ge(De.x,De.y);Y=Be.x,V=Be.y}else{var Xe=new Date;if(Xe-k<doubleTapSpeedInMS)if(y){var De=dt();lt(De.x,De.y,p)}else lt(S.x,S.y,p);else Xe-m<clickEventTimeInMS&&ke(Ce);k=Xe,zt(),at()}}function Me(Ce,De){var Be=Ce.clientX-De.clientX,Xe=Ce.clientY-De.clientY;return Math.sqrt(Be*Be+Xe*Xe)}function Le(Ce){te(Ce);var De=ct(Ce);y&&(De=dt()),lt(De.x,De.y,p)}function ze(Ce){if(We(),!g(Ce)){if(I=Ce,_=new Date,T)return Ce.stopPropagation(),!1;var De=Ce.button===1&&window.event!==null||Ce.button===0;if(De){q.cancel();var Be=ct(Ce),Xe=ge(Be.x,Be.y);return j=Y=Xe.x,G=V=Xe.y,document.addEventListener("mousemove",je),document.addEventListener("mouseup",Je),x.capture(Ce.target||Ce.srcElement),!1}}}function je(Ce){if(!T){bn();var De=ct(Ce),Be=ge(De.x,De.y),Xe=Be.x-Y,rt=Be.y-V;Y=Be.x,V=Be.y,Fe(Xe,rt)}}function Je(){var Ce=new Date;Ce-_<clickEventTimeInMS&&ke(I),x.release(),zt(),tt()}function tt(){document.removeEventListener("mousemove",je),document.removeEventListener("mouseup",Je),$=!1}function at(){document.removeEventListener("touchmove",Pe),document.removeEventListener("touchend",He),document.removeEventListener("touchcancel",He),$=!1,ve=!1,T=!1}function nt(Ce){if(!f(Ce)){q.cancel();var De=Ce.deltaY;Ce.deltaMode>0&&(De*=100);var Be=_t(De);if(Be!==1){var Xe=y?dt():ct(Ce);At(Xe.x,Xe.y,Be),Ce.preventDefault()}}}function ct(Ce){var De,Be,Xe=n.getBoundingClientRect();return De=Ce.clientX-Xe.left,Be=Ce.clientY-Xe.top,{x:De,y:Be}}function lt(Ce,De,Be){var Xe=o.scale,rt={scale:Xe},it={scale:Be*Xe};q.cancel(),gt(),J=animate(rt,it,{step:function(ot){ce(Ce,De,ot.scale)},done:or})}function ht(Ce,De,Be){var Xe=o.scale,rt={scale:Xe},it={scale:Be};q.cancel(),gt(),J=animate(rt,it,{step:function(ot){ce(Ce,De,ot.scale)}})}function dt(){var Ce=n.getBoundingClientRect();return{x:Ce.width*y.x,y:Ce.height*y.y}}function At(Ce,De,Be){return q.cancel(),gt(),Se(Ce,De,Be)}function gt(){J&&(J.cancel(),J=null)}function _t(Ce){var De=Math.sign(Ce),Be=Math.min(.25,Math.abs(v*Ce/128));return 1-De*Be}function bn(){$||(bt("panstart"),$=!0,q.start())}function zt(){$&&(ve||q.stop(),bt("panend"))}function or(){bt("zoomend")}function bt(Ce){O.fire(Ce,O)}}function parseTransformOrigin(s){if(s){if(typeof s=="object")return(!isNumber$1(s.x)||!isNumber$1(s.y))&&failTransformOrigin(s),s;failTransformOrigin()}}function failTransformOrigin(s){throw console.error(s),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join(`
`))}function noop(){}function validateBounds(s){var e=typeof s;if(!(e==="undefined"||e==="boolean")){var t=isNumber$1(s.left)&&isNumber$1(s.top)&&isNumber$1(s.bottom)&&isNumber$1(s.right);if(!t)throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}}function isNumber$1(s){return Number.isFinite(s)}function isNaN$1(s){return Number.isNaN?Number.isNaN(s):s!==s}function rigidScroll(){return{start:noop,stop:noop,cancel:noop}}function autoRun(){if(typeof document>"u")return;var s=document.getElementsByTagName("script");if(!s)return;for(var e,t=0;t<s.length;++t){var n=s[t];if(n.src&&n.src.match(/\bpanzoom(\.min)?\.js/)){e=n;break}}if(!e)return;var r=e.getAttribute("query");if(!r)return;var i=e.getAttribute("name")||"pz",o=Date.now();a();function a(){var c=document.querySelector(r);if(!c){var h=Date.now(),d=h-o;if(d<2e3){setTimeout(a,100);return}console.error("Cannot find the panzoom element",i);return}var p=u(e);console.log(p),window[i]=createPanZoom(c,p)}function u(c){for(var h=c.attributes,d={},p=0;p<h.length;++p){var f=h[p],g=l(f);g&&(d[g.name]=g.value)}return d}function l(c){if(c.name){var h=c.name[0]==="p"&&c.name[1]==="z"&&c.name[2]==="-";if(h){var d=c.name.substr(3),p=JSON.parse(c.value);return{name:d,value:p}}}}}autoRun();const createPanZoom$1=getDefaultExportFromCjs(panzoom);function commonjsRequire(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$6=getAugmentedNamespace(__viteBrowserExternal$1);var path2dPolyfill_min={},hasRequiredPath2dPolyfill_min;function requirePath2dPolyfill_min(){return hasRequiredPath2dPolyfill_min||(hasRequiredPath2dPolyfill_min=1,function(){function s(c,h,d){if(d||arguments.length===2)for(var p,f=0,g=h.length;f<g;f++)!p&&f in h||(p||(p=Array.prototype.slice.call(h,0,f)),p[f]=h[f]);return c.concat(p||Array.prototype.slice.call(h))}var e={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/gi,n=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function r(c){var h=[],d=String(c).trim();return d[0]!=="M"&&d[0]!=="m"||d.replace(t,function(p,f,g){var v=function(R){var k=R.match(n);return k?k.map(Number):[]}(g),y=f.toLowerCase(),x=f;if(y==="m"&&v.length>2&&(h.push(s([x],v.splice(0,2),!0)),y="l",x=x==="m"?"l":"L"),v.length<e[y])return"";for(h.push(s([x],v.splice(0,e[y]),!0));v.length>=e[y]&&v.length&&e[y];)h.push(s([x],v.splice(0,e[y]),!0));return""}),h}function i(c,h){var d=c.x*Math.cos(h)-c.y*Math.sin(h),p=c.y*Math.cos(h)+c.x*Math.sin(h);c.x=d,c.y=p}function o(c,h){c.x*=h,c.y*=h}var a=function(){function c(h){var d;this.commands=[],h&&h instanceof c?(d=this.commands).push.apply(d,h.commands):h&&(this.commands=r(h))}return c.prototype.addPath=function(h){var d;h&&h instanceof c&&(d=this.commands).push.apply(d,h.commands)},c.prototype.moveTo=function(h,d){this.commands.push(["M",h,d])},c.prototype.lineTo=function(h,d){this.commands.push(["L",h,d])},c.prototype.arc=function(h,d,p,f,g,v){this.commands.push(["AC",h,d,p,f,g,!!v])},c.prototype.arcTo=function(h,d,p,f,g){this.commands.push(["AT",h,d,p,f,g])},c.prototype.ellipse=function(h,d,p,f,g,v,y,x){this.commands.push(["E",h,d,p,f,g,v,y,!!x])},c.prototype.closePath=function(){this.commands.push(["Z"])},c.prototype.bezierCurveTo=function(h,d,p,f,g,v){this.commands.push(["C",h,d,p,f,g,v])},c.prototype.quadraticCurveTo=function(h,d,p,f){this.commands.push(["Q",h,d,p,f])},c.prototype.rect=function(h,d,p,f){this.commands.push(["R",h,d,p,f])},c.prototype.roundRect=function(h,d,p,f,g){g===void 0?this.commands.push(["RR",h,d,p,f,0]):this.commands.push(["RR",h,d,p,f,g])},c}();function u(c,h){var d,p,f,g,v,y,x,R,k,m,b,I,_,S,T,E,L,$,Y,V,j,G,X,q,Z=0,J=0,ve=null,K=null,O=null,N=null,F=null,z=null;c.beginPath();for(var D=0;D<h.length;++D){($=h[D][0])!=="S"&&$!=="s"&&$!=="C"&&$!=="c"&&(ve=null,K=null),$!=="T"&&$!=="t"&&$!=="Q"&&$!=="q"&&(O=null,N=null);var U=void 0;switch($){case"m":case"M":U=h[D],$==="m"?(Z+=U[1],J+=U[2]):(Z=U[1],J=U[2]),$!=="M"&&F||(F={x:Z,y:J}),c.moveTo(Z,J);break;case"l":Z+=(U=h[D])[1],J+=U[2],c.lineTo(Z,J);break;case"L":Z=(U=h[D])[1],J=U[2],c.lineTo(Z,J);break;case"H":Z=(U=h[D])[1],c.lineTo(Z,J);break;case"h":Z+=(U=h[D])[1],c.lineTo(Z,J);break;case"V":J=(U=h[D])[1],c.lineTo(Z,J);break;case"v":J+=(U=h[D])[1],c.lineTo(Z,J);break;case"a":case"A":if(U=h[D],z===null)throw new Error("This should never happen");$==="a"?(Z+=U[6],J+=U[7]):(Z=U[6],J=U[7]),S=U[1],T=U[2],x=U[3]*Math.PI/180,f=!!U[4],g=!!U[5],v={x:Z,y:J},i(y={x:(z.x-v.x)/2,y:(z.y-v.y)/2},-x),(R=y.x*y.x/(S*S)+y.y*y.y/(T*T))>1&&(S*=R=Math.sqrt(R),T*=R),k=S*S*T*T,m=S*S*y.y*y.y+T*T*y.x*y.x,o(Y={x:S*y.y/T,y:-T*y.x/S},g!==f?Math.sqrt((k-m)/m)||0:-Math.sqrt((k-m)/m)||0),p=Math.atan2((y.y-Y.y)/T,(y.x-Y.x)/S),d=Math.atan2(-(y.y+Y.y)/T,-(y.x+Y.x)/S),i(Y,x),G=Y,X=(v.x+z.x)/2,q=(v.y+z.y)/2,G.x+=X,G.y+=q,c.save(),c.translate(Y.x,Y.y),c.rotate(x),c.scale(S,T),c.arc(0,0,1,p,d,!g),c.restore();break;case"C":ve=(U=h[D])[3],K=U[4],Z=U[5],J=U[6],c.bezierCurveTo(U[1],U[2],ve,K,Z,J);break;case"c":U=h[D],c.bezierCurveTo(U[1]+Z,U[2]+J,U[3]+Z,U[4]+J,U[5]+Z,U[6]+J),ve=U[3]+Z,K=U[4]+J,Z+=U[5],J+=U[6];break;case"S":U=h[D],ve!==null&&K!==null||(ve=Z,K=J),c.bezierCurveTo(2*Z-ve,2*J-K,U[1],U[2],U[3],U[4]),ve=U[1],K=U[2],Z=U[3],J=U[4];break;case"s":U=h[D],ve!==null&&K!==null||(ve=Z,K=J),c.bezierCurveTo(2*Z-ve,2*J-K,U[1]+Z,U[2]+J,U[3]+Z,U[4]+J),ve=U[1]+Z,K=U[2]+J,Z+=U[3],J+=U[4];break;case"Q":O=(U=h[D])[1],N=U[2],Z=U[3],J=U[4],c.quadraticCurveTo(O,N,Z,J);break;case"q":O=(U=h[D])[1]+Z,N=U[2]+J,Z+=U[3],J+=U[4],c.quadraticCurveTo(O,N,Z,J);break;case"T":O!==null&&N!==null||(O=Z,N=J),O=2*Z-O,N=2*J-N,Z=(U=h[D])[1],J=U[2],c.quadraticCurveTo(O,N,Z,J);break;case"t":O!==null&&N!==null||(O=Z,N=J),O=2*Z-O,N=2*J-N,Z+=(U=h[D])[1],J+=U[2],c.quadraticCurveTo(O,N,Z,J);break;case"z":case"Z":F&&(Z=F.x,J=F.y),F=null,c.closePath();break;case"AC":Z=(U=h[D])[1],J=U[2],_=U[3],p=U[4],d=U[5],V=U[6],c.arc(Z,J,_,p,d,V);break;case"AT":b=(U=h[D])[1],I=U[2],Z=U[3],J=U[4],_=U[5],c.arcTo(b,I,Z,J,_);break;case"E":Z=(U=h[D])[1],J=U[2],S=U[3],T=U[4],x=U[5],p=U[6],d=U[7],V=U[8],c.save(),c.translate(Z,J),c.rotate(x),c.scale(S,T),c.arc(0,0,1,p,d,V),c.restore();break;case"R":Z=(U=h[D])[1],J=U[2],E=U[3],L=U[4],F={x:Z,y:J},c.rect(Z,J,E,L);break;case"RR":Z=(U=h[D])[1],J=U[2],E=U[3],L=U[4],j=U[5],F={x:Z,y:J},c.roundRect(Z,J,E,L,j)}z?(z.x=Z,z.y=J):z={x:Z,y:J}}}function l(c,h,d,p,f){var g=this;if(f===void 0&&(f=0),typeof f=="number"&&(f=[f]),Array.isArray(f)){if(f.length===0||f.length>4)throw new RangeError("Failed to execute 'roundRect' on '".concat(this.constructor.name,"': ").concat(f.length," radii provided. Between one and four radii are necessary."));if(f.forEach(function(m){if(m<0)throw new RangeError("Failed to execute 'roundRect' on '".concat(g.constructor.name,"': Radius value ").concat(m," is negative."))}),f.length===1&&f[0]===0)return this.rect(c,h,d,p);var v,y,x,R=Math.min(d,p)/2,k=v=y=x=Math.min(R,f[0]);f.length===2&&(v=x=Math.min(R,f[1])),f.length===3&&(v=x=Math.min(R,f[1]),y=Math.min(R,f[2])),f.length===4&&(v=Math.min(R,f[1]),y=Math.min(R,f[2]),x=Math.min(R,f[3])),this.moveTo(c,h+p-x),this.arcTo(c,h,c+k,h,k),this.arcTo(c+d,h,c+d,h+v,v),this.arcTo(c+d,h+p,c+d-y,h+p,y),this.arcTo(c,h+p,c,h+p-x,x),this.moveTo(c,h)}}(function(c){if(c&&c.CanvasRenderingContext2D&&!c.Path2D){var h=c.CanvasRenderingContext2D,d=h.prototype.fill,p=h.prototype.stroke,f=h.prototype.isPointInPath;h.prototype.fill=function(){for(var g=[],v=0;v<arguments.length;v++)g[v]=arguments[v];if(!(g[0]instanceof a))return x=g[0]||"nonzero",d.apply(this,[x]);var y=g[0],x=g[1]||"nonzero";u(this,y.commands),d.apply(this,[x])},h.prototype.stroke=function(g){g&&u(this,g.commands),p.apply(this)},h.prototype.isPointInPath=function(){for(var g=[],v=0;v<arguments.length;v++)g[v]=arguments[v];if(g[0]instanceof a){var y=g[0],x=g[1],R=g[2],k=g[3]||"nonzero";return u(this,y.commands),f.apply(this,[x,R,k])}return f.apply(this,g)},c.Path2D=a}})(window),function(c){if(c&&c.CanvasRenderingContext2D){var h=c.CanvasRenderingContext2D,d=c.Path2D;h&&!h.prototype.roundRect&&(h.prototype.roundRect=l),d&&!d.prototype.roundRect&&(d.prototype.roundRect=l)}}(window)}()),path2dPolyfill_min}(function(module,exports){(function(e,t){module.exports=t()})(globalThis,()=>(()=>{var __webpack_modules__=[,(s,e,t)=>{var Ye;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=Z,e.bytesToString=pe,e.createValidAbsoluteUrl=ve,e.getModificationDate=Ge,e.getUuid=qe,e.getVerbosityLevel=j,e.info=G,e.isArrayBuffer=_e,e.isArrayEqual=Ve,e.isNodeJS=void 0,e.normalizeUnicode=Qe,e.objectFromMap=ge,e.objectSize=ie,e.setVerbosityLevel=V,e.shadow=K,e.string32=ye,e.stringToBytes=ue,e.stringToPDFString=be,e.stringToUTF8String=de,e.unreachable=q,e.utf8StringToString=Te,e.warn=X,t(2),t(84),t(86),t(87),t(89),t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123);const n=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=n;const r=[1,0,0,1,0,0];e.IDENTITY_MATRIX=r;const i=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=i;const o=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=o;const a=1.35;e.LINE_FACTOR=a;const u=.35;e.LINE_DESCENT_FACTOR=u;const l=u/a;e.BASELINE_FACTOR=l;const c={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=c;const h={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=h;const d="pdfjs_internal_editor_";e.AnnotationEditorPrefix=d;const p={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=p;const f={RESIZE:1,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=f;const g={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=g;const v={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=v;const y={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=y;const x={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=x;const R={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=R;const k={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=k;const m={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=m;const b={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=b;const I={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=I;const _={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=_;const S={O:"PageOpen",C:"PageClose"};e.PageActionEventType=S;const T={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=T;const E={NONE:0,BINARY:1};e.CMapCompressionType=E;const L={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=L;const $={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=$;let Y=T.WARNINGS;function V(Se){Number.isInteger(Se)&&(Y=Se)}function j(){return Y}function G(Se){Y>=T.INFOS&&console.log(`Info: ${Se}`)}function X(Se){Y>=T.WARNINGS&&console.log(`Warning: ${Se}`)}function q(Se){throw new Error(Se)}function Z(Se,ce){Se||q(ce)}function J(Se){switch(Se==null?void 0:Se.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ve(Se){let ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,oe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!Se)return null;try{if(oe&&typeof Se=="string"){if(oe.addDefaultProtocol&&Se.startsWith("www.")){const Fe=Se.match(/\./g);(Fe==null?void 0:Fe.length)>=2&&(Se=`http://${Se}`)}if(oe.tryConvertEncoding)try{Se=de(Se)}catch{}}const Re=ce?new URL(Se,ce):new URL(Se);if(J(Re))return Re}catch{}return null}function K(Se,ce,oe){let Re=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return Object.defineProperty(Se,ce,{value:oe,enumerable:!Re,configurable:!0,writable:!1}),oe}const O=function(){function ce(oe,Re){this.constructor===ce&&q("Cannot initialize BaseException."),this.message=oe,this.name=Re}return ce.prototype=new Error,ce.constructor=ce,ce}();e.BaseException=O;class N extends O{constructor(ce,oe){super(ce,"PasswordException"),this.code=oe}}e.PasswordException=N;class F extends O{constructor(ce,oe){super(ce,"UnknownErrorException"),this.details=oe}}e.UnknownErrorException=F;class z extends O{constructor(ce){super(ce,"InvalidPDFException")}}e.InvalidPDFException=z;class D extends O{constructor(ce){super(ce,"MissingPDFException")}}e.MissingPDFException=D;class U extends O{constructor(ce,oe){super(ce,"UnexpectedResponseException"),this.status=oe}}e.UnexpectedResponseException=U;class ee extends O{constructor(ce){super(ce,"FormatError")}}e.FormatError=ee;class re extends O{constructor(ce){super(ce,"AbortException")}}e.AbortException=re;function pe(Se){(typeof Se!="object"||(Se==null?void 0:Se.length)===void 0)&&q("Invalid argument for bytesToString");const ce=Se.length,oe=8192;if(ce<oe)return String.fromCharCode.apply(null,Se);const Re=[];for(let Fe=0;Fe<ce;Fe+=oe){const et=Math.min(Fe+oe,ce),fe=Se.subarray(Fe,et);Re.push(String.fromCharCode.apply(null,fe))}return Re.join("")}function ue(Se){typeof Se!="string"&&q("Invalid argument for stringToBytes");const ce=Se.length,oe=new Uint8Array(ce);for(let Re=0;Re<ce;++Re)oe[Re]=Se.charCodeAt(Re)&255;return oe}function ye(Se){return String.fromCharCode(Se>>24&255,Se>>16&255,Se>>8&255,Se&255)}function ie(Se){return Object.keys(Se).length}function ge(Se){const ce=Object.create(null);for(const[oe,Re]of Se)ce[oe]=Re;return ce}function Ee(){const Se=new Uint8Array(4);return Se[0]=1,new Uint32Array(Se.buffer,0,1)[0]===1}function Oe(){try{return new Function(""),!0}catch{return!1}}class Ie{static get isLittleEndian(){return K(this,"isLittleEndian",Ee())}static get isEvalSupported(){return K(this,"isEvalSupported",Oe())}static get isOffscreenCanvasSupported(){return K(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?K(this,"platform",{isWin:!1,isMac:!1}):K(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}e.FeatureTest=Ie;const we=[...Array(256).keys()].map(Se=>Se.toString(16).padStart(2,"0"));class Ue{static makeHexColor(ce,oe,Re){return`#${we[ce]}${we[oe]}${we[Re]}`}static scaleMinMax(ce,oe){let Re;ce[0]?(ce[0]<0&&(Re=oe[0],oe[0]=oe[1],oe[1]=Re),oe[0]*=ce[0],oe[1]*=ce[0],ce[3]<0&&(Re=oe[2],oe[2]=oe[3],oe[3]=Re),oe[2]*=ce[3],oe[3]*=ce[3]):(Re=oe[0],oe[0]=oe[2],oe[2]=Re,Re=oe[1],oe[1]=oe[3],oe[3]=Re,ce[1]<0&&(Re=oe[2],oe[2]=oe[3],oe[3]=Re),oe[2]*=ce[1],oe[3]*=ce[1],ce[2]<0&&(Re=oe[0],oe[0]=oe[1],oe[1]=Re),oe[0]*=ce[2],oe[1]*=ce[2]),oe[0]+=ce[4],oe[1]+=ce[4],oe[2]+=ce[5],oe[3]+=ce[5]}static transform(ce,oe){return[ce[0]*oe[0]+ce[2]*oe[1],ce[1]*oe[0]+ce[3]*oe[1],ce[0]*oe[2]+ce[2]*oe[3],ce[1]*oe[2]+ce[3]*oe[3],ce[0]*oe[4]+ce[2]*oe[5]+ce[4],ce[1]*oe[4]+ce[3]*oe[5]+ce[5]]}static applyTransform(ce,oe){const Re=ce[0]*oe[0]+ce[1]*oe[2]+oe[4],Fe=ce[0]*oe[1]+ce[1]*oe[3]+oe[5];return[Re,Fe]}static applyInverseTransform(ce,oe){const Re=oe[0]*oe[3]-oe[1]*oe[2],Fe=(ce[0]*oe[3]-ce[1]*oe[2]+oe[2]*oe[5]-oe[4]*oe[3])/Re,et=(-ce[0]*oe[1]+ce[1]*oe[0]+oe[4]*oe[1]-oe[5]*oe[0])/Re;return[Fe,et]}static getAxialAlignedBoundingBox(ce,oe){const Re=this.applyTransform(ce,oe),Fe=this.applyTransform(ce.slice(2,4),oe),et=this.applyTransform([ce[0],ce[3]],oe),fe=this.applyTransform([ce[2],ce[1]],oe);return[Math.min(Re[0],Fe[0],et[0],fe[0]),Math.min(Re[1],Fe[1],et[1],fe[1]),Math.max(Re[0],Fe[0],et[0],fe[0]),Math.max(Re[1],Fe[1],et[1],fe[1])]}static inverseTransform(ce){const oe=ce[0]*ce[3]-ce[1]*ce[2];return[ce[3]/oe,-ce[1]/oe,-ce[2]/oe,ce[0]/oe,(ce[2]*ce[5]-ce[4]*ce[3])/oe,(ce[4]*ce[1]-ce[5]*ce[0])/oe]}static singularValueDecompose2dScale(ce){const oe=[ce[0],ce[2],ce[1],ce[3]],Re=ce[0]*oe[0]+ce[1]*oe[2],Fe=ce[0]*oe[1]+ce[1]*oe[3],et=ce[2]*oe[0]+ce[3]*oe[2],fe=ce[2]*oe[1]+ce[3]*oe[3],M=(Re+fe)/2,ne=Math.sqrt((Re+fe)**2-4*(Re*fe-et*Fe))/2,he=M+ne||1,ae=M-ne||1;return[Math.sqrt(he),Math.sqrt(ae)]}static normalizeRect(ce){const oe=ce.slice(0);return ce[0]>ce[2]&&(oe[0]=ce[2],oe[2]=ce[0]),ce[1]>ce[3]&&(oe[1]=ce[3],oe[3]=ce[1]),oe}static intersect(ce,oe){const Re=Math.max(Math.min(ce[0],ce[2]),Math.min(oe[0],oe[2])),Fe=Math.min(Math.max(ce[0],ce[2]),Math.max(oe[0],oe[2]));if(Re>Fe)return null;const et=Math.max(Math.min(ce[1],ce[3]),Math.min(oe[1],oe[3])),fe=Math.min(Math.max(ce[1],ce[3]),Math.max(oe[1],oe[3]));return et>fe?null:[Re,et,Fe,fe]}static bezierBoundingBox(ce,oe,Re,Fe,et,fe,M,ne){const he=[],ae=[[],[]];let W,P,Q,H,te,le,xe,Pe;for(let Me=0;Me<2;++Me){if(Me===0?(P=6*ce-12*Re+6*et,W=-3*ce+9*Re-9*et+3*M,Q=3*Re-3*ce):(P=6*oe-12*Fe+6*fe,W=-3*oe+9*Fe-9*fe+3*ne,Q=3*Fe-3*oe),Math.abs(W)<1e-12){if(Math.abs(P)<1e-12)continue;H=-Q/P,0<H&&H<1&&he.push(H);continue}xe=P*P-4*Q*W,Pe=Math.sqrt(xe),!(xe<0)&&(te=(-P+Pe)/(2*W),0<te&&te<1&&he.push(te),le=(-P-Pe)/(2*W),0<le&&le<1&&he.push(le))}let We=he.length,ke;const He=We;for(;We--;)H=he[We],ke=1-H,ae[0][We]=ke*ke*ke*ce+3*ke*ke*H*Re+3*ke*H*H*et+H*H*H*M,ae[1][We]=ke*ke*ke*oe+3*ke*ke*H*Fe+3*ke*H*H*fe+H*H*H*ne;return ae[0][He]=ce,ae[1][He]=oe,ae[0][He+1]=M,ae[1][He+1]=ne,ae[0].length=ae[1].length=He+2,[Math.min(...ae[0]),Math.min(...ae[1]),Math.max(...ae[0]),Math.max(...ae[1])]}}e.Util=Ue;const Ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function be(Se){if(Se[0]>="ï"){let oe;if(Se[0]==="þ"&&Se[1]==="ÿ"?oe="utf-16be":Se[0]==="ÿ"&&Se[1]==="þ"?oe="utf-16le":Se[0]==="ï"&&Se[1]==="»"&&Se[2]==="¿"&&(oe="utf-8"),oe)try{const Re=new TextDecoder(oe,{fatal:!0}),Fe=ue(Se);return Re.decode(Fe)}catch(Re){X(`stringToPDFString: "${Re}".`)}}const ce=[];for(let oe=0,Re=Se.length;oe<Re;oe++){const Fe=Ne[Se.charCodeAt(oe)];ce.push(Fe?String.fromCharCode(Fe):Se.charAt(oe))}return ce.join("")}function de(Se){return decodeURIComponent(escape(Se))}function Te(Se){return unescape(encodeURIComponent(Se))}function _e(Se){return typeof Se=="object"&&(Se==null?void 0:Se.byteLength)!==void 0}function Ve(Se,ce){if(Se.length!==ce.length)return!1;for(let oe=0,Re=Se.length;oe<Re;oe++)if(Se[oe]!==ce[oe])return!1;return!0}function Ge(){let Se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Date;return[Se.getUTCFullYear().toString(),(Se.getUTCMonth()+1).toString().padStart(2,"0"),Se.getUTCDate().toString().padStart(2,"0"),Se.getUTCHours().toString().padStart(2,"0"),Se.getUTCMinutes().toString().padStart(2,"0"),Se.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ke{constructor(){se(this,Ye,!1);this.promise=new Promise((ce,oe)=>{this.resolve=Re=>{Ae(this,Ye,!0),ce(Re)},this.reject=Re=>{Ae(this,Ye,!0),oe(Re)}})}get settled(){return w(this,Ye)}}Ye=new WeakMap,e.PromiseCapability=Ke;let $e=null,Ze=null;function Qe(Se){return $e||($e=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ze=new Map([["ﬅ","ſt"]])),Se.replaceAll($e,(ce,oe,Re)=>oe?oe.normalize("NFKC"):Ze.get(Re))}function qe(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Se=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Se);else for(let ce=0;ce<32;ce++)Se[ce]=Math.floor(Math.random()*255);return pe(Se)}},(s,e,t)=>{var n=t(3),r=t(4),i=t(69),o=t(70),a="WebAssembly",u=r[a],l=Error("e",{cause:7}).cause!==7,c=function(d,p){var f={};f[d]=o(d,p,l),n({global:!0,constructor:!0,arity:1,forced:l},f)},h=function(d,p){if(u&&u[d]){var f={};f[d]=o(a+"."+d,p,l),n({target:a,stat:!0,constructor:!0,arity:1,forced:l},f)}};c("Error",function(d){return function(f){return i(d,this,arguments)}}),c("EvalError",function(d){return function(f){return i(d,this,arguments)}}),c("RangeError",function(d){return function(f){return i(d,this,arguments)}}),c("ReferenceError",function(d){return function(f){return i(d,this,arguments)}}),c("SyntaxError",function(d){return function(f){return i(d,this,arguments)}}),c("TypeError",function(d){return function(f){return i(d,this,arguments)}}),c("URIError",function(d){return function(f){return i(d,this,arguments)}}),h("CompileError",function(d){return function(f){return i(d,this,arguments)}}),h("LinkError",function(d){return function(f){return i(d,this,arguments)}}),h("RuntimeError",function(d){return function(f){return i(d,this,arguments)}})},(s,e,t)=>{var n=t(4),r=t(5).f,i=t(44),o=t(48),a=t(38),u=t(56),l=t(68);s.exports=function(c,h){var d=c.target,p=c.global,f=c.stat,g,v,y,x,R,k;if(p?v=n:f?v=n[d]||a(d,{}):v=(n[d]||{}).prototype,v)for(y in h){if(R=h[y],c.dontCallGetSet?(k=r(v,y),x=k&&k.value):x=v[y],g=l(p?y:d+(f?".":"#")+y,c.forced),!g&&x!==void 0){if(typeof R==typeof x)continue;u(R,x)}(c.sham||x&&x.sham)&&i(R,"sham",!0),o(v,y,R,c)}}},function(s){var e=function(t){return t&&t.Math==Math&&t};s.exports=e(typeof globalThis=="object"&&globalThis)||e(typeof window=="object"&&window)||e(typeof self=="object"&&self)||e(typeof commonjsGlobal=="object"&&commonjsGlobal)||function(){return this}()||this||Function("return this")()},(s,e,t)=>{var n=t(6),r=t(8),i=t(10),o=t(11),a=t(12),u=t(18),l=t(39),c=t(42),h=Object.getOwnPropertyDescriptor;e.f=n?h:function(p,f){if(p=a(p),f=u(f),c)try{return h(p,f)}catch{}if(l(p,f))return o(!r(i.f,p,f),p[f])}},(s,e,t)=>{var n=t(7);s.exports=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},s=>{s.exports=function(e){try{return!!e()}catch{return!0}}},(s,e,t)=>{var n=t(9),r=Function.prototype.call;s.exports=n?r.bind(r):function(){return r.apply(r,arguments)}},(s,e,t)=>{var n=t(7);s.exports=!n(function(){var r=function(){}.bind();return typeof r!="function"||r.hasOwnProperty("prototype")})},(s,e)=>{var t={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,r=n&&!t.call({1:2},1);e.f=r?function(o){var a=n(this,o);return!!a&&a.enumerable}:t},s=>{s.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}},(s,e,t)=>{var n=t(13),r=t(16);s.exports=function(i){return n(r(i))}},(s,e,t)=>{var n=t(14),r=t(7),i=t(15),o=Object,a=n("".split);s.exports=r(function(){return!o("z").propertyIsEnumerable(0)})?function(u){return i(u)=="String"?a(u,""):o(u)}:o},(s,e,t)=>{var n=t(9),r=Function.prototype,i=r.call,o=n&&r.bind.bind(i,i);s.exports=n?o:function(a){return function(){return i.apply(a,arguments)}}},(s,e,t)=>{var n=t(14),r=n({}.toString),i=n("".slice);s.exports=function(o){return i(r(o),8,-1)}},(s,e,t)=>{var n=t(17),r=TypeError;s.exports=function(i){if(n(i))throw r("Can't call method on "+i);return i}},s=>{s.exports=function(e){return e==null}},(s,e,t)=>{var n=t(19),r=t(23);s.exports=function(i){var o=n(i,"string");return r(o)?o:o+""}},(s,e,t)=>{var n=t(8),r=t(20),i=t(23),o=t(30),a=t(33),u=t(34),l=TypeError,c=u("toPrimitive");s.exports=function(h,d){if(!r(h)||i(h))return h;var p=o(h,c),f;if(p){if(d===void 0&&(d="default"),f=n(p,h,d),!r(f)||i(f))return f;throw l("Can't convert object to primitive value")}return d===void 0&&(d="number"),a(h,d)}},(s,e,t)=>{var n=t(21),r=t(22),i=r.all;s.exports=r.IS_HTMLDDA?function(o){return typeof o=="object"?o!==null:n(o)||o===i}:function(o){return typeof o=="object"?o!==null:n(o)}},(s,e,t)=>{var n=t(22),r=n.all;s.exports=n.IS_HTMLDDA?function(i){return typeof i=="function"||i===r}:function(i){return typeof i=="function"}},s=>{var e=typeof document=="object"&&document.all,t=typeof e>"u"&&e!==void 0;s.exports={all:e,IS_HTMLDDA:t}},(s,e,t)=>{var n=t(24),r=t(21),i=t(25),o=t(26),a=Object;s.exports=o?function(u){return typeof u=="symbol"}:function(u){var l=n("Symbol");return r(l)&&i(l.prototype,a(u))}},(s,e,t)=>{var n=t(4),r=t(21),i=function(o){return r(o)?o:void 0};s.exports=function(o,a){return arguments.length<2?i(n[o]):n[o]&&n[o][a]}},(s,e,t)=>{var n=t(14);s.exports=n({}.isPrototypeOf)},(s,e,t)=>{var n=t(27);s.exports=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},(s,e,t)=>{var n=t(28),r=t(7),i=t(4),o=i.String;s.exports=!!Object.getOwnPropertySymbols&&!r(function(){var a=Symbol();return!o(a)||!(Object(a)instanceof Symbol)||!Symbol.sham&&n&&n<41})},(s,e,t)=>{var n=t(4),r=t(29),i=n.process,o=n.Deno,a=i&&i.versions||o&&o.version,u=a&&a.v8,l,c;u&&(l=u.split("."),c=l[0]>0&&l[0]<4?1:+(l[0]+l[1])),!c&&r&&(l=r.match(/Edge\/(\d+)/),(!l||l[1]>=74)&&(l=r.match(/Chrome\/(\d+)/),l&&(c=+l[1]))),s.exports=c},s=>{s.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},(s,e,t)=>{var n=t(31),r=t(17);s.exports=function(i,o){var a=i[o];return r(a)?void 0:n(a)}},(s,e,t)=>{var n=t(21),r=t(32),i=TypeError;s.exports=function(o){if(n(o))return o;throw i(r(o)+" is not a function")}},s=>{var e=String;s.exports=function(t){try{return e(t)}catch{return"Object"}}},(s,e,t)=>{var n=t(8),r=t(21),i=t(20),o=TypeError;s.exports=function(a,u){var l,c;if(u==="string"&&r(l=a.toString)&&!i(c=n(l,a))||r(l=a.valueOf)&&!i(c=n(l,a))||u!=="string"&&r(l=a.toString)&&!i(c=n(l,a)))return c;throw o("Can't convert object to primitive value")}},(s,e,t)=>{var n=t(4),r=t(35),i=t(39),o=t(41),a=t(27),u=t(26),l=n.Symbol,c=r("wks"),h=u?l.for||l:l&&l.withoutSetter||o;s.exports=function(d){return i(c,d)||(c[d]=a&&i(l,d)?l[d]:h("Symbol."+d)),c[d]}},(s,e,t)=>{var n=t(36),r=t(37);(s.exports=function(i,o){return r[i]||(r[i]=o!==void 0?o:{})})("versions",[]).push({version:"3.31.1",mode:n?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"})},s=>{s.exports=!1},(s,e,t)=>{var n=t(4),r=t(38),i="__core-js_shared__",o=n[i]||r(i,{});s.exports=o},(s,e,t)=>{var n=t(4),r=Object.defineProperty;s.exports=function(i,o){try{r(n,i,{value:o,configurable:!0,writable:!0})}catch{n[i]=o}return o}},(s,e,t)=>{var n=t(14),r=t(40),i=n({}.hasOwnProperty);s.exports=Object.hasOwn||function(a,u){return i(r(a),u)}},(s,e,t)=>{var n=t(16),r=Object;s.exports=function(i){return r(n(i))}},(s,e,t)=>{var n=t(14),r=0,i=Math.random(),o=n(1 .toString);s.exports=function(a){return"Symbol("+(a===void 0?"":a)+")_"+o(++r+i,36)}},(s,e,t)=>{var n=t(6),r=t(7),i=t(43);s.exports=!n&&!r(function(){return Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a!=7})},(s,e,t)=>{var n=t(4),r=t(20),i=n.document,o=r(i)&&r(i.createElement);s.exports=function(a){return o?i.createElement(a):{}}},(s,e,t)=>{var n=t(6),r=t(45),i=t(11);s.exports=n?function(o,a,u){return r.f(o,a,i(1,u))}:function(o,a,u){return o[a]=u,o}},(s,e,t)=>{var n=t(6),r=t(42),i=t(46),o=t(47),a=t(18),u=TypeError,l=Object.defineProperty,c=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",p="writable";e.f=n?i?function(g,v,y){if(o(g),v=a(v),o(y),typeof g=="function"&&v==="prototype"&&"value"in y&&p in y&&!y[p]){var x=c(g,v);x&&x[p]&&(g[v]=y.value,y={configurable:d in y?y[d]:x[d],enumerable:h in y?y[h]:x[h],writable:!1})}return l(g,v,y)}:l:function(g,v,y){if(o(g),v=a(v),o(y),r)try{return l(g,v,y)}catch{}if("get"in y||"set"in y)throw u("Accessors not supported");return"value"in y&&(g[v]=y.value),g}},(s,e,t)=>{var n=t(6),r=t(7);s.exports=n&&r(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},(s,e,t)=>{var n=t(20),r=String,i=TypeError;s.exports=function(o){if(n(o))return o;throw i(r(o)+" is not an object")}},(s,e,t)=>{var n=t(21),r=t(45),i=t(49),o=t(38);s.exports=function(a,u,l,c){c||(c={});var h=c.enumerable,d=c.name!==void 0?c.name:u;if(n(l)&&i(l,d,c),c.global)h?a[u]=l:o(u,l);else{try{c.unsafe?a[u]&&(h=!0):delete a[u]}catch{}h?a[u]=l:r.f(a,u,{value:l,enumerable:!1,configurable:!c.nonConfigurable,writable:!c.nonWritable})}return a}},(s,e,t)=>{var n=t(14),r=t(7),i=t(21),o=t(39),a=t(6),u=t(50).CONFIGURABLE,l=t(51),c=t(52),h=c.enforce,d=c.get,p=String,f=Object.defineProperty,g=n("".slice),v=n("".replace),y=n([].join),x=a&&!r(function(){return f(function(){},"length",{value:8}).length!==8}),R=String(String).split("String"),k=s.exports=function(m,b,I){g(p(b),0,7)==="Symbol("&&(b="["+v(p(b),/^Symbol\(([^)]*)\)/,"$1")+"]"),I&&I.getter&&(b="get "+b),I&&I.setter&&(b="set "+b),(!o(m,"name")||u&&m.name!==b)&&(a?f(m,"name",{value:b,configurable:!0}):m.name=b),x&&I&&o(I,"arity")&&m.length!==I.arity&&f(m,"length",{value:I.arity});try{I&&o(I,"constructor")&&I.constructor?a&&f(m,"prototype",{writable:!1}):m.prototype&&(m.prototype=void 0)}catch{}var _=h(m);return o(_,"source")||(_.source=y(R,typeof b=="string"?b:"")),m};Function.prototype.toString=k(function(){return i(this)&&d(this).source||l(this)},"toString")},(s,e,t)=>{var n=t(6),r=t(39),i=Function.prototype,o=n&&Object.getOwnPropertyDescriptor,a=r(i,"name"),u=a&&function(){}.name==="something",l=a&&(!n||n&&o(i,"name").configurable);s.exports={EXISTS:a,PROPER:u,CONFIGURABLE:l}},(s,e,t)=>{var n=t(14),r=t(21),i=t(37),o=n(Function.toString);r(i.inspectSource)||(i.inspectSource=function(a){return o(a)}),s.exports=i.inspectSource},(s,e,t)=>{var n=t(53),r=t(4),i=t(20),o=t(44),a=t(39),u=t(37),l=t(54),c=t(55),h="Object already initialized",d=r.TypeError,p=r.WeakMap,f,g,v,y=function(m){return v(m)?g(m):f(m,{})},x=function(m){return function(b){var I;if(!i(b)||(I=g(b)).type!==m)throw d("Incompatible receiver, "+m+" required");return I}};if(n||u.state){var R=u.state||(u.state=new p);R.get=R.get,R.has=R.has,R.set=R.set,f=function(m,b){if(R.has(m))throw d(h);return b.facade=m,R.set(m,b),b},g=function(m){return R.get(m)||{}},v=function(m){return R.has(m)}}else{var k=l("state");c[k]=!0,f=function(m,b){if(a(m,k))throw d(h);return b.facade=m,o(m,k,b),b},g=function(m){return a(m,k)?m[k]:{}},v=function(m){return a(m,k)}}s.exports={set:f,get:g,has:v,enforce:y,getterFor:x}},(s,e,t)=>{var n=t(4),r=t(21),i=n.WeakMap;s.exports=r(i)&&/native code/.test(String(i))},(s,e,t)=>{var n=t(35),r=t(41),i=n("keys");s.exports=function(o){return i[o]||(i[o]=r(o))}},s=>{s.exports={}},(s,e,t)=>{var n=t(39),r=t(57),i=t(5),o=t(45);s.exports=function(a,u,l){for(var c=r(u),h=o.f,d=i.f,p=0;p<c.length;p++){var f=c[p];!n(a,f)&&!(l&&n(l,f))&&h(a,f,d(u,f))}}},(s,e,t)=>{var n=t(24),r=t(14),i=t(58),o=t(67),a=t(47),u=r([].concat);s.exports=n("Reflect","ownKeys")||function(c){var h=i.f(a(c)),d=o.f;return d?u(h,d(c)):h}},(s,e,t)=>{var n=t(59),r=t(66),i=r.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(a){return n(a,i)}},(s,e,t)=>{var n=t(14),r=t(39),i=t(12),o=t(60).indexOf,a=t(55),u=n([].push);s.exports=function(l,c){var h=i(l),d=0,p=[],f;for(f in h)!r(a,f)&&r(h,f)&&u(p,f);for(;c.length>d;)r(h,f=c[d++])&&(~o(p,f)||u(p,f));return p}},(s,e,t)=>{var n=t(12),r=t(61),i=t(64),o=function(a){return function(u,l,c){var h=n(u),d=i(h),p=r(c,d),f;if(a&&l!=l){for(;d>p;)if(f=h[p++],f!=f)return!0}else for(;d>p;p++)if((a||p in h)&&h[p]===l)return a||p||0;return!a&&-1}};s.exports={includes:o(!0),indexOf:o(!1)}},(s,e,t)=>{var n=t(62),r=Math.max,i=Math.min;s.exports=function(o,a){var u=n(o);return u<0?r(u+a,0):i(u,a)}},(s,e,t)=>{var n=t(63);s.exports=function(r){var i=+r;return i!==i||i===0?0:n(i)}},s=>{var e=Math.ceil,t=Math.floor;s.exports=Math.trunc||function(r){var i=+r;return(i>0?t:e)(i)}},(s,e,t)=>{var n=t(65);s.exports=function(r){return n(r.length)}},(s,e,t)=>{var n=t(62),r=Math.min;s.exports=function(i){return i>0?r(n(i),9007199254740991):0}},s=>{s.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},(s,e)=>{e.f=Object.getOwnPropertySymbols},(s,e,t)=>{var n=t(7),r=t(21),i=/#|\.prototype\./,o=function(h,d){var p=u[a(h)];return p==c?!0:p==l?!1:r(d)?n(d):!!d},a=o.normalize=function(h){return String(h).replace(i,".").toLowerCase()},u=o.data={},l=o.NATIVE="N",c=o.POLYFILL="P";s.exports=o},(s,e,t)=>{var n=t(9),r=Function.prototype,i=r.apply,o=r.call;s.exports=typeof Reflect=="object"&&Reflect.apply||(n?o.bind(i):function(){return o.apply(i,arguments)})},(s,e,t)=>{var n=t(24),r=t(39),i=t(44),o=t(25),a=t(71),u=t(56),l=t(74),c=t(75),h=t(76),d=t(80),p=t(81),f=t(6),g=t(36);s.exports=function(v,y,x,R){var k="stackTraceLimit",m=R?2:1,b=v.split("."),I=b[b.length-1],_=n.apply(null,b);if(_){var S=_.prototype;if(!g&&r(S,"cause")&&delete S.cause,!x)return _;var T=n("Error"),E=y(function(L,$){var Y=h(R?$:L,void 0),V=R?new _(L):new _;return Y!==void 0&&i(V,"message",Y),p(V,E,V.stack,2),this&&o(S,this)&&c(V,this,E),arguments.length>m&&d(V,arguments[m]),V});if(E.prototype=S,I!=="Error"?a?a(E,T):u(E,T,{name:!0}):f&&k in _&&(l(E,_,k),l(E,_,"prepareStackTrace")),u(E,_),!g)try{S.name!==I&&i(S,"name",I),S.constructor=E}catch{}return E}}},(s,e,t)=>{var n=t(72),r=t(47),i=t(73);s.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var o=!1,a={},u;try{u=n(Object.prototype,"__proto__","set"),u(a,[]),o=a instanceof Array}catch{}return function(c,h){return r(c),i(h),o?u(c,h):c.__proto__=h,c}}():void 0)},(s,e,t)=>{var n=t(14),r=t(31);s.exports=function(i,o,a){try{return n(r(Object.getOwnPropertyDescriptor(i,o)[a]))}catch{}}},(s,e,t)=>{var n=t(21),r=String,i=TypeError;s.exports=function(o){if(typeof o=="object"||n(o))return o;throw i("Can't set "+r(o)+" as a prototype")}},(s,e,t)=>{var n=t(45).f;s.exports=function(r,i,o){o in r||n(r,o,{configurable:!0,get:function(){return i[o]},set:function(a){i[o]=a}})}},(s,e,t)=>{var n=t(21),r=t(20),i=t(71);s.exports=function(o,a,u){var l,c;return i&&n(l=a.constructor)&&l!==u&&r(c=l.prototype)&&c!==u.prototype&&i(o,c),o}},(s,e,t)=>{var n=t(77);s.exports=function(r,i){return r===void 0?arguments.length<2?"":i:n(r)}},(s,e,t)=>{var n=t(78),r=String;s.exports=function(i){if(n(i)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return r(i)}},(s,e,t)=>{var n=t(79),r=t(21),i=t(15),o=t(34),a=o("toStringTag"),u=Object,l=i(function(){return arguments}())=="Arguments",c=function(h,d){try{return h[d]}catch{}};s.exports=n?i:function(h){var d,p,f;return h===void 0?"Undefined":h===null?"Null":typeof(p=c(d=u(h),a))=="string"?p:l?i(d):(f=i(d))=="Object"&&r(d.callee)?"Arguments":f}},(s,e,t)=>{var n=t(34),r=n("toStringTag"),i={};i[r]="z",s.exports=String(i)==="[object z]"},(s,e,t)=>{var n=t(20),r=t(44);s.exports=function(i,o){n(o)&&"cause"in o&&r(i,"cause",o.cause)}},(s,e,t)=>{var n=t(44),r=t(82),i=t(83),o=Error.captureStackTrace;s.exports=function(a,u,l,c){i&&(o?o(a,u):n(a,"stack",r(l,c)))}},(s,e,t)=>{var n=t(14),r=Error,i=n("".replace),o=function(l){return String(r(l).stack)}("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,u=a.test(o);s.exports=function(l,c){if(u&&typeof l=="string"&&!r.prepareStackTrace)for(;c--;)l=i(l,a,"");return l}},(s,e,t)=>{var n=t(7),r=t(11);s.exports=!n(function(){var i=Error("a");return"stack"in i?(Object.defineProperty(i,"stack",r(1,7)),i.stack!==7):!0})},(s,e,t)=>{var n=t(48),r=t(14),i=t(77),o=t(85),a=URLSearchParams,u=a.prototype,l=r(u.append),c=r(u.delete),h=r(u.forEach),d=r([].push),p=new a("a=1&a=2");p.delete("a",1),p+""!="a=2"&&n(u,"delete",function(f){var g=arguments.length,v=g<2?void 0:arguments[1];if(g&&v===void 0)return c(this,f);var y=[];h(this,function(S,T){d(y,{key:T,value:S})}),o(g,1);for(var x=i(f),R=i(v),k=0,m=0,b=!1,I=y.length,_;k<I;)_=y[k++],b||_.key===x?(b=!0,c(this,_.key)):m++;for(;m<I;)_=y[m++],_.key===x&&_.value===R||l(this,_.key,_.value)},{enumerable:!0,unsafe:!0})},s=>{var e=TypeError;s.exports=function(t,n){if(t<n)throw e("Not enough arguments");return t}},(s,e,t)=>{var n=t(48),r=t(14),i=t(77),o=t(85),a=URLSearchParams,u=a.prototype,l=r(u.getAll),c=r(u.has),h=new a("a=1");h.has("a",2)&&n(u,"has",function(p){var f=arguments.length,g=f<2?void 0:arguments[1];if(f&&g===void 0)return c(this,p);var v=l(this,p);o(f,1);for(var y=i(g),x=0;x<v.length;)if(v[x++]===y)return!0;return!1},{enumerable:!0,unsafe:!0})},(s,e,t)=>{var n=t(6),r=t(14),i=t(88),o=URLSearchParams.prototype,a=r(o.forEach);n&&!("size"in o)&&i(o,"size",{get:function(){var l=0;return a(this,function(){l++}),l},configurable:!0,enumerable:!0})},(s,e,t)=>{var n=t(49),r=t(45);s.exports=function(i,o,a){return a.get&&n(a.get,o,{getter:!0}),a.set&&n(a.set,o,{setter:!0}),r.f(i,o,a)}},(s,e,t)=>{var n=t(3),r=t(40),i=t(64),o=t(90),a=t(92),u=t(7),l=u(function(){return[].push.call({length:4294967296},1)!==4294967297}),c=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(d){return d instanceof TypeError}},h=l||!c();n({target:"Array",proto:!0,arity:1,forced:h},{push:function(p){var f=r(this),g=i(f),v=arguments.length;a(g+v);for(var y=0;y<v;y++)f[g]=arguments[y],g++;return o(f,g),g}})},(s,e,t)=>{var n=t(6),r=t(91),i=TypeError,o=Object.getOwnPropertyDescriptor,a=n&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(u){return u instanceof TypeError}}();s.exports=a?function(u,l){if(r(u)&&!o(u,"length").writable)throw i("Cannot set read only .length");return u.length=l}:function(u,l){return u.length=l}},(s,e,t)=>{var n=t(15);s.exports=Array.isArray||function(i){return n(i)=="Array"}},s=>{var e=TypeError,t=9007199254740991;s.exports=function(n){if(n>t)throw e("Maximum allowed index exceeded");return n}},(s,e,t)=>{var n=t(94),r=t(98).findLast,i=n.aTypedArray,o=n.exportTypedArrayMethod;o("findLast",function(u){return r(i(this),u,arguments.length>1?arguments[1]:void 0)})},(s,e,t)=>{var n=t(95),r=t(6),i=t(4),o=t(21),a=t(20),u=t(39),l=t(78),c=t(32),h=t(44),d=t(48),p=t(88),f=t(25),g=t(96),v=t(71),y=t(34),x=t(41),R=t(52),k=R.enforce,m=R.get,b=i.Int8Array,I=b&&b.prototype,_=i.Uint8ClampedArray,S=_&&_.prototype,T=b&&g(b),E=I&&g(I),L=Object.prototype,$=i.TypeError,Y=y("toStringTag"),V=x("TYPED_ARRAY_TAG"),j="TypedArrayConstructor",G=n&&!!v&&l(i.opera)!=="Opera",X=!1,q,Z,J,ve={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},K={BigInt64Array:8,BigUint64Array:8},O=function(pe){if(!a(pe))return!1;var ue=l(pe);return ue==="DataView"||u(ve,ue)||u(K,ue)},N=function(re){var pe=g(re);if(a(pe)){var ue=m(pe);return ue&&u(ue,j)?ue[j]:N(pe)}},F=function(re){if(!a(re))return!1;var pe=l(re);return u(ve,pe)||u(K,pe)},z=function(re){if(F(re))return re;throw $("Target is not a typed array")},D=function(re){if(o(re)&&(!v||f(T,re)))return re;throw $(c(re)+" is not a typed array constructor")},U=function(re,pe,ue,ye){if(r){if(ue)for(var ie in ve){var ge=i[ie];if(ge&&u(ge.prototype,re))try{delete ge.prototype[re]}catch{try{ge.prototype[re]=pe}catch{}}}(!E[re]||ue)&&d(E,re,ue?pe:G&&I[re]||pe,ye)}},ee=function(re,pe,ue){var ye,ie;if(r){if(v){if(ue){for(ye in ve)if(ie=i[ye],ie&&u(ie,re))try{delete ie[re]}catch{}}if(!T[re]||ue)try{return d(T,re,ue?pe:G&&T[re]||pe)}catch{}else return}for(ye in ve)ie=i[ye],ie&&(!ie[re]||ue)&&d(ie,re,pe)}};for(q in ve)Z=i[q],J=Z&&Z.prototype,J?k(J)[j]=Z:G=!1;for(q in K)Z=i[q],J=Z&&Z.prototype,J&&(k(J)[j]=Z);if((!G||!o(T)||T===Function.prototype)&&(T=function(){throw $("Incorrect invocation")},G))for(q in ve)i[q]&&v(i[q],T);if((!G||!E||E===L)&&(E=T.prototype,G))for(q in ve)i[q]&&v(i[q].prototype,E);if(G&&g(S)!==E&&v(S,E),r&&!u(E,Y)){X=!0,p(E,Y,{configurable:!0,get:function(){return a(this)?this[V]:void 0}});for(q in ve)i[q]&&h(i[q],V,q)}s.exports={NATIVE_ARRAY_BUFFER_VIEWS:G,TYPED_ARRAY_TAG:X&&V,aTypedArray:z,aTypedArrayConstructor:D,exportTypedArrayMethod:U,exportTypedArrayStaticMethod:ee,getTypedArrayConstructor:N,isView:O,isTypedArray:F,TypedArray:T,TypedArrayPrototype:E}},s=>{s.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},(s,e,t)=>{var n=t(39),r=t(21),i=t(40),o=t(54),a=t(97),u=o("IE_PROTO"),l=Object,c=l.prototype;s.exports=a?l.getPrototypeOf:function(h){var d=i(h);if(n(d,u))return d[u];var p=d.constructor;return r(p)&&d instanceof p?p.prototype:d instanceof l?c:null}},(s,e,t)=>{var n=t(7);s.exports=!n(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype})},(s,e,t)=>{var n=t(99),r=t(13),i=t(40),o=t(64),a=function(u){var l=u==1;return function(c,h,d){for(var p=i(c),f=r(p),g=n(h,d),v=o(f),y,x;v-- >0;)if(y=f[v],x=g(y,v,p),x)switch(u){case 0:return y;case 1:return v}return l?-1:void 0}};s.exports={findLast:a(0),findLastIndex:a(1)}},(s,e,t)=>{var n=t(100),r=t(31),i=t(9),o=n(n.bind);s.exports=function(a,u){return r(a),u===void 0?a:i?o(a,u):function(){return a.apply(u,arguments)}}},(s,e,t)=>{var n=t(15),r=t(14);s.exports=function(i){if(n(i)==="Function")return r(i)}},(s,e,t)=>{var n=t(94),r=t(98).findLastIndex,i=n.aTypedArray,o=n.exportTypedArrayMethod;o("findLastIndex",function(u){return r(i(this),u,arguments.length>1?arguments[1]:void 0)})},(s,e,t)=>{var n=t(4),r=t(8),i=t(94),o=t(64),a=t(103),u=t(40),l=t(7),c=n.RangeError,h=n.Int8Array,d=h&&h.prototype,p=d&&d.set,f=i.aTypedArray,g=i.exportTypedArrayMethod,v=!l(function(){var x=new Uint8ClampedArray(2);return r(p,x,{length:1,0:3},1),x[1]!==3}),y=v&&i.NATIVE_ARRAY_BUFFER_VIEWS&&l(function(){var x=new h(2);return x.set(1),x.set("2",1),x[0]!==0||x[1]!==2});g("set",function(R){f(this);var k=a(arguments.length>1?arguments[1]:void 0,1),m=u(R);if(v)return r(p,this,m,k);var b=this.length,I=o(m),_=0;if(I+k>b)throw c("Wrong length");for(;_<I;)this[k+_]=m[_++]},!v||y)},(s,e,t)=>{var n=t(104),r=RangeError;s.exports=function(i,o){var a=n(i);if(a%o)throw r("Wrong offset");return a}},(s,e,t)=>{var n=t(62),r=RangeError;s.exports=function(i){var o=n(i);if(o<0)throw r("The argument can't be less than 0");return o}},(s,e,t)=>{var n=t(106),r=t(94),i=r.aTypedArray,o=r.exportTypedArrayMethod,a=r.getTypedArrayConstructor;o("toReversed",function(){return n(i(this),a(this))})},(s,e,t)=>{var n=t(64);s.exports=function(r,i){for(var o=n(r),a=new i(o),u=0;u<o;u++)a[u]=r[o-u-1];return a}},(s,e,t)=>{var n=t(94),r=t(14),i=t(31),o=t(108),a=n.aTypedArray,u=n.getTypedArrayConstructor,l=n.exportTypedArrayMethod,c=r(n.TypedArrayPrototype.sort);l("toSorted",function(d){d!==void 0&&i(d);var p=a(this),f=o(u(p),p);return c(f,d)})},(s,e,t)=>{var n=t(64);s.exports=function(r,i){for(var o=0,a=n(i),u=new r(a);a>o;)u[o]=i[o++];return u}},(s,e,t)=>{var n=t(110),r=t(94),i=t(111),o=t(62),a=t(112),u=r.aTypedArray,l=r.getTypedArrayConstructor,c=r.exportTypedArrayMethod,h=!!function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(d){return d===8}}();c("with",function(d,p){var f=u(this),g=o(d),v=i(f)?a(p):+p;return n(f,l(f),g,v)},!h)},(s,e,t)=>{var n=t(64),r=t(62),i=RangeError;s.exports=function(o,a,u,l){var c=n(o),h=r(u),d=h<0?c+h:h;if(d>=c||d<0)throw i("Incorrect index");for(var p=new a(c),f=0;f<c;f++)p[f]=f===d?l:o[f];return p}},(s,e,t)=>{var n=t(78);s.exports=function(r){var i=n(r);return i=="BigInt64Array"||i=="BigUint64Array"}},(s,e,t)=>{var n=t(19),r=TypeError;s.exports=function(i){var o=n(i,"number");if(typeof o=="number")throw r("Can't convert number to bigint");return BigInt(o)}},(s,e,t)=>{var n=t(6),r=t(88),i=t(114),o=ArrayBuffer.prototype;n&&!("detached"in o)&&r(o,"detached",{configurable:!0,get:function(){return i(this)}})},(s,e,t)=>{var n=t(14),r=t(115),i=n(ArrayBuffer.prototype.slice);s.exports=function(o){if(r(o)!==0)return!1;try{return i(o,0,0),!1}catch{return!0}}},(s,e,t)=>{var n=t(72),r=t(15),i=TypeError;s.exports=n(ArrayBuffer.prototype,"byteLength","get")||function(o){if(r(o)!="ArrayBuffer")throw i("ArrayBuffer expected");return o.byteLength}},(s,e,t)=>{var n=t(3),r=t(117);r&&n({target:"ArrayBuffer",proto:!0},{transfer:function(){return r(this,arguments.length?arguments[0]:void 0,!0)}})},(s,e,t)=>{var n=t(4),r=t(14),i=t(72),o=t(118),a=t(114),u=t(115),l=t(119),c=n.TypeError,h=n.structuredClone,d=n.ArrayBuffer,p=n.DataView,f=Math.min,g=d.prototype,v=p.prototype,y=r(g.slice),x=i(g,"resizable","get"),R=i(g,"maxByteLength","get"),k=r(v.getInt8),m=r(v.setInt8);s.exports=l&&function(b,I,_){var S=u(b),T=I===void 0?S:o(I),E=!x||!x(b);if(a(b))throw c("ArrayBuffer is detached");var L=h(b,{transfer:[b]});if(S==T&&(_||E))return L;if(S>=T&&(!_||E))return y(L,0,T);for(var $=_&&!E&&R?{maxByteLength:R(L)}:void 0,Y=new d(T,$),V=new p(L),j=new p(Y),G=f(T,S),X=0;X<G;X++)m(j,X,k(V,X));return Y}},(s,e,t)=>{var n=t(62),r=t(65),i=RangeError;s.exports=function(o){if(o===void 0)return 0;var a=n(o),u=r(a);if(a!==u)throw i("Wrong length or index");return u}},(s,e,t)=>{var n=t(4),r=t(7),i=t(28),o=t(120),a=t(121),u=t(122),l=n.structuredClone;s.exports=!!l&&!r(function(){if(a&&i>92||u&&i>94||o&&i>97)return!1;var c=new ArrayBuffer(8),h=l(c,{transfer:[c]});return c.byteLength!=0||h.byteLength!=8})},(s,e,t)=>{var n=t(121),r=t(122);s.exports=!n&&!r&&typeof window=="object"&&typeof document=="object"},s=>{s.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},(s,e,t)=>{var n=t(15);s.exports=typeof process<"u"&&n(process)=="process"},(s,e,t)=>{var n=t(3),r=t(117);r&&n({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return r(this,arguments.length?arguments[0]:void 0,!1)}})},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var s,t,n,r,Tt,o,Mt,u,l,c,h,d,p,f,g,v,Ht,x,R,Xt,m,b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0,__w_pdfjs_require__(84),__w_pdfjs_require__(86),__w_pdfjs_require__(87),__w_pdfjs_require__(2),__w_pdfjs_require__(93),__w_pdfjs_require__(101),__w_pdfjs_require__(102),__w_pdfjs_require__(105),__w_pdfjs_require__(107),__w_pdfjs_require__(109),__w_pdfjs_require__(113),__w_pdfjs_require__(116),__w_pdfjs_require__(123),__w_pdfjs_require__(89),__w_pdfjs_require__(125),__w_pdfjs_require__(135),__w_pdfjs_require__(137),__w_pdfjs_require__(140),__w_pdfjs_require__(142),__w_pdfjs_require__(144),__w_pdfjs_require__(146),__w_pdfjs_require__(148),__w_pdfjs_require__(151);var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(162),_display_utils=__w_pdfjs_require__(167),_font_loader=__w_pdfjs_require__(170),_displayNode_utils=__w_pdfjs_require__(171),_canvas=__w_pdfjs_require__(172),_worker_options=__w_pdfjs_require__(175),_message_handler=__w_pdfjs_require__(176),_metadata=__w_pdfjs_require__(177),_optional_content_config=__w_pdfjs_require__(178),_transport_stream=__w_pdfjs_require__(179),_displayFetch_stream=__w_pdfjs_require__(180),_displayNetwork=__w_pdfjs_require__(183),_displayNode_stream=__w_pdfjs_require__(184),_displaySvg=__w_pdfjs_require__(185),_xfa_text=__w_pdfjs_require__(193);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(_){if(typeof _=="string"||_ instanceof URL?_={url:_}:(0,_util.isArrayBuffer)(_)&&(_={data:_}),typeof _!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!_.url&&!_.data&&!_.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const S=new PDFDocumentLoadingTask,{docId:T}=S,E=_.url?getUrlProp(_.url):null,L=_.data?getDataProp(_.data):null,$=_.httpHeaders||null,Y=_.withCredentials===!0,V=_.password??null,j=_.range instanceof PDFDataRangeTransport?_.range:null,G=Number.isInteger(_.rangeChunkSize)&&_.rangeChunkSize>0?_.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let X=_.worker instanceof PDFWorker?_.worker:null;const q=_.verbosity,Z=typeof _.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(_.docBaseUrl)?_.docBaseUrl:null,J=typeof _.cMapUrl=="string"?_.cMapUrl:null,ve=_.cMapPacked!==!1,K=_.CMapReaderFactory||DefaultCMapReaderFactory,O=typeof _.standardFontDataUrl=="string"?_.standardFontDataUrl:null,N=_.StandardFontDataFactory||DefaultStandardFontDataFactory,F=_.stopAtErrors!==!0,z=Number.isInteger(_.maxImageSize)&&_.maxImageSize>-1?_.maxImageSize:-1,D=_.isEvalSupported!==!1,U=typeof _.isOffscreenCanvasSupported=="boolean"?_.isOffscreenCanvasSupported:!_util.isNodeJS,ee=Number.isInteger(_.canvasMaxAreaInBytes)?_.canvasMaxAreaInBytes:-1,re=typeof _.disableFontFace=="boolean"?_.disableFontFace:_util.isNodeJS,pe=_.fontExtraProperties===!0,ue=_.enableXfa===!0,ye=_.ownerDocument||globalThis.document,ie=_.disableRange===!0,ge=_.disableStream===!0,Ee=_.disableAutoFetch===!0,Oe=_.pdfBug===!0,Ie=j?j.length:_.length??NaN,we=typeof _.useSystemFonts=="boolean"?_.useSystemFonts:!_util.isNodeJS&&!re,Ue=typeof _.useWorkerFetch=="boolean"?_.useWorkerFetch:K===_display_utils.DOMCMapReaderFactory&&N===_display_utils.DOMStandardFontDataFactory&&J&&O&&(0,_display_utils.isValidFetchUrl)(J,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(O,document.baseURI),Ne=_.canvasFactory||new DefaultCanvasFactory({ownerDocument:ye}),be=_.filterFactory||new DefaultFilterFactory({docId:T,ownerDocument:ye}),de=null;(0,_util.setVerbosityLevel)(q);const Te={canvasFactory:Ne,filterFactory:be};if(Ue||(Te.cMapReaderFactory=new K({baseUrl:J,isCompressed:ve}),Te.standardFontDataFactory=new N({baseUrl:O})),!X){const Ge={verbosity:q,port:_worker_options.GlobalWorkerOptions.workerPort};X=Ge.port?PDFWorker.fromPort(Ge):new PDFWorker(Ge),S._worker=X}const _e={docId:T,apiVersion:"3.9.179",data:L,password:V,disableAutoFetch:Ee,rangeChunkSize:G,length:Ie,docBaseUrl:Z,enableXfa:ue,evaluatorOptions:{maxImageSize:z,disableFontFace:re,ignoreErrors:F,isEvalSupported:D,isOffscreenCanvasSupported:U,canvasMaxAreaInBytes:ee,fontExtraProperties:pe,useSystemFonts:we,cMapUrl:Ue?J:null,standardFontDataUrl:Ue?O:null}},Ve={ignoreErrors:F,isEvalSupported:D,disableFontFace:re,fontExtraProperties:pe,enableXfa:ue,ownerDocument:ye,disableAutoFetch:Ee,pdfBug:Oe,styleElement:de};return X.promise.then(function(){if(S.destroyed)throw new Error("Loading aborted");const Ge=_fetchDocument(X,_e),Ke=new Promise(function($e){let Ze;j?Ze=new _transport_stream.PDFDataTransportStream({length:Ie,initialData:j.initialData,progressiveDone:j.progressiveDone,contentDispositionFilename:j.contentDispositionFilename,disableRange:ie,disableStream:ge},j):L||(Ze=(qe=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(qe):(0,_display_utils.isValidFetchUrl)(qe.url)?new _displayFetch_stream.PDFFetchStream(qe):new _displayNetwork.PDFNetworkStream(qe))({url:E,length:Ie,httpHeaders:$,withCredentials:Y,rangeChunkSize:G,disableRange:ie,disableStream:ge})),$e(Ze)});return Promise.all([Ge,Ke]).then(function($e){let[Ze,Qe]=$e;if(S.destroyed)throw new Error("Loading aborted");const qe=new _message_handler.MessageHandler(T,Ze,X.port),Ye=new WorkerTransport(qe,S,Qe,Ve,Te);S._transport=Ye,qe.send("Ready",null)})}).catch(S._capability.reject),S}async function _fetchDocument(_,S){if(_.destroyed)throw new Error("Worker was destroyed");const T=await _.messageHandler.sendWithPromise("GetDocRequest",S,S.data?[S.data.buffer]:null);if(_.destroyed)throw new Error("Worker was destroyed");return T}function getUrlProp(_){if(_ instanceof URL)return _.href;try{return new URL(_,window.location).href}catch{if(_util.isNodeJS&&typeof _=="string")return _}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(_){if(_util.isNodeJS&&typeof Buffer<"u"&&_ instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(_ instanceof Uint8Array&&_.byteLength===_.buffer.byteLength)return _;if(typeof _=="string")return(0,_util.stringToBytes)(_);if(typeof _=="object"&&!isNaN(_==null?void 0:_.length)||(0,_util.isArrayBuffer)(_))return new Uint8Array(_);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${pt(e,s)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var S;this.destroyed=!0,await((S=this._transport)==null?void 0:S.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=e;s=new WeakMap,se(PDFDocumentLoadingTask,s,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(S,T){let E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;this.length=S,this.initialData=T,this.progressiveDone=E,this.contentDispositionFilename=L,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(S){this._rangeListeners.push(S)}addProgressListener(S){this._progressListeners.push(S)}addProgressiveReadListener(S){this._progressiveReadListeners.push(S)}addProgressiveDoneListener(S){this._progressiveDoneListeners.push(S)}onDataRange(S,T){for(const E of this._rangeListeners)E(S,T)}onDataProgress(S,T){this._readyCapability.promise.then(()=>{for(const E of this._progressListeners)E(S,T)})}onDataProgressiveRead(S){this._readyCapability.promise.then(()=>{for(const T of this._progressiveReadListeners)T(S)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const S of this._progressiveDoneListeners)S()})}transportReady(){this._readyCapability.resolve()}requestDataRange(S,T){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(S,T){this._pdfInfo=S,this._transport=T}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(S){return this._transport.getPage(S)}getPageIndex(S){return this._transport.getPageIndex(S)}getDestinations(){return this._transport.getDestinations()}getDestination(S){return this._transport.getDestination(S)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._transport.startCleanup(S||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(S,T,E){se(this,r);se(this,o);se(this,t,null);se(this,n,!1);let L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;this._pageIndex=S,this._pageInfo=T,this._transport=E,this._stats=L?new _display_utils.StatTimer:null,this._pdfBug=L,this.commonObjs=E.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:S,rotation:T=this.rotate,offsetX:E=0,offsetY:L=0,dontFlip:$=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new _display_utils.PageViewport({viewBox:this.view,scale:S,rotation:T,offsetX:E,offsetY:L,dontFlip:$})}getAnnotations(){let{intent:S="display"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const T=this._transport.getRenderingIntent(S);return this._transport.getAnnotations(this._pageIndex,T.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var S;return((S=this._transport._htmlForXfa)==null?void 0:S.children[this._pageIndex])||null}render(S){var F,z;let{canvasContext:T,viewport:E,intent:L="display",annotationMode:$=_util.AnnotationMode.ENABLE,transform:Y=null,background:V=null,optionalContentConfigPromise:j=null,annotationCanvasMap:G=null,pageColors:X=null,printAnnotationStorage:q=null}=S;(F=this._stats)==null||F.time("Overall");const Z=this._transport.getRenderingIntent(L,$,q);Ae(this,n,!1),me(this,o,Mt).call(this),j||(j=this._transport.getOptionalContentConfig());let J=this._intentStates.get(Z.cacheKey);J||(J=Object.create(null),this._intentStates.set(Z.cacheKey,J)),J.streamReaderCancelTimeout&&(clearTimeout(J.streamReaderCancelTimeout),J.streamReaderCancelTimeout=null);const ve=!!(Z.renderingIntent&_util.RenderingIntentFlag.PRINT);J.displayReadyCapability||(J.displayReadyCapability=new _util.PromiseCapability,J.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(z=this._stats)==null||z.time("Page Request"),this._pumpOperatorList(Z));const K=D=>{var U,ee;J.renderTasks.delete(O),(this._maybeCleanupAfterRender||ve)&&Ae(this,n,!0),me(this,r,Tt).call(this,!ve),D?(O.capability.reject(D),this._abortOperatorList({intentState:J,reason:D instanceof Error?D:new Error(D)})):O.capability.resolve(),(U=this._stats)==null||U.timeEnd("Rendering"),(ee=this._stats)==null||ee.timeEnd("Overall")},O=new InternalRenderTask({callback:K,params:{canvasContext:T,viewport:E,transform:Y,background:V},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:G,operatorList:J.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!ve,pdfBug:this._pdfBug,pageColors:X});(J.renderTasks||(J.renderTasks=new Set)).add(O);const N=O.task;return Promise.all([J.displayReadyCapability.promise,j]).then(D=>{var re;let[U,ee]=D;if(this.destroyed){K();return}(re=this._stats)==null||re.time("Rendering"),O.initializeGraphics({transparency:U,optionalContentConfig:ee}),O.operatorListChanged()}).catch(K),N}getOperatorList(){var j;let{intent:S="display",annotationMode:T=_util.AnnotationMode.ENABLE,printAnnotationStorage:E=null}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};function L(){Y.operatorList.lastChunk&&(Y.opListReadCapability.resolve(Y.operatorList),Y.renderTasks.delete(V))}const $=this._transport.getRenderingIntent(S,T,E,!0);let Y=this._intentStates.get($.cacheKey);Y||(Y=Object.create(null),this._intentStates.set($.cacheKey,Y));let V;return Y.opListReadCapability||(V=Object.create(null),V.operatorListChanged=L,Y.opListReadCapability=new _util.PromiseCapability,(Y.renderTasks||(Y.renderTasks=new Set)).add(V),Y.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(j=this._stats)==null||j.time("Page Request"),this._pumpOperatorList($)),Y.opListReadCapability.promise}streamTextContent(){let{includeMarkedContent:S=!1,disableNormalization:T=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const E=100;return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:S===!0,disableNormalization:T===!0},{highWaterMark:E,size(L){return L.items.length}})}getTextContent(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then(E=>_xfa_text.XfaText.textContent(E));const T=this.streamTextContent(S);return new Promise(function(E,L){function $(){Y.read().then(function(j){let{value:G,done:X}=j;if(X){E(V);return}Object.assign(V.styles,G.styles),V.items.push(...G.items),$()},L)}const Y=T.getReader(),V={items:[],styles:Object.create(null)};$()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const S=[];for(const T of this._intentStates.values())if(this._abortOperatorList({intentState:T,reason:new Error("Page was destroyed."),force:!0}),!T.opListReadCapability)for(const E of T.renderTasks)S.push(E.completed),E.cancel();return this.objs.clear(),Ae(this,n,!1),me(this,o,Mt).call(this),Promise.all(S)}cleanup(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;Ae(this,n,!0);const T=me(this,r,Tt).call(this,!1);return S&&T&&this._stats&&(this._stats=new _display_utils.StatTimer),T}_startRenderPage(S,T){var L,$;const E=this._intentStates.get(T);E&&((L=this._stats)==null||L.timeEnd("Page Request"),($=E.displayReadyCapability)==null||$.resolve(S))}_renderPageChunk(S,T){for(let E=0,L=S.length;E<L;E++)T.operatorList.fnArray.push(S.fnArray[E]),T.operatorList.argsArray.push(S.argsArray[E]);T.operatorList.lastChunk=S.lastChunk,T.operatorList.separateAnnots=S.separateAnnots;for(const E of T.renderTasks)E.operatorListChanged();S.lastChunk&&me(this,r,Tt).call(this,!0)}_pumpOperatorList(S){let{renderingIntent:T,cacheKey:E,annotationStorageSerializable:L}=S;const{map:$,transfers:Y}=L,j=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:T,cacheKey:E,annotationStorage:$},Y).getReader(),G=this._intentStates.get(E);G.streamReader=j;const X=()=>{j.read().then(q=>{let{value:Z,done:J}=q;if(J){G.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Z,G),X())},q=>{if(G.streamReader=null,!this._transport.destroyed){if(G.operatorList){G.operatorList.lastChunk=!0;for(const Z of G.renderTasks)Z.operatorListChanged();me(this,r,Tt).call(this,!0)}if(G.displayReadyCapability)G.displayReadyCapability.reject(q);else if(G.opListReadCapability)G.opListReadCapability.reject(q);else throw q}})};X()}_abortOperatorList(S){let{intentState:T,reason:E,force:L=!1}=S;if(T.streamReader){if(T.streamReaderCancelTimeout&&(clearTimeout(T.streamReaderCancelTimeout),T.streamReaderCancelTimeout=null),!L){if(T.renderTasks.size>0)return;if(E instanceof _display_utils.RenderingCancelledException){let $=RENDERING_CANCELLED_TIMEOUT;E.extraDelay>0&&E.extraDelay<1e3&&($+=E.extraDelay),T.streamReaderCancelTimeout=setTimeout(()=>{T.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:T,reason:E,force:!0})},$);return}}if(T.streamReader.cancel(new _util.AbortException(E.message)).catch(()=>{}),T.streamReader=null,!this._transport.destroyed){for(const[$,Y]of this._intentStates)if(Y===T){this._intentStates.delete($);break}this.cleanup()}}}get stats(){return this._stats}}t=new WeakMap,n=new WeakMap,r=new WeakSet,Tt=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(me(this,o,Mt).call(this),!w(this,n)||this.destroyed)return!1;if(S)return Ae(this,t,setTimeout(()=>{Ae(this,t,null),me(this,r,Tt).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:T,operatorList:E}of this._intentStates.values())if(T.size>0||!E.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Ae(this,n,!1),!0},o=new WeakSet,Mt=function(){w(this,t)&&(clearTimeout(w(this,t)),Ae(this,t,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){se(this,u,new Set);se(this,l,Promise.resolve())}postMessage(S,T){const E={data:structuredClone(S,null)};w(this,l).then(()=>{for(const L of w(this,u))L.call(this,E)})}addEventListener(S,T){w(this,u).add(T)}removeEventListener(S,T){w(this,u).delete(T)}terminate(){w(this,u).clear()}}u=new WeakMap,l=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const _=(c=document==null?void 0:document.currentScript)==null?void 0:c.src;_&&(PDFWorkerUtil.fallbackWorkerSrc=_.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(_,S){let T;try{if(T=new URL(_),!T.origin||T.origin==="null")return!1}catch{return!1}const E=new URL(S,T);return T.origin===E.origin},PDFWorkerUtil.createCDNWrapper=function(_){const S=`importScripts("${_}");`;return URL.createObjectURL(new Blob([S]))}}const _PDFWorker=class{constructor(){let{name:_=null,port:S=null,verbosity:T=(0,_util.getVerbosityLevel)()}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(S&&w(_PDFWorker,h).has(S))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=_,this.destroyed=!1,this.verbosity=T,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,S){w(_PDFWorker,h).set(S,this),this._initializeFromPort(S);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(_){this._port=_,this._messageHandler=new _message_handler.MessageHandler("main","worker",_),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:_}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,_)||(_=PDFWorkerUtil.createCDNWrapper(new URL(_,window.location).href));const S=new Worker(_),T=new _message_handler.MessageHandler("main","worker",S),E=()=>{S.removeEventListener("error",L),T.destroy(),S.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},L=()=>{this._webWorker||E()};S.addEventListener("error",L),T.on("test",Y=>{if(S.removeEventListener("error",L),this.destroyed){E();return}Y?(this._messageHandler=T,this._port=S,this._webWorker=S,this._readyCapability.resolve(),T.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),T.destroy(),S.terminate())}),T.on("ready",Y=>{if(S.removeEventListener("error",L),this.destroyed){E();return}try{$()}catch{this._setupFakeWorker()}});const $=()=>{const Y=new Uint8Array;T.send("test",Y,[Y.buffer])};$();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(_=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const S=new LoopbackPort;this._port=S;const T=`fake${PDFWorkerUtil.fakeWorkerId++}`,E=new _message_handler.MessageHandler(T+"_worker",T,S);_.setup(E,S);const L=new _message_handler.MessageHandler(T,T+"_worker",S);this._messageHandler=L,this._readyCapability.resolve(),L.send("configure",{verbosity:this.verbosity})}).catch(_=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${_.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),w(_PDFWorker,h).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(_){if(!(_!=null&&_.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return w(this,h).has(_.port)?w(this,h).get(_.port):new _PDFWorker(_)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var _;try{return((_=globalThis.pdfjsWorker)==null?void 0:_.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;h=new WeakMap,se(PDFWorker,h,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(S,T,E,L,$){se(this,v);se(this,d,new Map);se(this,p,new Map);se(this,f,new Map);se(this,g,null);this.messageHandler=S,this.loadingTask=T,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:L.ownerDocument,styleElement:L.styleElement}),this._params=L,this.canvasFactory=$.canvasFactory,this.filterFactory=$.filterFactory,this.cMapReaderFactory=$.cMapReaderFactory,this.standardFontDataFactory=$.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=E,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(S){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_util.AnnotationMode.ENABLE,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,$=_util.RenderingIntentFlag.DISPLAY,Y=_annotation_storage.SerializableEmpty;switch(S){case"any":$=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":$=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${S}`)}switch(T){case _util.AnnotationMode.DISABLE:$+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:$+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:$+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,Y=($&_util.RenderingIntentFlag.PRINT&&E instanceof _annotation_storage.PrintAnnotationStorage?E:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${T}`)}return L&&($+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:$,cacheKey:`${$}_${Y.hash}`,annotationStorageSerializable:Y}}destroy(){var E;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(E=w(this,g))==null||E.reject(new Error("Worker was destroyed during onPassword callback"));const S=[];for(const L of w(this,p).values())S.push(L._destroy());w(this,p).clear(),w(this,f).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const T=this.messageHandler.sendWithPromise("Terminate",null);return S.push(T),Promise.all(S).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),w(this,d).clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:S,loadingTask:T}=this;S.on("GetReader",(E,L)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=$=>{this._lastProgress={loaded:$.loaded,total:$.total}},L.onPull=()=>{this._fullReader.read().then(function($){let{value:Y,done:V}=$;if(V){L.close();return}(0,_util.assert)(Y instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),L.enqueue(new Uint8Array(Y),1,[Y])}).catch($=>{L.error($)})},L.onCancel=$=>{this._fullReader.cancel($),L.ready.catch(Y=>{if(!this.destroyed)throw Y})}}),S.on("ReaderHeadersReady",E=>{const L=new _util.PromiseCapability,$=this._fullReader;return $.headersReady.then(()=>{var Y;(!$.isStreamingSupported||!$.isRangeSupported)&&(this._lastProgress&&((Y=T.onProgress)==null||Y.call(T,this._lastProgress)),$.onProgress=V=>{var j;(j=T.onProgress)==null||j.call(T,{loaded:V.loaded,total:V.total})}),L.resolve({isStreamingSupported:$.isStreamingSupported,isRangeSupported:$.isRangeSupported,contentLength:$.contentLength})},L.reject),L.promise}),S.on("GetRangeReader",(E,L)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const $=this._networkStream.getRangeReader(E.begin,E.end);if(!$){L.close();return}L.onPull=()=>{$.read().then(function(Y){let{value:V,done:j}=Y;if(j){L.close();return}(0,_util.assert)(V instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),L.enqueue(new Uint8Array(V),1,[V])}).catch(Y=>{L.error(Y)})},L.onCancel=Y=>{$.cancel(Y),L.ready.catch(V=>{if(!this.destroyed)throw V})}}),S.on("GetDoc",E=>{let{pdfInfo:L}=E;this._numPages=L.numPages,this._htmlForXfa=L.htmlForXfa,delete L.htmlForXfa,T._capability.resolve(new PDFDocumentProxy(L,this))}),S.on("DocException",function(E){let L;switch(E.name){case"PasswordException":L=new _util.PasswordException(E.message,E.code);break;case"InvalidPDFException":L=new _util.InvalidPDFException(E.message);break;case"MissingPDFException":L=new _util.MissingPDFException(E.message);break;case"UnexpectedResponseException":L=new _util.UnexpectedResponseException(E.message,E.status);break;case"UnknownErrorException":L=new _util.UnknownErrorException(E.message,E.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}T._capability.reject(L)}),S.on("PasswordRequest",E=>{if(Ae(this,g,new _util.PromiseCapability),T.onPassword){const L=$=>{$ instanceof Error?w(this,g).reject($):w(this,g).resolve({password:$})};try{T.onPassword(L,E.code)}catch($){w(this,g).reject($)}}else w(this,g).reject(new _util.PasswordException(E.message,E.code));return w(this,g).promise}),S.on("DataLoaded",E=>{var L;(L=T.onProgress)==null||L.call(T,{loaded:E.length,total:E.length}),this.downloadInfoCapability.resolve(E)}),S.on("StartRenderPage",E=>{if(this.destroyed)return;w(this,p).get(E.pageIndex)._startRenderPage(E.transparency,E.cacheKey)}),S.on("commonobj",E=>{var V;let[L,$,Y]=E;if(!this.destroyed&&!this.commonObjs.has(L))switch($){case"Font":const j=this._params;if("error"in Y){const q=Y.error;(0,_util.warn)(`Error during font loading: ${q}`),this.commonObjs.resolve(L,q);break}const G=j.pdfBug&&((V=globalThis.FontInspector)!=null&&V.enabled)?(q,Z)=>globalThis.FontInspector.fontAdded(q,Z):null,X=new _font_loader.FontFaceObject(Y,{isEvalSupported:j.isEvalSupported,disableFontFace:j.disableFontFace,ignoreErrors:j.ignoreErrors,inspectFont:G});this.fontLoader.bind(X).catch(q=>S.sendWithPromise("FontFallback",{id:L})).finally(()=>{!j.fontExtraProperties&&X.data&&(X.data=null),this.commonObjs.resolve(L,X)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(L,Y);break;default:throw new Error(`Got unknown common object type ${$}`)}}),S.on("obj",E=>{var G;let[L,$,Y,V]=E;if(this.destroyed)return;const j=w(this,p).get($);if(!j.objs.has(L))switch(Y){case"Image":if(j.objs.resolve(L,V),V){let X;if(V.bitmap){const{width:q,height:Z}=V;X=q*Z*4}else X=((G=V.data)==null?void 0:G.length)||0;X>_util.MAX_IMAGE_SIZE_TO_CACHE&&(j._maybeCleanupAfterRender=!0)}break;case"Pattern":j.objs.resolve(L,V);break;default:throw new Error(`Got unknown object type ${Y}`)}}),S.on("DocProgress",E=>{var L;this.destroyed||(L=T.onProgress)==null||L.call(T,{loaded:E.loaded,total:E.total})}),S.on("FetchBuiltInCMap",E=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(E):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),S.on("FetchStandardFontData",E=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(E):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var E;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:S,transfers:T}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:S,filename:((E=this._fullReader)==null?void 0:E.filename)??null},T).finally(()=>{this.annotationStorage.resetModified()})}getPage(S){if(!Number.isInteger(S)||S<=0||S>this._numPages)return Promise.reject(new Error("Invalid page request."));const T=S-1,E=w(this,f).get(T);if(E)return E;const L=this.messageHandler.sendWithPromise("GetPage",{pageIndex:T}).then($=>{if(this.destroyed)throw new Error("Transport destroyed");const Y=new PDFPageProxy(T,$,this,this._params.pdfBug);return w(this,p).set(T,Y),Y});return w(this,f).set(T,L),L}getPageIndex(S){return typeof S!="object"||S===null||!Number.isInteger(S.num)||S.num<0||!Number.isInteger(S.gen)||S.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:S.num,gen:S.gen})}getAnnotations(S,T){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:S,intent:T})}getFieldObjects(){return me(this,v,Ht).call(this,"GetFieldObjects")}hasJSActions(){return me(this,v,Ht).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(S){return typeof S!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:S})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(S){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:S})}getStructTree(S){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:S})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(S=>new _optional_content_config.OptionalContentConfig(S))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const S="GetMetadata",T=w(this,d).get(S);if(T)return T;const E=this.messageHandler.sendWithPromise(S,null).then(L=>{var $,Y;return{info:L[0],metadata:L[1]?new _metadata.Metadata(L[1]):null,contentDispositionFilename:(($=this._fullReader)==null?void 0:$.filename)??null,contentLength:((Y=this._fullReader)==null?void 0:Y.contentLength)??null}});return w(this,d).set(S,E),E}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const T of w(this,p).values())if(!T.cleanup())throw new Error(`startCleanup: Page ${T.pageNumber} is currently rendering.`);this.commonObjs.clear(),S||this.fontLoader.clear(),w(this,d).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:S,enableXfa:T}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:S,enableXfa:T})}}d=new WeakMap,p=new WeakMap,f=new WeakMap,g=new WeakMap,v=new WeakSet,Ht=function(S){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const E=w(this,d).get(S);if(E)return E;const L=this.messageHandler.sendWithPromise(S,T);return w(this,d).set(S,L),L};class PDFObjects{constructor(){se(this,R);se(this,x,Object.create(null))}get(S){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(T){const L=me(this,R,Xt).call(this,S);return L.capability.promise.then(()=>T(L.data)),null}const E=w(this,x)[S];if(!(E!=null&&E.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${S}.`);return E.data}has(S){const T=w(this,x)[S];return(T==null?void 0:T.capability.settled)||!1}resolve(S){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const E=me(this,R,Xt).call(this,S);E.data=T,E.capability.resolve()}clear(){var S;for(const T in w(this,x)){const{data:E}=w(this,x)[T];(S=E==null?void 0:E.bitmap)==null||S.close()}Ae(this,x,Object.create(null))}}x=new WeakMap,R=new WeakSet,Xt=function(S){const T=w(this,x)[S];return T||(w(this,x)[S]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(S){se(this,m,null);Ae(this,m,S),this.onContinue=null}get promise(){return w(this,m).capability.promise}cancel(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;w(this,m).cancel(null,S)}get separateAnnots(){const{separateAnnots:S}=w(this,m).operatorList;if(!S)return!1;const{annotationCanvasMap:T}=w(this,m);return S.form||S.canvas&&(T==null?void 0:T.size)>0}}m=new WeakMap,exports.RenderTask=RenderTask;const I=class{constructor(S){let{callback:T,params:E,objs:L,commonObjs:$,annotationCanvasMap:Y,operatorList:V,pageIndex:j,canvasFactory:G,filterFactory:X,useRequestAnimationFrame:q=!1,pdfBug:Z=!1,pageColors:J=null}=S;this.callback=T,this.params=E,this.objs=L,this.commonObjs=$,this.annotationCanvasMap=Y,this.operatorListIdx=null,this.operatorList=V,this._pageIndex=j,this.canvasFactory=G,this.filterFactory=X,this._pdfBug=Z,this.pageColors=J,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=q===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=E.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics(S){var j,G;let{transparency:T=!1,optionalContentConfig:E}=S;if(this.cancelled)return;if(this._canvas){if(w(I,b).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");w(I,b).add(this._canvas)}this._pdfBug&&((j=globalThis.StepperManager)!=null&&j.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:L,viewport:$,transform:Y,background:V}=this.params;this.gfx=new _canvas.CanvasGraphics(L,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:E},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:Y,viewport:$,transparency:T,background:V}),this.operatorListIdx=0,this.graphicsReady=!0,(G=this.graphicsReadyCallback)==null||G.call(this)}cancel(){var E;let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.running=!1,this.cancelled=!0,(E=this.gfx)==null||E.endDrawing(),this._canvas&&w(I,b).delete(this._canvas),this.callback(S||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,T))}operatorListChanged(){var S;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(S=this.stepper)==null||S.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&w(I,b).delete(this._canvas),this.callback())))}};let InternalRenderTask=I;b=new WeakMap,se(InternalRenderTask,b,new WeakSet);const version="3.9.179";exports.version=version;const build="1ef6fbc52";exports.build=build},(s,e,t)=>{var n=t(3),r=t(126),i=t(134);n({target:"Set",proto:!0,real:!0,forced:!i("difference")},{difference:r})},(s,e,t)=>{var n=t(127),r=t(128),i=t(129),o=t(132),a=t(133),u=t(130),l=t(131),c=r.has,h=r.remove;s.exports=function(p){var f=n(this),g=a(p),v=i(f);return o(f)<=g.size?u(f,function(y){g.includes(y)&&h(v,y)}):l(g.getIterator(),function(y){c(f,y)&&h(v,y)}),v}},(s,e,t)=>{var n=t(128).has;s.exports=function(r){return n(r),r}},(s,e,t)=>{var n=t(14),r=Set.prototype;s.exports={Set,add:n(r.add),has:n(r.has),remove:n(r.delete),proto:r}},(s,e,t)=>{var n=t(128),r=t(130),i=n.Set,o=n.add;s.exports=function(a){var u=new i;return r(a,function(l){o(u,l)}),u}},(s,e,t)=>{var n=t(14),r=t(131),i=t(128),o=i.Set,a=i.proto,u=n(a.forEach),l=n(a.keys),c=l(new o).next;s.exports=function(h,d,p){return p?r(l(h),d,c):u(h,d)}},(s,e,t)=>{var n=t(8);s.exports=function(r,i,o){for(var a=o||r.next,u,l;!(u=n(a,r)).done;)if(l=i(u.value),l!==void 0)return l}},(s,e,t)=>{var n=t(72),r=t(128);s.exports=n(r.proto,"size","get")||function(i){return i.size}},(s,e,t)=>{var n=t(31),r=t(47),i=t(8),o=t(62),a=TypeError,u=Math.max,l=function(c,h,d,p){this.set=c,this.size=h,this.has=d,this.keys=p};l.prototype={getIterator:function(){return r(i(this.keys,this.set))},includes:function(c){return i(this.has,this.set,c)}},s.exports=function(c){r(c);var h=+c.size;if(h!=h)throw a("Invalid size");return new l(c,u(o(h),0),n(c.has),n(c.keys))}},(s,e,t)=>{var n=t(24),r=function(){return{size:0,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}};s.exports=function(i){try{var o=n("Set");return new o()[i](r()),!0}catch{return!1}}},(s,e,t)=>{var n=t(3),r=t(7),i=t(136),o=t(134),a=!o("intersection")||r(function(){return Array.from(new Set([1,2,3]).intersection(new Set([3,2])))!="3,2"});n({target:"Set",proto:!0,real:!0,forced:a},{intersection:i})},(s,e,t)=>{var n=t(127),r=t(128),i=t(132),o=t(133),a=t(130),u=t(131),l=r.Set,c=r.add,h=r.has;s.exports=function(p){var f=n(this),g=o(p),v=new l;return i(f)>g.size?u(g.getIterator(),function(y){h(f,y)&&c(v,y)}):a(f,function(y){g.includes(y)&&c(v,y)}),v}},(s,e,t)=>{var n=t(3),r=t(138),i=t(134);n({target:"Set",proto:!0,real:!0,forced:!i("isDisjointFrom")},{isDisjointFrom:r})},(s,e,t)=>{var n=t(127),r=t(128).has,i=t(132),o=t(133),a=t(130),u=t(131),l=t(139);s.exports=function(h){var d=n(this),p=o(h);if(i(d)<=p.size)return a(d,function(g){if(p.includes(g))return!1},!0)!==!1;var f=p.getIterator();return u(f,function(g){if(r(d,g))return l(f,"normal",!1)})!==!1}},(s,e,t)=>{var n=t(8),r=t(47),i=t(30);s.exports=function(o,a,u){var l,c;r(o);try{if(l=i(o,"return"),!l){if(a==="throw")throw u;return u}l=n(l,o)}catch(h){c=!0,l=h}if(a==="throw")throw u;if(c)throw l;return r(l),u}},(s,e,t)=>{var n=t(3),r=t(141),i=t(134);n({target:"Set",proto:!0,real:!0,forced:!i("isSubsetOf")},{isSubsetOf:r})},(s,e,t)=>{var n=t(127),r=t(132),i=t(130),o=t(133);s.exports=function(u){var l=n(this),c=o(u);return r(l)>c.size?!1:i(l,function(h){if(!c.includes(h))return!1},!0)!==!1}},(s,e,t)=>{var n=t(3),r=t(143),i=t(134);n({target:"Set",proto:!0,real:!0,forced:!i("isSupersetOf")},{isSupersetOf:r})},(s,e,t)=>{var n=t(127),r=t(128).has,i=t(132),o=t(133),a=t(131),u=t(139);s.exports=function(c){var h=n(this),d=o(c);if(i(h)<d.size)return!1;var p=d.getIterator();return a(p,function(f){if(!r(h,f))return u(p,"normal",!1)})!==!1}},(s,e,t)=>{var n=t(3),r=t(145),i=t(134);n({target:"Set",proto:!0,real:!0,forced:!i("symmetricDifference")},{symmetricDifference:r})},(s,e,t)=>{var n=t(127),r=t(128),i=t(129),o=t(133),a=t(131),u=r.add,l=r.has,c=r.remove;s.exports=function(d){var p=n(this),f=o(d).getIterator(),g=i(p);return a(f,function(v){l(p,v)?c(g,v):u(g,v)}),g}},(s,e,t)=>{var n=t(3),r=t(147),i=t(134);n({target:"Set",proto:!0,real:!0,forced:!i("union")},{union:r})},(s,e,t)=>{var n=t(127),r=t(128).add,i=t(129),o=t(133),a=t(131);s.exports=function(l){var c=n(this),h=o(l).getIterator(),d=i(c);return a(h,function(p){r(d,p)}),d}},(s,e,t)=>{var n=t(3),r=t(4),i=t(24),o=t(11),a=t(45).f,u=t(39),l=t(149),c=t(75),h=t(76),d=t(150),p=t(82),f=t(6),g=t(36),v="DOMException",y=i("Error"),x=i(v),R=function(){l(this,k);var j=arguments.length,G=h(j<1?void 0:arguments[0]),X=h(j<2?void 0:arguments[1],"Error"),q=new x(G,X),Z=y(G);return Z.name=v,a(q,"stack",o(1,p(Z.stack,1))),c(q,this,R),q},k=R.prototype=x.prototype,m="stack"in y(v),b="stack"in new x(1,2),I=x&&f&&Object.getOwnPropertyDescriptor(r,v),_=!!I&&!(I.writable&&I.configurable),S=m&&!_&&!b;n({global:!0,constructor:!0,forced:g||S},{DOMException:S?R:x});var T=i(v),E=T.prototype;if(E.constructor!==T){g||a(E,"constructor",o(1,T));for(var L in d)if(u(d,L)){var $=d[L],Y=$.s;u(T,Y)||a(T,Y,o(6,$.c))}}},(s,e,t)=>{var n=t(25),r=TypeError;s.exports=function(i,o){if(n(o,i))return i;throw r("Incorrect invocation")}},s=>{s.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},(s,e,t)=>{var n=t(36),r=t(3),i=t(4),o=t(24),a=t(14),u=t(7),l=t(41),c=t(21),h=t(152),d=t(17),p=t(20),f=t(23),g=t(153),v=t(47),y=t(78),x=t(39),R=t(158),k=t(44),m=t(64),b=t(85),I=t(159),_=t(161),S=t(128),T=t(83),E=t(119),L=i.Object,$=i.Array,Y=i.Date,V=i.Error,j=i.EvalError,G=i.RangeError,X=i.ReferenceError,q=i.SyntaxError,Z=i.TypeError,J=i.URIError,ve=i.PerformanceMark,K=i.WebAssembly,O=K&&K.CompileError||V,N=K&&K.LinkError||V,F=K&&K.RuntimeError||V,z=o("DOMException"),D=_.Map,U=_.has,ee=_.get,re=_.set,pe=S.Set,ue=S.add,ye=o("Object","keys"),ie=a([].push),ge=a((!0).valueOf),Ee=a(1 .valueOf),Oe=a("".valueOf),Ie=a(Y.prototype.getTime),we=l("structuredClone"),Ue="DataCloneError",Ne="Transferring",be=function(fe){return!u(function(){var M=new i.Set([7]),ne=fe(M),he=fe(L(7));return ne==M||!ne.has(7)||typeof he!="object"||he!=7})&&fe},de=function(fe,M){return!u(function(){var ne=new M,he=fe({a:ne,b:ne});return!(he&&he.a===he.b&&he.a instanceof M&&he.a.stack===ne.stack)})},Te=function(fe){return!u(function(){var M=fe(new i.AggregateError([1],we,{cause:3}));return M.name!="AggregateError"||M.errors[0]!=1||M.message!=we||M.cause!=3})},_e=i.structuredClone,Ve=n||!de(_e,V)||!de(_e,z)||!Te(_e),Ge=!_e&&be(function(fe){return new ve(we,{detail:fe}).detail}),Ke=be(_e)||Ge,$e=function(fe){throw new z("Uncloneable type: "+fe,Ue)},Ze=function(fe,M){throw new z((M||"Cloning")+" of "+fe+" cannot be properly polyfilled in this engine",Ue)},Qe=function(fe,M){return Ke||Ze(M),Ke(fe)},qe=function(){var fe;try{fe=new i.DataTransfer}catch{try{fe=new i.ClipboardEvent("").clipboardData}catch{}}return fe&&fe.items&&fe.files?fe:null},Ye=function(fe,M,ne){if(U(M,fe))return ee(M,fe);var he=ne||y(fe),ae,W,P,Q,H,te;if(he==="SharedArrayBuffer")Ke?ae=Ke(fe):ae=fe;else{var le=i.DataView;!le&&typeof fe.slice!="function"&&Ze("ArrayBuffer");try{if(typeof fe.slice=="function"&&!fe.resizable)ae=fe.slice(0);else for(W=fe.byteLength,P=("maxByteLength"in fe)?{maxByteLength:fe.maxByteLength}:void 0,ae=new ArrayBuffer(W,P),Q=new le(fe),H=new le(ae),te=0;te<W;te++)H.setUint8(te,Q.getUint8(te))}catch{throw new z("ArrayBuffer is detached",Ue)}}return re(M,fe,ae),ae},Se=function(fe,M,ne,he,ae){var W=i[M];return p(W)||Ze(M),new W(Ye(fe.buffer,ae),ne,he)},ce=function(fe,M,ne){this.object=fe,this.type=M,this.metadata=ne},oe=function(fe,M,ne){if(f(fe)&&$e("Symbol"),!p(fe))return fe;if(M){if(U(M,fe))return ee(M,fe)}else M=new D;var he=y(fe),ae,W,P,Q,H,te,le,xe;switch(he){case"Array":P=$(m(fe));break;case"Object":P={};break;case"Map":P=new D;break;case"Set":P=new pe;break;case"RegExp":P=new RegExp(fe.source,I(fe));break;case"Error":switch(W=fe.name,W){case"AggregateError":P=o("AggregateError")([]);break;case"EvalError":P=j();break;case"RangeError":P=G();break;case"ReferenceError":P=X();break;case"SyntaxError":P=q();break;case"TypeError":P=Z();break;case"URIError":P=J();break;case"CompileError":P=O();break;case"LinkError":P=N();break;case"RuntimeError":P=F();break;default:P=V()}break;case"DOMException":P=new z(fe.message,fe.name);break;case"ArrayBuffer":case"SharedArrayBuffer":P=ne?new ce(fe,he):Ye(fe,M,he);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":te=he==="DataView"?fe.byteLength:fe.length,P=ne?new ce(fe,he,{offset:fe.byteOffset,length:te}):Se(fe,he,fe.byteOffset,te,M);break;case"DOMQuad":try{P=new DOMQuad(oe(fe.p1,M,ne),oe(fe.p2,M,ne),oe(fe.p3,M,ne),oe(fe.p4,M,ne))}catch{P=Qe(fe,he)}break;case"File":if(Ke)try{P=Ke(fe),y(P)!==he&&(P=void 0)}catch{}if(!P)try{P=new File([fe],fe.name,fe)}catch{}P||Ze(he);break;case"FileList":if(Q=qe(),Q){for(H=0,te=m(fe);H<te;H++)Q.items.add(oe(fe[H],M,ne));P=Q.files}else P=Qe(fe,he);break;case"ImageData":try{P=new ImageData(oe(fe.data,M,ne),fe.width,fe.height,{colorSpace:fe.colorSpace})}catch{P=Qe(fe,he)}break;default:if(Ke)P=Ke(fe);else switch(he){case"BigInt":P=L(fe.valueOf());break;case"Boolean":P=L(ge(fe));break;case"Number":P=L(Ee(fe));break;case"String":P=L(Oe(fe));break;case"Date":P=new Y(Ie(fe));break;case"Blob":try{P=fe.slice(0,fe.size,fe.type)}catch{Ze(he)}break;case"DOMPoint":case"DOMPointReadOnly":ae=i[he];try{P=ae.fromPoint?ae.fromPoint(fe):new ae(fe.x,fe.y,fe.z,fe.w)}catch{Ze(he)}break;case"DOMRect":case"DOMRectReadOnly":ae=i[he];try{P=ae.fromRect?ae.fromRect(fe):new ae(fe.x,fe.y,fe.width,fe.height)}catch{Ze(he)}break;case"DOMMatrix":case"DOMMatrixReadOnly":ae=i[he];try{P=ae.fromMatrix?ae.fromMatrix(fe):new ae(fe)}catch{Ze(he)}break;case"AudioData":case"VideoFrame":c(fe.clone)||Ze(he);try{P=fe.clone()}catch{$e(he)}break;case"CropTarget":case"CryptoKey":case"FileSystemDirectoryHandle":case"FileSystemFileHandle":case"FileSystemHandle":case"GPUCompilationInfo":case"GPUCompilationMessage":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":Ze(he);default:$e(he)}}switch(re(M,fe,P),he){case"Array":case"Object":for(le=ye(fe),H=0,te=m(le);H<te;H++)xe=le[H],R(P,xe,oe(fe[xe],M,ne));break;case"Map":fe.forEach(function(Pe,We){re(P,oe(We,M,ne),oe(Pe,M,ne))});break;case"Set":fe.forEach(function(Pe){ue(P,oe(Pe,M,ne))});break;case"Error":k(P,"message",oe(fe.message,M,ne)),x(fe,"cause")&&k(P,"cause",oe(fe.cause,M,ne)),W=="AggregateError"&&(P.errors=oe(fe.errors,M,ne));case"DOMException":T&&k(P,"stack",oe(fe.stack,M,ne))}return P},Re=function(fe,M){if(!p(fe))return fe;if(U(M,fe))return ee(M,fe);var ne,he,ae,W,P,Q,H,te;if(fe instanceof ce)switch(ne=fe.type,he=fe.object,ne){case"ArrayBuffer":case"SharedArrayBuffer":te=Ye(he,M,ne);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":ae=fe.metadata,te=Se(he,ne,ae.offset,ae.length,M)}else switch(y(fe)){case"Array":case"Object":for(Q=ye(fe),W=0,P=m(Q);W<P;W++)H=Q[W],fe[H]=Re(fe[H],M);break;case"Map":te=new D,fe.forEach(function(le,xe){re(te,Re(xe,M),Re(le,M))});break;case"Set":te=new pe,fe.forEach(function(le){ue(te,Re(le,M))});break;case"Error":fe.message=Re(fe.message,M),x(fe,"cause")&&(fe.cause=Re(fe.cause,M)),fe.name=="AggregateError"&&(fe.errors=Re(fe.errors,M));case"DOMException":T&&(fe.stack=Re(fe.stack,M))}return re(M,fe,te||fe),te||fe},Fe=function(fe,M){if(!p(fe))throw Z("Transfer option cannot be converted to a sequence");var ne=[];g(fe,function(Pe){ie(ne,v(Pe))});for(var he=0,ae=m(ne),W=[],P,Q,H,te,le,xe;he<ae;){if(P=ne[he++],Q=y(P),Q==="ArrayBuffer"){ie(W,P);continue}if(U(M,P))throw new z("Duplicate transferable",Ue);if(E)te=_e(P,{transfer:[P]});else switch(Q){case"ImageBitmap":H=i.OffscreenCanvas,h(H)||Ze(Q,Ne);try{le=new H(P.width,P.height),xe=le.getContext("bitmaprenderer"),xe.transferFromImageBitmap(P),te=le.transferToImageBitmap()}catch{}break;case"AudioData":case"VideoFrame":(!c(P.clone)||!c(P.close))&&Ze(Q,Ne);try{te=P.clone(),P.close()}catch{}break;case"MediaSourceHandle":case"MessagePort":case"OffscreenCanvas":case"ReadableStream":case"TransformStream":case"WritableStream":Ze(Q,Ne)}if(te===void 0)throw new z("This object cannot be transferred: "+Q,Ue);re(M,P,te)}return W},et=function(fe,M){for(var ne=0,he=m(fe),ae,W;ne<he;){if(ae=fe[ne++],U(M,ae))throw new z("Duplicate transferable",Ue);E?W=_e(ae,{transfer:[ae]}):(c(ae.transfer)||Ze("ArrayBuffer",Ne),W=ae.transfer()),re(M,ae,W)}};r({global:!0,enumerable:!0,sham:!E,forced:Ve},{structuredClone:function(M){var ne=b(arguments.length,1)>1&&!d(arguments[1])?v(arguments[1]):void 0,he=ne?ne.transfer:void 0,ae=!1,W,P;he!==void 0&&(W=new D,P=Fe(he,W),ae=!!m(P));var Q=oe(M,W,ae);return ae&&(W=new D,et(he,W),Q=Re(Q,W)),Q}})},(s,e,t)=>{var n=t(14),r=t(7),i=t(21),o=t(78),a=t(24),u=t(51),l=function(){},c=[],h=a("Reflect","construct"),d=/^\s*(?:class|function)\b/,p=n(d.exec),f=!d.exec(l),g=function(x){if(!i(x))return!1;try{return h(l,c,x),!0}catch{return!1}},v=function(x){if(!i(x))return!1;switch(o(x)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!p(d,u(x))}catch{return!0}};v.sham=!0,s.exports=!h||r(function(){var y;return g(g.call)||!g(Object)||!g(function(){y=!0})||y})?v:g},(s,e,t)=>{var n=t(99),r=t(8),i=t(47),o=t(32),a=t(154),u=t(64),l=t(25),c=t(156),h=t(157),d=t(139),p=TypeError,f=function(v,y){this.stopped=v,this.result=y},g=f.prototype;s.exports=function(v,y,x){var R=x&&x.that,k=!!(x&&x.AS_ENTRIES),m=!!(x&&x.IS_RECORD),b=!!(x&&x.IS_ITERATOR),I=!!(x&&x.INTERRUPTED),_=n(y,R),S,T,E,L,$,Y,V,j=function(X){return S&&d(S,"normal",X),new f(!0,X)},G=function(X){return k?(i(X),I?_(X[0],X[1],j):_(X[0],X[1])):I?_(X,j):_(X)};if(m)S=v.iterator;else if(b)S=v;else{if(T=h(v),!T)throw p(o(v)+" is not iterable");if(a(T)){for(E=0,L=u(v);L>E;E++)if($=G(v[E]),$&&l(g,$))return $;return new f(!1)}S=c(v,T)}for(Y=m?v.next:S.next;!(V=r(Y,S)).done;){try{$=G(V.value)}catch(X){d(S,"throw",X)}if(typeof $=="object"&&$&&l(g,$))return $}return new f(!1)}},(s,e,t)=>{var n=t(34),r=t(155),i=n("iterator"),o=Array.prototype;s.exports=function(a){return a!==void 0&&(r.Array===a||o[i]===a)}},s=>{s.exports={}},(s,e,t)=>{var n=t(8),r=t(31),i=t(47),o=t(32),a=t(157),u=TypeError;s.exports=function(l,c){var h=arguments.length<2?a(l):c;if(r(h))return i(n(h,l));throw u(o(l)+" is not iterable")}},(s,e,t)=>{var n=t(78),r=t(30),i=t(17),o=t(155),a=t(34),u=a("iterator");s.exports=function(l){if(!i(l))return r(l,u)||r(l,"@@iterator")||o[n(l)]}},(s,e,t)=>{var n=t(18),r=t(45),i=t(11);s.exports=function(o,a,u){var l=n(a);l in o?r.f(o,l,i(0,u)):o[l]=u}},(s,e,t)=>{var n=t(8),r=t(39),i=t(25),o=t(160),a=RegExp.prototype;s.exports=function(u){var l=u.flags;return l===void 0&&!("flags"in a)&&!r(u,"flags")&&i(a,u)?n(o,u):l}},(s,e,t)=>{var n=t(47);s.exports=function(){var r=n(this),i="";return r.hasIndices&&(i+="d"),r.global&&(i+="g"),r.ignoreCase&&(i+="i"),r.multiline&&(i+="m"),r.dotAll&&(i+="s"),r.unicode&&(i+="u"),r.unicodeSets&&(i+="v"),r.sticky&&(i+="y"),i}},(s,e,t)=>{var n=t(14),r=Map.prototype;s.exports={Map,set:n(r.set),get:n(r.get),has:n(r.has),remove:n(r.delete),proto:r}},(s,e,t)=>{var l,c,h,Cn,p;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0,t(89),t(148),t(151);var n=t(1),r=t(163),i=t(169);const o=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=o;class a{constructor(){se(this,h);se(this,l,!1);se(this,c,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(g,v){const y=w(this,c).get(g);return y===void 0?v:Object.assign(v,y)}getRawValue(g){return w(this,c).get(g)}remove(g){if(w(this,c).delete(g),w(this,c).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const v of w(this,c).values())if(v instanceof r.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(g,v){const y=w(this,c).get(g);let x=!1;if(y!==void 0)for(const[R,k]of Object.entries(v))y[R]!==k&&(x=!0,y[R]=k);else x=!0,w(this,c).set(g,v);x&&me(this,h,Cn).call(this),v instanceof r.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(v.constructor._type)}has(g){return w(this,c).has(g)}getAll(){return w(this,c).size>0?(0,n.objectFromMap)(w(this,c)):null}setAll(g){for(const[v,y]of Object.entries(g))this.setValue(v,y)}get size(){return w(this,c).size}resetModified(){w(this,l)&&(Ae(this,l,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new u(this)}get serializable(){if(w(this,c).size===0)return o;const g=new Map,v=new i.MurmurHash3_64,y=[],x=Object.create(null);let R=!1;for(const[k,m]of w(this,c)){const b=m instanceof r.AnnotationEditor?m.serialize(!1,x):m;b&&(g.set(k,b),v.update(`${k}:${JSON.stringify(b)}`),R||(R=!!b.bitmap))}if(R)for(const k of g.values())k.bitmap&&y.push(k.bitmap);return g.size>0?{map:g,hash:v.hexdigest(),transfers:y}:o}}l=new WeakMap,c=new WeakMap,h=new WeakSet,Cn=function(){w(this,l)||(Ae(this,l,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=a;class u extends a{constructor(v){super();se(this,p,void 0);const{map:y,hash:x,transfers:R}=v.serializable,k=structuredClone(y,null);Ae(this,p,{map:k,hash:x,transfers:R})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return w(this,p)}}p=new WeakMap,e.PrintAnnotationStorage=u},(s,e,t)=>{var a,u,l,c,h,d,p,f,g,v,Yt,x,En,k,xn,b,wn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0,t(89),t(2);var n=t(1),r=t(164);const _=class{constructor(T){se(this,v);se(this,x);se(this,k);se(this,b);se(this,a,!1);se(this,u,null);se(this,l,null);se(this,c,this.focusin.bind(this));se(this,h,this.focusout.bind(this));se(this,d,!1);se(this,p,!1);se(this,f,!1);st(this,"_uiManager",null);se(this,g,_._zIndex++);this.constructor===_&&(0,n.unreachable)("Cannot initialize AnnotationEditor."),this.parent=T.parent,this.id=T.id,this.width=this.height=null,this.pageIndex=T.parent.pageIndex,this.name=T.name,this.div=null,this._uiManager=T.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1;const{rotation:E,rawDims:{pageWidth:L,pageHeight:$,pageX:Y,pageY:V}}=this.parent.viewport;this.rotation=E,this.pageRotation=(360+E-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[L,$],this.pageTranslation=[Y,V];const[j,G]=this.parentDimensions;this.x=T.x/j,this.y=T.y/G,this.isAttachedToDOM=!1,this.deleted=!1}static get _defaultLineColor(){return(0,n.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(T){const E=new o({id:T.parent.getNextId(),parent:T.parent,uiManager:T._uiManager});E.annotationElementId=T.annotationElementId,E.deleted=!0,E._uiManager.addToAnnotationStorage(E)}static initialize(T){}static updateDefaultParams(T,E){}static get defaultPropertiesToUpdate(){return[]}get propertiesToUpdate(){return[]}addCommands(T){this._uiManager.addCommands(T)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=w(this,g)}setParent(T){T!==null&&(this.pageIndex=T.pageIndex,this.pageDimensions=T.pageDimensions),this.parent=T}focusin(T){w(this,d)?Ae(this,d,!1):this.parent.setSelected(this)}focusout(T){var L;if(!this.isAttachedToDOM)return;const E=T.relatedTarget;E!=null&&E.closest(`#${this.id}`)||(T.preventDefault(),(L=this.parent)!=null&&L.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(T){const E=this.parent.div.getBoundingClientRect();this.startX=T.clientX-E.x,this.startY=T.clientY-E.y,T.dataTransfer.setData("text/plain",this.id),T.dataTransfer.effectAllowed="move"}setAt(T,E,L,$){const[Y,V]=this.parentDimensions;[L,$]=this.screenToPageTranslation(L,$),this.x=(T+L)/Y,this.y=(E+$)/V,this.fixAndSetPosition()}translate(T,E){me(this,v,Yt).call(this,this.parentDimensions,T,E)}translateInPage(T,E){me(this,v,Yt).call(this,this.pageDimensions,T,E),this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[T,E]=this.pageDimensions;let{x:L,y:$,width:Y,height:V}=this;switch(Y*=T,V*=E,L*=T,$*=E,this.rotation){case 0:L=Math.max(0,Math.min(T-Y,L)),$=Math.max(0,Math.min(E-V,$));break;case 90:L=Math.max(0,Math.min(T-V,L)),$=Math.min(E,Math.max(Y,$));break;case 180:L=Math.min(T,Math.max(Y,L)),$=Math.min(E,Math.max(V,$));break;case 270:L=Math.min(T,Math.max(V,L)),$=Math.max(0,Math.min(E-Y,$));break}this.x=L/T,this.y=$/E,this.div.style.left=`${(100*this.x).toFixed(2)}%`,this.div.style.top=`${(100*this.y).toFixed(2)}%`}screenToPageTranslation(T,E){switch(this.parentRotation){case 90:return[E,-T];case 180:return[-T,-E];case 270:return[-E,T];default:return[T,E]}}pageTranslationToScreen(T,E){switch(this.parentRotation){case 90:return[-E,T];case 180:return[-T,-E];case 270:return[E,-T];default:return[T,E]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{realScale:T}=this._uiManager.viewParameters,[E,L]=this.pageDimensions;return[E*T,L*T]}setDims(T,E){const[L,$]=this.parentDimensions;this.div.style.width=`${(100*T/L).toFixed(2)}%`,w(this,a)||(this.div.style.height=`${(100*E/$).toFixed(2)}%`)}fixDims(){const{style:T}=this.div,{height:E,width:L}=T,$=L.endsWith("%"),Y=!w(this,a)&&E.endsWith("%");if($&&Y)return;const[V,j]=this.parentDimensions;$||(T.width=`${(100*parseFloat(L)/V).toFixed(2)}%`),!w(this,a)&&!Y&&(T.height=`${(100*parseFloat(E)/j).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",w(this,c)),this.div.addEventListener("focusout",w(this,h));const[T,E]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*E/T).toFixed(2)}%`,this.div.style.maxHeight=`${(100*T/E).toFixed(2)}%`);const[L,$]=this.getInitialTranslation();return this.translate(L,$),(0,r.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(T){const{isMac:E}=n.FeatureTest.platform;if(T.button!==0||T.ctrlKey&&E){T.preventDefault();return}T.ctrlKey&&!E||T.shiftKey||T.metaKey&&E?this.parent.toggleSelected(this):this.parent.setSelected(this),Ae(this,d,!0)}getRect(T,E){const L=this.parentScale,[$,Y]=this.pageDimensions,[V,j]=this.pageTranslation,G=T/L,X=E/L,q=this.x*$,Z=this.y*Y,J=this.width*$,ve=this.height*Y;switch(this.rotation){case 0:return[q+G+V,Y-Z-X-ve+j,q+G+J+V,Y-Z-X+j];case 90:return[q+X+V,Y-Z+G+j,q+X+ve+V,Y-Z+G+J+j];case 180:return[q-G-J+V,Y-Z+X+j,q-G+V,Y-Z+X+ve+j];case 270:return[q-X-ve+V,Y-Z-G-J+j,q-X+V,Y-Z-G+j];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(T,E){const[L,$,Y,V]=T,j=Y-L,G=V-$;switch(this.rotation){case 0:return[L,E-V,j,G];case 90:return[L,E-$,G,j];case 180:return[Y,E-$,j,G];case 270:return[Y,E-V,G,j];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Ae(this,f,!0)}disableEditMode(){Ae(this,f,!1)}isInEditMode(){return w(this,f)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var T,E;(T=this.div)==null||T.addEventListener("focusin",w(this,c)),(E=this.div)==null||E.addEventListener("focusout",w(this,h))}serialize(){(0,n.unreachable)("An editor must be serializable")}static deserialize(T,E,L){const $=new this.prototype.constructor({parent:E,id:E.getNextId(),uiManager:L});$.rotation=T.rotation;const[Y,V]=$.pageDimensions,[j,G,X,q]=$.getRectInCurrentCoords(T.rect,V);return $.x=j/Y,$.y=G/V,$.width=X/Y,$.height=q/V,$}remove(){this.div.removeEventListener("focusin",w(this,c)),this.div.removeEventListener("focusout",w(this,h)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this)}get isResizable(){return!1}makeResizable(){this.isResizable&&(me(this,x,En).call(this),w(this,u).classList.remove("hidden"))}select(){var T;this.makeResizable(),(T=this.div)==null||T.classList.add("selectedEditor")}unselect(){var T,E,L;(T=w(this,u))==null||T.classList.add("hidden"),(E=this.div)==null||E.classList.remove("selectedEditor"),(L=this.div)!=null&&L.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(T,E){}disableEditing(){}enableEditing(){}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return w(this,p)}set isEditing(T){Ae(this,p,T),this.parent&&(T?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(T,E){Ae(this,a,!0);const L=T/E,{style:$}=this.div;$.aspectRatio=L,$.height="auto"}static get MIN_SIZE(){return 16}};let i=_;a=new WeakMap,u=new WeakMap,l=new WeakMap,c=new WeakMap,h=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,g=new WeakMap,v=new WeakSet,Yt=function(T,E,L){let[$,Y]=T;[E,L]=this.screenToPageTranslation(E,L),this.x+=E/$,this.y+=L/Y,this.fixAndSetPosition()},x=new WeakSet,En=function(){if(w(this,u))return;Ae(this,u,document.createElement("div")),w(this,u).classList.add("resizers");const T=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||T.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const E of T){const L=document.createElement("div");w(this,u).append(L),L.classList.add("resizer",E),L.addEventListener("pointerdown",me(this,k,xn).bind(this,E))}this.div.prepend(w(this,u))},k=new WeakSet,xn=function(T,E){E.preventDefault(),Ae(this,l,[E.clientX,E.clientY]);const L=me(this,b,wn).bind(this,T),$=this.div.draggable;this.div.draggable=!1;const Y=`resizing${T.charAt(0).toUpperCase()}${T.slice(1)}`;this.parent.div.classList.add(Y);const V={passive:!0,capture:!0};window.addEventListener("pointermove",L,V);const j=()=>{this._uiManager.stopUndoAccumulation(),this.div.draggable=$,this.parent.div.classList.remove(Y),window.removeEventListener("pointermove",L,V)};window.addEventListener("pointerup",j,{once:!0})},b=new WeakSet,wn=function(T,E){const{clientX:L,clientY:$}=E,Y=L-w(this,l)[0],V=$-w(this,l)[1];w(this,l)[0]=L,w(this,l)[1]=$;const[j,G]=this.parentDimensions,X=this.x,q=this.y,Z=this.width,J=this.height,ve=_.MIN_SIZE/j,K=_.MIN_SIZE/G;let O;const N=D=>Math.round(D*1e4)/1e4,F=(D,U)=>{const[ee,re]=this.parentDimensions;this.setDims(ee*D,re*U),this.fixAndSetPosition()},z=()=>{this.width=Z,this.height=J,this.x=X,this.y=q,F(Z,J)};switch(T){case"topLeft":{if(Math.sign(Y)*Math.sign(V)<0)return;const D=Math.hypot(Y,V),U=Math.hypot(Z*j,J*G),ee=N(X+Z),re=N(q+J),pe=Math.max(Math.min(1-Math.sign(Y)*(D/U),1/Z,1/J),ve/Z,K/J),ue=N(Z*pe),ye=N(J*pe),ie=ee-ue,ge=re-ye;O=()=>{this.width=ue,this.height=ye,this.x=ie,this.y=ge,F(ue,ye)};break}case"topMiddle":{const D=N(this.y+J),U=N(Math.max(K,Math.min(1,J-V/G))),ee=D-U;O=()=>{this.height=U,this.y=ee,F(Z,U)};break}case"topRight":{if(Math.sign(Y)*Math.sign(V)>0)return;const D=Math.hypot(Y,V),U=Math.hypot(this.width*j,this.height*G),ee=N(q+this.height),re=Math.max(Math.min(1+Math.sign(Y)*(D/U),1/Z,1/J),ve/Z,K/J),pe=N(Z*re),ue=N(J*re),ye=ee-ue;O=()=>{this.width=pe,this.height=ue,this.y=ye,F(pe,ue)};break}case"middleRight":{const D=N(Math.max(ve,Math.min(1,Z+Y/j)));O=()=>{this.width=D,F(D,J)};break}case"bottomRight":{if(Math.sign(Y)*Math.sign(V)<0)return;const D=Math.hypot(Y,V),U=Math.hypot(this.width*j,this.height*G),ee=Math.max(Math.min(1+Math.sign(Y)*(D/U),1/Z,1/J),ve/Z,K/J),re=N(Z*ee),pe=N(J*ee);O=()=>{this.width=re,this.height=pe,F(re,pe)};break}case"bottomMiddle":{const D=N(Math.max(K,Math.min(1,J+V/G)));O=()=>{this.height=D,F(Z,D)};break}case"bottomLeft":{if(Math.sign(Y)*Math.sign(V)>0)return;const D=Math.hypot(Y,V),U=Math.hypot(this.width*j,this.height*G),ee=N(X+this.width),re=Math.max(Math.min(1-Math.sign(Y)*(D/U),1/Z,1/J),ve/Z,K/J),pe=N(Z*re),ue=N(J*re),ye=ee-pe;O=()=>{this.width=pe,this.height=ue,this.x=ye,F(pe,ue)};break}case"middleLeft":{const D=N(X+Z),U=N(Math.max(ve,Math.min(1,Z-Y/j))),ee=D-U;O=()=>{this.width=U,this.x=ee,F(U,J)};break}}this.addCommands({cmd:O,undo:z,mustExec:!0,type:n.AnnotationEditorParamsType.RESIZE,overwriteIfSameType:!0,keepUndo:!0})},st(i,"_colorManager",new r.ColorManager),st(i,"_zIndex",1),e.AnnotationEditor=i;class o extends i{constructor(T){super(T),this.annotationElementId=T.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(s,e,t)=>{var p,f,g,v,y,jt,R,k,m,b,I,_n,T,E,L,$,Y,V,j,G,X,q,Z,J,ve,K,O,N,F,z,D,U,ee,re,pe,ue,ye,ie,ge,Ee,Oe,Nn,we,Kt,Ne,kn,de,On,_e,ft,Ge,Nt,$e,Pn,Qe,Rn,Ye,Zt,ce,kt,Re,Qt;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=i,e.opacityToHex=o,t(2),t(89),t(125),t(135),t(137),t(140),t(142),t(144),t(146),t(165);var n=t(1),r=t(167);function i(fe,M,ne){for(const he of ne)M.addEventListener(he,fe[he].bind(fe))}function o(fe){return Math.round(Math.min(255,Math.max(1,255*fe))).toString(16).padStart(2,"0")}class a{constructor(){se(this,p,0)}getId(){return`${n.AnnotationEditorPrefix}${pt(this,p)._++}`}}p=new WeakMap;class u{constructor(){se(this,y);se(this,f,(0,n.getUuid)());se(this,g,0);se(this,v,null)}async getFromFile(M){const{lastModified:ne,name:he,size:ae,type:W}=M;return me(this,y,jt).call(this,`${ne}_${he}_${ae}_${W}`,M)}async getFromUrl(M){return me(this,y,jt).call(this,M,M)}async getFromId(M){w(this,v)||Ae(this,v,new Map);const ne=w(this,v).get(M);return ne?ne.bitmap?(ne.refCounter+=1,ne):ne.file?this.getFromFile(ne.file):this.getFromUrl(ne.url):null}getSvgUrl(M){const ne=w(this,v).get(M);return ne!=null&&ne.isSvg?ne.svgUrl:null}deleteId(M){w(this,v)||Ae(this,v,new Map);const ne=w(this,v).get(M);ne&&(ne.refCounter-=1,ne.refCounter===0&&(ne.bitmap=null))}isValidId(M){return M.startsWith(`image_${w(this,f)}_`)}}f=new WeakMap,g=new WeakMap,v=new WeakMap,y=new WeakSet,jt=async function(M,ne){w(this,v)||Ae(this,v,new Map);let he=w(this,v).get(M);if(he===null)return null;if(he!=null&&he.bitmap)return he.refCounter+=1,he;try{he||(he={bitmap:null,id:`image_${w(this,f)}_${pt(this,g)._++}`,refCounter:0,isSvg:!1});let ae;if(typeof ne=="string"){he.url=ne;const W=await fetch(ne);if(!W.ok)throw new Error(W.statusText);ae=await W.blob()}else ae=he.file=ne;if(ae.type==="image/svg+xml"){const W=new FileReader,P=new Image,Q=new Promise((H,te)=>{P.onload=()=>{he.bitmap=P,he.isSvg=!0,H()},W.onload=()=>{P.src=he.svgUrl=W.result},P.onerror=W.onerror=te});W.readAsDataURL(ae),await Q}else he.bitmap=await createImageBitmap(ae);he.refCounter=1}catch(ae){console.error(ae),he=null}return w(this,v).set(M,he),he&&w(this,v).set(he.id,he),he};class l{constructor(){se(this,R,[]);se(this,k,!1);se(this,m,void 0);se(this,b,-1);let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:128;Ae(this,m,M)}add(M){let{cmd:ne,undo:he,mustExec:ae,type:W=NaN,overwriteIfSameType:P=!1,keepUndo:Q=!1}=M;if(ae&&ne(),w(this,k))return;const H={cmd:ne,undo:he,type:W};if(w(this,b)===-1){w(this,R).length>0&&(w(this,R).length=0),Ae(this,b,0),w(this,R).push(H);return}if(P&&w(this,R)[w(this,b)].type===W){Q&&(H.undo=w(this,R)[w(this,b)].undo),w(this,R)[w(this,b)]=H;return}const te=w(this,b)+1;te===w(this,m)?w(this,R).splice(0,1):(Ae(this,b,te),te<w(this,R).length&&w(this,R).splice(te)),w(this,R).push(H)}stopUndoAccumulation(){w(this,b)!==-1&&(w(this,R)[w(this,b)].type=NaN)}undo(){w(this,b)!==-1&&(Ae(this,k,!0),w(this,R)[w(this,b)].undo(),Ae(this,k,!1),Ae(this,b,w(this,b)-1))}redo(){w(this,b)<w(this,R).length-1&&(Ae(this,b,w(this,b)+1),Ae(this,k,!0),w(this,R)[w(this,b)].cmd(),Ae(this,k,!1))}hasSomethingToUndo(){return w(this,b)!==-1}hasSomethingToRedo(){return w(this,b)<w(this,R).length-1}destroy(){Ae(this,R,null)}}R=new WeakMap,k=new WeakMap,m=new WeakMap,b=new WeakMap,e.CommandManager=l;class c{constructor(M){se(this,I);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:ne}=n.FeatureTest.platform;for(const[he,ae,W={}]of M)for(const P of he){const Q=P.startsWith("mac+");ne&&Q?(this.callbacks.set(P.slice(4),{callback:ae,options:W}),this.allKeys.add(P.split("+").at(-1))):!ne&&!Q&&(this.callbacks.set(P,{callback:ae,options:W}),this.allKeys.add(P.split("+").at(-1)))}}exec(M,ne){if(!this.allKeys.has(ne.key))return;const he=this.callbacks.get(me(this,I,_n).call(this,ne));if(!he)return;const{callback:ae,options:{bubbles:W=!1,args:P=[],checker:Q=null}}=he;Q&&!Q(M,ne)||(ae.bind(M,...P)(),W||(ne.stopPropagation(),ne.preventDefault()))}}I=new WeakSet,_n=function(M){M.altKey&&this.buffer.push("alt"),M.ctrlKey&&this.buffer.push("ctrl"),M.metaKey&&this.buffer.push("meta"),M.shiftKey&&this.buffer.push("shift"),this.buffer.push(M.key);const ne=this.buffer.join("+");return this.buffer.length=0,ne},e.KeyboardManager=c;const S=class{get _colors(){const M=new Map([["CanvasText",null],["Canvas",null]]);return(0,r.getColorValues)(M),(0,n.shadow)(this,"_colors",M)}convert(M){const ne=(0,r.getRGB)(M);if(!window.matchMedia("(forced-colors: active)").matches)return ne;for(const[he,ae]of this._colors)if(ae.every((W,P)=>W===ne[P]))return S._colorsMapping.get(he);return ne}getHexCode(M){const ne=this._colors.get(M);return ne?n.Util.makeHexColor(...ne):M}};let h=S;st(h,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),e.ColorManager=h;const et=class{constructor(M,ne,he,ae){se(this,Oe);se(this,we);se(this,Ne);se(this,de);se(this,_e);se(this,Ge);se(this,$e);se(this,Qe);se(this,Ye);se(this,ce);se(this,Re);se(this,T,null);se(this,E,new Map);se(this,L,new Map);se(this,$,null);se(this,Y,new l);se(this,V,0);se(this,j,new Set);se(this,G,null);se(this,X,new Set);se(this,q,null);se(this,Z,null);se(this,J,new a);se(this,ve,!1);se(this,K,n.AnnotationEditorType.NONE);se(this,O,new Set);se(this,N,null);se(this,F,this.copy.bind(this));se(this,z,this.cut.bind(this));se(this,D,this.paste.bind(this));se(this,U,this.keydown.bind(this));se(this,ee,this.onEditingAction.bind(this));se(this,re,this.onPageChanging.bind(this));se(this,pe,this.onScaleChanging.bind(this));se(this,ue,this.onRotationChanging.bind(this));se(this,ye,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});se(this,ie,[0,0]);se(this,ge,null);se(this,Ee,null);Ae(this,Ee,M),Ae(this,q,ne),w(this,q)._on("editingaction",w(this,ee)),w(this,q)._on("pagechanging",w(this,re)),w(this,q)._on("scalechanging",w(this,pe)),w(this,q)._on("rotationchanging",w(this,ue)),Ae(this,$,he.annotationStorage),Ae(this,Z,he.filterFactory),Ae(this,N,ae),this.viewParameters={realScale:r.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const M=et.prototype,ne=W=>{const{activeElement:P}=document;return P&&w(W,Ee).contains(P)&&W.hasSomethingToControl()},he=this.TRANSLATE_SMALL,ae=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new c([[["ctrl+a","mac+meta+a"],M.selectAll],[["ctrl+z","mac+meta+z"],M.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],M.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],M.delete],[["Escape","mac+Escape"],M.unselectAll],[["ArrowLeft","mac+ArrowLeft"],M.translateSelectedEditors,{args:[-he,0],checker:ne}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],M.translateSelectedEditors,{args:[-ae,0],checker:ne}],[["ArrowRight","mac+ArrowRight"],M.translateSelectedEditors,{args:[he,0],checker:ne}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],M.translateSelectedEditors,{args:[ae,0],checker:ne}],[["ArrowUp","mac+ArrowUp"],M.translateSelectedEditors,{args:[0,-he],checker:ne}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],M.translateSelectedEditors,{args:[0,-ae],checker:ne}],[["ArrowDown","mac+ArrowDown"],M.translateSelectedEditors,{args:[0,he],checker:ne}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],M.translateSelectedEditors,{args:[0,ae],checker:ne}]]))}destroy(){me(this,we,Kt).call(this),w(this,q)._off("editingaction",w(this,ee)),w(this,q)._off("pagechanging",w(this,re)),w(this,q)._off("scalechanging",w(this,pe)),w(this,q)._off("rotationchanging",w(this,ue));for(const M of w(this,L).values())M.destroy();w(this,L).clear(),w(this,E).clear(),w(this,X).clear(),Ae(this,T,null),w(this,O).clear(),w(this,Y).destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",w(this,N)?w(this,Z).addHCMFilter(w(this,N).foreground,w(this,N).background):"none")}onPageChanging(M){let{pageNumber:ne}=M;Ae(this,V,ne-1)}focusMainContainer(){w(this,Ee).focus()}addShouldRescale(M){w(this,X).add(M)}removeShouldRescale(M){w(this,X).delete(M)}onScaleChanging(M){let{scale:ne}=M;this.commitOrRemove(),this.viewParameters.realScale=ne*r.PixelsPerInch.PDF_TO_CSS_UNITS;for(const he of w(this,X))he.onScaleChanging()}onRotationChanging(M){let{pagesRotation:ne}=M;this.commitOrRemove(),this.viewParameters.rotation=ne}addToAnnotationStorage(M){!M.isEmpty()&&w(this,$)&&!w(this,$).has(M.id)&&w(this,$).setValue(M.id,M)}copy(M){if(M.preventDefault(),w(this,T)&&w(this,T).commitOrRemove(),!this.hasSelection)return;const ne=[];for(const he of w(this,O)){const ae=he.serialize(!0);ae&&ne.push(ae)}ne.length!==0&&M.clipboardData.setData("application/pdfjs",JSON.stringify(ne))}cut(M){this.copy(M),this.delete()}paste(M){M.preventDefault();let ne=M.clipboardData.getData("application/pdfjs");if(!ne)return;try{ne=JSON.parse(ne)}catch(ae){(0,n.warn)(`paste: "${ae.message}".`);return}if(!Array.isArray(ne))return;this.unselectAll();const he=this.currentLayer;try{const ae=[];for(const Q of ne){const H=he.deserialize(Q);if(!H)return;ae.push(H)}const W=()=>{for(const Q of ae)me(this,Ye,Zt).call(this,Q);me(this,Re,Qt).call(this,ae)},P=()=>{for(const Q of ae)Q.remove()};this.addCommands({cmd:W,undo:P,mustExec:!0})}catch(ae){(0,n.warn)(`paste: "${ae.message}".`)}}keydown(M){var ne;(ne=this.getActive())!=null&&ne.shouldGetKeyboardEvents()||et._keyboardManager.exec(this,M)}onEditingAction(M){["undo","redo","delete","selectAll"].includes(M.name)&&this[M.name]()}setEditingState(M){M?(me(this,Oe,Nn).call(this),me(this,Ne,kn).call(this),me(this,_e,ft).call(this,{isEditing:w(this,K)!==n.AnnotationEditorType.NONE,isEmpty:me(this,ce,kt).call(this),hasSomethingToUndo:w(this,Y).hasSomethingToUndo(),hasSomethingToRedo:w(this,Y).hasSomethingToRedo(),hasSelectedEditor:!1})):(me(this,we,Kt).call(this),me(this,de,On).call(this),me(this,_e,ft).call(this,{isEditing:!1}))}registerEditorTypes(M){if(!w(this,G)){Ae(this,G,M);for(const ne of w(this,G))me(this,Ge,Nt).call(this,ne.defaultPropertiesToUpdate)}}getId(){return w(this,J).getId()}get currentLayer(){return w(this,L).get(w(this,V))}get currentPageIndex(){return w(this,V)}addLayer(M){w(this,L).set(M.pageIndex,M),w(this,ve)?M.enable():M.disable()}removeLayer(M){w(this,L).delete(M.pageIndex)}updateMode(M){let ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(Ae(this,K,M),M===n.AnnotationEditorType.NONE){this.setEditingState(!1),me(this,Qe,Rn).call(this);return}this.setEditingState(!0),me(this,$e,Pn).call(this);for(const he of w(this,L).values())he.updateMode(M);if(ne){for(const he of w(this,E).values())if(he.annotationElementId===ne){this.setSelected(he),he.enterInEditMode();break}}}updateToolbar(M){M!==w(this,K)&&w(this,q).dispatch("switchannotationeditormode",{source:this,mode:M})}updateParams(M,ne){if(w(this,G)){for(const he of w(this,O))he.updateParams(M,ne);for(const he of w(this,G))he.updateDefaultParams(M,ne)}}getEditors(M){const ne=[];for(const he of w(this,E).values())he.pageIndex===M&&ne.push(he);return ne}getEditor(M){return w(this,E).get(M)}addEditor(M){w(this,E).set(M.id,M)}removeEditor(M){var ne;w(this,E).delete(M.id),this.unselect(M),(!M.annotationElementId||!w(this,j).has(M.annotationElementId))&&((ne=w(this,$))==null||ne.remove(M.id))}addDeletedAnnotationElement(M){w(this,j).add(M.annotationElementId),M.deleted=!0}isDeletedAnnotationElement(M){return w(this,j).has(M)}removeDeletedAnnotationElement(M){w(this,j).delete(M.annotationElementId),M.deleted=!1}setActiveEditor(M){w(this,T)!==M&&(Ae(this,T,M),M&&me(this,Ge,Nt).call(this,M.propertiesToUpdate))}toggleSelected(M){if(w(this,O).has(M)){w(this,O).delete(M),M.unselect(),me(this,_e,ft).call(this,{hasSelectedEditor:this.hasSelection});return}w(this,O).add(M),M.select(),me(this,Ge,Nt).call(this,M.propertiesToUpdate),me(this,_e,ft).call(this,{hasSelectedEditor:!0})}setSelected(M){for(const ne of w(this,O))ne!==M&&ne.unselect();w(this,O).clear(),w(this,O).add(M),M.select(),me(this,Ge,Nt).call(this,M.propertiesToUpdate),me(this,_e,ft).call(this,{hasSelectedEditor:!0})}isSelected(M){return w(this,O).has(M)}unselect(M){M.unselect(),w(this,O).delete(M),me(this,_e,ft).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return w(this,O).size!==0}stopUndoAccumulation(){w(this,Y).stopUndoAccumulation()}undo(){w(this,Y).undo(),me(this,_e,ft).call(this,{hasSomethingToUndo:w(this,Y).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:me(this,ce,kt).call(this)})}redo(){w(this,Y).redo(),me(this,_e,ft).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:w(this,Y).hasSomethingToRedo(),isEmpty:me(this,ce,kt).call(this)})}addCommands(M){w(this,Y).add(M),me(this,_e,ft).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:me(this,ce,kt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const M=[...w(this,O)],ne=()=>{for(const ae of M)ae.remove()},he=()=>{for(const ae of M)me(this,Ye,Zt).call(this,ae)};this.addCommands({cmd:ne,undo:he,mustExec:!0})}commitOrRemove(){var M;(M=w(this,T))==null||M.commitOrRemove()}hasSomethingToControl(){return w(this,T)||this.hasSelection}selectAll(){for(const M of w(this,O))M.commit();me(this,Re,Qt).call(this,w(this,E).values())}unselectAll(){if(w(this,T)){w(this,T).commitOrRemove();return}if(this.hasSelection){for(const M of w(this,O))M.unselect();w(this,O).clear(),me(this,_e,ft).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(M,ne){if((arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1)||this.commitOrRemove(),!this.hasSelection)return;w(this,ie)[0]+=M,w(this,ie)[1]+=ne;const[ae,W]=w(this,ie),P=[...w(this,O)],Q=1e3;w(this,ge)&&clearTimeout(w(this,ge)),Ae(this,ge,setTimeout(()=>{Ae(this,ge,null),w(this,ie)[0]=w(this,ie)[1]=0,this.addCommands({cmd:()=>{for(const H of P)w(this,E).has(H.id)&&H.translateInPage(ae,W)},undo:()=>{for(const H of P)w(this,E).has(H.id)&&H.translateInPage(-ae,-W)},mustExec:!1})},Q));for(const H of P)H.translateInPage(M,ne)}isActive(M){return w(this,T)===M}getActive(){return w(this,T)}getMode(){return w(this,K)}get imageManager(){return(0,n.shadow)(this,"imageManager",new u)}};let d=et;T=new WeakMap,E=new WeakMap,L=new WeakMap,$=new WeakMap,Y=new WeakMap,V=new WeakMap,j=new WeakMap,G=new WeakMap,X=new WeakMap,q=new WeakMap,Z=new WeakMap,J=new WeakMap,ve=new WeakMap,K=new WeakMap,O=new WeakMap,N=new WeakMap,F=new WeakMap,z=new WeakMap,D=new WeakMap,U=new WeakMap,ee=new WeakMap,re=new WeakMap,pe=new WeakMap,ue=new WeakMap,ye=new WeakMap,ie=new WeakMap,ge=new WeakMap,Ee=new WeakMap,Oe=new WeakSet,Nn=function(){window.addEventListener("keydown",w(this,U),{capture:!0})},we=new WeakSet,Kt=function(){window.removeEventListener("keydown",w(this,U),{capture:!0})},Ne=new WeakSet,kn=function(){document.addEventListener("copy",w(this,F)),document.addEventListener("cut",w(this,z)),document.addEventListener("paste",w(this,D))},de=new WeakSet,On=function(){document.removeEventListener("copy",w(this,F)),document.removeEventListener("cut",w(this,z)),document.removeEventListener("paste",w(this,D))},_e=new WeakSet,ft=function(M){Object.entries(M).some(he=>{let[ae,W]=he;return w(this,ye)[ae]!==W})&&w(this,q).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(w(this,ye),M)})},Ge=new WeakSet,Nt=function(M){w(this,q).dispatch("annotationeditorparamschanged",{source:this,details:M})},$e=new WeakSet,Pn=function(){if(!w(this,ve)){Ae(this,ve,!0);for(const M of w(this,L).values())M.enable()}},Qe=new WeakSet,Rn=function(){if(this.unselectAll(),w(this,ve)){Ae(this,ve,!1);for(const M of w(this,L).values())M.disable()}},Ye=new WeakSet,Zt=function(M){const ne=w(this,L).get(M.pageIndex);ne?ne.addOrRebuild(M):this.addEditor(M)},ce=new WeakSet,kt=function(){if(w(this,E).size===0)return!0;if(w(this,E).size===1)for(const M of w(this,E).values())return M.isEmpty();return!1},Re=new WeakSet,Qt=function(M){w(this,O).clear();for(const ne of M)ne.isEmpty()||(w(this,O).add(ne),ne.select());me(this,_e,ft).call(this,{hasSelectedEditor:!0})},st(d,"TRANSLATE_SMALL",1),st(d,"TRANSLATE_BIG",10),e.AnnotationEditorUIManager=d},(s,e,t)=>{var n=t(3),r=t(6),i=t(4),o=t(24),a=t(14),u=t(8),l=t(21),c=t(20),h=t(91),d=t(39),p=t(77),f=t(64),g=t(158),v=t(7),y=t(166),x=t(27),R=i.JSON,k=i.Number,m=i.SyntaxError,b=R&&R.parse,I=o("Object","keys"),_=Object.getOwnPropertyDescriptor,S=a("".charAt),T=a("".slice),E=a(/./.exec),L=a([].push),$=/^\d$/,Y=/^[1-9]$/,V=/^(-|\d)$/,j=/^[\t\n\r ]$/,G=0,X=1,q=function(F,z){F=p(F);var D=new K(F,0),U=D.parse(),ee=U.value,re=D.skip(j,U.end);if(re<F.length)throw m('Unexpected extra character: "'+S(F,re)+'" after the parsed data at: '+re);return l(z)?Z({"":ee},"",z,U):ee},Z=function(F,z,D,U){var ee=F[z],re=U&&ee===U.value,pe=re&&typeof U.source=="string"?{source:U.source}:{},ue,ye,ie,ge,Ee;if(c(ee)){var Oe=h(ee),Ie=re?U.nodes:Oe?[]:{};if(Oe)for(ue=Ie.length,ie=f(ee),ge=0;ge<ie;ge++)J(ee,ge,Z(ee,""+ge,D,ge<ue?Ie[ge]:void 0));else for(ye=I(ee),ie=f(ye),ge=0;ge<ie;ge++)Ee=ye[ge],J(ee,Ee,Z(ee,Ee,D,d(Ie,Ee)?Ie[Ee]:void 0))}return u(D,F,z,ee,pe)},J=function(F,z,D){if(r){var U=_(F,z);if(U&&!U.configurable)return}D===void 0?delete F[z]:g(F,z,D)},ve=function(F,z,D,U){this.value=F,this.end=z,this.source=D,this.nodes=U},K=function(F,z){this.source=F,this.index=z};K.prototype={fork:function(F){return new K(this.source,F)},parse:function(){var F=this.source,z=this.skip(j,this.index),D=this.fork(z),U=S(F,z);if(E(V,U))return D.number();switch(U){case"{":return D.object();case"[":return D.array();case'"':return D.string();case"t":return D.keyword(!0);case"f":return D.keyword(!1);case"n":return D.keyword(null)}throw m('Unexpected character: "'+U+'" at: '+z)},node:function(F,z,D,U,ee){return new ve(z,U,F?null:T(this.source,D,U),ee)},object:function(){for(var F=this.source,z=this.index+1,D=!1,U={},ee={};z<F.length;){if(z=this.until(['"',"}"],z),S(F,z)=="}"&&!D){z++;break}var re=this.fork(z).string(),pe=re.value;z=re.end,z=this.until([":"],z)+1,z=this.skip(j,z),re=this.fork(z).parse(),g(ee,pe,re),g(U,pe,re.value),z=this.until([",","}"],re.end);var ue=S(F,z);if(ue==",")D=!0,z++;else if(ue=="}"){z++;break}}return this.node(X,U,this.index,z,ee)},array:function(){for(var F=this.source,z=this.index+1,D=!1,U=[],ee=[];z<F.length;){if(z=this.skip(j,z),S(F,z)=="]"&&!D){z++;break}var re=this.fork(z).parse();if(L(ee,re),L(U,re.value),z=this.until([",","]"],re.end),S(F,z)==",")D=!0,z++;else if(S(F,z)=="]"){z++;break}}return this.node(X,U,this.index,z,ee)},string:function(){var F=this.index,z=y(this.source,this.index+1);return this.node(G,z.value,F,z.end)},number:function(){var F=this.source,z=this.index,D=z;if(S(F,D)=="-"&&D++,S(F,D)=="0")D++;else if(E(Y,S(F,D)))D=this.skip($,++D);else throw m("Failed to parse number at: "+D);if(S(F,D)=="."&&(D=this.skip($,++D)),S(F,D)=="e"||S(F,D)=="E"){D++,(S(F,D)=="+"||S(F,D)=="-")&&D++;var U=D;if(D=this.skip($,D),U==D)throw m("Failed to parse number's exponent value at: "+D)}return this.node(G,k(T(F,z,D)),z,D)},keyword:function(F){var z=""+F,D=this.index,U=D+z.length;if(T(this.source,D,U)!=z)throw m("Failed to parse value at: "+D);return this.node(G,F,D,U)},skip:function(F,z){for(var D=this.source;z<D.length&&E(F,S(D,z));z++);return z},until:function(F,z){z=this.skip(j,z);for(var D=S(this.source,z),U=0;U<F.length;U++)if(F[U]==D)return z;throw m('Unexpected character: "'+D+'" at: '+z)}};var O=v(function(){var F="9007199254740993",z;return b(F,function(D,U,ee){z=ee.source}),z!==F}),N=x&&!v(function(){return 1/b("-0 	")!==-1/0});n({target:"JSON",stat:!0,forced:O},{parse:function(z,D){return N&&!l(D)?b(z):q(z,D)}})},(s,e,t)=>{var n=t(14),r=t(39),i=SyntaxError,o=parseInt,a=String.fromCharCode,u=n("".charAt),l=n("".slice),c=n(/./.exec),h={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},d=/^[\da-f]{4}$/i,p=/^[\u0000-\u001F]$/;s.exports=function(f,g){for(var v=!0,y="";g<f.length;){var x=u(f,g);if(x=="\\"){var R=l(f,g,g+2);if(r(h,R))y+=h[R],g+=2;else if(R=="\\u"){g+=2;var k=l(f,g,g+4);if(!c(d,k))throw i("Bad Unicode escape at: "+g);y+=a(o(k,16)),g+=4}else throw i('Unknown escape sequence: "'+R+'"')}else if(x=='"'){v=!1,g++;break}else{if(c(p,x))throw i("Bad control character in string literal at: "+g);y+=x,g++}}if(v)throw i("Unterminated string at: "+g);return{value:y,end:g}}},(s,e,t)=>{var G,X,q,Z,J,ve,K,O,N,F,z,D,Ct,ee,Et,pe,qt,ye,Dt,ge,Ft,Oe,Ot,we,Pt;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=e.AnnotationPrefix=void 0,e.deprecated=I,e.getColorValues=L,e.getCurrentTransform=$,e.getCurrentTransformInverse=Y,e.getFilenameFromUrl=x,e.getPdfFilenameFromUrl=R,e.getRGB=E,e.getXfaPageViewport=T,e.isDataScheme=v,e.isPdfFile=y,e.isValidFetchUrl=m,e.loadScript=b,e.setLayerDimensions=V,t(2),t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123),t(89),t(84),t(86),t(87);var n=t(168),r=t(1);const i="http://www.w3.org/2000/svg",o="pdfjs_internal_id_";e.AnnotationPrefix=o;const j=class{};let a=j;st(a,"CSS",96),st(a,"PDF",72),st(a,"PDF_TO_CSS_UNITS",j.CSS/j.PDF),e.PixelsPerInch=a;class u extends n.BaseFilterFactory{constructor(){let{docId:de,ownerDocument:Te=globalThis.document}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super();se(this,D);se(this,ee);se(this,pe);se(this,ye);se(this,ge);se(this,Oe);se(this,we);se(this,G,void 0);se(this,X,void 0);se(this,q,void 0);se(this,Z,void 0);se(this,J,void 0);se(this,ve,void 0);se(this,K,void 0);se(this,O,void 0);se(this,N,void 0);se(this,F,void 0);se(this,z,0);Ae(this,q,de),Ae(this,Z,Te)}addFilter(de){if(!de)return"none";let Te=w(this,D,Ct).get(de);if(Te)return Te;let _e,Ve,Ge,Ke;if(de.length===1){const qe=de[0],Ye=new Array(256);for(let Se=0;Se<256;Se++)Ye[Se]=qe[Se]/255;Ke=_e=Ve=Ge=Ye.join(",")}else{const[qe,Ye,Se]=de,ce=new Array(256),oe=new Array(256),Re=new Array(256);for(let Fe=0;Fe<256;Fe++)ce[Fe]=qe[Fe]/255,oe[Fe]=Ye[Fe]/255,Re[Fe]=Se[Fe]/255;_e=ce.join(","),Ve=oe.join(","),Ge=Re.join(","),Ke=`${_e}${Ve}${Ge}`}if(Te=w(this,D,Ct).get(Ke),Te)return w(this,D,Ct).set(de,Te),Te;const $e=`g_${w(this,q)}_transfer_map_${pt(this,z)._++}`,Ze=`url(#${$e})`;w(this,D,Ct).set(de,Ze),w(this,D,Ct).set(Ke,Ze);const Qe=me(this,ye,Dt).call(this,$e);return me(this,Oe,Ot).call(this,_e,Ve,Ge,Qe),Ze}addHCMFilter(de,Te){var Ye;const _e=`${de}-${Te}`;if(w(this,ve)===_e)return w(this,K);if(Ae(this,ve,_e),Ae(this,K,"none"),(Ye=w(this,J))==null||Ye.remove(),!de||!Te)return w(this,K);const Ve=me(this,we,Pt).call(this,de);de=r.Util.makeHexColor(...Ve);const Ge=me(this,we,Pt).call(this,Te);if(Te=r.Util.makeHexColor(...Ge),w(this,ee,Et).style.color="",de==="#000000"&&Te==="#ffffff"||de===Te)return w(this,K);const Ke=new Array(256);for(let Se=0;Se<=255;Se++){const ce=Se/255;Ke[Se]=ce<=.03928?ce/12.92:((ce+.055)/1.055)**2.4}const $e=Ke.join(","),Ze=`g_${w(this,q)}_hcm_filter`,Qe=Ae(this,O,me(this,ye,Dt).call(this,Ze));me(this,Oe,Ot).call(this,$e,$e,$e,Qe),me(this,pe,qt).call(this,Qe);const qe=(Se,ce)=>{const oe=Ve[Se]/255,Re=Ge[Se]/255,Fe=new Array(ce+1);for(let et=0;et<=ce;et++)Fe[et]=oe+et/ce*(Re-oe);return Fe.join(",")};return me(this,Oe,Ot).call(this,qe(0,5),qe(1,5),qe(2,5),Qe),Ae(this,K,`url(#${Ze})`),w(this,K)}addHighlightHCMFilter(de,Te,_e,Ve){var Re;const Ge=`${de}-${Te}-${_e}-${Ve}`;if(w(this,N)===Ge)return w(this,F);if(Ae(this,N,Ge),Ae(this,F,"none"),(Re=w(this,O))==null||Re.remove(),!de||!Te)return w(this,F);const[Ke,$e]=[de,Te].map(me(this,we,Pt).bind(this));let Ze=Math.round(.2126*Ke[0]+.7152*Ke[1]+.0722*Ke[2]),Qe=Math.round(.2126*$e[0]+.7152*$e[1]+.0722*$e[2]),[qe,Ye]=[_e,Ve].map(me(this,we,Pt).bind(this));Qe<Ze&&([Ze,Qe,qe,Ye]=[Qe,Ze,Ye,qe]),w(this,ee,Et).style.color="";const Se=(Fe,et,fe)=>{const M=new Array(256),ne=(Qe-Ze)/fe,he=Fe/255,ae=(et-Fe)/(255*fe);let W=0;for(let P=0;P<=fe;P++){const Q=Math.round(Ze+P*ne),H=he+P*ae;for(let te=W;te<=Q;te++)M[te]=H;W=Q+1}for(let P=W;P<256;P++)M[P]=M[W-1];return M.join(",")},ce=`g_${w(this,q)}_hcm_highlight_filter`,oe=Ae(this,O,me(this,ye,Dt).call(this,ce));return me(this,pe,qt).call(this,oe),me(this,Oe,Ot).call(this,Se(qe[0],Ye[0],5),Se(qe[1],Ye[1],5),Se(qe[2],Ye[2],5),oe),Ae(this,F,`url(#${ce})`),w(this,F)}destroy(){arguments.length>0&&arguments[0]!==void 0&&arguments[0]&&(w(this,K)||w(this,F))||(w(this,X)&&(w(this,X).parentNode.parentNode.remove(),Ae(this,X,null)),w(this,G)&&(w(this,G).clear(),Ae(this,G,null)),Ae(this,z,0))}}G=new WeakMap,X=new WeakMap,q=new WeakMap,Z=new WeakMap,J=new WeakMap,ve=new WeakMap,K=new WeakMap,O=new WeakMap,N=new WeakMap,F=new WeakMap,z=new WeakMap,D=new WeakSet,Ct=function(){return w(this,G)||Ae(this,G,new Map)},ee=new WeakSet,Et=function(){if(!w(this,X)){const de=w(this,Z).createElement("div"),{style:Te}=de;Te.visibility="hidden",Te.contain="strict",Te.width=Te.height=0,Te.position="absolute",Te.top=Te.left=0,Te.zIndex=-1;const _e=w(this,Z).createElementNS(i,"svg");_e.setAttribute("width",0),_e.setAttribute("height",0),Ae(this,X,w(this,Z).createElementNS(i,"defs")),de.append(_e),_e.append(w(this,X)),w(this,Z).body.append(de)}return w(this,X)},pe=new WeakSet,qt=function(de){const Te=w(this,Z).createElementNS(i,"feColorMatrix");Te.setAttribute("type","matrix"),Te.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),de.append(Te)},ye=new WeakSet,Dt=function(de){const Te=w(this,Z).createElementNS(i,"filter");return Te.setAttribute("color-interpolation-filters","sRGB"),Te.setAttribute("id",de),w(this,ee,Et).append(Te),Te},ge=new WeakSet,Ft=function(de,Te,_e){const Ve=w(this,Z).createElementNS(i,Te);Ve.setAttribute("type","discrete"),Ve.setAttribute("tableValues",_e),de.append(Ve)},Oe=new WeakSet,Ot=function(de,Te,_e,Ve){const Ge=w(this,Z).createElementNS(i,"feComponentTransfer");Ve.append(Ge),me(this,ge,Ft).call(this,Ge,"feFuncR",de),me(this,ge,Ft).call(this,Ge,"feFuncG",Te),me(this,ge,Ft).call(this,Ge,"feFuncB",_e)},we=new WeakSet,Pt=function(de){return w(this,ee,Et).style.color=de,E(getComputedStyle(w(this,ee,Et)).getPropertyValue("color"))},e.DOMFilterFactory=u;class l extends n.BaseCanvasFactory{constructor(){let{ownerDocument:be=globalThis.document}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this._document=be}_createCanvas(be,de){const Te=this._document.createElement("canvas");return Te.width=be,Te.height=de,Te}}e.DOMCanvasFactory=l;async function c(Ne){let be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(m(Ne,document.baseURI)){const de=await fetch(Ne);if(!de.ok)throw new Error(de.statusText);return be?new Uint8Array(await de.arrayBuffer()):(0,r.stringToBytes)(await de.text())}return new Promise((de,Te)=>{const _e=new XMLHttpRequest;_e.open("GET",Ne,!0),be&&(_e.responseType="arraybuffer"),_e.onreadystatechange=()=>{if(_e.readyState===XMLHttpRequest.DONE){if(_e.status===200||_e.status===0){let Ve;if(be&&_e.response?Ve=new Uint8Array(_e.response):!be&&_e.responseText&&(Ve=(0,r.stringToBytes)(_e.responseText)),Ve){de(Ve);return}}Te(new Error(_e.statusText))}},_e.send(null)})}class h extends n.BaseCMapReaderFactory{_fetchData(be,de){return c(be,this.isCompressed).then(Te=>({cMapData:Te,compressionType:de}))}}e.DOMCMapReaderFactory=h;class d extends n.BaseStandardFontDataFactory{_fetchData(be){return c(be,!0)}}e.DOMStandardFontDataFactory=d;class p extends n.BaseSVGFactory{_createSVG(be){return document.createElementNS(i,be)}}e.DOMSVGFactory=p;class f{constructor(be){let{viewBox:de,scale:Te,rotation:_e,offsetX:Ve=0,offsetY:Ge=0,dontFlip:Ke=!1}=be;this.viewBox=de,this.scale=Te,this.rotation=_e,this.offsetX=Ve,this.offsetY=Ge;const $e=(de[2]+de[0])/2,Ze=(de[3]+de[1])/2;let Qe,qe,Ye,Se;switch(_e%=360,_e<0&&(_e+=360),_e){case 180:Qe=-1,qe=0,Ye=0,Se=1;break;case 90:Qe=0,qe=1,Ye=1,Se=0;break;case 270:Qe=0,qe=-1,Ye=-1,Se=0;break;case 0:Qe=1,qe=0,Ye=0,Se=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Ke&&(Ye=-Ye,Se=-Se);let ce,oe,Re,Fe;Qe===0?(ce=Math.abs(Ze-de[1])*Te+Ve,oe=Math.abs($e-de[0])*Te+Ge,Re=(de[3]-de[1])*Te,Fe=(de[2]-de[0])*Te):(ce=Math.abs($e-de[0])*Te+Ve,oe=Math.abs(Ze-de[1])*Te+Ge,Re=(de[2]-de[0])*Te,Fe=(de[3]-de[1])*Te),this.transform=[Qe*Te,qe*Te,Ye*Te,Se*Te,ce-Qe*Te*$e-Ye*Te*Ze,oe-qe*Te*$e-Se*Te*Ze],this.width=Re,this.height=Fe}get rawDims(){const{viewBox:be}=this;return(0,r.shadow)(this,"rawDims",{pageWidth:be[2]-be[0],pageHeight:be[3]-be[1],pageX:be[0],pageY:be[1]})}clone(){let{scale:be=this.scale,rotation:de=this.rotation,offsetX:Te=this.offsetX,offsetY:_e=this.offsetY,dontFlip:Ve=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new f({viewBox:this.viewBox.slice(),scale:be,rotation:de,offsetX:Te,offsetY:_e,dontFlip:Ve})}convertToViewportPoint(be,de){return r.Util.applyTransform([be,de],this.transform)}convertToViewportRectangle(be){const de=r.Util.applyTransform([be[0],be[1]],this.transform),Te=r.Util.applyTransform([be[2],be[3]],this.transform);return[de[0],de[1],Te[0],Te[1]]}convertToPdfPoint(be,de){return r.Util.applyInverseTransform([be,de],this.transform)}}e.PageViewport=f;class g extends r.BaseException{constructor(be){let de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;super(be,"RenderingCancelledException"),this.extraDelay=de}}e.RenderingCancelledException=g;function v(Ne){const be=Ne.length;let de=0;for(;de<be&&Ne[de].trim()==="";)de++;return Ne.substring(de,de+5).toLowerCase()==="data:"}function y(Ne){return typeof Ne=="string"&&/\.pdf$/i.test(Ne)}function x(Ne){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)||([Ne]=Ne.split(/[#?]/,1)),Ne.substring(Ne.lastIndexOf("/")+1)}function R(Ne){let be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"document.pdf";if(typeof Ne!="string")return be;if(v(Ne))return(0,r.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),be;const de=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Te=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,_e=de.exec(Ne);let Ve=Te.exec(_e[1])||Te.exec(_e[2])||Te.exec(_e[3]);if(Ve&&(Ve=Ve[0],Ve.includes("%")))try{Ve=Te.exec(decodeURIComponent(Ve))[0]}catch{}return Ve||be}class k{constructor(){st(this,"started",Object.create(null));st(this,"times",[])}time(be){be in this.started&&(0,r.warn)(`Timer is already running for ${be}`),this.started[be]=Date.now()}timeEnd(be){be in this.started||(0,r.warn)(`Timer has not been started for ${be}`),this.times.push({name:be,start:this.started[be],end:Date.now()}),delete this.started[be]}toString(){const be=[];let de=0;for(const{name:Te}of this.times)de=Math.max(Te.length,de);for(const{name:Te,start:_e,end:Ve}of this.times)be.push(`${Te.padEnd(de)} ${Ve-_e}ms
`);return be.join("")}}e.StatTimer=k;function m(Ne,be){try{const{protocol:de}=be?new URL(Ne,be):new URL(Ne);return de==="http:"||de==="https:"}catch{return!1}}function b(Ne){let be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return new Promise((de,Te)=>{const _e=document.createElement("script");_e.src=Ne,_e.onload=function(Ve){be&&_e.remove(),de(Ve)},_e.onerror=function(){Te(new Error(`Cannot load script at: ${_e.src}`))},(document.head||document.documentElement).append(_e)})}function I(Ne){console.log("Deprecated API usage: "+Ne)}let _;class S{static toDateObject(be){if(!be||typeof be!="string")return null;_||(_=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const de=_.exec(be);if(!de)return null;const Te=parseInt(de[1],10);let _e=parseInt(de[2],10);_e=_e>=1&&_e<=12?_e-1:0;let Ve=parseInt(de[3],10);Ve=Ve>=1&&Ve<=31?Ve:1;let Ge=parseInt(de[4],10);Ge=Ge>=0&&Ge<=23?Ge:0;let Ke=parseInt(de[5],10);Ke=Ke>=0&&Ke<=59?Ke:0;let $e=parseInt(de[6],10);$e=$e>=0&&$e<=59?$e:0;const Ze=de[7]||"Z";let Qe=parseInt(de[8],10);Qe=Qe>=0&&Qe<=23?Qe:0;let qe=parseInt(de[9],10)||0;return qe=qe>=0&&qe<=59?qe:0,Ze==="-"?(Ge+=Qe,Ke+=qe):Ze==="+"&&(Ge-=Qe,Ke-=qe),new Date(Date.UTC(Te,_e,Ve,Ge,Ke,$e))}}e.PDFDateString=S;function T(Ne,be){let{scale:de=1,rotation:Te=0}=be;const{width:_e,height:Ve}=Ne.attributes.style,Ge=[0,0,parseInt(_e),parseInt(Ve)];return new f({viewBox:Ge,scale:de,rotation:Te})}function E(Ne){if(Ne.startsWith("#")){const be=parseInt(Ne.slice(1),16);return[(be&16711680)>>16,(be&65280)>>8,be&255]}return Ne.startsWith("rgb(")?Ne.slice(4,-1).split(",").map(be=>parseInt(be)):Ne.startsWith("rgba(")?Ne.slice(5,-1).split(",").map(be=>parseInt(be)).slice(0,3):((0,r.warn)(`Not a valid color format: "${Ne}"`),[0,0,0])}function L(Ne){const be=document.createElement("span");be.style.visibility="hidden",document.body.append(be);for(const de of Ne.keys()){be.style.color=de;const Te=window.getComputedStyle(be).color;Ne.set(de,E(Te))}be.remove()}function $(Ne){const{a:be,b:de,c:Te,d:_e,e:Ve,f:Ge}=Ne.getTransform();return[be,de,Te,_e,Ve,Ge]}function Y(Ne){const{a:be,b:de,c:Te,d:_e,e:Ve,f:Ge}=Ne.getTransform().invertSelf();return[be,de,Te,_e,Ve,Ge]}function V(Ne,be){let de=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,Te=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;if(be instanceof f){const{pageWidth:_e,pageHeight:Ve}=be.rawDims,{style:Ge}=Ne,Ke=`calc(var(--scale-factor) * ${_e}px)`,$e=`calc(var(--scale-factor) * ${Ve}px)`;!de||be.rotation%180===0?(Ge.width=Ke,Ge.height=$e):(Ge.width=$e,Ge.height=Ke)}Te&&Ne.setAttribute("data-main-rotation",be.rotation)}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0,t(2);var n=t(1);class r{constructor(){this.constructor===r&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(c){return"none"}addHCMFilter(c,h){return"none"}addHighlightHCMFilter(c,h,d,p){return"none"}destroy(){}}e.BaseFilterFactory=r;class i{constructor(){this.constructor===i&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(c,h){if(c<=0||h<=0)throw new Error("Invalid canvas size");const d=this._createCanvas(c,h);return{canvas:d,context:d.getContext("2d")}}reset(c,h,d){if(!c.canvas)throw new Error("Canvas is not specified");if(h<=0||d<=0)throw new Error("Invalid canvas size");c.canvas.width=h,c.canvas.height=d}destroy(c){if(!c.canvas)throw new Error("Canvas is not specified");c.canvas.width=0,c.canvas.height=0,c.canvas=null,c.context=null}_createCanvas(c,h){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=i;class o{constructor(c){let{baseUrl:h=null,isCompressed:d=!0}=c;this.constructor===o&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=h,this.isCompressed=d}async fetch(c){let{name:h}=c;if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!h)throw new Error("CMap name must be specified.");const d=this.baseUrl+h+(this.isCompressed?".bcmap":""),p=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(d,p).catch(f=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${d}`)})}_fetchData(c,h){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=o;class a{constructor(c){let{baseUrl:h=null}=c;this.constructor===a&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=h}async fetch(c){let{filename:h}=c;if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!h)throw new Error("Font filename must be specified.");const d=`${this.baseUrl}${h}`;return this._fetchData(d).catch(p=>{throw new Error(`Unable to load font data at: ${d}`)})}_fetchData(c){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=a;class u{constructor(){this.constructor===u&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(c<=0||h<=0)throw new Error("Invalid SVG dimensions");const p=this._createSVG("svg:svg");return p.setAttribute("version","1.1"),d||(p.setAttribute("width",`${c}px`),p.setAttribute("height",`${h}px`)),p.setAttribute("preserveAspectRatio","none"),p.setAttribute("viewBox",`0 0 ${c} ${h}`),p}createElement(c){if(typeof c!="string")throw new Error("Invalid SVG element type");return this._createSVG(c)}_createSVG(c){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=u},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0,t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123),t(2);var n=t(1);const r=3285377520,i=4294901760,o=65535;class a{constructor(l){this.h1=l?l&4294967295:r,this.h2=l?l&4294967295:r}update(l){let c,h;if(typeof l=="string"){c=new Uint8Array(l.length*2),h=0;for(let I=0,_=l.length;I<_;I++){const S=l.charCodeAt(I);S<=255?c[h++]=S:(c[h++]=S>>>8,c[h++]=S&255)}}else if((0,n.isArrayBuffer)(l))c=l.slice(),h=c.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const d=h>>2,p=h-d*4,f=new Uint32Array(c.buffer,0,d);let g=0,v=0,y=this.h1,x=this.h2;const R=3432918353,k=461845907,m=R&o,b=k&o;for(let I=0;I<d;I++)I&1?(g=f[I],g=g*R&i|g*m&o,g=g<<15|g>>>17,g=g*k&i|g*b&o,y^=g,y=y<<13|y>>>19,y=y*5+3864292196):(v=f[I],v=v*R&i|v*m&o,v=v<<15|v>>>17,v=v*k&i|v*b&o,x^=v,x=x<<13|x>>>19,x=x*5+3864292196);switch(g=0,p){case 3:g^=c[d*4+2]<<16;case 2:g^=c[d*4+1]<<8;case 1:g^=c[d*4],g=g*R&i|g*m&o,g=g<<15|g>>>17,g=g*k&i|g*b&o,d&1?y^=g:x^=g}this.h1=y,this.h2=x}hexdigest(){let l=this.h1,c=this.h2;return l^=c>>>1,l=l*3981806797&i|l*36045&o,c=c*4283543511&i|((c<<16|l>>>16)*2950163797&i)>>>16,l^=c>>>1,l=l*444984403&i|l*60499&o,c=c*3301882366&i|((c<<16|l>>>16)*3120437893&i)>>>16,l^=c>>>1,(l>>>0).toString(16).padStart(8,"0")+(c>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=a},(s,e,t)=>{var o;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0,t(125),t(135),t(137),t(140),t(142),t(144),t(146),t(89),t(148);var n=t(1);class r{constructor(u){se(this,o,new Set);let{ownerDocument:l=globalThis.document,styleElement:c=null}=u;this._document=l,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(u){this.nativeFontFaces.add(u),this._document.fonts.add(u)}removeNativeFontFace(u){this.nativeFontFaces.delete(u),this._document.fonts.delete(u)}insertRule(u){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const l=this.styleElement.sheet;l.insertRule(u,l.cssRules.length)}clear(){for(const u of this.nativeFontFaces)this._document.fonts.delete(u);this.nativeFontFaces.clear(),w(this,o).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(u){if(!(!u||w(this,o).has(u.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:l,src:c,style:h}=u,d=new FontFace(l,c,h);this.addNativeFontFace(d);try{await d.load(),w(this,o).add(l)}catch{(0,n.warn)(`Cannot load system font: ${u.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(d)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(u){if(u.attached||u.missingFile&&!u.systemFontInfo)return;if(u.attached=!0,u.systemFontInfo){await this.loadSystemFont(u.systemFontInfo);return}if(this.isFontLoadingAPISupported){const c=u.createNativeFontFace();if(c){this.addNativeFontFace(c);try{await c.loaded}catch(h){throw(0,n.warn)(`Failed to load font '${c.family}': '${h}'.`),u.disableFontFace=!0,h}}return}const l=u.createFontFaceRule();if(l){if(this.insertRule(l),this.isSyncFontLoadingSupported)return;await new Promise(c=>{const h=this._queueLoadingCallback(c);this._prepareFontLoadEvent(u,h)})}}get isFontLoadingAPISupported(){var l;const u=!!((l=this._document)!=null&&l.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",u)}get isSyncFontLoadingSupported(){let u=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(u=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",u)}_queueLoadingCallback(u){function l(){for((0,n.assert)(!h.done,"completeRequest() cannot be called twice."),h.done=!0;c.length>0&&c[0].done;){const d=c.shift();setTimeout(d.callback,0)}}const{loadingRequests:c}=this,h={done:!1,complete:l,callback:u};return c.push(h),h}get _loadTestFont(){const u=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",u)}_prepareFontLoadEvent(u,l){function c(E,L){return E.charCodeAt(L)<<24|E.charCodeAt(L+1)<<16|E.charCodeAt(L+2)<<8|E.charCodeAt(L+3)&255}function h(E,L,$,Y){const V=E.substring(0,L),j=E.substring(L+$);return V+Y+j}let d,p;const f=this._document.createElement("canvas");f.width=1,f.height=1;const g=f.getContext("2d");let v=0;function y(E,L){if(++v>30){(0,n.warn)("Load test font never loaded."),L();return}if(g.font="30px "+E,g.fillText(".",0,20),g.getImageData(0,0,1,1).data[3]>0){L();return}setTimeout(y.bind(null,E,L))}const x=`lt${Date.now()}${this.loadTestFontId++}`;let R=this._loadTestFont;R=h(R,976,x.length,x);const m=16,b=1482184792;let I=c(R,m);for(d=0,p=x.length-3;d<p;d+=4)I=I-b+c(x,d)|0;d<x.length&&(I=I-b+c(x+"XXX",d)|0),R=h(R,m,4,(0,n.string32)(I));const _=`url(data:font/opentype;base64,${btoa(R)});`,S=`@font-face {font-family:"${x}";src:${_}}`;this.insertRule(S);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const E of[u.loadedName,x]){const L=this._document.createElement("span");L.textContent="Hi",L.style.fontFamily=E,T.append(L)}this._document.body.append(T),y(x,()=>{T.remove(),l.complete()})}}o=new WeakMap,e.FontLoader=r;class i{constructor(u,l){let{isEvalSupported:c=!0,disableFontFace:h=!1,ignoreErrors:d=!1,inspectFont:p=null}=l;this.compiledGlyphs=Object.create(null);for(const f in u)this[f]=u[f];this.isEvalSupported=c!==!1,this.disableFontFace=h===!0,this.ignoreErrors=d===!0,this._inspectFont=p}createNativeFontFace(){var l;if(!this.data||this.disableFontFace)return null;let u;if(!this.cssFontInfo)u=new FontFace(this.loadedName,this.data,{});else{const c={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(c.style=`oblique ${this.cssFontInfo.italicAngle}deg`),u=new FontFace(this.cssFontInfo.fontFamily,this.data,c)}return(l=this._inspectFont)==null||l.call(this,this),u}createFontFaceRule(){var h;if(!this.data||this.disableFontFace)return null;const u=(0,n.bytesToString)(this.data),l=`url(data:${this.mimetype};base64,${btoa(u)});`;let c;if(!this.cssFontInfo)c=`@font-face {font-family:"${this.loadedName}";src:${l}}`;else{let d=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(d+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),c=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${d}src:${l}}`}return(h=this._inspectFont)==null||h.call(this,this,l),c}getPathGenerator(u,l){if(this.compiledGlyphs[l]!==void 0)return this.compiledGlyphs[l];let c;try{c=u.get(this.loadedName+"_path_"+l)}catch(h){if(!this.ignoreErrors)throw h;return(0,n.warn)(`getPathGenerator - ignoring character: "${h}".`),this.compiledGlyphs[l]=function(d,p){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const h=[];for(const d of c){const p=d.args!==void 0?d.args.join(","):"";h.push("c.",d.cmd,"(",p,`);
`)}return this.compiledGlyphs[l]=new Function("c","size",h.join(""))}return this.compiledGlyphs[l]=function(h,d){for(const p of c)p.cmd==="scale"&&(p.args=[d,-d]),h[p.cmd].apply(h,p.args)}}}e.FontFaceObject=i},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0,t(2),t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123);var n=t(168),r=t(1);(function(){if(!(globalThis.DOMMatrix||!r.isNodeJS))try{globalThis.DOMMatrix=require$$6.DOMMatrix}catch(h){(0,r.warn)(`Cannot polyfill \`DOMMatrix\`, rendering may be broken: "${h}".`)}})(),function(){if(!(globalThis.Path2D||!r.isNodeJS))try{const{CanvasRenderingContext2D:h}=require$$6,{polyfillPath2D:d}=requirePath2dPolyfill_min();globalThis.CanvasRenderingContext2D=h,d(globalThis)}catch(h){(0,r.warn)(`Cannot polyfill \`Path2D\`, rendering may be broken: "${h}".`)}}();const i=function(c){return new Promise((h,d)=>{require$$6.readFile(c,(f,g)=>{if(f||!g){d(new Error(f));return}h(new Uint8Array(g))})})};class o extends n.BaseFilterFactory{}e.NodeFilterFactory=o;class a extends n.BaseCanvasFactory{_createCanvas(h,d){return require$$6.createCanvas(h,d)}}e.NodeCanvasFactory=a;class u extends n.BaseCMapReaderFactory{_fetchData(h,d){return i(h).then(p=>({cMapData:p,compressionType:d}))}}e.NodeCMapReaderFactory=u;class l extends n.BaseStandardFontDataFactory{_fetchData(h){return i(h)}}e.NodeStandardFontDataFactory=l},(s,e,t)=>{var X,Jt,Z,en;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0,t(2),t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123),t(89);var n=t(1),r=t(167),i=t(173),o=t(174);const a=16,u=100,l=4096,c=15,h=10,d=1e3,p=16;function f(K,O){if(K._removeMirroring)throw new Error("Context is already forwarding operations.");K.__originalSave=K.save,K.__originalRestore=K.restore,K.__originalRotate=K.rotate,K.__originalScale=K.scale,K.__originalTranslate=K.translate,K.__originalTransform=K.transform,K.__originalSetTransform=K.setTransform,K.__originalResetTransform=K.resetTransform,K.__originalClip=K.clip,K.__originalMoveTo=K.moveTo,K.__originalLineTo=K.lineTo,K.__originalBezierCurveTo=K.bezierCurveTo,K.__originalRect=K.rect,K.__originalClosePath=K.closePath,K.__originalBeginPath=K.beginPath,K._removeMirroring=()=>{K.save=K.__originalSave,K.restore=K.__originalRestore,K.rotate=K.__originalRotate,K.scale=K.__originalScale,K.translate=K.__originalTranslate,K.transform=K.__originalTransform,K.setTransform=K.__originalSetTransform,K.resetTransform=K.__originalResetTransform,K.clip=K.__originalClip,K.moveTo=K.__originalMoveTo,K.lineTo=K.__originalLineTo,K.bezierCurveTo=K.__originalBezierCurveTo,K.rect=K.__originalRect,K.closePath=K.__originalClosePath,K.beginPath=K.__originalBeginPath,delete K._removeMirroring},K.save=function(){O.save(),this.__originalSave()},K.restore=function(){O.restore(),this.__originalRestore()},K.translate=function(F,z){O.translate(F,z),this.__originalTranslate(F,z)},K.scale=function(F,z){O.scale(F,z),this.__originalScale(F,z)},K.transform=function(F,z,D,U,ee,re){O.transform(F,z,D,U,ee,re),this.__originalTransform(F,z,D,U,ee,re)},K.setTransform=function(F,z,D,U,ee,re){O.setTransform(F,z,D,U,ee,re),this.__originalSetTransform(F,z,D,U,ee,re)},K.resetTransform=function(){O.resetTransform(),this.__originalResetTransform()},K.rotate=function(F){O.rotate(F),this.__originalRotate(F)},K.clip=function(F){O.clip(F),this.__originalClip(F)},K.moveTo=function(N,F){O.moveTo(N,F),this.__originalMoveTo(N,F)},K.lineTo=function(N,F){O.lineTo(N,F),this.__originalLineTo(N,F)},K.bezierCurveTo=function(N,F,z,D,U,ee){O.bezierCurveTo(N,F,z,D,U,ee),this.__originalBezierCurveTo(N,F,z,D,U,ee)},K.rect=function(N,F,z,D){O.rect(N,F,z,D),this.__originalRect(N,F,z,D)},K.closePath=function(){O.closePath(),this.__originalClosePath()},K.beginPath=function(){O.beginPath(),this.__originalBeginPath()}}class g{constructor(O){this.canvasFactory=O,this.cache=Object.create(null)}getCanvas(O,N,F){let z;return this.cache[O]!==void 0?(z=this.cache[O],this.canvasFactory.reset(z,N,F)):(z=this.canvasFactory.create(N,F),this.cache[O]=z),z}delete(O){delete this.cache[O]}clear(){for(const O in this.cache){const N=this.cache[O];this.canvasFactory.destroy(N),delete this.cache[O]}}}function v(K,O,N,F,z,D,U,ee,re,pe){const[ue,ye,ie,ge,Ee,Oe]=(0,r.getCurrentTransform)(K);if(ye===0&&ie===0){const Ue=U*ue+Ee,Ne=Math.round(Ue),be=ee*ge+Oe,de=Math.round(be),Te=(U+re)*ue+Ee,_e=Math.abs(Math.round(Te)-Ne)||1,Ve=(ee+pe)*ge+Oe,Ge=Math.abs(Math.round(Ve)-de)||1;return K.setTransform(Math.sign(ue),0,0,Math.sign(ge),Ne,de),K.drawImage(O,N,F,z,D,0,0,_e,Ge),K.setTransform(ue,ye,ie,ge,Ee,Oe),[_e,Ge]}if(ue===0&&ge===0){const Ue=ee*ie+Ee,Ne=Math.round(Ue),be=U*ye+Oe,de=Math.round(be),Te=(ee+pe)*ie+Ee,_e=Math.abs(Math.round(Te)-Ne)||1,Ve=(U+re)*ye+Oe,Ge=Math.abs(Math.round(Ve)-de)||1;return K.setTransform(0,Math.sign(ye),Math.sign(ie),0,Ne,de),K.drawImage(O,N,F,z,D,0,0,Ge,_e),K.setTransform(ue,ye,ie,ge,Ee,Oe),[Ge,_e]}K.drawImage(O,N,F,z,D,U,ee,re,pe);const Ie=Math.hypot(ue,ye),we=Math.hypot(ie,ge);return[Ie*re,we*pe]}function y(K){const{width:O,height:N}=K;if(O>d||N>d)return null;const F=1e3,z=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),D=O+1;let U=new Uint8Array(D*(N+1)),ee,re,pe;const ue=O+7&-8;let ye=new Uint8Array(ue*N),ie=0;for(const we of K.data){let Ue=128;for(;Ue>0;)ye[ie++]=we&Ue?0:255,Ue>>=1}let ge=0;for(ie=0,ye[ie]!==0&&(U[0]=1,++ge),re=1;re<O;re++)ye[ie]!==ye[ie+1]&&(U[re]=ye[ie]?2:1,++ge),ie++;for(ye[ie]!==0&&(U[re]=2,++ge),ee=1;ee<N;ee++){ie=ee*ue,pe=ee*D,ye[ie-ue]!==ye[ie]&&(U[pe]=ye[ie]?1:8,++ge);let we=(ye[ie]?4:0)+(ye[ie-ue]?8:0);for(re=1;re<O;re++)we=(we>>2)+(ye[ie+1]?4:0)+(ye[ie-ue+1]?8:0),z[we]&&(U[pe+re]=z[we],++ge),ie++;if(ye[ie-ue]!==ye[ie]&&(U[pe+re]=ye[ie]?2:4,++ge),ge>F)return null}for(ie=ue*(N-1),pe=ee*D,ye[ie]!==0&&(U[pe]=8,++ge),re=1;re<O;re++)ye[ie]!==ye[ie+1]&&(U[pe+re]=ye[ie]?4:8,++ge),ie++;if(ye[ie]!==0&&(U[pe+re]=4,++ge),ge>F)return null;const Ee=new Int32Array([0,D,-1,0,-D,0,0,0,1]),Oe=new Path2D;for(ee=0;ge&&ee<=N;ee++){let we=ee*D;const Ue=we+O;for(;we<Ue&&!U[we];)we++;if(we===Ue)continue;Oe.moveTo(we%D,ee);const Ne=we;let be=U[we];do{const de=Ee[be];do we+=de;while(!U[we]);const Te=U[we];Te!==5&&Te!==10?(be=Te,U[we]=0):(be=Te&51*be>>4,U[we]&=be>>2|be<<2),Oe.lineTo(we%D,we/D|0),U[we]||--ge}while(Ne!==we);--ee}return ye=null,U=null,function(we){we.save(),we.scale(1/O,-1/N),we.translate(0,-N),we.fill(Oe),we.beginPath(),we.restore()}}class x{constructor(O,N){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,O,N])}clone(){const O=Object.create(this);return O.clipBox=this.clipBox.slice(),O}setCurrentPoint(O,N){this.x=O,this.y=N}updatePathMinMax(O,N,F){[N,F]=n.Util.applyTransform([N,F],O),this.minX=Math.min(this.minX,N),this.minY=Math.min(this.minY,F),this.maxX=Math.max(this.maxX,N),this.maxY=Math.max(this.maxY,F)}updateRectMinMax(O,N){const F=n.Util.applyTransform(N,O),z=n.Util.applyTransform(N.slice(2),O);this.minX=Math.min(this.minX,F[0],z[0]),this.minY=Math.min(this.minY,F[1],z[1]),this.maxX=Math.max(this.maxX,F[0],z[0]),this.maxY=Math.max(this.maxY,F[1],z[1])}updateScalingPathMinMax(O,N){n.Util.scaleMinMax(O,N),this.minX=Math.min(this.minX,N[0]),this.maxX=Math.max(this.maxX,N[1]),this.minY=Math.min(this.minY,N[2]),this.maxY=Math.max(this.maxY,N[3])}updateCurvePathMinMax(O,N,F,z,D,U,ee,re,pe,ue){const ye=n.Util.bezierBoundingBox(N,F,z,D,U,ee,re,pe);if(ue){ue[0]=Math.min(ue[0],ye[0],ye[2]),ue[1]=Math.max(ue[1],ye[0],ye[2]),ue[2]=Math.min(ue[2],ye[1],ye[3]),ue[3]=Math.max(ue[3],ye[1],ye[3]);return}this.updateRectMinMax(O,ye)}getPathBoundingBox(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:i.PathType.FILL,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const F=[this.minX,this.minY,this.maxX,this.maxY];if(O===i.PathType.STROKE){N||(0,n.unreachable)("Stroke bounding box must include transform.");const z=n.Util.singularValueDecompose2dScale(N),D=z[0]*this.lineWidth/2,U=z[1]*this.lineWidth/2;F[0]-=D,F[1]-=U,F[2]+=D,F[3]+=U}return F}updateClipFromPath(){const O=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(O||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(O){this.clipBox=O,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:i.PathType.FILL,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return n.Util.intersect(this.clipBox,this.getPathBoundingBox(O,N))}}function R(K,O){if(typeof ImageData<"u"&&O instanceof ImageData){K.putImageData(O,0,0);return}const N=O.height,F=O.width,z=N%p,D=(N-z)/p,U=z===0?D:D+1,ee=K.createImageData(F,p);let re=0,pe;const ue=O.data,ye=ee.data;let ie,ge,Ee,Oe;if(O.kind===n.ImageKind.GRAYSCALE_1BPP){const Ie=ue.byteLength,we=new Uint32Array(ye.buffer,0,ye.byteLength>>2),Ue=we.length,Ne=F+7>>3,be=4294967295,de=n.FeatureTest.isLittleEndian?4278190080:255;for(ie=0;ie<U;ie++){for(Ee=ie<D?p:z,pe=0,ge=0;ge<Ee;ge++){const Te=Ie-re;let _e=0;const Ve=Te>Ne?F:Te*8-7,Ge=Ve&-8;let Ke=0,$e=0;for(;_e<Ge;_e+=8)$e=ue[re++],we[pe++]=$e&128?be:de,we[pe++]=$e&64?be:de,we[pe++]=$e&32?be:de,we[pe++]=$e&16?be:de,we[pe++]=$e&8?be:de,we[pe++]=$e&4?be:de,we[pe++]=$e&2?be:de,we[pe++]=$e&1?be:de;for(;_e<Ve;_e++)Ke===0&&($e=ue[re++],Ke=128),we[pe++]=$e&Ke?be:de,Ke>>=1}for(;pe<Ue;)we[pe++]=0;K.putImageData(ee,0,ie*p)}}else if(O.kind===n.ImageKind.RGBA_32BPP){for(ge=0,Oe=F*p*4,ie=0;ie<D;ie++)ye.set(ue.subarray(re,re+Oe)),re+=Oe,K.putImageData(ee,0,ge),ge+=p;ie<U&&(Oe=F*z*4,ye.set(ue.subarray(re,re+Oe)),K.putImageData(ee,0,ge))}else if(O.kind===n.ImageKind.RGB_24BPP)for(Ee=p,Oe=F*Ee,ie=0;ie<U;ie++){for(ie>=D&&(Ee=z,Oe=F*Ee),pe=0,ge=Oe;ge--;)ye[pe++]=ue[re++],ye[pe++]=ue[re++],ye[pe++]=ue[re++],ye[pe++]=255;K.putImageData(ee,0,ie*p)}else throw new Error(`bad image kind: ${O.kind}`)}function k(K,O){if(O.bitmap){K.drawImage(O.bitmap,0,0);return}const N=O.height,F=O.width,z=N%p,D=(N-z)/p,U=z===0?D:D+1,ee=K.createImageData(F,p);let re=0;const pe=O.data,ue=ee.data;for(let ye=0;ye<U;ye++){const ie=ye<D?p:z;({srcPos:re}=(0,o.convertBlackAndWhiteToRGBA)({src:pe,srcPos:re,dest:ue,width:F,height:ie,nonBlackColor:0})),K.putImageData(ee,0,ye*p)}}function m(K,O){const N=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const F of N)K[F]!==void 0&&(O[F]=K[F]);K.setLineDash!==void 0&&(O.setLineDash(K.getLineDash()),O.lineDashOffset=K.lineDashOffset)}function b(K){if(K.strokeStyle=K.fillStyle="#000000",K.fillRule="nonzero",K.globalAlpha=1,K.lineWidth=1,K.lineCap="butt",K.lineJoin="miter",K.miterLimit=10,K.globalCompositeOperation="source-over",K.font="10px sans-serif",K.setLineDash!==void 0&&(K.setLineDash([]),K.lineDashOffset=0),!n.isNodeJS){const{filter:O}=K;O!=="none"&&O!==""&&(K.filter="none")}}function I(K,O,N,F){const z=K.length;for(let D=3;D<z;D+=4){const U=K[D];if(U===0)K[D-3]=O,K[D-2]=N,K[D-1]=F;else if(U<255){const ee=255-U;K[D-3]=K[D-3]*U+O*ee>>8,K[D-2]=K[D-2]*U+N*ee>>8,K[D-1]=K[D-1]*U+F*ee>>8}}}function _(K,O,N){const F=K.length,z=1/255;for(let D=3;D<F;D+=4){const U=N?N[K[D]]:K[D];O[D]=O[D]*U*z|0}}function S(K,O,N){const F=K.length;for(let z=3;z<F;z+=4){const D=K[z-3]*77+K[z-2]*152+K[z-1]*28;O[z]=N?O[z]*N[D>>8]>>8:O[z]*D>>16}}function T(K,O,N,F,z,D,U,ee,re,pe,ue){const ye=!!D,ie=ye?D[0]:0,ge=ye?D[1]:0,Ee=ye?D[2]:0,Oe=z==="Luminosity"?S:_,we=Math.min(F,Math.ceil(1048576/N));for(let Ue=0;Ue<F;Ue+=we){const Ne=Math.min(we,F-Ue),be=K.getImageData(ee-pe,Ue+(re-ue),N,Ne),de=O.getImageData(ee,Ue+re,N,Ne);ye&&I(be.data,ie,ge,Ee),Oe(be.data,de.data,U),O.putImageData(de,ee,Ue+re)}}function E(K,O,N,F){const z=F[0],D=F[1],U=F[2]-z,ee=F[3]-D;U===0||ee===0||(T(O.context,N,U,ee,O.subtype,O.backdrop,O.transferMap,z,D,O.offsetX,O.offsetY),K.save(),K.globalAlpha=1,K.globalCompositeOperation="source-over",K.setTransform(1,0,0,1,0,0),K.drawImage(N.canvas,0,0),K.restore())}function L(K,O){const N=n.Util.singularValueDecompose2dScale(K);N[0]=Math.fround(N[0]),N[1]=Math.fround(N[1]);const F=Math.fround((globalThis.devicePixelRatio||1)*r.PixelsPerInch.PDF_TO_CSS_UNITS);return O!==void 0?O:N[0]<=F||N[1]<=F}const $=["butt","round","square"],Y=["miter","round","bevel"],V={},j={},ve=class{constructor(O,N,F,z,D,U,ee,re){se(this,X);se(this,Z);let{optionalContentConfig:pe,markedContentStack:ue=null}=U;this.ctx=O,this.current=new x(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=N,this.objs=F,this.canvasFactory=z,this.filterFactory=D,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=ue||[],this.optionalContentConfig=pe,this.cachedCanvases=new g(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=ee,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=re,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(O){let N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return typeof O=="string"?O.startsWith("g_")?this.commonObjs.get(O):this.objs.get(O):N}beginDrawing(O){let{transform:N,viewport:F,transparency:z=!1,background:D=null}=O;const U=this.ctx.canvas.width,ee=this.ctx.canvas.height,re=this.ctx.fillStyle;if(this.ctx.fillStyle=D||"#ffffff",this.ctx.fillRect(0,0,U,ee),this.ctx.fillStyle=re,z){const pe=this.cachedCanvases.getCanvas("transparent",U,ee);this.compositeCtx=this.ctx,this.transparentCanvas=pe.canvas,this.ctx=pe.context,this.ctx.save(),this.ctx.transform(...(0,r.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),b(this.ctx),N&&(this.ctx.transform(...N),this.outputScaleX=N[0],this.outputScaleY=N[0]),this.ctx.transform(...F.transform),this.viewportScale=F.scale,this.baseTransform=(0,r.getCurrentTransform)(this.ctx)}executeOperatorList(O,N,F,z){const D=O.argsArray,U=O.fnArray;let ee=N||0;const re=D.length;if(re===ee)return ee;const pe=re-ee>h&&typeof F=="function",ue=pe?Date.now()+c:0;let ye=0;const ie=this.commonObjs,ge=this.objs;let Ee;for(;;){if(z!==void 0&&ee===z.nextBreakPoint)return z.breakIt(ee,F),ee;if(Ee=U[ee],Ee!==n.OPS.dependency)this[Ee].apply(this,D[ee]);else for(const Oe of D[ee]){const Ie=Oe.startsWith("g_")?ie:ge;if(!Ie.has(Oe))return Ie.get(Oe,F),ee}if(ee++,ee===re)return ee;if(pe&&++ye>h){if(Date.now()>ue)return F(),ee;ye=0}}}endDrawing(){me(this,X,Jt).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const O of this._cachedBitmapsMap.values()){for(const N of O.values())typeof HTMLCanvasElement<"u"&&N instanceof HTMLCanvasElement&&(N.width=N.height=0);O.clear()}this._cachedBitmapsMap.clear(),me(this,Z,en).call(this)}_scaleImage(O,N){const F=O.width,z=O.height;let D=Math.max(Math.hypot(N[0],N[1]),1),U=Math.max(Math.hypot(N[2],N[3]),1),ee=F,re=z,pe="prescale1",ue,ye;for(;D>2&&ee>1||U>2&&re>1;){let ie=ee,ge=re;D>2&&ee>1&&(ie=ee>=16384?Math.floor(ee/2)-1||1:Math.ceil(ee/2),D/=ee/ie),U>2&&re>1&&(ge=re>=16384?Math.floor(re/2)-1||1:Math.ceil(re)/2,U/=re/ge),ue=this.cachedCanvases.getCanvas(pe,ie,ge),ye=ue.context,ye.clearRect(0,0,ie,ge),ye.drawImage(O,0,0,ee,re,0,0,ie,ge),O=ue.canvas,ee=ie,re=ge,pe=pe==="prescale1"?"prescale2":"prescale1"}return{img:O,paintWidth:ee,paintHeight:re}}_createMaskCanvas(O){const N=this.ctx,{width:F,height:z}=O,D=this.current.fillColor,U=this.current.patternFill,ee=(0,r.getCurrentTransform)(N);let re,pe,ue,ye;if((O.bitmap||O.data)&&O.count>1){const _e=O.bitmap||O.data.buffer;pe=JSON.stringify(U?ee:[ee.slice(0,4),D]),re=this._cachedBitmapsMap.get(_e),re||(re=new Map,this._cachedBitmapsMap.set(_e,re));const Ve=re.get(pe);if(Ve&&!U){const Ge=Math.round(Math.min(ee[0],ee[2])+ee[4]),Ke=Math.round(Math.min(ee[1],ee[3])+ee[5]);return{canvas:Ve,offsetX:Ge,offsetY:Ke}}ue=Ve}ue||(ye=this.cachedCanvases.getCanvas("maskCanvas",F,z),k(ye.context,O));let ie=n.Util.transform(ee,[1/F,0,0,-1/z,0,0]);ie=n.Util.transform(ie,[1,0,0,1,0,-z]);const ge=n.Util.applyTransform([0,0],ie),Ee=n.Util.applyTransform([F,z],ie),Oe=n.Util.normalizeRect([ge[0],ge[1],Ee[0],Ee[1]]),Ie=Math.round(Oe[2]-Oe[0])||1,we=Math.round(Oe[3]-Oe[1])||1,Ue=this.cachedCanvases.getCanvas("fillCanvas",Ie,we),Ne=Ue.context,be=Math.min(ge[0],Ee[0]),de=Math.min(ge[1],Ee[1]);Ne.translate(-be,-de),Ne.transform(...ie),ue||(ue=this._scaleImage(ye.canvas,(0,r.getCurrentTransformInverse)(Ne)),ue=ue.img,re&&U&&re.set(pe,ue)),Ne.imageSmoothingEnabled=L((0,r.getCurrentTransform)(Ne),O.interpolate),v(Ne,ue,0,0,ue.width,ue.height,0,0,F,z),Ne.globalCompositeOperation="source-in";const Te=n.Util.transform((0,r.getCurrentTransformInverse)(Ne),[1,0,0,1,-be,-de]);return Ne.fillStyle=U?D.getPattern(N,this,Te,i.PathType.FILL):D,Ne.fillRect(0,0,F,z),re&&!U&&(this.cachedCanvases.delete("fillCanvas"),re.set(pe,Ue.canvas)),{canvas:Ue.canvas,offsetX:Math.round(be),offsetY:Math.round(de)}}setLineWidth(O){O!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=O,this.ctx.lineWidth=O}setLineCap(O){this.ctx.lineCap=$[O]}setLineJoin(O){this.ctx.lineJoin=Y[O]}setMiterLimit(O){this.ctx.miterLimit=O}setDash(O,N){const F=this.ctx;F.setLineDash!==void 0&&(F.setLineDash(O),F.lineDashOffset=N)}setRenderingIntent(O){}setFlatness(O){}setGState(O){for(const[N,F]of O)switch(N){case"LW":this.setLineWidth(F);break;case"LC":this.setLineCap(F);break;case"LJ":this.setLineJoin(F);break;case"ML":this.setMiterLimit(F);break;case"D":this.setDash(F[0],F[1]);break;case"RI":this.setRenderingIntent(F);break;case"FL":this.setFlatness(F);break;case"Font":this.setFont(F[0],F[1]);break;case"CA":this.current.strokeAlpha=F;break;case"ca":this.current.fillAlpha=F,this.ctx.globalAlpha=F;break;case"BM":this.ctx.globalCompositeOperation=F;break;case"SMask":this.current.activeSMask=F?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(F);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const O=this.inSMaskMode;this.current.activeSMask&&!O?this.beginSMaskMode():!this.current.activeSMask&&O&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const O=this.ctx.canvas.width,N=this.ctx.canvas.height,F="smaskGroupAt"+this.groupLevel,z=this.cachedCanvases.getCanvas(F,O,N);this.suspendedCtx=this.ctx,this.ctx=z.context;const D=this.ctx;D.setTransform(...(0,r.getCurrentTransform)(this.suspendedCtx)),m(this.suspendedCtx,D),f(D,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),m(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(O){if(!this.current.activeSMask)return;O?(O[0]=Math.floor(O[0]),O[1]=Math.floor(O[1]),O[2]=Math.ceil(O[2]),O[3]=Math.ceil(O[3])):O=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const N=this.current.activeSMask,F=this.suspendedCtx;E(F,N,this.ctx,O),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(m(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const O=this.current;this.stateStack.push(O),this.current=O.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),m(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(O,N,F,z,D,U){this.ctx.transform(O,N,F,z,D,U),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(O,N,F){const z=this.ctx,D=this.current;let U=D.x,ee=D.y,re,pe;const ue=(0,r.getCurrentTransform)(z),ye=ue[0]===0&&ue[3]===0||ue[1]===0&&ue[2]===0,ie=ye?F.slice(0):null;for(let ge=0,Ee=0,Oe=O.length;ge<Oe;ge++)switch(O[ge]|0){case n.OPS.rectangle:U=N[Ee++],ee=N[Ee++];const Ie=N[Ee++],we=N[Ee++],Ue=U+Ie,Ne=ee+we;z.moveTo(U,ee),Ie===0||we===0?z.lineTo(Ue,Ne):(z.lineTo(Ue,ee),z.lineTo(Ue,Ne),z.lineTo(U,Ne)),ye||D.updateRectMinMax(ue,[U,ee,Ue,Ne]),z.closePath();break;case n.OPS.moveTo:U=N[Ee++],ee=N[Ee++],z.moveTo(U,ee),ye||D.updatePathMinMax(ue,U,ee);break;case n.OPS.lineTo:U=N[Ee++],ee=N[Ee++],z.lineTo(U,ee),ye||D.updatePathMinMax(ue,U,ee);break;case n.OPS.curveTo:re=U,pe=ee,U=N[Ee+4],ee=N[Ee+5],z.bezierCurveTo(N[Ee],N[Ee+1],N[Ee+2],N[Ee+3],U,ee),D.updateCurvePathMinMax(ue,re,pe,N[Ee],N[Ee+1],N[Ee+2],N[Ee+3],U,ee,ie),Ee+=6;break;case n.OPS.curveTo2:re=U,pe=ee,z.bezierCurveTo(U,ee,N[Ee],N[Ee+1],N[Ee+2],N[Ee+3]),D.updateCurvePathMinMax(ue,re,pe,U,ee,N[Ee],N[Ee+1],N[Ee+2],N[Ee+3],ie),U=N[Ee+2],ee=N[Ee+3],Ee+=4;break;case n.OPS.curveTo3:re=U,pe=ee,U=N[Ee+2],ee=N[Ee+3],z.bezierCurveTo(N[Ee],N[Ee+1],U,ee,U,ee),D.updateCurvePathMinMax(ue,re,pe,N[Ee],N[Ee+1],U,ee,U,ee,ie),Ee+=4;break;case n.OPS.closePath:z.closePath();break}ye&&D.updateScalingPathMinMax(ue,ie),D.setCurrentPoint(U,ee)}closePath(){this.ctx.closePath()}stroke(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const N=this.ctx,F=this.current.strokeColor;N.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof F=="object"&&(F!=null&&F.getPattern)?(N.save(),N.strokeStyle=F.getPattern(N,this,(0,r.getCurrentTransformInverse)(N),i.PathType.STROKE),this.rescaleAndStroke(!1),N.restore()):this.rescaleAndStroke(!0)),O&&this.consumePath(this.current.getClippedPathBoundingBox()),N.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const N=this.ctx,F=this.current.fillColor,z=this.current.patternFill;let D=!1;z&&(N.save(),N.fillStyle=F.getPattern(N,this,(0,r.getCurrentTransformInverse)(N),i.PathType.FILL),D=!0);const U=this.current.getClippedPathBoundingBox();this.contentVisible&&U!==null&&(this.pendingEOFill?(N.fill("evenodd"),this.pendingEOFill=!1):N.fill()),D&&N.restore(),O&&this.consumePath(U)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=V}eoClip(){this.pendingClip=j}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const O=this.pendingTextPaths,N=this.ctx;if(O===void 0){N.beginPath();return}N.save(),N.beginPath();for(const F of O)N.setTransform(...F.transform),N.translate(F.x,F.y),F.addToPath(N,F.fontSize);N.restore(),N.clip(),N.beginPath(),delete this.pendingTextPaths}setCharSpacing(O){this.current.charSpacing=O}setWordSpacing(O){this.current.wordSpacing=O}setHScale(O){this.current.textHScale=O/100}setLeading(O){this.current.leading=-O}setFont(O,N){var ue;const F=this.commonObjs.get(O),z=this.current;if(!F)throw new Error(`Can't find font for ${O}`);if(z.fontMatrix=F.fontMatrix||n.FONT_IDENTITY_MATRIX,(z.fontMatrix[0]===0||z.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+O),N<0?(N=-N,z.fontDirection=-1):z.fontDirection=1,this.current.font=F,this.current.fontSize=N,F.isType3Font)return;const D=F.loadedName||"sans-serif",U=((ue=F.systemFontInfo)==null?void 0:ue.css)||`"${D}", ${F.fallbackName}`;let ee="normal";F.black?ee="900":F.bold&&(ee="bold");const re=F.italic?"italic":"normal";let pe=N;N<a?pe=a:N>u&&(pe=u),this.current.fontSizeScale=N/pe,this.ctx.font=`${re} ${ee} ${pe}px ${U}`}setTextRenderingMode(O){this.current.textRenderingMode=O}setTextRise(O){this.current.textRise=O}moveText(O,N){this.current.x=this.current.lineX+=O,this.current.y=this.current.lineY+=N}setLeadingMoveText(O,N){this.setLeading(-N),this.moveText(O,N)}setTextMatrix(O,N,F,z,D,U){this.current.textMatrix=[O,N,F,z,D,U],this.current.textMatrixScale=Math.hypot(O,N),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(O,N,F,z){const D=this.ctx,U=this.current,ee=U.font,re=U.textRenderingMode,pe=U.fontSize/U.fontSizeScale,ue=re&n.TextRenderingMode.FILL_STROKE_MASK,ye=!!(re&n.TextRenderingMode.ADD_TO_PATH_FLAG),ie=U.patternFill&&!ee.missingFile;let ge;(ee.disableFontFace||ye||ie)&&(ge=ee.getPathGenerator(this.commonObjs,O)),ee.disableFontFace||ie?(D.save(),D.translate(N,F),D.beginPath(),ge(D,pe),z&&D.setTransform(...z),(ue===n.TextRenderingMode.FILL||ue===n.TextRenderingMode.FILL_STROKE)&&D.fill(),(ue===n.TextRenderingMode.STROKE||ue===n.TextRenderingMode.FILL_STROKE)&&D.stroke(),D.restore()):((ue===n.TextRenderingMode.FILL||ue===n.TextRenderingMode.FILL_STROKE)&&D.fillText(O,N,F),(ue===n.TextRenderingMode.STROKE||ue===n.TextRenderingMode.FILL_STROKE)&&D.strokeText(O,N,F)),ye&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,r.getCurrentTransform)(D),x:N,y:F,fontSize:pe,addToPath:ge})}get isFontSubpixelAAEnabled(){const{context:O}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);O.scale(1.5,1),O.fillText("I",0,10);const N=O.getImageData(0,0,10,10).data;let F=!1;for(let z=3;z<N.length;z+=4)if(N[z]>0&&N[z]<255){F=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",F)}showText(O){const N=this.current,F=N.font;if(F.isType3Font)return this.showType3Text(O);const z=N.fontSize;if(z===0)return;const D=this.ctx,U=N.fontSizeScale,ee=N.charSpacing,re=N.wordSpacing,pe=N.fontDirection,ue=N.textHScale*pe,ye=O.length,ie=F.vertical,ge=ie?1:-1,Ee=F.defaultVMetrics,Oe=z*N.fontMatrix[0],Ie=N.textRenderingMode===n.TextRenderingMode.FILL&&!F.disableFontFace&&!N.patternFill;D.save(),D.transform(...N.textMatrix),D.translate(N.x,N.y+N.textRise),pe>0?D.scale(ue,-1):D.scale(ue,1);let we;if(N.patternFill){D.save();const Te=N.fillColor.getPattern(D,this,(0,r.getCurrentTransformInverse)(D),i.PathType.FILL);we=(0,r.getCurrentTransform)(D),D.restore(),D.fillStyle=Te}let Ue=N.lineWidth;const Ne=N.textMatrixScale;if(Ne===0||Ue===0){const Te=N.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(Te===n.TextRenderingMode.STROKE||Te===n.TextRenderingMode.FILL_STROKE)&&(Ue=this.getSinglePixelWidth())}else Ue/=Ne;if(U!==1&&(D.scale(U,U),Ue/=U),D.lineWidth=Ue,F.isInvalidPDFjsFont){const Te=[];let _e=0;for(const Ve of O)Te.push(Ve.unicode),_e+=Ve.width;D.fillText(Te.join(""),0,0),N.x+=_e*Oe*ue,D.restore(),this.compose();return}let be=0,de;for(de=0;de<ye;++de){const Te=O[de];if(typeof Te=="number"){be+=ge*Te*z/1e3;continue}let _e=!1;const Ve=(Te.isSpace?re:0)+ee,Ge=Te.fontChar,Ke=Te.accent;let $e,Ze,Qe=Te.width;if(ie){const Ye=Te.vmetric||Ee,Se=-(Te.vmetric?Ye[1]:Qe*.5)*Oe,ce=Ye[2]*Oe;Qe=Ye?-Ye[0]:Qe,$e=Se/U,Ze=(be+ce)/U}else $e=be/U,Ze=0;if(F.remeasure&&Qe>0){const Ye=D.measureText(Ge).width*1e3/z*U;if(Qe<Ye&&this.isFontSubpixelAAEnabled){const Se=Qe/Ye;_e=!0,D.save(),D.scale(Se,1),$e/=Se}else Qe!==Ye&&($e+=(Qe-Ye)/2e3*z/U)}if(this.contentVisible&&(Te.isInFont||F.missingFile)){if(Ie&&!Ke)D.fillText(Ge,$e,Ze);else if(this.paintChar(Ge,$e,Ze,we),Ke){const Ye=$e+z*Ke.offset.x/U,Se=Ze-z*Ke.offset.y/U;this.paintChar(Ke.fontChar,Ye,Se,we)}}const qe=ie?Qe*Oe-Ve*pe:Qe*Oe+Ve*pe;be+=qe,_e&&D.restore()}ie?N.y-=be:N.x+=be*ue,D.restore(),this.compose()}showType3Text(O){const N=this.ctx,F=this.current,z=F.font,D=F.fontSize,U=F.fontDirection,ee=z.vertical?1:-1,re=F.charSpacing,pe=F.wordSpacing,ue=F.textHScale*U,ye=F.fontMatrix||n.FONT_IDENTITY_MATRIX,ie=O.length,ge=F.textRenderingMode===n.TextRenderingMode.INVISIBLE;let Ee,Oe,Ie,we;if(!(ge||D===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,N.save(),N.transform(...F.textMatrix),N.translate(F.x,F.y),N.scale(ue,U),Ee=0;Ee<ie;++Ee){if(Oe=O[Ee],typeof Oe=="number"){we=ee*Oe*D/1e3,this.ctx.translate(we,0),F.x+=we*ue;continue}const Ue=(Oe.isSpace?pe:0)+re,Ne=z.charProcOperatorList[Oe.operatorListId];if(!Ne){(0,n.warn)(`Type3 character "${Oe.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Oe,this.save(),N.scale(D,D),N.transform(...ye),this.executeOperatorList(Ne),this.restore()),Ie=n.Util.applyTransform([Oe.width,0],ye)[0]*D+Ue,N.translate(Ie,0),F.x+=Ie*ue}N.restore(),this.processingType3=null}}setCharWidth(O,N){}setCharWidthAndBounds(O,N,F,z,D,U){this.ctx.rect(F,z,D-F,U-z),this.ctx.clip(),this.endPath()}getColorN_Pattern(O){let N;if(O[0]==="TilingPattern"){const F=O[1],z=this.baseTransform||(0,r.getCurrentTransform)(this.ctx),D={createCanvasGraphics:U=>new ve(U,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};N=new i.TilingPattern(O,F,this.ctx,D,z)}else N=this._getPattern(O[1],O[2]);return N}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(O,N,F){const z=n.Util.makeHexColor(O,N,F);this.ctx.strokeStyle=z,this.current.strokeColor=z}setFillRGBColor(O,N,F){const z=n.Util.makeHexColor(O,N,F);this.ctx.fillStyle=z,this.current.fillColor=z,this.current.patternFill=!1}_getPattern(O){let N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,F;return this.cachedPatterns.has(O)?F=this.cachedPatterns.get(O):(F=(0,i.getShadingPattern)(this.getObject(O)),this.cachedPatterns.set(O,F)),N&&(F.matrix=N),F}shadingFill(O){if(!this.contentVisible)return;const N=this.ctx;this.save();const F=this._getPattern(O);N.fillStyle=F.getPattern(N,this,(0,r.getCurrentTransformInverse)(N),i.PathType.SHADING);const z=(0,r.getCurrentTransformInverse)(N);if(z){const{width:D,height:U}=N.canvas,[ee,re,pe,ue]=n.Util.getAxialAlignedBoundingBox([0,0,D,U],z);this.ctx.fillRect(ee,re,pe-ee,ue-re)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(O,N){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(O)&&O.length===6&&this.transform(...O),this.baseTransform=(0,r.getCurrentTransform)(this.ctx),N)){const F=N[2]-N[0],z=N[3]-N[1];this.ctx.rect(N[0],N[1],F,z),this.current.updateRectMinMax((0,r.getCurrentTransform)(this.ctx),N),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(O){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const N=this.ctx;O.isolated||(0,n.info)("TODO: Support non-isolated groups."),O.knockout&&(0,n.warn)("Knockout groups not supported.");const F=(0,r.getCurrentTransform)(N);if(O.matrix&&N.transform(...O.matrix),!O.bbox)throw new Error("Bounding box is required.");let z=n.Util.getAxialAlignedBoundingBox(O.bbox,(0,r.getCurrentTransform)(N));const D=[0,0,N.canvas.width,N.canvas.height];z=n.Util.intersect(z,D)||[0,0,0,0];const U=Math.floor(z[0]),ee=Math.floor(z[1]);let re=Math.max(Math.ceil(z[2])-U,1),pe=Math.max(Math.ceil(z[3])-ee,1),ue=1,ye=1;re>l&&(ue=re/l,re=l),pe>l&&(ye=pe/l,pe=l),this.current.startNewPathAndClipBox([0,0,re,pe]);let ie="groupAt"+this.groupLevel;O.smask&&(ie+="_smask_"+this.smaskCounter++%2);const ge=this.cachedCanvases.getCanvas(ie,re,pe),Ee=ge.context;Ee.scale(1/ue,1/ye),Ee.translate(-U,-ee),Ee.transform(...F),O.smask?this.smaskStack.push({canvas:ge.canvas,context:Ee,offsetX:U,offsetY:ee,scaleX:ue,scaleY:ye,subtype:O.smask.subtype,backdrop:O.smask.backdrop,transferMap:O.smask.transferMap||null,startTransformInverse:null}):(N.setTransform(1,0,0,1,0,0),N.translate(U,ee),N.scale(ue,ye),N.save()),m(N,Ee),this.ctx=Ee,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(N),this.groupLevel++}endGroup(O){if(!this.contentVisible)return;this.groupLevel--;const N=this.ctx,F=this.groupStack.pop();if(this.ctx=F,this.ctx.imageSmoothingEnabled=!1,O.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const z=(0,r.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...z);const D=n.Util.getAxialAlignedBoundingBox([0,0,N.canvas.width,N.canvas.height],z);this.ctx.drawImage(N.canvas,0,0),this.ctx.restore(),this.compose(D)}}beginAnnotation(O,N,F,z,D){if(me(this,X,Jt).call(this),b(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(N)&&N.length===4){const U=N[2]-N[0],ee=N[3]-N[1];if(D&&this.annotationCanvasMap){F=F.slice(),F[4]-=N[0],F[5]-=N[1],N=N.slice(),N[0]=N[1]=0,N[2]=U,N[3]=ee;const[re,pe]=n.Util.singularValueDecompose2dScale((0,r.getCurrentTransform)(this.ctx)),{viewportScale:ue}=this,ye=Math.ceil(U*this.outputScaleX*ue),ie=Math.ceil(ee*this.outputScaleY*ue);this.annotationCanvas=this.canvasFactory.create(ye,ie);const{canvas:ge,context:Ee}=this.annotationCanvas;this.annotationCanvasMap.set(O,ge),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Ee,this.ctx.save(),this.ctx.setTransform(re,0,0,-pe,0,ee*pe),b(this.ctx)}else b(this.ctx),this.ctx.rect(N[0],N[1],U,ee),this.ctx.clip(),this.endPath()}this.current=new x(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...F),this.transform(...z)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),me(this,Z,en).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(O){if(!this.contentVisible)return;const N=O.count;O=this.getObject(O.data,O),O.count=N;const F=this.ctx,z=this.processingType3;if(z&&(z.compiled===void 0&&(z.compiled=y(O)),z.compiled)){z.compiled(F);return}const D=this._createMaskCanvas(O),U=D.canvas;F.save(),F.setTransform(1,0,0,1,0,0),F.drawImage(U,D.offsetX,D.offsetY),F.restore(),this.compose()}paintImageMaskXObjectRepeat(O,N){let F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,z=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,D=arguments.length>4?arguments[4]:void 0,U=arguments.length>5?arguments[5]:void 0;if(!this.contentVisible)return;O=this.getObject(O.data,O);const ee=this.ctx;ee.save();const re=(0,r.getCurrentTransform)(ee);ee.transform(N,F,z,D,0,0);const pe=this._createMaskCanvas(O);ee.setTransform(1,0,0,1,pe.offsetX-re[4],pe.offsetY-re[5]);for(let ue=0,ye=U.length;ue<ye;ue+=2){const ie=n.Util.transform(re,[N,F,z,D,U[ue],U[ue+1]]),[ge,Ee]=n.Util.applyTransform([0,0],ie);ee.drawImage(pe.canvas,ge,Ee)}ee.restore(),this.compose()}paintImageMaskXObjectGroup(O){if(!this.contentVisible)return;const N=this.ctx,F=this.current.fillColor,z=this.current.patternFill;for(const D of O){const{data:U,width:ee,height:re,transform:pe}=D,ue=this.cachedCanvases.getCanvas("maskCanvas",ee,re),ye=ue.context;ye.save();const ie=this.getObject(U,D);k(ye,ie),ye.globalCompositeOperation="source-in",ye.fillStyle=z?F.getPattern(ye,this,(0,r.getCurrentTransformInverse)(N),i.PathType.FILL):F,ye.fillRect(0,0,ee,re),ye.restore(),N.save(),N.transform(...pe),N.scale(1,-1),v(N,ue.canvas,0,0,ee,re,0,-1,1,1),N.restore()}this.compose()}paintImageXObject(O){if(!this.contentVisible)return;const N=this.getObject(O);if(!N){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(N)}paintImageXObjectRepeat(O,N,F,z){if(!this.contentVisible)return;const D=this.getObject(O);if(!D){(0,n.warn)("Dependent image isn't ready yet");return}const U=D.width,ee=D.height,re=[];for(let pe=0,ue=z.length;pe<ue;pe+=2)re.push({transform:[N,0,0,F,z[pe],z[pe+1]],x:0,y:0,w:U,h:ee});this.paintInlineImageXObjectGroup(D,re)}applyTransferMapsToCanvas(O){return this.current.transferMaps!=="none"&&(O.filter=this.current.transferMaps,O.drawImage(O.canvas,0,0),O.filter="none"),O.canvas}applyTransferMapsToBitmap(O){if(this.current.transferMaps==="none")return O.bitmap;const{bitmap:N,width:F,height:z}=O,D=this.cachedCanvases.getCanvas("inlineImage",F,z),U=D.context;return U.filter=this.current.transferMaps,U.drawImage(N,0,0),U.filter="none",D.canvas}paintInlineImageXObject(O){if(!this.contentVisible)return;const N=O.width,F=O.height,z=this.ctx;if(this.save(),!n.isNodeJS){const{filter:ee}=z;ee!=="none"&&ee!==""&&(z.filter="none")}z.scale(1/N,-1/F);let D;if(O.bitmap)D=this.applyTransferMapsToBitmap(O);else if(typeof HTMLElement=="function"&&O instanceof HTMLElement||!O.data)D=O;else{const re=this.cachedCanvases.getCanvas("inlineImage",N,F).context;R(re,O),D=this.applyTransferMapsToCanvas(re)}const U=this._scaleImage(D,(0,r.getCurrentTransformInverse)(z));z.imageSmoothingEnabled=L((0,r.getCurrentTransform)(z),O.interpolate),v(z,U.img,0,0,U.paintWidth,U.paintHeight,0,-F,N,F),this.compose(),this.restore()}paintInlineImageXObjectGroup(O,N){if(!this.contentVisible)return;const F=this.ctx;let z;if(O.bitmap)z=O.bitmap;else{const D=O.width,U=O.height,re=this.cachedCanvases.getCanvas("inlineImage",D,U).context;R(re,O),z=this.applyTransferMapsToCanvas(re)}for(const D of N)F.save(),F.transform(...D.transform),F.scale(1,-1),v(F,z,D.x,D.y,D.w,D.h,0,-1,1,1),F.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(O){}markPointProps(O,N){}beginMarkedContent(O){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(O,N){O==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(N)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(O){const N=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(O);const F=this.ctx;this.pendingClip&&(N||(this.pendingClip===j?F.clip("evenodd"):F.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),F.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const O=(0,r.getCurrentTransform)(this.ctx);if(O[1]===0&&O[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(O[0]),Math.abs(O[3]));else{const N=Math.abs(O[0]*O[3]-O[2]*O[1]),F=Math.hypot(O[0],O[2]),z=Math.hypot(O[1],O[3]);this._cachedGetSinglePixelWidth=Math.max(F,z)/N}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:O}=this.current,{a:N,b:F,c:z,d:D}=this.ctx.getTransform();let U,ee;if(F===0&&z===0){const re=Math.abs(N),pe=Math.abs(D);if(re===pe)if(O===0)U=ee=1/re;else{const ue=re*O;U=ee=ue<1?1/ue:1}else if(O===0)U=1/re,ee=1/pe;else{const ue=re*O,ye=pe*O;U=ue<1?1/ue:1,ee=ye<1?1/ye:1}}else{const re=Math.abs(N*D-F*z),pe=Math.hypot(N,F),ue=Math.hypot(z,D);if(O===0)U=ue/re,ee=pe/re;else{const ye=O*re;U=ue>ye?ue/ye:1,ee=pe>ye?pe/ye:1}}this._cachedScaleForStroking[0]=U,this._cachedScaleForStroking[1]=ee}return this._cachedScaleForStroking}rescaleAndStroke(O){const{ctx:N}=this,{lineWidth:F}=this.current,[z,D]=this.getScaleForStroking();if(N.lineWidth=F||1,z===1&&D===1){N.stroke();return}const U=N.getLineDash();if(O&&N.save(),N.scale(z,D),U.length>0){const ee=Math.max(z,D);N.setLineDash(U.map(re=>re/ee)),N.lineDashOffset/=ee}N.stroke(),O&&N.restore()}isContentVisible(){for(let O=this.markedContentStack.length-1;O>=0;O--)if(!this.markedContentStack[O].visible)return!1;return!0}};let G=ve;X=new WeakSet,Jt=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Z=new WeakSet,en=function(){if(this.pageColors){const O=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(O!=="none"){const N=this.ctx.filter;this.ctx.filter=O,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=N}}},e.CanvasGraphics=G;for(const K in n.OPS)G.prototype[K]!==void 0&&(G.prototype[n.OPS[K]]=G.prototype[K])},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=p,t(2);var n=t(1),r=t(167);const i={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=i;function o(y,x){if(!x)return;const R=x[2]-x[0],k=x[3]-x[1],m=new Path2D;m.rect(x[0],x[1],R,k),y.clip(m)}class a{constructor(){this.constructor===a&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class u extends a{constructor(x){super(),this._type=x[1],this._bbox=x[2],this._colorStops=x[3],this._p0=x[4],this._p1=x[5],this._r0=x[6],this._r1=x[7],this.matrix=null}_createGradient(x){let R;this._type==="axial"?R=x.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(R=x.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const k of this._colorStops)R.addColorStop(k[0],k[1]);return R}getPattern(x,R,k,m){let b;if(m===i.STROKE||m===i.FILL){const I=R.current.getClippedPathBoundingBox(m,(0,r.getCurrentTransform)(x))||[0,0,0,0],_=Math.ceil(I[2]-I[0])||1,S=Math.ceil(I[3]-I[1])||1,T=R.cachedCanvases.getCanvas("pattern",_,S,!0),E=T.context;E.clearRect(0,0,E.canvas.width,E.canvas.height),E.beginPath(),E.rect(0,0,E.canvas.width,E.canvas.height),E.translate(-I[0],-I[1]),k=n.Util.transform(k,[1,0,0,1,I[0],I[1]]),E.transform(...R.baseTransform),this.matrix&&E.transform(...this.matrix),o(E,this._bbox),E.fillStyle=this._createGradient(E),E.fill(),b=x.createPattern(T.canvas,"no-repeat");const L=new DOMMatrix(k);b.setTransform(L)}else o(x,this._bbox),b=this._createGradient(x);return b}}function l(y,x,R,k,m,b,I,_){const S=x.coords,T=x.colors,E=y.data,L=y.width*4;let $;S[R+1]>S[k+1]&&($=R,R=k,k=$,$=b,b=I,I=$),S[k+1]>S[m+1]&&($=k,k=m,m=$,$=I,I=_,_=$),S[R+1]>S[k+1]&&($=R,R=k,k=$,$=b,b=I,I=$);const Y=(S[R]+x.offsetX)*x.scaleX,V=(S[R+1]+x.offsetY)*x.scaleY,j=(S[k]+x.offsetX)*x.scaleX,G=(S[k+1]+x.offsetY)*x.scaleY,X=(S[m]+x.offsetX)*x.scaleX,q=(S[m+1]+x.offsetY)*x.scaleY;if(V>=q)return;const Z=T[b],J=T[b+1],ve=T[b+2],K=T[I],O=T[I+1],N=T[I+2],F=T[_],z=T[_+1],D=T[_+2],U=Math.round(V),ee=Math.round(q);let re,pe,ue,ye,ie,ge,Ee,Oe;for(let Ie=U;Ie<=ee;Ie++){if(Ie<G){const de=Ie<V?0:(V-Ie)/(V-G);re=Y-(Y-j)*de,pe=Z-(Z-K)*de,ue=J-(J-O)*de,ye=ve-(ve-N)*de}else{let de;Ie>q?de=1:G===q?de=0:de=(G-Ie)/(G-q),re=j-(j-X)*de,pe=K-(K-F)*de,ue=O-(O-z)*de,ye=N-(N-D)*de}let we;Ie<V?we=0:Ie>q?we=1:we=(V-Ie)/(V-q),ie=Y-(Y-X)*we,ge=Z-(Z-F)*we,Ee=J-(J-z)*we,Oe=ve-(ve-D)*we;const Ue=Math.round(Math.min(re,ie)),Ne=Math.round(Math.max(re,ie));let be=L*Ie+Ue*4;for(let de=Ue;de<=Ne;de++)we=(re-de)/(re-ie),we<0?we=0:we>1&&(we=1),E[be++]=pe-(pe-ge)*we|0,E[be++]=ue-(ue-Ee)*we|0,E[be++]=ye-(ye-Oe)*we|0,E[be++]=255}}function c(y,x,R){const k=x.coords,m=x.colors;let b,I;switch(x.type){case"lattice":const _=x.verticesPerRow,S=Math.floor(k.length/_)-1,T=_-1;for(b=0;b<S;b++){let E=b*_;for(let L=0;L<T;L++,E++)l(y,R,k[E],k[E+1],k[E+_],m[E],m[E+1],m[E+_]),l(y,R,k[E+_+1],k[E+1],k[E+_],m[E+_+1],m[E+1],m[E+_])}break;case"triangles":for(b=0,I=k.length;b<I;b+=3)l(y,R,k[b],k[b+1],k[b+2],m[b],m[b+1],m[b+2]);break;default:throw new Error("illegal figure")}}class h extends a{constructor(x){super(),this._coords=x[2],this._colors=x[3],this._figures=x[4],this._bounds=x[5],this._bbox=x[7],this._background=x[8],this.matrix=null}_createMeshCanvas(x,R,k){const _=Math.floor(this._bounds[0]),S=Math.floor(this._bounds[1]),T=Math.ceil(this._bounds[2])-_,E=Math.ceil(this._bounds[3])-S,L=Math.min(Math.ceil(Math.abs(T*x[0]*1.1)),3e3),$=Math.min(Math.ceil(Math.abs(E*x[1]*1.1)),3e3),Y=T/L,V=E/$,j={coords:this._coords,colors:this._colors,offsetX:-_,offsetY:-S,scaleX:1/Y,scaleY:1/V},G=L+2*2,X=$+2*2,q=k.getCanvas("mesh",G,X,!1),Z=q.context,J=Z.createImageData(L,$);if(R){const K=J.data;for(let O=0,N=K.length;O<N;O+=4)K[O]=R[0],K[O+1]=R[1],K[O+2]=R[2],K[O+3]=255}for(const K of this._figures)c(J,K,j);return Z.putImageData(J,2,2),{canvas:q.canvas,offsetX:_-2*Y,offsetY:S-2*V,scaleX:Y,scaleY:V}}getPattern(x,R,k,m){o(x,this._bbox);let b;if(m===i.SHADING)b=n.Util.singularValueDecompose2dScale((0,r.getCurrentTransform)(x));else if(b=n.Util.singularValueDecompose2dScale(R.baseTransform),this.matrix){const _=n.Util.singularValueDecompose2dScale(this.matrix);b=[b[0]*_[0],b[1]*_[1]]}const I=this._createMeshCanvas(b,m===i.SHADING?null:this._background,R.cachedCanvases);return m!==i.SHADING&&(x.setTransform(...R.baseTransform),this.matrix&&x.transform(...this.matrix)),x.translate(I.offsetX,I.offsetY),x.scale(I.scaleX,I.scaleY),x.createPattern(I.canvas,"no-repeat")}}class d extends a{getPattern(){return"hotpink"}}function p(y){switch(y[0]){case"RadialAxial":return new u(y);case"Mesh":return new h(y);case"Dummy":return new d}throw new Error(`Unknown IR type: ${y[0]}`)}const f={COLORED:1,UNCOLORED:2},v=class{constructor(x,R,k,m,b){this.operatorList=x[2],this.matrix=x[3]||[1,0,0,1,0,0],this.bbox=x[4],this.xstep=x[5],this.ystep=x[6],this.paintType=x[7],this.tilingType=x[8],this.color=R,this.ctx=k,this.canvasGraphicsFactory=m,this.baseTransform=b}createPatternCanvas(x){const R=this.operatorList,k=this.bbox,m=this.xstep,b=this.ystep,I=this.paintType,_=this.tilingType,S=this.color,T=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+_);const E=k[0],L=k[1],$=k[2],Y=k[3],V=n.Util.singularValueDecompose2dScale(this.matrix),j=n.Util.singularValueDecompose2dScale(this.baseTransform),G=[V[0]*j[0],V[1]*j[1]],X=this.getSizeAndScale(m,this.ctx.canvas.width,G[0]),q=this.getSizeAndScale(b,this.ctx.canvas.height,G[1]),Z=x.cachedCanvases.getCanvas("pattern",X.size,q.size,!0),J=Z.context,ve=T.createCanvasGraphics(J);ve.groupLevel=x.groupLevel,this.setFillAndStrokeStyleToContext(ve,I,S);let K=E,O=L,N=$,F=Y;return E<0&&(K=0,N+=Math.abs(E)),L<0&&(O=0,F+=Math.abs(L)),J.translate(-(X.scale*K),-(q.scale*O)),ve.transform(X.scale,0,0,q.scale,0,0),J.save(),this.clipBbox(ve,K,O,N,F),ve.baseTransform=(0,r.getCurrentTransform)(ve.ctx),ve.executeOperatorList(R),ve.endDrawing(),{canvas:Z.canvas,scaleX:X.scale,scaleY:q.scale,offsetX:K,offsetY:O}}getSizeAndScale(x,R,k){x=Math.abs(x);const m=Math.max(v.MAX_PATTERN_SIZE,R);let b=Math.ceil(x*k);return b>=m?b=m:k=b/x,{scale:k,size:b}}clipBbox(x,R,k,m,b){const I=m-R,_=b-k;x.ctx.rect(R,k,I,_),x.current.updateRectMinMax((0,r.getCurrentTransform)(x.ctx),[R,k,m,b]),x.clip(),x.endPath()}setFillAndStrokeStyleToContext(x,R,k){const m=x.ctx,b=x.current;switch(R){case f.COLORED:const I=this.ctx;m.fillStyle=I.fillStyle,m.strokeStyle=I.strokeStyle,b.fillColor=I.fillStyle,b.strokeColor=I.strokeStyle;break;case f.UNCOLORED:const _=n.Util.makeHexColor(k[0],k[1],k[2]);m.fillStyle=_,m.strokeStyle=_,b.fillColor=_,b.strokeColor=_;break;default:throw new n.FormatError(`Unsupported paint type: ${R}`)}}getPattern(x,R,k,m){let b=k;m!==i.SHADING&&(b=n.Util.transform(b,R.baseTransform),this.matrix&&(b=n.Util.transform(b,this.matrix)));const I=this.createPatternCanvas(R);let _=new DOMMatrix(b);_=_.translate(I.offsetX,I.offsetY),_=_.scale(1/I.scaleX,1/I.scaleY);const S=x.createPattern(I.canvas,"repeat");return S.setTransform(_),S}};let g=v;st(g,"MAX_PATTERN_SIZE",3e3),e.TilingPattern=g},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=i,e.convertToRGBA=r,e.grayToRGBA=a,t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123);var n=t(1);function r(u){switch(u.kind){case n.ImageKind.GRAYSCALE_1BPP:return i(u);case n.ImageKind.RGB_24BPP:return o(u)}return null}function i(u){let{src:l,srcPos:c=0,dest:h,width:d,height:p,nonBlackColor:f=4294967295,inverseDecode:g=!1}=u;const v=n.FeatureTest.isLittleEndian?4278190080:255,[y,x]=g?[f,v]:[v,f],R=d>>3,k=d&7,m=l.length;h=new Uint32Array(h.buffer);let b=0;for(let I=0;I<p;I++){for(const S=c+R;c<S;c++){const T=c<m?l[c]:255;h[b++]=T&128?x:y,h[b++]=T&64?x:y,h[b++]=T&32?x:y,h[b++]=T&16?x:y,h[b++]=T&8?x:y,h[b++]=T&4?x:y,h[b++]=T&2?x:y,h[b++]=T&1?x:y}if(k===0)continue;const _=c<m?l[c++]:255;for(let S=0;S<k;S++)h[b++]=_&1<<7-S?x:y}return{srcPos:c,destPos:b}}function o(u){let{src:l,srcPos:c=0,dest:h,destPos:d=0,width:p,height:f}=u,g=0;const v=l.length>>2,y=new Uint32Array(l.buffer,c,v);if(n.FeatureTest.isLittleEndian){for(;g<v-2;g+=3,d+=4){const x=y[g],R=y[g+1],k=y[g+2];h[d]=x|4278190080,h[d+1]=x>>>24|R<<8|4278190080,h[d+2]=R>>>16|k<<16|4278190080,h[d+3]=k>>>8|4278190080}for(let x=g*4,R=l.length;x<R;x+=3)h[d++]=l[x]|l[x+1]<<8|l[x+2]<<16|4278190080}else{for(;g<v-2;g+=3,d+=4){const x=y[g],R=y[g+1],k=y[g+2];h[d]=x|255,h[d+1]=x<<24|R>>>8|255,h[d+2]=R<<16|k>>>16|255,h[d+3]=k<<8|255}for(let x=g*4,R=l.length;x<R;x+=3)h[d++]=l[x]<<24|l[x+1]<<16|l[x+2]<<8|255}return{srcPos:c,destPos:d}}function a(u,l){if(n.FeatureTest.isLittleEndian)for(let c=0,h=u.length;c<h;c++)l[c]=u[c]*65793|4278190080;else for(let c=0,h=u.length;c<h;c++)l[c]=u[c]*16843008|255}},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const t=Object.create(null);e.GlobalWorkerOptions=t,t.workerPort=null,t.workerSrc=""},(s,e,t)=>{var u,In,c,Mn,d,Lt;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0,t(2);var n=t(1);const r={UNKNOWN:0,DATA:1,ERROR:2},i={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function o(f){switch(f instanceof Error||typeof f=="object"&&f!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),f.name){case"AbortException":return new n.AbortException(f.message);case"MissingPDFException":return new n.MissingPDFException(f.message);case"PasswordException":return new n.PasswordException(f.message,f.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(f.message,f.status);case"UnknownErrorException":return new n.UnknownErrorException(f.message,f.details);default:return new n.UnknownErrorException(f.message,f.toString())}}class a{constructor(g,v,y){se(this,u);se(this,c);se(this,d);this.sourceName=g,this.targetName=v,this.comObj=y,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=x=>{const R=x.data;if(R.targetName!==this.sourceName)return;if(R.stream){me(this,c,Mn).call(this,R);return}if(R.callback){const m=R.callbackId,b=this.callbackCapabilities[m];if(!b)throw new Error(`Cannot resolve callback ${m}`);if(delete this.callbackCapabilities[m],R.callback===r.DATA)b.resolve(R.data);else if(R.callback===r.ERROR)b.reject(o(R.reason));else throw new Error("Unexpected callback case");return}const k=this.actionHandler[R.action];if(!k)throw new Error(`Unknown action from worker: ${R.action}`);if(R.callbackId){const m=this.sourceName,b=R.sourceName;new Promise(function(I){I(k(R.data))}).then(function(I){y.postMessage({sourceName:m,targetName:b,callback:r.DATA,callbackId:R.callbackId,data:I})},function(I){y.postMessage({sourceName:m,targetName:b,callback:r.ERROR,callbackId:R.callbackId,reason:o(I)})});return}if(R.streamId){me(this,u,In).call(this,R);return}k(R.data)},y.addEventListener("message",this._onComObjOnMessage)}on(g,v){const y=this.actionHandler;if(y[g])throw new Error(`There is already an actionName called "${g}"`);y[g]=v}send(g,v,y){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:g,data:v},y)}sendWithPromise(g,v,y){const x=this.callbackId++,R=new n.PromiseCapability;this.callbackCapabilities[x]=R;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:g,callbackId:x,data:v},y)}catch(k){R.reject(k)}return R.promise}sendWithStream(g,v,y,x){const R=this.streamId++,k=this.sourceName,m=this.targetName,b=this.comObj;return new ReadableStream({start:I=>{const _=new n.PromiseCapability;return this.streamControllers[R]={controller:I,startCall:_,pullCall:null,cancelCall:null,isClosed:!1},b.postMessage({sourceName:k,targetName:m,action:g,streamId:R,data:v,desiredSize:I.desiredSize},x),_.promise},pull:I=>{const _=new n.PromiseCapability;return this.streamControllers[R].pullCall=_,b.postMessage({sourceName:k,targetName:m,stream:i.PULL,streamId:R,desiredSize:I.desiredSize}),_.promise},cancel:I=>{(0,n.assert)(I instanceof Error,"cancel must have a valid reason");const _=new n.PromiseCapability;return this.streamControllers[R].cancelCall=_,this.streamControllers[R].isClosed=!0,b.postMessage({sourceName:k,targetName:m,stream:i.CANCEL,streamId:R,reason:o(I)}),_.promise}},y)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}u=new WeakSet,In=function(g){const v=g.streamId,y=this.sourceName,x=g.sourceName,R=this.comObj,k=this,m=this.actionHandler[g.action],b={enqueue(I){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,S=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const T=this.desiredSize;this.desiredSize-=_,T>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),R.postMessage({sourceName:y,targetName:x,stream:i.ENQUEUE,streamId:v,chunk:I},S)},close(){this.isCancelled||(this.isCancelled=!0,R.postMessage({sourceName:y,targetName:x,stream:i.CLOSE,streamId:v}),delete k.streamSinks[v])},error(I){(0,n.assert)(I instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,R.postMessage({sourceName:y,targetName:x,stream:i.ERROR,streamId:v,reason:o(I)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:g.desiredSize,ready:null};b.sinkCapability.resolve(),b.ready=b.sinkCapability.promise,this.streamSinks[v]=b,new Promise(function(I){I(m(g.data,b))}).then(function(){R.postMessage({sourceName:y,targetName:x,stream:i.START_COMPLETE,streamId:v,success:!0})},function(I){R.postMessage({sourceName:y,targetName:x,stream:i.START_COMPLETE,streamId:v,reason:o(I)})})},c=new WeakSet,Mn=function(g){const v=g.streamId,y=this.sourceName,x=g.sourceName,R=this.comObj,k=this.streamControllers[v],m=this.streamSinks[v];switch(g.stream){case i.START_COMPLETE:g.success?k.startCall.resolve():k.startCall.reject(o(g.reason));break;case i.PULL_COMPLETE:g.success?k.pullCall.resolve():k.pullCall.reject(o(g.reason));break;case i.PULL:if(!m){R.postMessage({sourceName:y,targetName:x,stream:i.PULL_COMPLETE,streamId:v,success:!0});break}m.desiredSize<=0&&g.desiredSize>0&&m.sinkCapability.resolve(),m.desiredSize=g.desiredSize,new Promise(function(b){var I;b((I=m.onPull)==null?void 0:I.call(m))}).then(function(){R.postMessage({sourceName:y,targetName:x,stream:i.PULL_COMPLETE,streamId:v,success:!0})},function(b){R.postMessage({sourceName:y,targetName:x,stream:i.PULL_COMPLETE,streamId:v,reason:o(b)})});break;case i.ENQUEUE:if((0,n.assert)(k,"enqueue should have stream controller"),k.isClosed)break;k.controller.enqueue(g.chunk);break;case i.CLOSE:if((0,n.assert)(k,"close should have stream controller"),k.isClosed)break;k.isClosed=!0,k.controller.close(),me(this,d,Lt).call(this,k,v);break;case i.ERROR:(0,n.assert)(k,"error should have stream controller"),k.controller.error(o(g.reason)),me(this,d,Lt).call(this,k,v);break;case i.CANCEL_COMPLETE:g.success?k.cancelCall.resolve():k.cancelCall.reject(o(g.reason)),me(this,d,Lt).call(this,k,v);break;case i.CANCEL:if(!m)break;new Promise(function(b){var I;b((I=m.onCancel)==null?void 0:I.call(m,o(g.reason)))}).then(function(){R.postMessage({sourceName:y,targetName:x,stream:i.CANCEL_COMPLETE,streamId:v,success:!0})},function(b){R.postMessage({sourceName:y,targetName:x,stream:i.CANCEL_COMPLETE,streamId:v,reason:o(b)})}),m.sinkCapability.reject(o(g.reason)),m.isCancelled=!0,delete this.streamSinks[v];break;default:throw new Error("Unexpected stream case")}},d=new WeakSet,Lt=async function(g,v){var y,x,R;await Promise.allSettled([(y=g.startCall)==null?void 0:y.promise,(x=g.pullCall)==null?void 0:x.promise,(R=g.cancelCall)==null?void 0:R.promise]),delete this.streamControllers[v]},e.MessageHandler=a},(s,e,t)=>{var i,o;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=t(1);class r{constructor(u){se(this,i,void 0);se(this,o,void 0);let{parsedData:l,rawData:c}=u;Ae(this,i,l),Ae(this,o,c)}getRaw(){return w(this,o)}get(u){return w(this,i).get(u)??null}getAll(){return(0,n.objectFromMap)(w(this,i))}has(u){return w(this,i).has(u)}}i=new WeakMap,o=new WeakMap,e.Metadata=r},(s,e,t)=>{var u,l,c,h,d,p,tn;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=t(1),r=t(169);const i=Symbol("INTERNAL");class o{constructor(v,y){se(this,u,!0);this.name=v,this.intent=y}get visible(){return w(this,u)}_setVisible(v,y){v!==i&&(0,n.unreachable)("Internal method `_setVisible` called."),Ae(this,u,y)}}u=new WeakMap;class a{constructor(v){se(this,p);se(this,l,null);se(this,c,new Map);se(this,h,null);se(this,d,null);if(this.name=null,this.creator=null,v!==null){this.name=v.name,this.creator=v.creator,Ae(this,d,v.order);for(const y of v.groups)w(this,c).set(y.id,new o(y.name,y.intent));if(v.baseState==="OFF")for(const y of w(this,c).values())y._setVisible(i,!1);for(const y of v.on)w(this,c).get(y)._setVisible(i,!0);for(const y of v.off)w(this,c).get(y)._setVisible(i,!1);Ae(this,h,this.getHash())}}isVisible(v){if(w(this,c).size===0)return!0;if(!v)return(0,n.warn)("Optional content group not defined."),!0;if(v.type==="OCG")return w(this,c).has(v.id)?w(this,c).get(v.id).visible:((0,n.warn)(`Optional content group not found: ${v.id}`),!0);if(v.type==="OCMD"){if(v.expression)return me(this,p,tn).call(this,v.expression);if(!v.policy||v.policy==="AnyOn"){for(const y of v.ids){if(!w(this,c).has(y))return(0,n.warn)(`Optional content group not found: ${y}`),!0;if(w(this,c).get(y).visible)return!0}return!1}else if(v.policy==="AllOn"){for(const y of v.ids){if(!w(this,c).has(y))return(0,n.warn)(`Optional content group not found: ${y}`),!0;if(!w(this,c).get(y).visible)return!1}return!0}else if(v.policy==="AnyOff"){for(const y of v.ids){if(!w(this,c).has(y))return(0,n.warn)(`Optional content group not found: ${y}`),!0;if(!w(this,c).get(y).visible)return!0}return!1}else if(v.policy==="AllOff"){for(const y of v.ids){if(!w(this,c).has(y))return(0,n.warn)(`Optional content group not found: ${y}`),!0;if(w(this,c).get(y).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${v.policy}.`),!0}return(0,n.warn)(`Unknown group type ${v.type}.`),!0}setVisibility(v){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!w(this,c).has(v)){(0,n.warn)(`Optional content group not found: ${v}`);return}w(this,c).get(v)._setVisible(i,!!y),Ae(this,l,null)}get hasInitialVisibility(){return this.getHash()===w(this,h)}getOrder(){return w(this,c).size?w(this,d)?w(this,d).slice():[...w(this,c).keys()]:null}getGroups(){return w(this,c).size>0?(0,n.objectFromMap)(w(this,c)):null}getGroup(v){return w(this,c).get(v)||null}getHash(){if(w(this,l)!==null)return w(this,l);const v=new r.MurmurHash3_64;for(const[y,x]of w(this,c))v.update(`${y}:${x.visible}`);return Ae(this,l,v.hexdigest())}}l=new WeakMap,c=new WeakMap,h=new WeakMap,d=new WeakMap,p=new WeakSet,tn=function(v){const y=v.length;if(y<2)return!0;const x=v[0];for(let R=1;R<y;R++){const k=v[R];let m;if(Array.isArray(k))m=me(this,p,tn).call(this,k);else if(w(this,c).has(k))m=w(this,c).get(k).visible;else return(0,n.warn)(`Optional content group not found: ${k}`),!0;switch(x){case"And":if(!m)return!1;break;case"Or":if(m)return!0;break;case"Not":return!m;default:return!0}}return x==="And"},e.OptionalContentConfig=a},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0,t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123),t(89);var n=t(1),r=t(167);class i{constructor(l,c){let{length:h,initialData:d,progressiveDone:p=!1,contentDispositionFilename:f=null,disableRange:g=!1,disableStream:v=!1}=l;if((0,n.assert)(c,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=p,this._contentDispositionFilename=f,(d==null?void 0:d.length)>0){const y=d instanceof Uint8Array&&d.byteLength===d.buffer.byteLength?d.buffer:new Uint8Array(d).buffer;this._queuedChunks.push(y)}this._pdfDataRangeTransport=c,this._isStreamingSupported=!v,this._isRangeSupported=!g,this._contentLength=h,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((y,x)=>{this._onReceiveData({begin:y,chunk:x})}),this._pdfDataRangeTransport.addProgressListener((y,x)=>{this._onProgress({loaded:y,total:x})}),this._pdfDataRangeTransport.addProgressiveReadListener(y=>{this._onReceiveData({chunk:y})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(l){let{begin:c,chunk:h}=l;const d=h instanceof Uint8Array&&h.byteLength===h.buffer.byteLength?h.buffer:new Uint8Array(h).buffer;if(c===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(d):this._queuedChunks.push(d);else{const p=this._rangeReaders.some(function(f){return f._begin!==c?!1:(f._enqueue(d),!0)});(0,n.assert)(p,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var l;return((l=this._fullRequestReader)==null?void 0:l._loaded)??0}_onProgress(l){var c,h,d,p;l.total===void 0?(h=(c=this._rangeReaders[0])==null?void 0:c.onProgress)==null||h.call(c,{loaded:l.loaded}):(p=(d=this._fullRequestReader)==null?void 0:d.onProgress)==null||p.call(d,{loaded:l.loaded,total:l.total})}_onProgressiveDone(){var l;(l=this._fullRequestReader)==null||l.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(l){const c=this._rangeReaders.indexOf(l);c>=0&&this._rangeReaders.splice(c,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const l=this._queuedChunks;return this._queuedChunks=null,new o(this,l,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(l,c){if(c<=this._progressiveDataLength)return null;const h=new a(this,l,c);return this._pdfDataRangeTransport.requestDataRange(l,c),this._rangeReaders.push(h),h}cancelAllRequests(l){var c;(c=this._fullRequestReader)==null||c.cancel(l);for(const h of this._rangeReaders.slice(0))h.cancel(l);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=i;class o{constructor(l,c){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;this._stream=l,this._done=h||!1,this._filename=(0,r.isPdfFile)(d)?d:null,this._queuedChunks=c||[],this._loaded=0;for(const p of this._queuedChunks)this._loaded+=p.byteLength;this._requests=[],this._headersReady=Promise.resolve(),l._fullRequestReader=this,this.onProgress=null}_enqueue(l){this._done||(this._requests.length>0?this._requests.shift().resolve({value:l,done:!1}):this._queuedChunks.push(l),this._loaded+=l.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const l=new n.PromiseCapability;return this._requests.push(l),l.promise}cancel(l){this._done=!0;for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class a{constructor(l,c,h){this._stream=l,this._begin=c,this._end=h,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(l){if(!this._done){if(this._requests.length===0)this._queuedChunk=l;else{this._requests.shift().resolve({value:l,done:!1});for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const c=this._queuedChunk;return this._queuedChunk=null,{value:c,done:!1}}if(this._done)return{value:void 0,done:!0};const l=new n.PromiseCapability;return this._requests.push(l),l.promise}cancel(l){this._done=!0;for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0,t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123),t(89);var n=t(1),r=t(181);function i(h,d,p){return{method:"GET",headers:h,signal:p.signal,mode:"cors",credentials:d?"include":"same-origin",redirect:"follow"}}function o(h){const d=new Headers;for(const p in h){const f=h[p];f!==void 0&&d.append(p,f)}return d}function a(h){return h instanceof Uint8Array?h.buffer:h instanceof ArrayBuffer?h:((0,n.warn)(`getArrayBuffer - unexpected data format: ${h}`),new Uint8Array(h).buffer)}class u{constructor(d){this.source=d,this.isHttp=/^https?:/i.test(d.url),this.httpHeaders=this.isHttp&&d.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var d;return((d=this._fullRequestReader)==null?void 0:d._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new l(this),this._fullRequestReader}getRangeReader(d,p){if(p<=this._progressiveDataLength)return null;const f=new c(this,d,p);return this._rangeRequestReaders.push(f),f}cancelAllRequests(d){var p;(p=this._fullRequestReader)==null||p.cancel(d);for(const f of this._rangeRequestReaders.slice(0))f.cancel(d)}}e.PDFFetchStream=u;class l{constructor(d){this._stream=d,this._reader=null,this._loaded=0,this._filename=null;const p=d.source;this._withCredentials=p.withCredentials||!1,this._contentLength=p.length,this._headersCapability=new n.PromiseCapability,this._disableRange=p.disableRange||!1,this._rangeChunkSize=p.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!p.disableStream,this._isRangeSupported=!p.disableRange,this._headers=o(this._stream.httpHeaders);const f=p.url;fetch(f,i(this._headers,this._withCredentials,this._abortController)).then(g=>{if(!(0,r.validateResponseStatus)(g.status))throw(0,r.createResponseStatusError)(g.status,f);this._reader=g.body.getReader(),this._headersCapability.resolve();const v=R=>g.headers.get(R),{allowRangeRequests:y,suggestedLength:x}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:v,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=y,this._contentLength=x||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(v),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var f;await this._headersCapability.promise;const{value:d,done:p}=await this._reader.read();return p?{value:d,done:p}:(this._loaded+=d.byteLength,(f=this.onProgress)==null||f.call(this,{loaded:this._loaded,total:this._contentLength}),{value:a(d),done:!1})}cancel(d){var p;(p=this._reader)==null||p.cancel(d),this._abortController.abort()}}class c{constructor(d,p,f){this._stream=d,this._reader=null,this._loaded=0;const g=d.source;this._withCredentials=g.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!g.disableStream,this._abortController=new AbortController,this._headers=o(this._stream.httpHeaders),this._headers.append("Range",`bytes=${p}-${f-1}`);const v=g.url;fetch(v,i(this._headers,this._withCredentials,this._abortController)).then(y=>{if(!(0,r.validateResponseStatus)(y.status))throw(0,r.createResponseStatusError)(y.status,v);this._readCapability.resolve(),this._reader=y.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var f;await this._readCapability.promise;const{value:d,done:p}=await this._reader.read();return p?{value:d,done:p}:(this._loaded+=d.byteLength,(f=this.onProgress)==null||f.call(this,{loaded:this._loaded}),{value:a(d),done:!1})}cancel(d){var p;(p=this._reader)==null||p.cancel(d),this._abortController.abort()}}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=u,e.extractFilenameFromHeader=a,e.validateRangeRequestCapabilities=o,e.validateResponseStatus=l;var n=t(1),r=t(182),i=t(167);function o(c){let{getResponseHeader:h,isHttp:d,rangeChunkSize:p,disableRange:f}=c;const g={allowRangeRequests:!1,suggestedLength:void 0},v=parseInt(h("Content-Length"),10);return!Number.isInteger(v)||(g.suggestedLength=v,v<=2*p)||f||!d||h("Accept-Ranges")!=="bytes"||(h("Content-Encoding")||"identity")!=="identity"||(g.allowRangeRequests=!0),g}function a(c){const h=c("Content-Disposition");if(h){let d=(0,r.getFilenameFromContentDispositionHeader)(h);if(d.includes("%"))try{d=decodeURIComponent(d)}catch{}if((0,i.isPdfFile)(d))return d}return null}function u(c,h){return c===404||c===0&&h.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+h+'".'):new n.UnexpectedResponseException(`Unexpected server response (${c}) while retrieving PDF "${h}".`,c)}function l(c){return c===200||c===206}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=r,t(89),t(148);var n=t(1);function r(i){let o=!0,a=u("filename\\*","i").exec(i);if(a){a=a[1];let g=d(a);return g=unescape(g),g=p(g),g=f(g),c(g)}if(a=h(i),a){const g=f(a);return c(g)}if(a=u("filename","i").exec(i),a){a=a[1];let g=d(a);return g=f(g),c(g)}function u(g,v){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',v)}function l(g,v){if(g){if(!/^[\x00-\xFF]+$/.test(v))return v;try{const y=new TextDecoder(g,{fatal:!0}),x=(0,n.stringToBytes)(v);v=y.decode(x),o=!1}catch{}}return v}function c(g){return o&&/[\x80-\xff]/.test(g)&&(g=l("utf-8",g),o&&(g=l("iso-8859-1",g))),g}function h(g){const v=[];let y;const x=u("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=x.exec(g))!==null;){let[,k,m,b]=y;if(k=parseInt(k,10),k in v){if(k===0)break;continue}v[k]=[m,b]}const R=[];for(let k=0;k<v.length&&k in v;++k){let[m,b]=v[k];b=d(b),m&&(b=unescape(b),k===0&&(b=p(b))),R.push(b)}return R.join("")}function d(g){if(g.startsWith('"')){const v=g.slice(1).split('\\"');for(let y=0;y<v.length;++y){const x=v[y].indexOf('"');x!==-1&&(v[y]=v[y].slice(0,x),v.length=y+1),v[y]=v[y].replaceAll(/\\(.)/g,"$1")}g=v.join('"')}return g}function p(g){const v=g.indexOf("'");if(v===-1)return g;const y=g.slice(0,v),R=g.slice(v+1).replace(/^[^']*'/,"");return l(y,R)}function f(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(v,y,x,R){if(x==="q"||x==="Q")return R=R.replaceAll("_"," "),R=R.replaceAll(/=([0-9a-fA-F]{2})/g,function(k,m){return String.fromCharCode(parseInt(m,16))}),l(y,R);try{R=atob(R)}catch{}return l(y,R)})}return""}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0,t(89);var n=t(1),r=t(181);const i=200,o=206;function a(d){const p=d.response;return typeof p!="string"?p:(0,n.stringToBytes)(p).buffer}class u{constructor(p){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.url=p,this.isHttp=/^https?:/i.test(p),this.httpHeaders=this.isHttp&&f.httpHeaders||Object.create(null),this.withCredentials=f.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(p,f,g){const v={begin:p,end:f};for(const y in g)v[y]=g[y];return this.request(v)}requestFull(p){return this.request(p)}request(p){const f=new XMLHttpRequest,g=this.currXhrId++,v=this.pendingRequests[g]={xhr:f};f.open("GET",this.url),f.withCredentials=this.withCredentials;for(const y in this.httpHeaders){const x=this.httpHeaders[y];x!==void 0&&f.setRequestHeader(y,x)}return this.isHttp&&"begin"in p&&"end"in p?(f.setRequestHeader("Range",`bytes=${p.begin}-${p.end-1}`),v.expectedStatus=o):v.expectedStatus=i,f.responseType="arraybuffer",p.onError&&(f.onerror=function(y){p.onError(f.status)}),f.onreadystatechange=this.onStateChange.bind(this,g),f.onprogress=this.onProgress.bind(this,g),v.onHeadersReceived=p.onHeadersReceived,v.onDone=p.onDone,v.onError=p.onError,v.onProgress=p.onProgress,f.send(null),g}onProgress(p,f){var v;const g=this.pendingRequests[p];g&&((v=g.onProgress)==null||v.call(g,f))}onStateChange(p,f){var k,m,b;const g=this.pendingRequests[p];if(!g)return;const v=g.xhr;if(v.readyState>=2&&g.onHeadersReceived&&(g.onHeadersReceived(),delete g.onHeadersReceived),v.readyState!==4||!(p in this.pendingRequests))return;if(delete this.pendingRequests[p],v.status===0&&this.isHttp){(k=g.onError)==null||k.call(g,v.status);return}const y=v.status||i;if(!(y===i&&g.expectedStatus===o)&&y!==g.expectedStatus){(m=g.onError)==null||m.call(g,v.status);return}const R=a(v);if(y===o){const I=v.getResponseHeader("Content-Range"),_=/bytes (\d+)-(\d+)\/(\d+)/.exec(I);g.onDone({begin:parseInt(_[1],10),chunk:R})}else R?g.onDone({begin:0,chunk:R}):(b=g.onError)==null||b.call(g,v.status)}getRequestXhr(p){return this.pendingRequests[p].xhr}isPendingRequest(p){return p in this.pendingRequests}abortRequest(p){const f=this.pendingRequests[p].xhr;delete this.pendingRequests[p],f.abort()}}class l{constructor(p){this._source=p,this._manager=new u(p.url,{httpHeaders:p.httpHeaders,withCredentials:p.withCredentials}),this._rangeChunkSize=p.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(p){const f=this._rangeRequestReaders.indexOf(p);f>=0&&this._rangeRequestReaders.splice(f,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new c(this._manager,this._source),this._fullRequestReader}getRangeReader(p,f){const g=new h(this._manager,p,f);return g.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(g),g}cancelAllRequests(p){var f;(f=this._fullRequestReader)==null||f.cancel(p);for(const g of this._rangeRequestReaders.slice(0))g.cancel(p)}}e.PDFNetworkStream=l;class c{constructor(p,f){this._manager=p;const g={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=f.url,this._fullRequestId=p.requestFull(g),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=f.disableRange||!1,this._contentLength=f.length,this._rangeChunkSize=f.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const p=this._fullRequestId,f=this._manager.getRequestXhr(p),g=x=>f.getResponseHeader(x),{allowRangeRequests:v,suggestedLength:y}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});v&&(this._isRangeSupported=!0),this._contentLength=y||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(g),this._isRangeSupported&&this._manager.abortRequest(p),this._headersReceivedCapability.resolve()}_onDone(p){if(p&&(this._requests.length>0?this._requests.shift().resolve({value:p.chunk,done:!1}):this._cachedChunks.push(p.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(p){this._storedError=(0,r.createResponseStatusError)(p,this._url),this._headersReceivedCapability.reject(this._storedError);for(const f of this._requests)f.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(p){var f;(f=this.onProgress)==null||f.call(this,{loaded:p.loaded,total:p.lengthComputable?p.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const p=new n.PromiseCapability;return this._requests.push(p),p.promise}cancel(p){this._done=!0,this._headersReceivedCapability.reject(p);for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class h{constructor(p,f,g){this._manager=p;const v={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=p.url,this._requestId=p.requestRange(f,g,v),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var p;(p=this.onClosed)==null||p.call(this,this)}_onDone(p){const f=p.chunk;this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunk=f,this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(p){this._storedError=(0,r.createResponseStatusError)(p,this._url);for(const f of this._requests)f.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(p){var f;this.isStreamingSupported||(f=this.onProgress)==null||f.call(this,{loaded:p.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const f=this._queuedChunk;return this._queuedChunk=null,{value:f,done:!1}}if(this._done)return{value:void 0,done:!0};const p=new n.PromiseCapability;return this._requests.push(p),p.promise}cancel(p){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0,t(89),t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123);var n=t(1),r=t(181);const i=/^file:\/\/\/[a-zA-Z]:\//;function o(g){const v=require$$6,y=v.parse(g);return y.protocol==="file:"||y.host?y:/^[a-z]:[/\\]/i.test(g)?v.parse(`file:///${g}`):(y.host||(y.protocol="file:"),y)}class a{constructor(v){this.source=v,this.url=o(v.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&v.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var v;return((v=this._fullRequestReader)==null?void 0:v._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new p(this):new h(this),this._fullRequestReader}getRangeReader(v,y){if(y<=this._progressiveDataLength)return null;const x=this.isFsUrl?new f(this,v,y):new d(this,v,y);return this._rangeRequestReaders.push(x),x}cancelAllRequests(v){var y;(y=this._fullRequestReader)==null||y.cancel(v);for(const x of this._rangeRequestReaders.slice(0))x.cancel(v)}}e.PDFNodeStream=a;class u{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null;const y=v.source;this._contentLength=y.length,this._loaded=0,this._filename=null,this._disableRange=y.disableRange||!1,this._rangeChunkSize=y.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!y.disableStream,this._isRangeSupported=!y.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var x;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const v=this._readableStream.read();return v===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=v.length,(x=this.onProgress)==null||x.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",y=>{this._error(y)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class l{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const y=v.source;this._isStreamingSupported=!y.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var x;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const v=this._readableStream.read();return v===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=v.length,(x=this.onProgress)==null||x.call(this,{loaded:this._loaded}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",y=>{this._error(y)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function c(g,v){return{protocol:g.protocol,auth:g.auth,host:g.hostname,port:g.port,path:g.path,method:"GET",headers:v}}class h extends u{constructor(v){super(v);const y=x=>{if(x.statusCode===404){const b=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=b,this._headersCapability.reject(b);return}this._headersCapability.resolve(),this._setReadableStream(x);const R=b=>this._readableStream.headers[b.toLowerCase()],{allowRangeRequests:k,suggestedLength:m}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:R,isHttp:v.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=k,this._contentLength=m||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(R)};if(this._request=null,this._url.protocol==="http:"){const x=require$$6;this._request=x.request(c(this._url,v.httpHeaders),y)}else{const x=require$$6;this._request=x.request(c(this._url,v.httpHeaders),y)}this._request.on("error",x=>{this._storedError=x,this._headersCapability.reject(x)}),this._request.end()}}class d extends l{constructor(v,y,x){super(v),this._httpHeaders={};for(const k in v.httpHeaders){const m=v.httpHeaders[k];m!==void 0&&(this._httpHeaders[k]=m)}this._httpHeaders.Range=`bytes=${y}-${x-1}`;const R=k=>{if(k.statusCode===404){const m=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=m;return}this._setReadableStream(k)};if(this._request=null,this._url.protocol==="http:"){const k=require$$6;this._request=k.request(c(this._url,this._httpHeaders),R)}else{const k=require$$6;this._request=k.request(c(this._url,this._httpHeaders),R)}this._request.on("error",k=>{this._storedError=k}),this._request.end()}}class p extends u{constructor(v){super(v);let y=decodeURIComponent(this._url.path);i.test(this._url.href)&&(y=y.replace(/^\//,""));const x=require$$6;x.lstat(y,(R,k)=>{if(R){R.code==="ENOENT"&&(R=new n.MissingPDFException(`Missing PDF "${y}".`)),this._storedError=R,this._headersCapability.reject(R);return}this._contentLength=k.size,this._setReadableStream(x.createReadStream(y)),this._headersCapability.resolve()})}}class f extends l{constructor(v,y,x){super(v);let R=decodeURIComponent(this._url.path);i.test(this._url.href)&&(R=R.replace(/^\//,""));const k=require$$6;this._setReadableStream(k.createReadStream(R,{start:y,end:x-1}))}}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0,t(84),t(86),t(87),t(93),t(101),t(102),t(105),t(107),t(109),t(113),t(116),t(123),t(2),t(89),t(186);var n=t(167),r=t(1);const i={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},o="http://www.w3.org/XML/1998/namespace",a="http://www.w3.org/1999/xlink",u=["butt","round","square"],l=["miter","round","bevel"],c=function(k){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(URL.createObjectURL&&typeof Blob<"u"&&!b)return URL.createObjectURL(new Blob([k],{type:m}));const I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let _=`data:${m};base64,`;for(let S=0,T=k.length;S<T;S+=3){const E=k[S]&255,L=k[S+1]&255,$=k[S+2]&255,Y=E>>2,V=(E&3)<<4|L>>4,j=S+1<T?(L&15)<<2|$>>6:64,G=S+2<T?$&63:64;_+=I[Y]+I[V]+I[j]+I[G]}return _},h=function(){const k=new Uint8Array([137,80,78,71,13,10,26,10]),m=12,b=new Int32Array(256);for(let $=0;$<256;$++){let Y=$;for(let V=0;V<8;V++)Y=Y&1?3988292384^Y>>1&2147483647:Y>>1&2147483647;b[$]=Y}function I($,Y,V){let j=-1;for(let G=Y;G<V;G++){const X=(j^$[G])&255,q=b[X];j=j>>>8^q}return j^-1}function _($,Y,V,j){let G=j;const X=Y.length;V[G]=X>>24&255,V[G+1]=X>>16&255,V[G+2]=X>>8&255,V[G+3]=X&255,G+=4,V[G]=$.charCodeAt(0)&255,V[G+1]=$.charCodeAt(1)&255,V[G+2]=$.charCodeAt(2)&255,V[G+3]=$.charCodeAt(3)&255,G+=4,V.set(Y,G),G+=Y.length;const q=I(V,j+4,G);V[G]=q>>24&255,V[G+1]=q>>16&255,V[G+2]=q>>8&255,V[G+3]=q&255}function S($,Y,V){let j=1,G=0;for(let X=Y;X<V;++X)j=(j+($[X]&255))%65521,G=(G+j)%65521;return G<<16|j}function T($){if(!r.isNodeJS)return E($);try{const Y=parseInt(process.versions.node)>=8?$:Buffer.from($),V=require$$6.deflateSync(Y,{level:9});return V instanceof Uint8Array?V:new Uint8Array(V)}catch(Y){(0,r.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Y)}return E($)}function E($){let Y=$.length;const V=65535,j=Math.ceil(Y/V),G=new Uint8Array(2+Y+j*5+4);let X=0;G[X++]=120,G[X++]=156;let q=0;for(;Y>V;)G[X++]=0,G[X++]=255,G[X++]=255,G[X++]=0,G[X++]=0,G.set($.subarray(q,q+V),X),X+=V,q+=V,Y-=V;G[X++]=1,G[X++]=Y&255,G[X++]=Y>>8&255,G[X++]=~Y&65535&255,G[X++]=(~Y&65535)>>8&255,G.set($.subarray(q),X),X+=$.length-q;const Z=S($,0,$.length);return G[X++]=Z>>24&255,G[X++]=Z>>16&255,G[X++]=Z>>8&255,G[X++]=Z&255,G}function L($,Y,V,j){const G=$.width,X=$.height;let q,Z,J;const ve=$.data;switch(Y){case r.ImageKind.GRAYSCALE_1BPP:Z=0,q=1,J=G+7>>3;break;case r.ImageKind.RGB_24BPP:Z=2,q=8,J=G*3;break;case r.ImageKind.RGBA_32BPP:Z=6,q=8,J=G*4;break;default:throw new Error("invalid format")}const K=new Uint8Array((1+J)*X);let O=0,N=0;for(let re=0;re<X;++re)K[O++]=0,K.set(ve.subarray(N,N+J),O),N+=J,O+=J;if(Y===r.ImageKind.GRAYSCALE_1BPP&&j){O=0;for(let re=0;re<X;re++){O++;for(let pe=0;pe<J;pe++)K[O++]^=255}}const F=new Uint8Array([G>>24&255,G>>16&255,G>>8&255,G&255,X>>24&255,X>>16&255,X>>8&255,X&255,q,Z,0,0,0]),z=T(K),D=k.length+m*3+F.length+z.length,U=new Uint8Array(D);let ee=0;return U.set(k,ee),ee+=k.length,_("IHDR",F,U,ee),ee+=m+F.length,_("IDATA",z,U,ee),ee+=m+z.length,_("IEND",new Uint8Array(0),U,ee),c(U,"image/png",V)}return function(Y,V,j){const G=Y.kind===void 0?r.ImageKind.GRAYSCALE_1BPP:Y.kind;return L(Y,G,V,j)}}();class d{constructor(){this.fontSizeScale=1,this.fontWeight=i.fontWeight,this.fontSize=0,this.textMatrix=r.IDENTITY_MATRIX,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=r.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=i.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(m,b){this.x=m,this.y=b}}function p(k){let m=[];const b=[];for(const I of k){if(I.fn==="save"){m.push({fnId:92,fn:"group",items:[]}),b.push(m),m=m.at(-1).items;continue}I.fn==="restore"?m=b.pop():m.push(I)}return m}function f(k){if(Number.isInteger(k))return k.toString();const m=k.toFixed(10);let b=m.length-1;if(m[b]!=="0")return m;do b--;while(m[b]==="0");return m.substring(0,m[b]==="."?b:b+1)}function g(k){if(k[4]===0&&k[5]===0){if(k[1]===0&&k[2]===0)return k[0]===1&&k[3]===1?"":`scale(${f(k[0])} ${f(k[3])})`;if(k[0]===k[3]&&k[1]===-k[2]){const m=Math.acos(k[0])*180/Math.PI;return`rotate(${f(m)})`}}else if(k[0]===1&&k[1]===0&&k[2]===0&&k[3]===1)return`translate(${f(k[4])} ${f(k[5])})`;return`matrix(${f(k[0])} ${f(k[1])} ${f(k[2])} ${f(k[3])} ${f(k[4])} ${f(k[5])})`}let v=0,y=0,x=0;class R{constructor(m,b){let I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new d,this.transformMatrix=r.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=m,this.objs=b,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!I,this._operatorIdMapping=[];for(const _ in r.OPS)this._operatorIdMapping[r.OPS[_]]=_}getObject(m){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return typeof m=="string"?m.startsWith("g_")?this.commonObjs.get(m):this.objs.get(m):b}save(){this.transformStack.push(this.transformMatrix);const m=this.current;this.extraStack.push(m),this.current=m.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(m){this.save(),this.executeOpTree(m),this.restore()}loadDependencies(m){const b=m.fnArray,I=m.argsArray;for(let _=0,S=b.length;_<S;_++)if(b[_]===r.OPS.dependency)for(const T of I[_]){const E=T.startsWith("g_")?this.commonObjs:this.objs,L=new Promise($=>{E.get(T,$)});this.current.dependencies.push(L)}return Promise.all(this.current.dependencies)}transform(m,b,I,_,S,T){const E=[m,b,I,_,S,T];this.transformMatrix=r.Util.transform(this.transformMatrix,E),this.tgrp=null}getSVG(m,b){this.viewport=b;const I=this._initialize(b);return this.loadDependencies(m).then(()=>(this.transformMatrix=r.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(m)),I))}convertOpList(m){const b=this._operatorIdMapping,I=m.argsArray,_=m.fnArray,S=[];for(let T=0,E=_.length;T<E;T++){const L=_[T];S.push({fnId:L,fn:b[L],args:I[T]})}return p(S)}executeOpTree(m){for(const b of m){const I=b.fn,_=b.fnId,S=b.args;switch(_|0){case r.OPS.beginText:this.beginText();break;case r.OPS.dependency:break;case r.OPS.setLeading:this.setLeading(S);break;case r.OPS.setLeadingMoveText:this.setLeadingMoveText(S[0],S[1]);break;case r.OPS.setFont:this.setFont(S);break;case r.OPS.showText:this.showText(S[0]);break;case r.OPS.showSpacedText:this.showText(S[0]);break;case r.OPS.endText:this.endText();break;case r.OPS.moveText:this.moveText(S[0],S[1]);break;case r.OPS.setCharSpacing:this.setCharSpacing(S[0]);break;case r.OPS.setWordSpacing:this.setWordSpacing(S[0]);break;case r.OPS.setHScale:this.setHScale(S[0]);break;case r.OPS.setTextMatrix:this.setTextMatrix(S[0],S[1],S[2],S[3],S[4],S[5]);break;case r.OPS.setTextRise:this.setTextRise(S[0]);break;case r.OPS.setTextRenderingMode:this.setTextRenderingMode(S[0]);break;case r.OPS.setLineWidth:this.setLineWidth(S[0]);break;case r.OPS.setLineJoin:this.setLineJoin(S[0]);break;case r.OPS.setLineCap:this.setLineCap(S[0]);break;case r.OPS.setMiterLimit:this.setMiterLimit(S[0]);break;case r.OPS.setFillRGBColor:this.setFillRGBColor(S[0],S[1],S[2]);break;case r.OPS.setStrokeRGBColor:this.setStrokeRGBColor(S[0],S[1],S[2]);break;case r.OPS.setStrokeColorN:this.setStrokeColorN(S);break;case r.OPS.setFillColorN:this.setFillColorN(S);break;case r.OPS.shadingFill:this.shadingFill(S[0]);break;case r.OPS.setDash:this.setDash(S[0],S[1]);break;case r.OPS.setRenderingIntent:this.setRenderingIntent(S[0]);break;case r.OPS.setFlatness:this.setFlatness(S[0]);break;case r.OPS.setGState:this.setGState(S[0]);break;case r.OPS.fill:this.fill();break;case r.OPS.eoFill:this.eoFill();break;case r.OPS.stroke:this.stroke();break;case r.OPS.fillStroke:this.fillStroke();break;case r.OPS.eoFillStroke:this.eoFillStroke();break;case r.OPS.clip:this.clip("nonzero");break;case r.OPS.eoClip:this.clip("evenodd");break;case r.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case r.OPS.paintImageXObject:this.paintImageXObject(S[0]);break;case r.OPS.paintInlineImageXObject:this.paintInlineImageXObject(S[0]);break;case r.OPS.paintImageMaskXObject:this.paintImageMaskXObject(S[0]);break;case r.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(S[0],S[1]);break;case r.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case r.OPS.closePath:this.closePath();break;case r.OPS.closeStroke:this.closeStroke();break;case r.OPS.closeFillStroke:this.closeFillStroke();break;case r.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case r.OPS.nextLine:this.nextLine();break;case r.OPS.transform:this.transform(S[0],S[1],S[2],S[3],S[4],S[5]);break;case r.OPS.constructPath:this.constructPath(S[0],S[1]);break;case r.OPS.endPath:this.endPath();break;case 92:this.group(b.items);break;default:(0,r.warn)(`Unimplemented operator ${I}`);break}}}setWordSpacing(m){this.current.wordSpacing=m}setCharSpacing(m){this.current.charSpacing=m}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(m,b,I,_,S,T){const E=this.current;E.textMatrix=E.lineMatrix=[m,b,I,_,S,T],E.textMatrixScale=Math.hypot(m,b),E.x=E.lineX=0,E.y=E.lineY=0,E.xcoords=[],E.ycoords=[],E.tspan=this.svgFactory.createElement("svg:tspan"),E.tspan.setAttributeNS(null,"font-family",E.fontFamily),E.tspan.setAttributeNS(null,"font-size",`${f(E.fontSize)}px`),E.tspan.setAttributeNS(null,"y",f(-E.y)),E.txtElement=this.svgFactory.createElement("svg:text"),E.txtElement.append(E.tspan)}beginText(){const m=this.current;m.x=m.lineX=0,m.y=m.lineY=0,m.textMatrix=r.IDENTITY_MATRIX,m.lineMatrix=r.IDENTITY_MATRIX,m.textMatrixScale=1,m.tspan=this.svgFactory.createElement("svg:tspan"),m.txtElement=this.svgFactory.createElement("svg:text"),m.txtgrp=this.svgFactory.createElement("svg:g"),m.xcoords=[],m.ycoords=[]}moveText(m,b){const I=this.current;I.x=I.lineX+=m,I.y=I.lineY+=b,I.xcoords=[],I.ycoords=[],I.tspan=this.svgFactory.createElement("svg:tspan"),I.tspan.setAttributeNS(null,"font-family",I.fontFamily),I.tspan.setAttributeNS(null,"font-size",`${f(I.fontSize)}px`),I.tspan.setAttributeNS(null,"y",f(-I.y))}showText(m){const b=this.current,I=b.font,_=b.fontSize;if(_===0)return;const S=b.fontSizeScale,T=b.charSpacing,E=b.wordSpacing,L=b.fontDirection,$=b.textHScale*L,Y=I.vertical,V=Y?1:-1,j=I.defaultVMetrics,G=_*b.fontMatrix[0];let X=0;for(const J of m){if(J===null){X+=L*E;continue}else if(typeof J=="number"){X+=V*J*_/1e3;continue}const ve=(J.isSpace?E:0)+T,K=J.fontChar;let O,N,F=J.width;if(Y){let D;const U=J.vmetric||j;D=J.vmetric?U[1]:F*.5,D=-D*G;const ee=U[2]*G;F=U?-U[0]:F,O=D/S,N=(X+ee)/S}else O=X/S,N=0;(J.isInFont||I.missingFile)&&(b.xcoords.push(b.x+O),Y&&b.ycoords.push(-b.y+N),b.tspan.textContent+=K);const z=Y?F*G-ve*L:F*G+ve*L;X+=z}b.tspan.setAttributeNS(null,"x",b.xcoords.map(f).join(" ")),Y?b.tspan.setAttributeNS(null,"y",b.ycoords.map(f).join(" ")):b.tspan.setAttributeNS(null,"y",f(-b.y)),Y?b.y-=X:b.x+=X*$,b.tspan.setAttributeNS(null,"font-family",b.fontFamily),b.tspan.setAttributeNS(null,"font-size",`${f(b.fontSize)}px`),b.fontStyle!==i.fontStyle&&b.tspan.setAttributeNS(null,"font-style",b.fontStyle),b.fontWeight!==i.fontWeight&&b.tspan.setAttributeNS(null,"font-weight",b.fontWeight);const q=b.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;if(q===r.TextRenderingMode.FILL||q===r.TextRenderingMode.FILL_STROKE?(b.fillColor!==i.fillColor&&b.tspan.setAttributeNS(null,"fill",b.fillColor),b.fillAlpha<1&&b.tspan.setAttributeNS(null,"fill-opacity",b.fillAlpha)):b.textRenderingMode===r.TextRenderingMode.ADD_TO_PATH?b.tspan.setAttributeNS(null,"fill","transparent"):b.tspan.setAttributeNS(null,"fill","none"),q===r.TextRenderingMode.STROKE||q===r.TextRenderingMode.FILL_STROKE){const J=1/(b.textMatrixScale||1);this._setStrokeAttributes(b.tspan,J)}let Z=b.textMatrix;b.textRise!==0&&(Z=Z.slice(),Z[5]+=b.textRise),b.txtElement.setAttributeNS(null,"transform",`${g(Z)} scale(${f($)}, -1)`),b.txtElement.setAttributeNS(o,"xml:space","preserve"),b.txtElement.append(b.tspan),b.txtgrp.append(b.txtElement),this._ensureTransformGroup().append(b.txtElement)}setLeadingMoveText(m,b){this.setLeading(-b),this.moveText(m,b)}addFontStyle(m){if(!m.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const b=c(m.data,m.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${m.loadedName}"; src: url(${b}); }
`}setFont(m){const b=this.current,I=this.commonObjs.get(m[0]);let _=m[1];b.font=I,this.embedFonts&&!I.missingFile&&!this.embeddedFonts[I.loadedName]&&(this.addFontStyle(I),this.embeddedFonts[I.loadedName]=I),b.fontMatrix=I.fontMatrix||r.FONT_IDENTITY_MATRIX;let S="normal";I.black?S="900":I.bold&&(S="bold");const T=I.italic?"italic":"normal";_<0?(_=-_,b.fontDirection=-1):b.fontDirection=1,b.fontSize=_,b.fontFamily=I.loadedName,b.fontWeight=S,b.fontStyle=T,b.tspan=this.svgFactory.createElement("svg:tspan"),b.tspan.setAttributeNS(null,"y",f(-b.y)),b.xcoords=[],b.ycoords=[]}endText(){var b;const m=this.current;m.textRenderingMode&r.TextRenderingMode.ADD_TO_PATH_FLAG&&((b=m.txtElement)!=null&&b.hasChildNodes())&&(m.element=m.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(m){m>0&&(this.current.lineWidth=m)}setLineCap(m){this.current.lineCap=u[m]}setLineJoin(m){this.current.lineJoin=l[m]}setMiterLimit(m){this.current.miterLimit=m}setStrokeAlpha(m){this.current.strokeAlpha=m}setStrokeRGBColor(m,b,I){this.current.strokeColor=r.Util.makeHexColor(m,b,I)}setFillAlpha(m){this.current.fillAlpha=m}setFillRGBColor(m,b,I){this.current.fillColor=r.Util.makeHexColor(m,b,I),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(m){this.current.strokeColor=this._makeColorN_Pattern(m)}setFillColorN(m){this.current.fillColor=this._makeColorN_Pattern(m)}shadingFill(m){const{width:b,height:I}=this.viewport,_=r.Util.inverseTransform(this.transformMatrix),[S,T,E,L]=r.Util.getAxialAlignedBoundingBox([0,0,b,I],_),$=this.svgFactory.createElement("svg:rect");$.setAttributeNS(null,"x",S),$.setAttributeNS(null,"y",T),$.setAttributeNS(null,"width",E-S),$.setAttributeNS(null,"height",L-T),$.setAttributeNS(null,"fill",this._makeShadingPattern(m)),this.current.fillAlpha<1&&$.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append($)}_makeColorN_Pattern(m){return m[0]==="TilingPattern"?this._makeTilingPattern(m):this._makeShadingPattern(m)}_makeTilingPattern(m){const b=m[1],I=m[2],_=m[3]||r.IDENTITY_MATRIX,[S,T,E,L]=m[4],$=m[5],Y=m[6],V=m[7],j=`shading${x++}`,[G,X,q,Z]=r.Util.normalizeRect([...r.Util.applyTransform([S,T],_),...r.Util.applyTransform([E,L],_)]),[J,ve]=r.Util.singularValueDecompose2dScale(_),K=$*J,O=Y*ve,N=this.svgFactory.createElement("svg:pattern");N.setAttributeNS(null,"id",j),N.setAttributeNS(null,"patternUnits","userSpaceOnUse"),N.setAttributeNS(null,"width",K),N.setAttributeNS(null,"height",O),N.setAttributeNS(null,"x",`${G}`),N.setAttributeNS(null,"y",`${X}`);const F=this.svg,z=this.transformMatrix,D=this.current.fillColor,U=this.current.strokeColor,ee=this.svgFactory.create(q-G,Z-X);if(this.svg=ee,this.transformMatrix=_,V===2){const re=r.Util.makeHexColor(...b);this.current.fillColor=re,this.current.strokeColor=re}return this.executeOpTree(this.convertOpList(I)),this.svg=F,this.transformMatrix=z,this.current.fillColor=D,this.current.strokeColor=U,N.append(ee.childNodes[0]),this.defs.append(N),`url(#${j})`}_makeShadingPattern(m){switch(typeof m=="string"&&(m=this.objs.get(m)),m[0]){case"RadialAxial":const b=`shading${x++}`,I=m[3];let _;switch(m[1]){case"axial":const S=m[4],T=m[5];_=this.svgFactory.createElement("svg:linearGradient"),_.setAttributeNS(null,"id",b),_.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),_.setAttributeNS(null,"x1",S[0]),_.setAttributeNS(null,"y1",S[1]),_.setAttributeNS(null,"x2",T[0]),_.setAttributeNS(null,"y2",T[1]);break;case"radial":const E=m[4],L=m[5],$=m[6],Y=m[7];_=this.svgFactory.createElement("svg:radialGradient"),_.setAttributeNS(null,"id",b),_.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),_.setAttributeNS(null,"cx",L[0]),_.setAttributeNS(null,"cy",L[1]),_.setAttributeNS(null,"r",Y),_.setAttributeNS(null,"fx",E[0]),_.setAttributeNS(null,"fy",E[1]),_.setAttributeNS(null,"fr",$);break;default:throw new Error(`Unknown RadialAxial type: ${m[1]}`)}for(const S of I){const T=this.svgFactory.createElement("svg:stop");T.setAttributeNS(null,"offset",S[0]),T.setAttributeNS(null,"stop-color",S[1]),_.append(T)}return this.defs.append(_),`url(#${b})`;case"Mesh":return(0,r.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${m[0]}`)}}setDash(m,b){this.current.dashArray=m,this.current.dashPhase=b}constructPath(m,b){const I=this.current;let _=I.x,S=I.y,T=[],E=0;for(const L of m)switch(L|0){case r.OPS.rectangle:_=b[E++],S=b[E++];const $=b[E++],Y=b[E++],V=_+$,j=S+Y;T.push("M",f(_),f(S),"L",f(V),f(S),"L",f(V),f(j),"L",f(_),f(j),"Z");break;case r.OPS.moveTo:_=b[E++],S=b[E++],T.push("M",f(_),f(S));break;case r.OPS.lineTo:_=b[E++],S=b[E++],T.push("L",f(_),f(S));break;case r.OPS.curveTo:_=b[E+4],S=b[E+5],T.push("C",f(b[E]),f(b[E+1]),f(b[E+2]),f(b[E+3]),f(_),f(S)),E+=6;break;case r.OPS.curveTo2:T.push("C",f(_),f(S),f(b[E]),f(b[E+1]),f(b[E+2]),f(b[E+3])),_=b[E+2],S=b[E+3],E+=4;break;case r.OPS.curveTo3:_=b[E+2],S=b[E+3],T.push("C",f(b[E]),f(b[E+1]),f(_),f(S),f(_),f(S)),E+=4;break;case r.OPS.closePath:T.push("Z");break}T=T.join(" "),I.path&&m.length>0&&m[0]!==r.OPS.rectangle&&m[0]!==r.OPS.moveTo?T=I.path.getAttributeNS(null,"d")+T:(I.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(I.path)),I.path.setAttributeNS(null,"d",T),I.path.setAttributeNS(null,"fill","none"),I.element=I.path,I.setCurrentPoint(_,S)}endPath(){const m=this.current;if(m.path=null,!this.pendingClip)return;if(!m.element){this.pendingClip=null;return}const b=`clippath${v++}`,I=this.svgFactory.createElement("svg:clipPath");I.setAttributeNS(null,"id",b),I.setAttributeNS(null,"transform",g(this.transformMatrix));const _=m.element.cloneNode(!0);if(this.pendingClip==="evenodd"?_.setAttributeNS(null,"clip-rule","evenodd"):_.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,I.append(_),this.defs.append(I),m.activeClipUrl){m.clipGroup=null;for(const S of this.extraStack)S.clipGroup=null;I.setAttributeNS(null,"clip-path",m.activeClipUrl)}m.activeClipUrl=`url(#${b})`,this.tgrp=null}clip(m){this.pendingClip=m}closePath(){const m=this.current;if(m.path){const b=`${m.path.getAttributeNS(null,"d")}Z`;m.path.setAttributeNS(null,"d",b)}}setLeading(m){this.current.leading=-m}setTextRise(m){this.current.textRise=m}setTextRenderingMode(m){this.current.textRenderingMode=m}setHScale(m){this.current.textHScale=m/100}setRenderingIntent(m){}setFlatness(m){}setGState(m){for(const[b,I]of m)switch(b){case"LW":this.setLineWidth(I);break;case"LC":this.setLineCap(I);break;case"LJ":this.setLineJoin(I);break;case"ML":this.setMiterLimit(I);break;case"D":this.setDash(I[0],I[1]);break;case"RI":this.setRenderingIntent(I);break;case"FL":this.setFlatness(I);break;case"Font":this.setFont(I);break;case"CA":this.setStrokeAlpha(I);break;case"ca":this.setFillAlpha(I);break;default:(0,r.warn)(`Unimplemented graphic state operator ${b}`);break}}fill(){const m=this.current;m.element&&(m.element.setAttributeNS(null,"fill",m.fillColor),m.element.setAttributeNS(null,"fill-opacity",m.fillAlpha),this.endPath())}stroke(){const m=this.current;m.element&&(this._setStrokeAttributes(m.element),m.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(m){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const I=this.current;let _=I.dashArray;b!==1&&_.length>0&&(_=_.map(function(S){return b*S})),m.setAttributeNS(null,"stroke",I.strokeColor),m.setAttributeNS(null,"stroke-opacity",I.strokeAlpha),m.setAttributeNS(null,"stroke-miterlimit",f(I.miterLimit)),m.setAttributeNS(null,"stroke-linecap",I.lineCap),m.setAttributeNS(null,"stroke-linejoin",I.lineJoin),m.setAttributeNS(null,"stroke-width",f(b*I.lineWidth)+"px"),m.setAttributeNS(null,"stroke-dasharray",_.map(f).join(" ")),m.setAttributeNS(null,"stroke-dashoffset",f(b*I.dashPhase)+"px")}eoFill(){var m;(m=this.current.element)==null||m.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var m;(m=this.current.element)==null||m.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const m=this.svgFactory.createElement("svg:rect");m.setAttributeNS(null,"x","0"),m.setAttributeNS(null,"y","0"),m.setAttributeNS(null,"width","1px"),m.setAttributeNS(null,"height","1px"),m.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(m)}paintImageXObject(m){const b=this.getObject(m);if(!b){(0,r.warn)(`Dependent image with object ID ${m} is not ready yet`);return}this.paintInlineImageXObject(b)}paintInlineImageXObject(m,b){const I=m.width,_=m.height,S=h(m,this.forceDataSchema,!!b),T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x","0"),T.setAttributeNS(null,"y","0"),T.setAttributeNS(null,"width",f(I)),T.setAttributeNS(null,"height",f(_)),this.current.element=T,this.clip("nonzero");const E=this.svgFactory.createElement("svg:image");E.setAttributeNS(a,"xlink:href",S),E.setAttributeNS(null,"x","0"),E.setAttributeNS(null,"y",f(-_)),E.setAttributeNS(null,"width",f(I)+"px"),E.setAttributeNS(null,"height",f(_)+"px"),E.setAttributeNS(null,"transform",`scale(${f(1/I)} ${f(-1/_)})`),b?b.append(E):this._ensureTransformGroup().append(E)}paintImageMaskXObject(m){const b=this.getObject(m.data,m);if(b.bitmap){(0,r.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const I=this.current,_=b.width,S=b.height,T=I.fillColor;I.maskId=`mask${y++}`;const E=this.svgFactory.createElement("svg:mask");E.setAttributeNS(null,"id",I.maskId);const L=this.svgFactory.createElement("svg:rect");L.setAttributeNS(null,"x","0"),L.setAttributeNS(null,"y","0"),L.setAttributeNS(null,"width",f(_)),L.setAttributeNS(null,"height",f(S)),L.setAttributeNS(null,"fill",T),L.setAttributeNS(null,"mask",`url(#${I.maskId})`),this.defs.append(E),this._ensureTransformGroup().append(L),this.paintInlineImageXObject(b,E)}paintFormXObjectBegin(m,b){if(Array.isArray(m)&&m.length===6&&this.transform(m[0],m[1],m[2],m[3],m[4],m[5]),b){const I=b[2]-b[0],_=b[3]-b[1],S=this.svgFactory.createElement("svg:rect");S.setAttributeNS(null,"x",b[0]),S.setAttributeNS(null,"y",b[1]),S.setAttributeNS(null,"width",f(I)),S.setAttributeNS(null,"height",f(_)),this.current.element=S,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(m){const b=this.svgFactory.create(m.width,m.height),I=this.svgFactory.createElement("svg:defs");b.append(I),this.defs=I;const _=this.svgFactory.createElement("svg:g");return _.setAttributeNS(null,"transform",g(m.transform)),b.append(_),this.svg=_,b}_ensureClipGroup(){if(!this.current.clipGroup){const m=this.svgFactory.createElement("svg:g");m.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(m),this.current.clipGroup=m}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",g(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=R},(s,e,t)=>{var n=t(3),r=t(187),i=t(192);n({target:"Array",proto:!0},{group:function(a){var u=arguments.length>1?arguments[1]:void 0;return r(this,a,u)}}),i("group")},(s,e,t)=>{var n=t(99),r=t(14),i=t(13),o=t(40),a=t(18),u=t(64),l=t(188),c=t(108),h=Array,d=r([].push);s.exports=function(p,f,g,v){for(var y=o(p),x=i(y),R=n(f,g),k=l(null),m=u(x),b=0,I,_,S;m>b;b++)S=x[b],_=a(R(S,b,y)),_ in k?d(k[_],S):k[_]=[S];if(v&&(I=v(y),I!==h))for(_ in k)k[_]=c(I,k[_]);return k}},(s,e,t)=>{var n=t(47),r=t(189),i=t(66),o=t(55),a=t(191),u=t(43),l=t(54),c=">",h="<",d="prototype",p="script",f=l("IE_PROTO"),g=function(){},v=function(m){return h+p+c+m+h+"/"+p+c},y=function(m){m.write(v("")),m.close();var b=m.parentWindow.Object;return m=null,b},x=function(){var m=u("iframe"),b="java"+p+":",I;return m.style.display="none",a.appendChild(m),m.src=String(b),I=m.contentWindow.document,I.open(),I.write(v("document.F=Object")),I.close(),I.F},R,k=function(){try{R=new ActiveXObject("htmlfile")}catch{}k=typeof document<"u"?document.domain&&R?y(R):x():y(R);for(var m=i.length;m--;)delete k[d][i[m]];return k()};o[f]=!0,s.exports=Object.create||function(b,I){var _;return b!==null?(g[d]=n(b),_=new g,g[d]=null,_[f]=b):_=k(),I===void 0?_:r.f(_,I)}},(s,e,t)=>{var n=t(6),r=t(46),i=t(45),o=t(47),a=t(12),u=t(190);e.f=n&&!r?Object.defineProperties:function(c,h){o(c);for(var d=a(h),p=u(h),f=p.length,g=0,v;f>g;)i.f(c,v=p[g++],d[v]);return c}},(s,e,t)=>{var n=t(59),r=t(66);s.exports=Object.keys||function(o){return n(o,r)}},(s,e,t)=>{var n=t(24);s.exports=n("document","documentElement")},(s,e,t)=>{var n=t(34),r=t(188),i=t(45).f,o=n("unscopables"),a=Array.prototype;a[o]==null&&i(a,o,{configurable:!0,value:r(null)}),s.exports=function(u){a[o][u]=!0}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0,t(89);class n{static textContent(i){const o=[],a={items:o,styles:Object.create(null)};function u(l){var d;if(!l)return;let c=null;const h=l.name;if(h==="#text")c=l.value;else if(n.shouldBuildText(h))(d=l==null?void 0:l.attributes)!=null&&d.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&o.push({str:c}),!!l.children)for(const p of l.children)u(p)}return u(i),a}static shouldBuildText(i){return!(i==="textarea"||i==="input"||i==="option"||i==="select")}}e.XfaText=n},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=g,e.updateTextLayer=v,t(89),t(2);var n=t(1),r=t(167);const i=1e5,o=30,a=.8,u=new Map;function l(y,x){let R;if(x&&n.FeatureTest.isOffscreenCanvasSupported)R=new OffscreenCanvas(y,y).getContext("2d",{alpha:!1});else{const k=document.createElement("canvas");k.width=k.height=y,R=k.getContext("2d",{alpha:!1})}return R}function c(y,x){const R=u.get(y);if(R)return R;const k=l(o,x);k.font=`${o}px ${y}`;const m=k.measureText("");let b=m.fontBoundingBoxAscent,I=Math.abs(m.fontBoundingBoxDescent);if(b){const S=b/(b+I);return u.set(y,S),k.canvas.width=k.canvas.height=0,S}k.strokeStyle="red",k.clearRect(0,0,o,o),k.strokeText("g",0,0);let _=k.getImageData(0,0,o,o).data;I=0;for(let S=_.length-1-3;S>=0;S-=4)if(_[S]>0){I=Math.ceil(S/4/o);break}k.clearRect(0,0,o,o),k.strokeText("A",0,o),_=k.getImageData(0,0,o,o).data,b=0;for(let S=0,T=_.length;S<T;S+=4)if(_[S]>0){b=o-Math.floor(S/4/o);break}if(k.canvas.width=k.canvas.height=0,b){const S=b/(b+I);return u.set(y,S),S}return u.set(y,a),a}function h(y,x,R){const k=document.createElement("span"),m={angle:0,canvasWidth:0,hasText:x.str!=="",hasEOL:x.hasEOL,fontSize:0};y._textDivs.push(k);const b=n.Util.transform(y._transform,x.transform);let I=Math.atan2(b[1],b[0]);const _=R[x.fontName];_.vertical&&(I+=Math.PI/2);const S=Math.hypot(b[2],b[3]),T=S*c(_.fontFamily,y._isOffscreenCanvasSupported);let E,L;I===0?(E=b[4],L=b[5]-T):(E=b[4]+T*Math.sin(I),L=b[5]-T*Math.cos(I));const $="calc(var(--scale-factor)*",Y=k.style;y._container===y._rootContainer?(Y.left=`${(100*E/y._pageWidth).toFixed(2)}%`,Y.top=`${(100*L/y._pageHeight).toFixed(2)}%`):(Y.left=`${$}${E.toFixed(2)}px)`,Y.top=`${$}${L.toFixed(2)}px)`),Y.fontSize=`${$}${S.toFixed(2)}px)`,Y.fontFamily=_.fontFamily,m.fontSize=S,k.setAttribute("role","presentation"),k.textContent=x.str,k.dir=x.dir,y._fontInspectorEnabled&&(k.dataset.fontName=x.fontName),I!==0&&(m.angle=I*(180/Math.PI));let V=!1;if(x.str.length>1)V=!0;else if(x.str!==" "&&x.transform[0]!==x.transform[3]){const j=Math.abs(x.transform[0]),G=Math.abs(x.transform[3]);j!==G&&Math.max(j,G)/Math.min(j,G)>1.5&&(V=!0)}V&&(m.canvasWidth=_.vertical?x.height:x.width),y._textDivProperties.set(k,m),y._isReadableStream&&y._layoutText(k)}function d(y){const{div:x,scale:R,properties:k,ctx:m,prevFontSize:b,prevFontFamily:I}=y,{style:_}=x;let S="";if(k.canvasWidth!==0&&k.hasText){const{fontFamily:T}=_,{canvasWidth:E,fontSize:L}=k;(b!==L||I!==T)&&(m.font=`${L*R}px ${T}`,y.prevFontSize=L,y.prevFontFamily=T);const{width:$}=m.measureText(x.textContent);$>0&&(S=`scaleX(${E*R/$})`)}k.angle!==0&&(S=`rotate(${k.angle}deg) ${S}`),S.length>0&&(_.transform=S)}function p(y){if(y._canceled)return;const x=y._textDivs,R=y._capability;if(x.length>i){R.resolve();return}if(!y._isReadableStream)for(const m of x)y._layoutText(m);R.resolve()}class f{constructor(x){var Y;let{textContentSource:R,container:k,viewport:m,textDivs:b,textDivProperties:I,textContentItemsStr:_,isOffscreenCanvasSupported:S}=x;this._textContentSource=R,this._isReadableStream=R instanceof ReadableStream,this._container=this._rootContainer=k,this._textDivs=b||[],this._textContentItemsStr=_||[],this._isOffscreenCanvasSupported=S,this._fontInspectorEnabled=!!((Y=globalThis.FontInspector)!=null&&Y.enabled),this._reader=null,this._textDivProperties=I||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:m.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:l(0,S)};const{pageWidth:T,pageHeight:E,pageX:L,pageY:$}=m.rawDims;this._transform=[1,0,0,-1,-L,$+E],this._pageWidth=T,this._pageHeight=E,(0,r.setLayerDimensions)(k,m),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(x,R){for(const k of x){if(k.str===void 0){if(k.type==="beginMarkedContentProps"||k.type==="beginMarkedContent"){const m=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),k.id!==null&&this._container.setAttribute("id",`${k.id}`),m.append(this._container)}else k.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(k.str),h(this,k,R)}}_layoutText(x){const R=this._layoutTextParams.properties=this._textDivProperties.get(x);if(this._layoutTextParams.div=x,d(this._layoutTextParams),R.hasText&&this._container.append(x),R.hasEOL){const k=document.createElement("br");k.setAttribute("role","presentation"),this._container.append(k)}}_render(){const x=new n.PromiseCapability;let R=Object.create(null);if(this._isReadableStream){const k=()=>{this._reader.read().then(m=>{let{value:b,done:I}=m;if(I){x.resolve();return}Object.assign(R,b.styles),this._processItems(b.items,R),k()},x.reject)};this._reader=this._textContentSource.getReader(),k()}else if(this._textContentSource){const{items:k,styles:m}=this._textContentSource;this._processItems(k,m),x.resolve()}else throw new Error('No "textContentSource" parameter specified.');x.promise.then(()=>{R=null,p(this)},this._capability.reject)}}e.TextLayerRenderTask=f;function g(y){!y.textContentSource&&(y.textContent||y.textContentStream)&&((0,r.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),y.textContentSource=y.textContent||y.textContentStream);const{container:x,viewport:R}=y,k=getComputedStyle(x),m=k.getPropertyValue("visibility"),b=parseFloat(k.getPropertyValue("--scale-factor"));m==="visible"&&(!b||Math.abs(b-R.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const I=new f(y);return I._render(),I}function v(y){let{container:x,viewport:R,textDivs:k,textDivProperties:m,isOffscreenCanvasSupported:b,mustRotate:I=!0,mustRescale:_=!0}=y;if(I&&(0,r.setLayerDimensions)(x,{rotation:R.rotation}),_){const S=l(0,b),E={prevFontSize:null,prevFontFamily:null,div:null,scale:R.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:S};for(const L of k)E.properties=m.get(L),E.div=L,d(E)}}},(s,e,t)=>{var h,d,p,f,g,v,y,x,R,k,m,nn,I,Dn,S,rn,E,sn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0,t(125),t(135),t(137),t(140),t(142),t(144),t(146);var n=t(1),r=t(163),i=t(164),o=t(196),a=t(201),u=t(167),l=t(202);const $=class{constructor(V){se(this,m);se(this,I);se(this,S);se(this,E);se(this,h,void 0);se(this,d,!1);se(this,p,null);se(this,f,this.pointerup.bind(this));se(this,g,this.pointerdown.bind(this));se(this,v,new Map);se(this,y,!1);se(this,x,!1);se(this,R,!1);se(this,k,void 0);let{uiManager:j,pageIndex:G,div:X,accessibilityManager:q,annotationLayer:Z,viewport:J,l10n:ve}=V;const K=[o.FreeTextEditor,a.InkEditor,l.StampEditor];if(!$._initialized){$._initialized=!0;for(const O of K)O.initialize(ve)}j.registerEditorTypes(K),Ae(this,k,j),this.pageIndex=G,this.div=X,Ae(this,h,q),Ae(this,p,Z),this.viewport=J,w(this,k).addLayer(this)}get isEmpty(){return w(this,v).size===0}updateToolbar(V){w(this,k).updateToolbar(V)}updateMode(){let V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:w(this,k).getMode();me(this,E,sn).call(this),V===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),w(this,k).unselectAll(),V!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",V===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",V===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",V===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(V){if(!V&&w(this,k).getMode()!==n.AnnotationEditorType.INK)return;if(!V){for(const G of w(this,v).values())if(G.isEmpty()){G.setInBackground();return}}me(this,S,rn).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(V){w(this,k).setEditingState(V)}addCommands(V){w(this,k).addCommands(V)}enable(){this.div.style.pointerEvents="auto";const V=new Set;for(const G of w(this,v).values())G.enableEditing(),G.annotationElementId&&V.add(G.annotationElementId);if(!w(this,p))return;const j=w(this,p).getEditableAnnotations();for(const G of j){if(G.hide(),w(this,k).isDeletedAnnotationElement(G.data.id)||V.has(G.data.id))continue;const X=this.deserialize(G);X&&(this.addOrRebuild(X),X.enableEditing())}}disable(){var j;Ae(this,R,!0),this.div.style.pointerEvents="none";const V=new Set;for(const G of w(this,v).values()){if(G.disableEditing(),!G.annotationElementId||G.serialize()!==null){V.add(G.annotationElementId);continue}(j=this.getEditableAnnotation(G.annotationElementId))==null||j.show(),G.remove()}if(w(this,p)){const G=w(this,p).getEditableAnnotations();for(const X of G){const{id:q}=X.data;V.has(q)||w(this,k).isDeletedAnnotationElement(q)||X.show()}}me(this,E,sn).call(this),this.isEmpty&&(this.div.hidden=!0),Ae(this,R,!1)}getEditableAnnotation(V){var j;return((j=w(this,p))==null?void 0:j.getEditableAnnotation(V))||null}setActiveEditor(V){w(this,k).getActive()!==V&&w(this,k).setActiveEditor(V)}enableClick(){this.div.addEventListener("pointerdown",w(this,g)),this.div.addEventListener("pointerup",w(this,f))}disableClick(){this.div.removeEventListener("pointerdown",w(this,g)),this.div.removeEventListener("pointerup",w(this,f))}attach(V){w(this,v).set(V.id,V);const{annotationElementId:j}=V;j&&w(this,k).isDeletedAnnotationElement(j)&&w(this,k).removeDeletedAnnotationElement(V)}detach(V){var j;w(this,v).delete(V.id),(j=w(this,h))==null||j.removePointerInTextLayer(V.contentDiv),!w(this,R)&&V.annotationElementId&&w(this,k).addDeletedAnnotationElement(V)}remove(V){this.detach(V),w(this,k).removeEditor(V),V.div.style.display="none",setTimeout(()=>{V.div.style.display="",V.div.remove(),V.isAttachedToDOM=!1,document.activeElement===document.body&&w(this,k).focusMainContainer()},0),w(this,x)||this.addInkEditorIfNeeded(!1)}add(V){if(me(this,m,nn).call(this,V),w(this,k).addEditor(V),this.attach(V),!V.isAttachedToDOM){const j=V.render();this.div.append(j),V.isAttachedToDOM=!0}this.moveEditorInDOM(V),V.onceAdded(),w(this,k).addToAnnotationStorage(V)}moveEditorInDOM(V){var j;(j=w(this,h))==null||j.moveElementInDOM(this.div,V.div,V.contentDiv,!0)}addOrRebuild(V){V.needsToBeRebuilt()?V.rebuild():this.add(V)}addUndoableEditor(V){const j=()=>{this.addOrRebuild(V)},G=()=>{V.remove()};this.addCommands({cmd:j,undo:G,mustExec:!1})}getNextId(){return w(this,k).getId()}deserialize(V){switch(V.annotationType??V.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return o.FreeTextEditor.deserialize(V,this,w(this,k));case n.AnnotationEditorType.INK:return a.InkEditor.deserialize(V,this,w(this,k));case n.AnnotationEditorType.STAMP:return l.StampEditor.deserialize(V,this,w(this,k))}return null}setSelected(V){w(this,k).setSelected(V)}toggleSelected(V){w(this,k).toggleSelected(V)}isSelected(V){return w(this,k).isSelected(V)}unselect(V){w(this,k).unselect(V)}pointerup(V){const{isMac:j}=n.FeatureTest.platform;if(!(V.button!==0||V.ctrlKey&&j)&&V.target===this.div&&w(this,y)){if(Ae(this,y,!1),!w(this,d)){Ae(this,d,!0);return}me(this,S,rn).call(this,V)}}pointerdown(V){if(w(this,y)){Ae(this,y,!1);return}const{isMac:j}=n.FeatureTest.platform;if(V.button!==0||V.ctrlKey&&j||V.target!==this.div)return;Ae(this,y,!0);const G=w(this,k).getActive();Ae(this,d,!G||G.isEmpty())}drop(V){const j=V.dataTransfer.getData("text/plain"),G=w(this,k).getEditor(j);if(!G)return;V.preventDefault(),V.dataTransfer.dropEffect="move",me(this,m,nn).call(this,G);const X=this.div.getBoundingClientRect(),q=V.clientX-X.x,Z=V.clientY-X.y;G.translate(q-G.startX,Z-G.startY),this.moveEditorInDOM(G),G.div.focus()}dragover(V){V.preventDefault()}destroy(){var V,j;((V=w(this,k).getActive())==null?void 0:V.parent)===this&&w(this,k).setActiveEditor(null);for(const G of w(this,v).values())(j=w(this,h))==null||j.removePointerInTextLayer(G.contentDiv),G.setParent(null),G.isAttachedToDOM=!1,G.div.remove();this.div=null,w(this,v).clear(),w(this,k).removeLayer(this)}render(V){let{viewport:j}=V;this.viewport=j,(0,u.setLayerDimensions)(this.div,j),(0,i.bindEvents)(this,this.div,["dragover","drop"]);for(const G of w(this,k).getEditors(this.pageIndex))this.add(G);this.updateMode()}update(V){let{viewport:j}=V;w(this,k).commitOrRemove(),this.viewport=j,(0,u.setLayerDimensions)(this.div,{rotation:j.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:V,pageHeight:j}=this.viewport.rawDims;return[V,j]}};let c=$;h=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,g=new WeakMap,v=new WeakMap,y=new WeakMap,x=new WeakMap,R=new WeakMap,k=new WeakMap,m=new WeakSet,nn=function(V){var j;V.parent!==this&&(V.annotationElementId&&(w(this,k).addDeletedAnnotationElement(V.annotationElementId),r.AnnotationEditor.deleteAnnotationElement(V),V.annotationElementId=null),this.attach(V),(j=V.parent)==null||j.detach(V),V.setParent(this),V.div&&V.isAttachedToDOM&&(V.div.remove(),this.div.append(V.div)))},I=new WeakSet,Dn=function(V){switch(w(this,k).getMode()){case n.AnnotationEditorType.FREETEXT:return new o.FreeTextEditor(V);case n.AnnotationEditorType.INK:return new a.InkEditor(V);case n.AnnotationEditorType.STAMP:return new l.StampEditor(V)}return null},S=new WeakSet,rn=function(V){const j=this.getNextId(),G=me(this,I,Dn).call(this,{parent:this,id:j,x:V.offsetX,y:V.offsetY,uiManager:w(this,k)});return G&&this.add(G),G},E=new WeakSet,sn=function(){Ae(this,x,!0);for(const V of w(this,v).values())V.isEmpty()&&V.remove();Ae(this,x,!1)},st(c,"_initialized",!1),e.AnnotationEditorLayer=c},(s,e,t)=>{var u,l,c,h,d,p,f,g,v,y,Fn,R,Ln,m,Bn,I,Rt,S,on,E,Vn,$,an;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0,t(89);var n=t(1),r=t(164),i=t(163),o=t(197);const V=class extends i.AnnotationEditor{constructor(X){super({...X,name:"freeTextEditor"});se(this,y);se(this,R);se(this,m);se(this,I);se(this,S);se(this,E);se(this,$);se(this,u,this.editorDivBlur.bind(this));se(this,l,this.editorDivFocus.bind(this));se(this,c,this.editorDivInput.bind(this));se(this,h,this.editorDivKeydown.bind(this));se(this,d,void 0);se(this,p,"");se(this,f,`${this.id}-editor`);se(this,g,void 0);se(this,v,null);Ae(this,d,X.color||V._defaultColor||i.AnnotationEditor._defaultLineColor),Ae(this,g,X.fontSize||V._defaultFontSize)}static get _keyboardManager(){const X=V.prototype,q=ve=>ve.isEmpty(),Z=r.AnnotationEditorUIManager.TRANSLATE_SMALL,J=r.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new r.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],X.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],X.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],X._translateEmpty,{args:[-Z,0],checker:q}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],X._translateEmpty,{args:[-J,0],checker:q}],[["ArrowRight","mac+ArrowRight"],X._translateEmpty,{args:[Z,0],checker:q}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],X._translateEmpty,{args:[J,0],checker:q}],[["ArrowUp","mac+ArrowUp"],X._translateEmpty,{args:[0,-Z],checker:q}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],X._translateEmpty,{args:[0,-J],checker:q}],[["ArrowDown","mac+ArrowDown"],X._translateEmpty,{args:[0,Z],checker:q}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],X._translateEmpty,{args:[0,J],checker:q}]]))}static initialize(X){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(Z=>[Z,X.get(Z)]));const q=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(q.getPropertyValue("--freetext-padding"))}static updateDefaultParams(X,q){switch(X){case n.AnnotationEditorParamsType.FREETEXT_SIZE:V._defaultFontSize=q;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:V._defaultColor=q;break}}updateParams(X,q){switch(X){case n.AnnotationEditorParamsType.FREETEXT_SIZE:me(this,y,Fn).call(this,q);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:me(this,R,Ln).call(this,q);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,V._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,V._defaultColor||i.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,w(this,g)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,w(this,d)]]}_translateEmpty(X,q){this._uiManager.translateSelectedEditors(X,q,!0)}getInitialTranslation(){const X=this.parentScale;return[-V._internalPadding*X,-(V._internalPadding+w(this,g))*X]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",w(this,h)),this.editorDiv.addEventListener("focus",w(this,l)),this.editorDiv.addEventListener("blur",w(this,u)),this.editorDiv.addEventListener("input",w(this,c)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",w(this,f)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",w(this,h)),this.editorDiv.removeEventListener("focus",w(this,l)),this.editorDiv.removeEventListener("blur",w(this,u)),this.editorDiv.removeEventListener("input",w(this,c)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(X){super.focusin(X),X.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){if(this.width){me(this,$,an).call(this);return}this.enableEditMode(),this.editorDiv.focus()}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const X=w(this,p),q=Ae(this,p,me(this,m,Bn).call(this).trimEnd());if(X===q)return;const Z=J=>{if(Ae(this,p,J),!J){this.remove();return}me(this,S,on).call(this),this.rebuild(),me(this,I,Rt).call(this)};this.addCommands({cmd:()=>{Z(q)},undo:()=>{Z(X)},mustExec:!1}),me(this,I,Rt).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(X){this.enterInEditMode()}keydown(X){X.target===this.div&&X.key==="Enter"&&this.enterInEditMode()}editorDivKeydown(X){V._keyboardManager.exec(this,X)}editorDivFocus(X){this.isEditing=!0}editorDivBlur(X){this.isEditing=!1}editorDivInput(X){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let X,q;this.width&&(X=this.x,q=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",w(this,f)),this.enableEditing(),V._l10nPromise.get("editor_free_text2_aria_label").then(J=>{var ve;return(ve=this.editorDiv)==null?void 0:ve.setAttribute("aria-label",J)}),V._l10nPromise.get("free_text2_default_content").then(J=>{var ve;return(ve=this.editorDiv)==null?void 0:ve.setAttribute("default-content",J)}),this.editorDiv.contentEditable=!0;const{style:Z}=this.editorDiv;if(Z.fontSize=`calc(${w(this,g)}px * var(--scale-factor))`,Z.color=w(this,d),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,r.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[J,ve]=this.parentDimensions;if(this.annotationElementId){const{position:K}=w(this,v);let[O,N]=this.getInitialTranslation();[O,N]=this.pageTranslationToScreen(O,N);const[F,z]=this.pageDimensions,[D,U]=this.pageTranslation;let ee,re;switch(this.rotation){case 0:ee=X+(K[0]-D)/F,re=q+this.height-(K[1]-U)/z;break;case 90:ee=X+(K[0]-D)/F,re=q-(K[1]-U)/z,[O,N]=[N,-O];break;case 180:ee=X-this.width+(K[0]-D)/F,re=q-(K[1]-U)/z,[O,N]=[-O,-N];break;case 270:ee=X+(K[0]-D-this.height*z)/F,re=q+(K[1]-U-this.width*F)/z,[O,N]=[-N,O];break}this.setAt(ee*J,re*ve,O,N)}else this.setAt(X*J,q*ve,this.width*J,this.height*ve);me(this,S,on).call(this),this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(X,q,Z){let J=null;if(X instanceof o.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:K,fontColor:O},rect:N,rotation:F,id:z},textContent:D,textPosition:U,parent:{page:{pageNumber:ee}}}=X;if(!D||D.length===0)return null;J=X={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(O),fontSize:K,value:D.join(`
`),position:U,pageIndex:ee-1,rect:N,rotation:F,id:z,deleted:!1}}const ve=super.deserialize(X,q,Z);return Ae(ve,g,X.fontSize),Ae(ve,d,n.Util.makeHexColor(...X.color)),Ae(ve,p,X.value),ve.annotationElementId=X.id||null,Ae(ve,v,J),ve}serialize(){let X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const q=V._internalPadding*this.parentScale,Z=this.getRect(q,q),J=i.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:w(this,d)),ve={annotationType:n.AnnotationEditorType.FREETEXT,color:J,fontSize:w(this,g),value:w(this,p),pageIndex:this.pageIndex,rect:Z,rotation:this.rotation};return X?ve:this.annotationElementId&&!me(this,E,Vn).call(this,ve)?null:(ve.id=this.annotationElementId,ve)}};let a=V;u=new WeakMap,l=new WeakMap,c=new WeakMap,h=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,g=new WeakMap,v=new WeakMap,y=new WeakSet,Fn=function(X){const q=J=>{this.editorDiv.style.fontSize=`calc(${J}px * var(--scale-factor))`,this.translate(0,-(J-w(this,g))*this.parentScale),Ae(this,g,J),me(this,I,Rt).call(this)},Z=w(this,g);this.addCommands({cmd:()=>{q(X)},undo:()=>{q(Z)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},R=new WeakSet,Ln=function(X){const q=w(this,d);this.addCommands({cmd:()=>{Ae(this,d,this.editorDiv.style.color=X)},undo:()=>{Ae(this,d,this.editorDiv.style.color=q)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},m=new WeakSet,Bn=function(){const X=this.editorDiv.getElementsByTagName("div");if(X.length===0)return this.editorDiv.innerText;const q=[];for(const Z of X)q.push(Z.innerText.replace(/\r\n?|\n/,""));return q.join(`
`)},I=new WeakSet,Rt=function(){const[X,q]=this.parentDimensions;let Z;if(this.isAttachedToDOM)Z=this.div.getBoundingClientRect();else{const{currentLayer:J,div:ve}=this,K=ve.style.display;ve.style.display="hidden",J.div.append(this.div),Z=ve.getBoundingClientRect(),ve.remove(),ve.style.display=K}this.rotation%180===this.parentRotation%180?(this.width=Z.width/X,this.height=Z.height/q):(this.width=Z.height/X,this.height=Z.width/q),this.fixAndSetPosition()},S=new WeakSet,on=function(){if(this.editorDiv.replaceChildren(),!!w(this,p))for(const X of w(this,p).split(`
`)){const q=document.createElement("div");q.append(X?document.createTextNode(X):document.createElement("br")),this.editorDiv.append(q)}},E=new WeakSet,Vn=function(X){const{value:q,fontSize:Z,color:J,rect:ve,pageIndex:K}=w(this,v);return X.value!==q||X.fontSize!==Z||X.rect.some((O,N)=>Math.abs(O-ve[N])>=1)||X.color.some((O,N)=>O!==J[N])||X.pageIndex!==K},$=new WeakSet,an=function(){let X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.annotationElementId)return;if(me(this,I,Rt).call(this),!X&&(this.width===0||this.height===0)){setTimeout(()=>me(this,$,an).call(this,!0),0);return}const q=V._internalPadding*this.parentScale;w(this,v).rect=this.getRect(q,q)},st(a,"_freeTextDefaultContent",""),st(a,"_l10nPromise"),st(a,"_internalPadding",0),st(a,"_defaultColor",null),st(a,"_defaultFontSize",10),st(a,"_type","freetext"),e.FreeTextEditor=a},(s,e,t)=>{var N,F,yt,D,Wn,ee,re,pe,ue,ye,ie,ge,Ee,Oe,Ie,we,Ue,Ne,be,de,Te,_e,cn,Ge,ln,$e,un,Qe,qe,Ye,Se,ce,oe,Re,Fe,et,fe,Un,ne,hn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0,t(89),t(125),t(135),t(137),t(140),t(142),t(144),t(146);var n=t(1),r=t(167),i=t(162),o=t(198),a=t(199),u=t(200);const l=1e3,c=9,h=new WeakSet;function d(ae){return{width:ae[2]-ae[0],height:ae[3]-ae[1]}}class p{static create(W){switch(W.data.annotationType){case n.AnnotationType.LINK:return new g(W);case n.AnnotationType.TEXT:return new v(W);case n.AnnotationType.WIDGET:switch(W.data.fieldType){case"Tx":return new x(W);case"Btn":return W.data.radioButton?new m(W):W.data.checkBox?new k(W):new b(W);case"Ch":return new I(W);case"Sig":return new R(W)}return new y(W);case n.AnnotationType.POPUP:return new _(W);case n.AnnotationType.FREETEXT:return new T(W);case n.AnnotationType.LINE:return new E(W);case n.AnnotationType.SQUARE:return new L(W);case n.AnnotationType.CIRCLE:return new $(W);case n.AnnotationType.POLYLINE:return new Y(W);case n.AnnotationType.CARET:return new j(W);case n.AnnotationType.INK:return new G(W);case n.AnnotationType.POLYGON:return new V(W);case n.AnnotationType.HIGHLIGHT:return new X(W);case n.AnnotationType.UNDERLINE:return new q(W);case n.AnnotationType.SQUIGGLY:return new Z(W);case n.AnnotationType.STRIKEOUT:return new J(W);case n.AnnotationType.STAMP:return new ve(W);case n.AnnotationType.FILEATTACHMENT:return new K(W);default:return new f(W)}}}class f{constructor(W){se(this,N,!1);let{isRenderable:P=!1,ignoreBorder:Q=!1,createQuadrilaterals:H=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.isRenderable=P,this.data=W.data,this.layer=W.layer,this.linkService=W.linkService,this.downloadManager=W.downloadManager,this.imageResourcesPath=W.imageResourcesPath,this.renderForms=W.renderForms,this.svgFactory=W.svgFactory,this.annotationStorage=W.annotationStorage,this.enableScripting=W.enableScripting,this.hasJSActions=W.hasJSActions,this._fieldObjects=W.fieldObjects,this.parent=W.parent,P&&(this.container=this._createContainer(Q)),H&&this._createQuadrilaterals()}_createContainer(W){const{data:P,parent:{page:Q,viewport:H}}=this,te=document.createElement("section");te.setAttribute("data-annotation-id",P.id),te.style.zIndex=this.parent.zIndex++,this.data.popupRef&&te.setAttribute("aria-haspopup","dialog"),P.noRotate&&te.classList.add("norotate");const{pageWidth:le,pageHeight:xe,pageX:Pe,pageY:We}=H.rawDims;if(!P.rect||this instanceof _){const{rotation:ze}=P;return!P.hasOwnCanvas&&ze!==0&&this.setRotation(ze,te),te}const{width:ke,height:He}=d(P.rect),Me=n.Util.normalizeRect([P.rect[0],Q.view[3]-P.rect[1]+Q.view[1],P.rect[2],Q.view[3]-P.rect[3]+Q.view[1]]);if(!W&&P.borderStyle.width>0){te.style.borderWidth=`${P.borderStyle.width}px`;const ze=P.borderStyle.horizontalCornerRadius,je=P.borderStyle.verticalCornerRadius;if(ze>0||je>0){const tt=`calc(${ze}px * var(--scale-factor)) / calc(${je}px * var(--scale-factor))`;te.style.borderRadius=tt}else if(this instanceof m){const tt=`calc(${ke}px * var(--scale-factor)) / calc(${He}px * var(--scale-factor))`;te.style.borderRadius=tt}switch(P.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:te.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:te.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:te.style.borderBottomStyle="solid";break}const Je=P.borderColor||null;Je?(Ae(this,N,!0),te.style.borderColor=n.Util.makeHexColor(Je[0]|0,Je[1]|0,Je[2]|0)):te.style.borderWidth=0}te.style.left=`${100*(Me[0]-Pe)/le}%`,te.style.top=`${100*(Me[1]-We)/xe}%`;const{rotation:Le}=P;return P.hasOwnCanvas||Le===0?(te.style.width=`${100*ke/le}%`,te.style.height=`${100*He/xe}%`):this.setRotation(Le,te),te}setRotation(W){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.container;if(!this.data.rect)return;const{pageWidth:Q,pageHeight:H}=this.parent.viewport.rawDims,{width:te,height:le}=d(this.data.rect);let xe,Pe;W%180===0?(xe=100*te/Q,Pe=100*le/H):(xe=100*le/Q,Pe=100*te/H),P.style.width=`${xe}%`,P.style.height=`${Pe}%`,P.setAttribute("data-main-rotation",(360-W)%360)}get _commonActions(){const W=(P,Q,H)=>{const te=H.detail[P];H.target.style[Q]=o.ColorConverters[`${te[0]}_HTML`](te.slice(1))};return(0,n.shadow)(this,"_commonActions",{display:P=>{const Q=P.detail.display%2===1;this.container.style.visibility=Q?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:Q,print:P.detail.display===0||P.detail.display===3})},print:P=>{this.annotationStorage.setValue(this.data.id,{print:P.detail.print})},hidden:P=>{this.container.style.visibility=P.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:P.detail.hidden})},focus:P=>{setTimeout(()=>P.target.focus({preventScroll:!1}),0)},userName:P=>{P.target.title=P.detail.userName},readonly:P=>{P.detail.readonly?P.target.setAttribute("readonly",""):P.target.removeAttribute("readonly")},required:P=>{this._setRequired(P.target,P.detail.required)},bgColor:P=>{W("bgColor","backgroundColor",P)},fillColor:P=>{W("fillColor","backgroundColor",P)},fgColor:P=>{W("fgColor","color",P)},textColor:P=>{W("textColor","color",P)},borderColor:P=>{W("borderColor","borderColor",P)},strokeColor:P=>{W("strokeColor","borderColor",P)},rotation:P=>{const Q=P.detail.rotation;this.setRotation(Q),this.annotationStorage.setValue(this.data.id,{rotation:Q})}})}_dispatchEventFromSandbox(W,P){const Q=this._commonActions;for(const H of Object.keys(P.detail)){const te=W[H]||Q[H];te==null||te(P)}}_setDefaultPropertiesFromJS(W){if(!this.enableScripting)return;const P=this.annotationStorage.getRawValue(this.data.id);if(!P)return;const Q=this._commonActions;for(const[H,te]of Object.entries(P)){const le=Q[H];if(le){const xe={detail:{[H]:te},target:W};le(xe),delete P[H]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:W}=this.data;if(!W)return;const[P,Q,H,te]=this.data.rect;if(W.length===1){const[,{x:je,y:Je},{x:tt,y:at}]=W[0];if(H===je&&te===Je&&P===tt&&Q===at)return}const{style:le}=this.container;let xe;if(w(this,N)){const{borderColor:je,borderWidth:Je}=le;le.borderWidth=0,xe=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${je}" stroke-width="${Je}">`],this.container.classList.add("hasBorder")}const Pe=H-P,We=te-Q,{svgFactory:ke}=this,He=ke.createElement("svg");He.classList.add("quadrilateralsContainer"),He.setAttribute("width",0),He.setAttribute("height",0);const Me=ke.createElement("defs");He.append(Me);const Le=ke.createElement("clipPath"),ze=`clippath_${this.data.id}`;Le.setAttribute("id",ze),Le.setAttribute("clipPathUnits","objectBoundingBox"),Me.append(Le);for(const[,{x:je,y:Je},{x:tt,y:at}]of W){const nt=ke.createElement("rect"),ct=(tt-P)/Pe,lt=(te-Je)/We,ht=(je-tt)/Pe,dt=(Je-at)/We;nt.setAttribute("x",ct),nt.setAttribute("y",lt),nt.setAttribute("width",ht),nt.setAttribute("height",dt),Le.append(nt),xe==null||xe.push(`<rect vector-effect="non-scaling-stroke" x="${ct}" y="${lt}" width="${ht}" height="${dt}"/>`)}w(this,N)&&(xe.push("</g></svg>')"),le.backgroundImage=xe.join("")),this.container.append(He),this.container.style.clipPath=`url(#${ze})`}_createPopup(){const{container:W,data:P}=this;W.setAttribute("aria-haspopup","dialog");const Q=new _({data:{color:P.color,titleObj:P.titleObj,modificationDate:P.modificationDate,contentsObj:P.contentsObj,richText:P.richText,parentRect:P.rect,borderStyle:0,id:`popup_${P.id}`,rotation:P.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Q.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(W){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Q=[];if(this._fieldObjects){const H=this._fieldObjects[W];if(H)for(const{page:te,id:le,exportValues:xe}of H){if(te===-1||le===P)continue;const Pe=typeof xe=="string"?xe:null,We=document.querySelector(`[data-element-id="${le}"]`);if(We&&!h.has(We)){(0,n.warn)(`_getElementsByName - element not allowed: ${le}`);continue}Q.push({id:le,exportValue:Pe,domElement:We})}return Q}for(const H of document.getElementsByName(W)){const{exportValue:te}=H,le=H.getAttribute("data-element-id");le!==P&&h.has(H)&&Q.push({id:le,exportValue:te,domElement:H})}return Q}show(){var W;this.container&&(this.container.hidden=!1),(W=this.popup)==null||W.maybeShow()}hide(){var W;this.container&&(this.container.hidden=!0),(W=this.popup)==null||W.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const W=this.getElementsToTriggerPopup();if(Array.isArray(W))for(const P of W)P.classList.add("highlightArea");else W.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:W,data:{id:P}}=this;this.container.addEventListener("dblclick",()=>{var Q;(Q=this.linkService.eventBus)==null||Q.dispatch("switchannotationeditormode",{source:this,mode:W,editId:P})})}}N=new WeakMap;class g extends f{constructor(P){let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;super(P,{isRenderable:!0,ignoreBorder:!!(Q!=null&&Q.ignoreBorder),createQuadrilaterals:!0});se(this,F);se(this,D);this.isTooltipOnly=P.data.isTooltipOnly}render(){const{data:P,linkService:Q}=this,H=document.createElement("a");H.setAttribute("data-element-id",P.id);let te=!1;return P.url?(Q.addLinkAttributes(H,P.url,P.newWindow),te=!0):P.action?(this._bindNamedAction(H,P.action),te=!0):P.attachment?(this._bindAttachment(H,P.attachment),te=!0):P.setOCGState?(me(this,D,Wn).call(this,H,P.setOCGState),te=!0):P.dest?(this._bindLink(H,P.dest),te=!0):(P.actions&&(P.actions.Action||P.actions["Mouse Up"]||P.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(H,P),te=!0),P.resetForm?(this._bindResetFormAction(H,P.resetForm),te=!0):this.isTooltipOnly&&!te&&(this._bindLink(H,""),te=!0)),this.container.classList.add("linkAnnotation"),te&&this.container.append(H),this.container}_bindLink(P,Q){P.href=this.linkService.getDestinationHash(Q),P.onclick=()=>(Q&&this.linkService.goToDestination(Q),!1),(Q||Q==="")&&me(this,F,yt).call(this)}_bindNamedAction(P,Q){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>(this.linkService.executeNamedAction(Q),!1),me(this,F,yt).call(this)}_bindAttachment(P,Q){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>{var H;return(H=this.downloadManager)==null||H.openOrDownloadData(this.container,Q.content,Q.filename),!1},me(this,F,yt).call(this)}_bindJSAction(P,Q){P.href=this.linkService.getAnchorUrl("");const H=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const te of Object.keys(Q.actions)){const le=H.get(te);le&&(P[le]=()=>{var xe;return(xe=this.linkService.eventBus)==null||xe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Q.id,name:te}}),!1})}P.onclick||(P.onclick=()=>!1),me(this,F,yt).call(this)}_bindResetFormAction(P,Q){const H=P.onclick;if(H||(P.href=this.linkService.getAnchorUrl("")),me(this,F,yt).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),H||(P.onclick=()=>!1);return}P.onclick=()=>{var He;H==null||H();const{fields:te,refs:le,include:xe}=Q,Pe=[];if(te.length!==0||le.length!==0){const Me=new Set(le);for(const Le of te){const ze=this._fieldObjects[Le]||[];for(const{id:je}of ze)Me.add(je)}for(const Le of Object.values(this._fieldObjects))for(const ze of Le)Me.has(ze.id)===xe&&Pe.push(ze)}else for(const Me of Object.values(this._fieldObjects))Pe.push(...Me);const We=this.annotationStorage,ke=[];for(const Me of Pe){const{id:Le}=Me;switch(ke.push(Le),Me.type){case"text":{const je=Me.defaultValue||"";We.setValue(Le,{value:je});break}case"checkbox":case"radiobutton":{const je=Me.defaultValue===Me.exportValues;We.setValue(Le,{value:je});break}case"combobox":case"listbox":{const je=Me.defaultValue||"";We.setValue(Le,{value:je});break}default:continue}const ze=document.querySelector(`[data-element-id="${Le}"]`);if(ze){if(!h.has(ze)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${Le}`);continue}}else continue;ze.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((He=this.linkService.eventBus)==null||He.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:ke,name:"ResetForm"}})),!1}}}F=new WeakSet,yt=function(){this.container.setAttribute("data-internal-link","")},D=new WeakSet,Wn=function(P,Q){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>(this.linkService.executeSetOCGState(Q),!1),me(this,F,yt).call(this)};class v extends f{constructor(W){var Q,H,te;const P=!!(W.data.popupRef||(Q=W.data.titleObj)!=null&&Q.str||(H=W.data.contentsObj)!=null&&H.str||(te=W.data.richText)!=null&&te.str);super(W,{isRenderable:P})}render(){this.container.classList.add("textAnnotation");const W=document.createElement("img");return W.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",W.alt="[{{type}} Annotation]",W.dataset.l10nId="text_annotation_type",W.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.popupRef||this._createPopup(),this.container.append(W),this.container}}class y extends f{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(W){var P;this.data.hasOwnCanvas&&(((P=W.previousSibling)==null?void 0:P.nodeName)==="CANVAS"&&(W.previousSibling.hidden=!0),W.hidden=!1)}_getKeyModifier(W){const{isWin:P,isMac:Q}=n.FeatureTest.platform;return P&&W.ctrlKey||Q&&W.metaKey}_setEventListener(W,P,Q,H){P.includes("mouse")?W.addEventListener(P,te=>{var le;(le=this.linkService.eventBus)==null||le.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Q,value:H(te),shift:te.shiftKey,modifier:this._getKeyModifier(te)}})}):W.addEventListener(P,te=>{var le;(le=this.linkService.eventBus)==null||le.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Q,value:H(te)}})})}_setEventListeners(W,P,Q){var H;for(const[te,le]of P)(le==="Action"||(H=this.data.actions)!=null&&H[le])&&this._setEventListener(W,te,le,Q)}_setBackgroundColor(W){const P=this.data.backgroundColor||null;W.style.backgroundColor=P===null?"transparent":n.Util.makeHexColor(P[0],P[1],P[2])}_setTextStyle(W){const P=["left","center","right"],{fontColor:Q}=this.data.defaultAppearanceData,H=this.data.defaultAppearanceData.fontSize||c,te=W.style;let le;const xe=2,Pe=We=>Math.round(10*We)/10;if(this.data.multiLine){const We=Math.abs(this.data.rect[3]-this.data.rect[1]-xe),ke=Math.round(We/(n.LINE_FACTOR*H))||1,He=We/ke;le=Math.min(H,Pe(He/n.LINE_FACTOR))}else{const We=Math.abs(this.data.rect[3]-this.data.rect[1]-xe);le=Math.min(H,Pe(We/n.LINE_FACTOR))}te.fontSize=`calc(${le}px * var(--scale-factor))`,te.color=n.Util.makeHexColor(Q[0],Q[1],Q[2]),this.data.textAlignment!==null&&(te.textAlign=P[this.data.textAlignment])}_setRequired(W,P){P?W.setAttribute("required",!0):W.removeAttribute("required"),W.setAttribute("aria-required",P)}}class x extends y{constructor(W){const P=W.renderForms||!W.data.hasAppearance&&!!W.data.fieldValue;super(W,{isRenderable:P})}setPropertyOnSiblings(W,P,Q,H){const te=this.annotationStorage;for(const le of this._getElementsByName(W.name,W.id))le.domElement&&(le.domElement[P]=Q),te.setValue(le.id,{[H]:Q})}render(){var H,te;const W=this.annotationStorage,P=this.data.id;this.container.classList.add("textWidgetAnnotation");let Q=null;if(this.renderForms){const le=W.getValue(P,{value:this.data.fieldValue});let xe=le.value||"";const Pe=W.getValue(P,{charLimit:this.data.maxLen}).charLimit;Pe&&xe.length>Pe&&(xe=xe.slice(0,Pe));let We=le.formattedValue||((H=this.data.textContent)==null?void 0:H.join(`
`))||null;We&&this.data.comb&&(We=We.replaceAll(/\s+/g,""));const ke={userValue:xe,formattedValue:We,lastCommittedValue:null,commitKey:1};this.data.multiLine?(Q=document.createElement("textarea"),Q.textContent=We??xe,this.data.doNotScroll&&(Q.style.overflowY="hidden")):(Q=document.createElement("input"),Q.type="text",Q.setAttribute("value",We??xe),this.data.doNotScroll&&(Q.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Q.hidden=!0),h.add(Q),Q.setAttribute("data-element-id",P),Q.disabled=this.data.readOnly,Q.name=this.data.baseFieldName||this.data.fieldName,Q.tabIndex=l,this._setRequired(Q,this.data.required),Pe&&(Q.maxLength=Pe),Q.addEventListener("input",Me=>{W.setValue(P,{value:Me.target.value}),this.setPropertyOnSiblings(Q,"value",Me.target.value,"value"),ke.formattedValue=null}),Q.addEventListener("resetform",Me=>{const Le=this.data.defaultFieldValue??"";Q.value=ke.userValue=Le,ke.formattedValue=null});let He=Me=>{const{formattedValue:Le}=ke;Le!=null&&(Me.target.value=Le),Me.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Q.addEventListener("focus",Le=>{const{target:ze}=Le;ke.userValue&&(ze.value=ke.userValue),ke.lastCommittedValue=ze.value,ke.commitKey=1}),Q.addEventListener("updatefromsandbox",Le=>{this.showElementAndHideCanvas(Le.target);const ze={value(je){ke.userValue=je.detail.value??"",W.setValue(P,{value:ke.userValue.toString()}),je.target.value=ke.userValue},formattedValue(je){const{formattedValue:Je}=je.detail;ke.formattedValue=Je,Je!=null&&je.target!==document.activeElement&&(je.target.value=Je),W.setValue(P,{formattedValue:Je})},selRange(je){je.target.setSelectionRange(...je.detail.selRange)},charLimit:je=>{var nt;const{charLimit:Je}=je.detail,{target:tt}=je;if(Je===0){tt.removeAttribute("maxLength");return}tt.setAttribute("maxLength",Je);let at=ke.userValue;!at||at.length<=Je||(at=at.slice(0,Je),tt.value=ke.userValue=at,W.setValue(P,{value:at}),(nt=this.linkService.eventBus)==null||nt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:at,willCommit:!0,commitKey:1,selStart:tt.selectionStart,selEnd:tt.selectionEnd}}))}};this._dispatchEventFromSandbox(ze,Le)}),Q.addEventListener("keydown",Le=>{var Je;ke.commitKey=1;let ze=-1;if(Le.key==="Escape"?ze=0:Le.key==="Enter"&&!this.data.multiLine?ze=2:Le.key==="Tab"&&(ke.commitKey=3),ze===-1)return;const{value:je}=Le.target;ke.lastCommittedValue!==je&&(ke.lastCommittedValue=je,ke.userValue=je,(Je=this.linkService.eventBus)==null||Je.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:je,willCommit:!0,commitKey:ze,selStart:Le.target.selectionStart,selEnd:Le.target.selectionEnd}}))});const Me=He;He=null,Q.addEventListener("blur",Le=>{var je;if(!Le.relatedTarget)return;const{value:ze}=Le.target;ke.userValue=ze,ke.lastCommittedValue!==ze&&((je=this.linkService.eventBus)==null||je.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:ze,willCommit:!0,commitKey:ke.commitKey,selStart:Le.target.selectionStart,selEnd:Le.target.selectionEnd}})),Me(Le)}),(te=this.data.actions)!=null&&te.Keystroke&&Q.addEventListener("beforeinput",Le=>{var lt;ke.lastCommittedValue=null;const{data:ze,target:je}=Le,{value:Je,selectionStart:tt,selectionEnd:at}=je;let nt=tt,ct=at;switch(Le.inputType){case"deleteWordBackward":{const ht=Je.substring(0,tt).match(/\w*[^\w]*$/);ht&&(nt-=ht[0].length);break}case"deleteWordForward":{const ht=Je.substring(tt).match(/^[^\w]*\w*/);ht&&(ct+=ht[0].length);break}case"deleteContentBackward":tt===at&&(nt-=1);break;case"deleteContentForward":tt===at&&(ct+=1);break}Le.preventDefault(),(lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:Je,change:ze||"",willCommit:!1,selStart:nt,selEnd:ct}})}),this._setEventListeners(Q,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Le=>Le.target.value)}if(He&&Q.addEventListener("blur",He),this.data.comb){const Le=(this.data.rect[2]-this.data.rect[0])/Pe;Q.classList.add("comb"),Q.style.letterSpacing=`calc(${Le}px * var(--scale-factor) - 1ch)`}}else Q=document.createElement("div"),Q.textContent=this.data.fieldValue,Q.style.verticalAlign="middle",Q.style.display="table-cell";return this._setTextStyle(Q),this._setBackgroundColor(Q),this._setDefaultPropertiesFromJS(Q),this.container.append(Q),this.container}}class R extends y{constructor(W){super(W,{isRenderable:!!W.data.hasOwnCanvas})}}class k extends y{constructor(W){super(W,{isRenderable:W.renderForms})}render(){const W=this.annotationStorage,P=this.data,Q=P.id;let H=W.getValue(Q,{value:P.exportValue===P.fieldValue}).value;typeof H=="string"&&(H=H!=="Off",W.setValue(Q,{value:H})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const te=document.createElement("input");return h.add(te),te.setAttribute("data-element-id",Q),te.disabled=P.readOnly,this._setRequired(te,this.data.required),te.type="checkbox",te.name=P.baseFieldName||P.fieldName,H&&te.setAttribute("checked",!0),te.setAttribute("exportValue",P.exportValue),te.tabIndex=l,te.addEventListener("change",le=>{const{name:xe,checked:Pe}=le.target;for(const We of this._getElementsByName(xe,Q)){const ke=Pe&&We.exportValue===P.exportValue;We.domElement&&(We.domElement.checked=ke),W.setValue(We.id,{value:ke})}W.setValue(Q,{value:Pe})}),te.addEventListener("resetform",le=>{const xe=P.defaultFieldValue||"Off";le.target.checked=xe===P.exportValue}),this.enableScripting&&this.hasJSActions&&(te.addEventListener("updatefromsandbox",le=>{const xe={value(Pe){Pe.target.checked=Pe.detail.value!=="Off",W.setValue(Q,{value:Pe.target.checked})}};this._dispatchEventFromSandbox(xe,le)}),this._setEventListeners(te,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],le=>le.target.checked)),this._setBackgroundColor(te),this._setDefaultPropertiesFromJS(te),this.container.append(te),this.container}}class m extends y{constructor(W){super(W,{isRenderable:W.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const W=this.annotationStorage,P=this.data,Q=P.id;let H=W.getValue(Q,{value:P.fieldValue===P.buttonValue}).value;typeof H=="string"&&(H=H!==P.buttonValue,W.setValue(Q,{value:H}));const te=document.createElement("input");if(h.add(te),te.setAttribute("data-element-id",Q),te.disabled=P.readOnly,this._setRequired(te,this.data.required),te.type="radio",te.name=P.baseFieldName||P.fieldName,H&&te.setAttribute("checked",!0),te.tabIndex=l,te.addEventListener("change",le=>{const{name:xe,checked:Pe}=le.target;for(const We of this._getElementsByName(xe,Q))W.setValue(We.id,{value:!1});W.setValue(Q,{value:Pe})}),te.addEventListener("resetform",le=>{const xe=P.defaultFieldValue;le.target.checked=xe!=null&&xe===P.buttonValue}),this.enableScripting&&this.hasJSActions){const le=P.buttonValue;te.addEventListener("updatefromsandbox",xe=>{const Pe={value:We=>{const ke=le===We.detail.value;for(const He of this._getElementsByName(We.target.name)){const Me=ke&&He.id===Q;He.domElement&&(He.domElement.checked=Me),W.setValue(He.id,{value:Me})}}};this._dispatchEventFromSandbox(Pe,xe)}),this._setEventListeners(te,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],xe=>xe.target.checked)}return this._setBackgroundColor(te),this._setDefaultPropertiesFromJS(te),this.container.append(te),this.container}}class b extends g{constructor(W){super(W,{ignoreBorder:W.data.hasAppearance})}render(){const W=super.render();W.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(W.title=this.data.alternativeText);const P=W.lastChild;return this.enableScripting&&this.hasJSActions&&P&&(this._setDefaultPropertiesFromJS(P),P.addEventListener("updatefromsandbox",Q=>{this._dispatchEventFromSandbox({},Q)})),W}}class I extends y{constructor(W){super(W,{isRenderable:W.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const W=this.annotationStorage,P=this.data.id,Q=W.getValue(P,{value:this.data.fieldValue}),H=document.createElement("select");h.add(H),H.setAttribute("data-element-id",P),H.disabled=this.data.readOnly,this._setRequired(H,this.data.required),H.name=this.data.baseFieldName||this.data.fieldName,H.tabIndex=l;let te=this.data.combo&&this.data.options.length>0;this.data.combo||(H.size=this.data.options.length,this.data.multiSelect&&(H.multiple=!0)),H.addEventListener("resetform",ke=>{const He=this.data.defaultFieldValue;for(const Me of H.options)Me.selected=Me.value===He});for(const ke of this.data.options){const He=document.createElement("option");He.textContent=ke.displayValue,He.value=ke.exportValue,Q.value.includes(ke.exportValue)&&(He.setAttribute("selected",!0),te=!1),H.append(He)}let le=null;if(te){const ke=document.createElement("option");ke.value=" ",ke.setAttribute("hidden",!0),ke.setAttribute("selected",!0),H.prepend(ke),le=()=>{ke.remove(),H.removeEventListener("input",le),le=null},H.addEventListener("input",le)}const xe=ke=>{const He=ke?"value":"textContent",{options:Me,multiple:Le}=H;return Le?Array.prototype.filter.call(Me,ze=>ze.selected).map(ze=>ze[He]):Me.selectedIndex===-1?null:Me[Me.selectedIndex][He]};let Pe=xe(!1);const We=ke=>{const He=ke.target.options;return Array.prototype.map.call(He,Me=>({displayValue:Me.textContent,exportValue:Me.value}))};return this.enableScripting&&this.hasJSActions?(H.addEventListener("updatefromsandbox",ke=>{const He={value(Me){le==null||le();const Le=Me.detail.value,ze=new Set(Array.isArray(Le)?Le:[Le]);for(const je of H.options)je.selected=ze.has(je.value);W.setValue(P,{value:xe(!0)}),Pe=xe(!1)},multipleSelection(Me){H.multiple=!0},remove(Me){const Le=H.options,ze=Me.detail.remove;Le[ze].selected=!1,H.remove(ze),Le.length>0&&Array.prototype.findIndex.call(Le,Je=>Je.selected)===-1&&(Le[0].selected=!0),W.setValue(P,{value:xe(!0),items:We(Me)}),Pe=xe(!1)},clear(Me){for(;H.length!==0;)H.remove(0);W.setValue(P,{value:null,items:[]}),Pe=xe(!1)},insert(Me){const{index:Le,displayValue:ze,exportValue:je}=Me.detail.insert,Je=H.children[Le],tt=document.createElement("option");tt.textContent=ze,tt.value=je,Je?Je.before(tt):H.append(tt),W.setValue(P,{value:xe(!0),items:We(Me)}),Pe=xe(!1)},items(Me){const{items:Le}=Me.detail;for(;H.length!==0;)H.remove(0);for(const ze of Le){const{displayValue:je,exportValue:Je}=ze,tt=document.createElement("option");tt.textContent=je,tt.value=Je,H.append(tt)}H.options.length>0&&(H.options[0].selected=!0),W.setValue(P,{value:xe(!0),items:We(Me)}),Pe=xe(!1)},indices(Me){const Le=new Set(Me.detail.indices);for(const ze of Me.target.options)ze.selected=Le.has(ze.index);W.setValue(P,{value:xe(!0)}),Pe=xe(!1)},editable(Me){Me.target.disabled=!Me.detail.editable}};this._dispatchEventFromSandbox(He,ke)}),H.addEventListener("input",ke=>{var Me;const He=xe(!0);W.setValue(P,{value:He}),ke.preventDefault(),(Me=this.linkService.eventBus)==null||Me.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:Pe,changeEx:He,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(H,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],ke=>ke.target.value)):H.addEventListener("input",function(ke){W.setValue(P,{value:xe(!0)})}),this.data.combo&&this._setTextStyle(H),this._setBackgroundColor(H),this._setDefaultPropertiesFromJS(H),this.container.append(H),this.container}}class _ extends f{constructor(W){var te,le,xe;const{data:P,elements:Q}=W,H=!!((te=P.titleObj)!=null&&te.str||(le=P.contentsObj)!=null&&le.str||(xe=P.richText)!=null&&xe.str);super(W,{isRenderable:H}),this.elements=Q}render(){this.container.classList.add("popupAnnotation");const W=new S({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),P=[];for(const Q of this.elements)Q.popup=W,P.push(Q.data.id),Q.addHighlightArea();return this.container.setAttribute("aria-controls",P.join(",")),this.container}}class S{constructor(W){se(this,_e);se(this,Ge);se(this,$e);se(this,ee,null);se(this,re,me(this,$e,un).bind(this));se(this,pe,me(this,Ge,ln).bind(this));se(this,ue,me(this,_e,cn).bind(this));se(this,ye,null);se(this,ie,null);se(this,ge,null);se(this,Ee,null);se(this,Oe,null);se(this,Ie,null);se(this,we,!1);se(this,Ue,null);se(this,Ne,null);se(this,be,null);se(this,de,null);se(this,Te,!1);let{container:P,color:Q,elements:H,titleObj:te,modificationDate:le,contentsObj:xe,richText:Pe,parent:We,rect:ke,parentRect:He,open:Me}=W;Ae(this,ie,P),Ae(this,de,te),Ae(this,ge,xe),Ae(this,be,Pe),Ae(this,Oe,We),Ae(this,ye,Q),Ae(this,Ne,ke),Ae(this,Ie,He),Ae(this,Ee,H);const Le=r.PDFDateString.toDateObject(le);Le&&Ae(this,ee,We.l10n.get("annotation_date_string",{date:Le.toLocaleDateString(),time:Le.toLocaleTimeString()})),this.trigger=H.flatMap(ze=>ze.getElementsToTriggerPopup());for(const ze of this.trigger)ze.addEventListener("click",w(this,ue)),ze.addEventListener("mouseenter",w(this,pe)),ze.addEventListener("mouseleave",w(this,re));w(this,ie).hidden=!0,Me&&me(this,_e,cn).call(this)}render(){if(w(this,Ue))return;const{page:{view:W},viewport:{rawDims:{pageWidth:P,pageHeight:Q,pageX:H,pageY:te}}}=w(this,Oe),le=Ae(this,Ue,document.createElement("div"));if(le.className="popup",w(this,ye)){const nt=le.style.outlineColor=n.Util.makeHexColor(...w(this,ye));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?le.style.backgroundColor=`color-mix(in srgb, ${nt} 30%, white)`:le.style.backgroundColor=n.Util.makeHexColor(...w(this,ye).map(lt=>Math.floor(.7*(255-lt)+lt)))}const xe=document.createElement("span");xe.className="header";const Pe=document.createElement("h1");if(xe.append(Pe),{dir:Pe.dir,str:Pe.textContent}=w(this,de),le.append(xe),w(this,ee)){const nt=document.createElement("span");nt.classList.add("popupDate"),w(this,ee).then(ct=>{nt.textContent=ct}),xe.append(nt)}const We=w(this,ge),ke=w(this,be);if(ke!=null&&ke.str&&(!(We!=null&&We.str)||We.str===ke.str))u.XfaLayer.render({xfaHtml:ke.html,intent:"richText",div:le}),le.lastChild.classList.add("richText","popupContent");else{const nt=this._formatContents(We);le.append(nt)}let He=!!w(this,Ie),Me=He?w(this,Ie):w(this,Ne);for(const nt of w(this,Ee))if(!Me||n.Util.intersect(nt.data.rect,Me)!==null){Me=nt.data.rect,He=!0;break}const Le=n.Util.normalizeRect([Me[0],W[3]-Me[1]+W[1],Me[2],W[3]-Me[3]+W[1]]),ze=5,je=He?Me[2]-Me[0]+ze:0,Je=Le[0]+je,tt=Le[1],{style:at}=w(this,ie);at.left=`${100*(Je-H)/P}%`,at.top=`${100*(tt-te)/Q}%`,w(this,ie).append(le)}_formatContents(W){let{str:P,dir:Q}=W;const H=document.createElement("p");H.classList.add("popupContent"),H.dir=Q;const te=P.split(/(?:\r\n?|\n)/);for(let le=0,xe=te.length;le<xe;++le){const Pe=te[le];H.append(document.createTextNode(Pe)),le<xe-1&&H.append(document.createElement("br"))}return H}forceHide(){Ae(this,Te,this.isVisible),w(this,Te)&&(w(this,ie).hidden=!0)}maybeShow(){w(this,Te)&&(Ae(this,Te,!1),w(this,ie).hidden=!1)}get isVisible(){return w(this,ie).hidden===!1}}ee=new WeakMap,re=new WeakMap,pe=new WeakMap,ue=new WeakMap,ye=new WeakMap,ie=new WeakMap,ge=new WeakMap,Ee=new WeakMap,Oe=new WeakMap,Ie=new WeakMap,we=new WeakMap,Ue=new WeakMap,Ne=new WeakMap,be=new WeakMap,de=new WeakMap,Te=new WeakMap,_e=new WeakSet,cn=function(){Ae(this,we,!w(this,we)),w(this,we)?(me(this,Ge,ln).call(this),w(this,ie).addEventListener("click",w(this,ue))):(me(this,$e,un).call(this),w(this,ie).removeEventListener("click",w(this,ue)))},Ge=new WeakSet,ln=function(){w(this,Ue)||this.render(),this.isVisible?w(this,we)&&w(this,ie).classList.add("focused"):(w(this,ie).hidden=!1,w(this,ie).style.zIndex=parseInt(w(this,ie).style.zIndex)+1e3)},$e=new WeakSet,un=function(){w(this,ie).classList.remove("focused"),!(w(this,we)||!this.isVisible)&&(w(this,ie).hidden=!0,w(this,ie).style.zIndex=parseInt(w(this,ie).style.zIndex)-1e3)};class T extends f{constructor(W){var Q,H,te;const P=!!(W.data.popupRef||(Q=W.data.titleObj)!=null&&Q.str||(H=W.data.contentsObj)!=null&&H.str||(te=W.data.richText)!=null&&te.str);super(W,{isRenderable:P,ignoreBorder:!0}),this.textContent=W.data.textContent,this.textPosition=W.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const W=document.createElement("div");W.classList.add("annotationTextContent"),W.setAttribute("role","comment");for(const P of this.textContent){const Q=document.createElement("span");Q.textContent=P,W.append(Q)}this.container.append(W)}return this.data.popupRef||this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=T;class E extends f{constructor(P){var H,te,le;const Q=!!(P.data.popupRef||(H=P.data.titleObj)!=null&&H.str||(te=P.data.contentsObj)!=null&&te.str||(le=P.data.richText)!=null&&le.str);super(P,{isRenderable:Q,ignoreBorder:!0});se(this,Qe,null)}render(){this.container.classList.add("lineAnnotation");const P=this.data,{width:Q,height:H}=d(P.rect),te=this.svgFactory.create(Q,H,!0),le=Ae(this,Qe,this.svgFactory.createElement("svg:line"));return le.setAttribute("x1",P.rect[2]-P.lineCoordinates[0]),le.setAttribute("y1",P.rect[3]-P.lineCoordinates[1]),le.setAttribute("x2",P.rect[2]-P.lineCoordinates[2]),le.setAttribute("y2",P.rect[3]-P.lineCoordinates[3]),le.setAttribute("stroke-width",P.borderStyle.width||1),le.setAttribute("stroke","transparent"),le.setAttribute("fill","transparent"),te.append(le),this.container.append(te),P.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return w(this,Qe)}addHighlightArea(){this.container.classList.add("highlightArea")}}Qe=new WeakMap;class L extends f{constructor(P){var H,te,le;const Q=!!(P.data.popupRef||(H=P.data.titleObj)!=null&&H.str||(te=P.data.contentsObj)!=null&&te.str||(le=P.data.richText)!=null&&le.str);super(P,{isRenderable:Q,ignoreBorder:!0});se(this,qe,null)}render(){this.container.classList.add("squareAnnotation");const P=this.data,{width:Q,height:H}=d(P.rect),te=this.svgFactory.create(Q,H,!0),le=P.borderStyle.width,xe=Ae(this,qe,this.svgFactory.createElement("svg:rect"));return xe.setAttribute("x",le/2),xe.setAttribute("y",le/2),xe.setAttribute("width",Q-le),xe.setAttribute("height",H-le),xe.setAttribute("stroke-width",le||1),xe.setAttribute("stroke","transparent"),xe.setAttribute("fill","transparent"),te.append(xe),this.container.append(te),P.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return w(this,qe)}addHighlightArea(){this.container.classList.add("highlightArea")}}qe=new WeakMap;class $ extends f{constructor(P){var H,te,le;const Q=!!(P.data.popupRef||(H=P.data.titleObj)!=null&&H.str||(te=P.data.contentsObj)!=null&&te.str||(le=P.data.richText)!=null&&le.str);super(P,{isRenderable:Q,ignoreBorder:!0});se(this,Ye,null)}render(){this.container.classList.add("circleAnnotation");const P=this.data,{width:Q,height:H}=d(P.rect),te=this.svgFactory.create(Q,H,!0),le=P.borderStyle.width,xe=Ae(this,Ye,this.svgFactory.createElement("svg:ellipse"));return xe.setAttribute("cx",Q/2),xe.setAttribute("cy",H/2),xe.setAttribute("rx",Q/2-le/2),xe.setAttribute("ry",H/2-le/2),xe.setAttribute("stroke-width",le||1),xe.setAttribute("stroke","transparent"),xe.setAttribute("fill","transparent"),te.append(xe),this.container.append(te),P.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return w(this,Ye)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ye=new WeakMap;class Y extends f{constructor(P){var H,te,le;const Q=!!(P.data.popupRef||(H=P.data.titleObj)!=null&&H.str||(te=P.data.contentsObj)!=null&&te.str||(le=P.data.richText)!=null&&le.str);super(P,{isRenderable:Q,ignoreBorder:!0});se(this,Se,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const P=this.data,{width:Q,height:H}=d(P.rect),te=this.svgFactory.create(Q,H,!0);let le=[];for(const Pe of P.vertices){const We=Pe.x-P.rect[0],ke=P.rect[3]-Pe.y;le.push(We+","+ke)}le=le.join(" ");const xe=Ae(this,Se,this.svgFactory.createElement(this.svgElementName));return xe.setAttribute("points",le),xe.setAttribute("stroke-width",P.borderStyle.width||1),xe.setAttribute("stroke","transparent"),xe.setAttribute("fill","transparent"),te.append(xe),this.container.append(te),P.popupRef||this._createPopup(xe,P),this.container}getElementsToTriggerPopup(){return w(this,Se)}addHighlightArea(){this.container.classList.add("highlightArea")}}Se=new WeakMap;class V extends Y{constructor(W){super(W),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class j extends f{constructor(W){var Q,H,te;const P=!!(W.data.popupRef||(Q=W.data.titleObj)!=null&&Q.str||(H=W.data.contentsObj)!=null&&H.str||(te=W.data.richText)!=null&&te.str);super(W,{isRenderable:P,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.popupRef||this._createPopup(),this.container}}class G extends f{constructor(P){var H,te,le;const Q=!!(P.data.popupRef||(H=P.data.titleObj)!=null&&H.str||(te=P.data.contentsObj)!=null&&te.str||(le=P.data.richText)!=null&&le.str);super(P,{isRenderable:Q,ignoreBorder:!0});se(this,ce,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const P=this.data,{width:Q,height:H}=d(P.rect),te=this.svgFactory.create(Q,H,!0);for(const le of P.inkLists){let xe=[];for(const We of le){const ke=We.x-P.rect[0],He=P.rect[3]-We.y;xe.push(`${ke},${He}`)}xe=xe.join(" ");const Pe=this.svgFactory.createElement(this.svgElementName);w(this,ce).push(Pe),Pe.setAttribute("points",xe),Pe.setAttribute("stroke-width",P.borderStyle.width||1),Pe.setAttribute("stroke","transparent"),Pe.setAttribute("fill","transparent"),P.popupRef||this._createPopup(Pe,P),te.append(Pe)}return this.container.append(te),this.container}getElementsToTriggerPopup(){return w(this,ce)}addHighlightArea(){this.container.classList.add("highlightArea")}}ce=new WeakMap,e.InkAnnotationElement=G;class X extends f{constructor(W){var Q,H,te;const P=!!(W.data.popupRef||(Q=W.data.titleObj)!=null&&Q.str||(H=W.data.contentsObj)!=null&&H.str||(te=W.data.richText)!=null&&te.str);super(W,{isRenderable:P,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class q extends f{constructor(W){var Q,H,te;const P=!!(W.data.popupRef||(Q=W.data.titleObj)!=null&&Q.str||(H=W.data.contentsObj)!=null&&H.str||(te=W.data.richText)!=null&&te.str);super(W,{isRenderable:P,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Z extends f{constructor(W){var Q,H,te;const P=!!(W.data.popupRef||(Q=W.data.titleObj)!=null&&Q.str||(H=W.data.contentsObj)!=null&&H.str||(te=W.data.richText)!=null&&te.str);super(W,{isRenderable:P,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class J extends f{constructor(W){var Q,H,te;const P=!!(W.data.popupRef||(Q=W.data.titleObj)!=null&&Q.str||(H=W.data.contentsObj)!=null&&H.str||(te=W.data.richText)!=null&&te.str);super(W,{isRenderable:P,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class ve extends f{constructor(W){var Q,H,te;const P=!!(W.data.popupRef||(Q=W.data.titleObj)!=null&&Q.str||(H=W.data.contentsObj)!=null&&H.str||(te=W.data.richText)!=null&&te.str);super(W,{isRenderable:P,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.popupRef||this._createPopup(),this.container}}e.StampAnnotationElement=ve;class K extends f{constructor(P){var te;super(P,{isRenderable:!0});se(this,oe,null);const{filename:Q,content:H}=this.data.file;this.filename=(0,r.getFilenameFromUrl)(Q,!0),this.content=H,(te=this.linkService.eventBus)==null||te.dispatch("fileattachmentannotation",{source:this,filename:Q,content:H})}render(){var Q,H;this.container.classList.add("fileAttachmentAnnotation");let P;return this.data.hasAppearance?P=document.createElement("div"):(P=document.createElement("img"),P.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),P.classList.add("popupTriggerArea"),P.addEventListener("dblclick",this._download.bind(this)),Ae(this,oe,P),!this.data.popupRef&&((Q=this.data.titleObj)!=null&&Q.str||(H=this.data.contentsObj)!=null&&H.str||this.data.richText)&&this._createPopup(),this.container.append(P),this.container}getElementsToTriggerPopup(){return w(this,oe)}addHighlightArea(){this.container.classList.add("highlightArea")}_download(){var P;(P=this.downloadManager)==null||P.openOrDownloadData(this.container,this.content,this.filename)}}oe=new WeakMap;class O{constructor(W){se(this,fe);se(this,ne);se(this,Re,null);se(this,Fe,null);se(this,et,new Map);let{div:P,accessibilityManager:Q,annotationCanvasMap:H,l10n:te,page:le,viewport:xe}=W;this.div=P,Ae(this,Re,Q),Ae(this,Fe,H),this.l10n=te,this.page=le,this.viewport=xe,this.zIndex=0,this.l10n||(this.l10n=a.NullL10n)}async render(W){const{annotations:P}=W,Q=this.div;(0,r.setLayerDimensions)(Q,this.viewport);const H=new Map,te={data:null,layer:Q,linkService:W.linkService,downloadManager:W.downloadManager,imageResourcesPath:W.imageResourcesPath||"",renderForms:W.renderForms!==!1,svgFactory:new r.DOMSVGFactory,annotationStorage:W.annotationStorage||new i.AnnotationStorage,enableScripting:W.enableScripting===!0,hasJSActions:W.hasJSActions,fieldObjects:W.fieldObjects,parent:this,elements:null};for(const le of P){if(le.noHTML)continue;const xe=le.annotationType===n.AnnotationType.POPUP;if(xe){const ke=H.get(le.id);if(!ke)continue;te.elements=ke}else{const{width:ke,height:He}=d(le.rect);if(ke<=0||He<=0)continue}te.data=le;const Pe=p.create(te);if(!Pe.isRenderable)continue;if(!xe&&le.popupRef){const ke=H.get(le.popupRef);ke?ke.push(Pe):H.set(le.popupRef,[Pe])}Pe.annotationEditorType>0&&w(this,et).set(Pe.data.id,Pe);const We=Pe.render();le.hidden&&(We.style.visibility="hidden"),me(this,fe,Un).call(this,We,le.id)}me(this,ne,hn).call(this),await this.l10n.translate(Q)}update(W){let{viewport:P}=W;const Q=this.div;this.viewport=P,(0,r.setLayerDimensions)(Q,{rotation:P.rotation}),me(this,ne,hn).call(this),Q.hidden=!1}getEditableAnnotations(){return Array.from(w(this,et).values())}getEditableAnnotation(W){return w(this,et).get(W)}}Re=new WeakMap,Fe=new WeakMap,et=new WeakMap,fe=new WeakSet,Un=function(W,P){var H;const Q=W.firstChild||W;Q.id=`${r.AnnotationPrefix}${P}`,this.div.append(W),(H=w(this,Re))==null||H.moveElementInDOM(this.div,W,Q,!1)},ne=new WeakSet,hn=function(){if(!w(this,Fe))return;const W=this.div;for(const[P,Q]of w(this,Fe)){const H=W.querySelector(`[data-annotation-id="${P}"]`);if(!H)continue;const{firstChild:te}=H;te?te.nodeName==="CANVAS"?te.replaceWith(Q):te.before(Q):H.append(Q)}w(this,Fe).clear()},e.AnnotationLayer=O},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function t(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}class n{static CMYK_G(i){let[o,a,u,l]=i;return["G",1-Math.min(1,.3*o+.59*u+.11*a+l)]}static G_CMYK(i){let[o]=i;return["CMYK",0,0,0,1-o]}static G_RGB(i){let[o]=i;return["RGB",o,o,o]}static G_HTML(i){let[o]=i;const a=t(o);return`#${a}${a}${a}`}static RGB_G(i){let[o,a,u]=i;return["G",.3*o+.59*a+.11*u]}static RGB_HTML(i){let[o,a,u]=i;const l=t(o),c=t(a),h=t(u);return`#${l}${c}${h}`}static T_HTML(){return"#00000000"}static CMYK_RGB(i){let[o,a,u,l]=i;return["RGB",1-Math.min(1,o+l),1-Math.min(1,u+l),1-Math.min(1,a+l)]}static CMYK_HTML(i){const o=this.CMYK_RGB(i).slice(1);return this.RGB_HTML(o)}static RGB_CMYK(i){let[o,a,u]=i;const l=1-o,c=1-a,h=1-u,d=Math.min(l,c,h);return["CMYK",l,c,h,d]}}e.ColorConverters=n},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=n;const t={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image"};t.print_progress_percent="{{progress}}%";function n(o,a){switch(o){case"find_match_count":o=`find_match_count[${a.total===1?"one":"other"}]`;break;case"find_match_count_limit":o=`find_match_count_limit[${a.limit===1?"one":"other"}]`;break}return t[o]||""}function r(o,a){return a?o.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(u,l)=>l in a?a[l]:"{{"+l+"}}"):o}const i={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(o){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n(o,a);return r(u,a)},async translate(o){}};e.NullL10n=i},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0,t(89);var n=t(193);class r{static setupStorage(o,a,u,l,c){const h=l.getValue(a,{value:null});switch(u.name){case"textarea":if(h.value!==null&&(o.textContent=h.value),c==="print")break;o.addEventListener("input",d=>{l.setValue(a,{value:d.target.value})});break;case"input":if(u.attributes.type==="radio"||u.attributes.type==="checkbox"){if(h.value===u.attributes.xfaOn?o.setAttribute("checked",!0):h.value===u.attributes.xfaOff&&o.removeAttribute("checked"),c==="print")break;o.addEventListener("change",d=>{l.setValue(a,{value:d.target.checked?d.target.getAttribute("xfaOn"):d.target.getAttribute("xfaOff")})})}else{if(h.value!==null&&o.setAttribute("value",h.value),c==="print")break;o.addEventListener("input",d=>{l.setValue(a,{value:d.target.value})})}break;case"select":if(h.value!==null){o.setAttribute("value",h.value);for(const d of u.children)d.attributes.value===h.value?d.attributes.selected=!0:d.attributes.hasOwnProperty("selected")&&delete d.attributes.selected}o.addEventListener("input",d=>{const p=d.target.options,f=p.selectedIndex===-1?"":p[p.selectedIndex].value;l.setValue(a,{value:f})});break}}static setAttributes(o){let{html:a,element:u,storage:l=null,intent:c,linkService:h}=o;const{attributes:d}=u,p=a instanceof HTMLAnchorElement;d.type==="radio"&&(d.name=`${d.name}-${c}`);for(const[f,g]of Object.entries(d))if(g!=null)switch(f){case"class":g.length&&a.setAttribute(f,g.join(" "));break;case"dataId":break;case"id":a.setAttribute("data-element-id",g);break;case"style":Object.assign(a.style,g);break;case"textContent":a.textContent=g;break;default:(!p||f!=="href"&&f!=="newWindow")&&a.setAttribute(f,g)}p&&h.addLinkAttributes(a,d.href,d.newWindow),l&&d.dataId&&this.setupStorage(a,d.dataId,u,l)}static render(o){var g;const a=o.annotationStorage,u=o.linkService,l=o.xfaHtml,c=o.intent||"display",h=document.createElement(l.name);l.attributes&&this.setAttributes({html:h,element:l,intent:c,linkService:u});const d=[[l,-1,h]],p=o.div;if(p.append(h),o.viewport){const v=`matrix(${o.viewport.transform.join(",")})`;p.style.transform=v}c!=="richText"&&p.setAttribute("class","xfaLayer xfaFont");const f=[];for(;d.length>0;){const[v,y,x]=d.at(-1);if(y+1===v.children.length){d.pop();continue}const R=v.children[++d.at(-1)[1]];if(R===null)continue;const{name:k}=R;if(k==="#text"){const b=document.createTextNode(R.value);f.push(b),x.append(b);continue}const m=(g=R==null?void 0:R.attributes)!=null&&g.xmlns?document.createElementNS(R.attributes.xmlns,k):document.createElement(k);if(x.append(m),R.attributes&&this.setAttributes({html:m,element:R,storage:a,intent:c,linkService:u}),R.children&&R.children.length>0)d.push([R,-1,m]);else if(R.value){const b=document.createTextNode(R.value);n.XfaText.shouldBuildText(k)&&f.push(b),m.append(b)}}for(const v of p.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))v.setAttribute("readOnly",!0);return{textDivs:f}}static update(o){const a=`matrix(${o.viewport.transform.join(",")})`;o.div.style.transform=a,o.div.hidden=!1}}e.XfaLayer=r},(s,e,t)=>{var u,l,c,h,d,p,f,g,v,y,x,R,k,m,b,I,Gn,S,zn,E,$n,$,Hn,V,dn,G,Xn,q,fn,J,Yn,K,jn,N,Kn,z,Zn,U,Qn,re,mt,ue,pn,ie,Bt,Ee,Vt,Ie,xt,Ue,mn,be,Wt,Te,qn,Ve,gn,Ke,Jn,Ze,er,qe,vn,Se,Ut,oe,wt;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0,t(89),t(2);var n=t(1),r=t(163),i=t(197),o=t(164);const Fe=class extends r.AnnotationEditor{constructor(M){super({...M,name:"inkEditor"});se(this,I);se(this,S);se(this,E);se(this,$);se(this,V);se(this,G);se(this,q);se(this,J);se(this,K);se(this,N);se(this,z);se(this,U);se(this,re);se(this,ue);se(this,ie);se(this,Ee);se(this,Ie);se(this,Ue);se(this,be);se(this,Ze);se(this,qe);se(this,Se);se(this,oe);se(this,u,0);se(this,l,0);se(this,c,this.canvasContextMenu.bind(this));se(this,h,this.canvasPointermove.bind(this));se(this,d,this.canvasPointerleave.bind(this));se(this,p,this.canvasPointerup.bind(this));se(this,f,this.canvasPointerdown.bind(this));se(this,g,new Path2D);se(this,v,!1);se(this,y,!1);se(this,x,!1);se(this,R,null);se(this,k,0);se(this,m,0);se(this,b,null);this.color=M.color||null,this.thickness=M.thickness||null,this.opacity=M.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(M){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(ne=>[ne,M.get(ne)]))}static updateDefaultParams(M,ne){switch(M){case n.AnnotationEditorParamsType.INK_THICKNESS:Fe._defaultThickness=ne;break;case n.AnnotationEditorParamsType.INK_COLOR:Fe._defaultColor=ne;break;case n.AnnotationEditorParamsType.INK_OPACITY:Fe._defaultOpacity=ne/100;break}}updateParams(M,ne){switch(M){case n.AnnotationEditorParamsType.INK_THICKNESS:me(this,I,Gn).call(this,ne);break;case n.AnnotationEditorParamsType.INK_COLOR:me(this,S,zn).call(this,ne);break;case n.AnnotationEditorParamsType.INK_OPACITY:me(this,E,$n).call(this,ne);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,Fe._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,Fe._defaultColor||r.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(Fe._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Fe._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||Fe._defaultColor||r.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Fe._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(me(this,ie,Bt).call(this),me(this,Ee,Vt).call(this)),this.isAttachedToDOM||(this.parent.add(this),me(this,Ie,xt).call(this)),me(this,oe,wt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,w(this,R).disconnect(),Ae(this,R,null),super.remove())}setParent(M){!this.parent&&M?this._uiManager.removeShouldRescale(this):this.parent&&M===null&&this._uiManager.addShouldRescale(this),super.setParent(M)}onScaleChanging(){const[M,ne]=this.parentDimensions,he=this.width*M,ae=this.height*ne;this.setDimensions(he,ae)}enableEditMode(){w(this,v)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",w(this,f)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",w(this,f)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){w(this,v)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Ae(this,v,!0),this.div.classList.add("disabled"),me(this,oe,wt).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(M){super.focusin(M),this.enableEditMode()}canvasPointerdown(M){M.button!==0||!this.isInEditMode()||w(this,v)||(this.setInForeground(),M.preventDefault(),M.type!=="mouse"&&this.div.focus(),me(this,G,Xn).call(this,M.offsetX,M.offsetY))}canvasContextMenu(M){M.preventDefault()}canvasPointermove(M){M.preventDefault(),me(this,q,fn).call(this,M.offsetX,M.offsetY)}canvasPointerup(M){M.preventDefault(),me(this,ue,pn).call(this,M)}canvasPointerleave(M){me(this,ue,pn).call(this,M)}get isResizable(){return!this.isEmpty()&&w(this,v)}render(){if(this.div)return this.div;let M,ne;this.width&&(M=this.x,ne=this.y),super.render(),Fe._l10nPromise.get("editor_ink2_aria_label").then(Q=>{var H;return(H=this.div)==null?void 0:H.setAttribute("aria-label",Q)});const[he,ae,W,P]=me(this,$,Hn).call(this);if(this.setAt(he,ae,0,0),this.setDims(W,P),me(this,ie,Bt).call(this),this.width){const[Q,H]=this.parentDimensions;this.setAspectRatio(this.width*Q,this.height*H),this.setAt(M*Q,ne*H,this.width*Q,this.height*H),Ae(this,x,!0),me(this,Ie,xt).call(this),this.setDims(this.width*Q,this.height*H),me(this,re,mt).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return me(this,Ee,Vt).call(this),this.div}setDimensions(M,ne){const he=Math.round(M),ae=Math.round(ne);if(w(this,k)===he&&w(this,m)===ae)return;Ae(this,k,he),Ae(this,m,ae),this.canvas.style.visibility="hidden";const[W,P]=this.parentDimensions;this.width=M/W,this.height=ne/P,this.fixAndSetPosition(),w(this,v)&&me(this,Ue,mn).call(this,M,ne),me(this,Ie,xt).call(this),me(this,re,mt).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(M,ne,he){var He,Me,Le;if(M instanceof i.InkAnnotationElement)return null;const ae=super.deserialize(M,ne,he);ae.thickness=M.thickness,ae.color=n.Util.makeHexColor(...M.color),ae.opacity=M.opacity;const[W,P]=ae.pageDimensions,Q=ae.width*W,H=ae.height*P,te=ae.parentScale,le=M.thickness/2;Ae(ae,v,!0),Ae(ae,k,Math.round(Q)),Ae(ae,m,Math.round(H));const{paths:xe,rect:Pe,rotation:We}=M;for(let{bezier:ze}of xe){ze=me(He=Fe,Ke,Jn).call(He,ze,Pe,We);const je=[];ae.paths.push(je);let Je=te*(ze[0]-le),tt=te*(ze[1]-le);for(let nt=2,ct=ze.length;nt<ct;nt+=6){const lt=te*(ze[nt]-le),ht=te*(ze[nt+1]-le),dt=te*(ze[nt+2]-le),At=te*(ze[nt+3]-le),gt=te*(ze[nt+4]-le),_t=te*(ze[nt+5]-le);je.push([[Je,tt],[lt,ht],[dt,At],[gt,_t]]),Je=gt,tt=_t}const at=me(this,Te,qn).call(this,je);ae.bezierPath2D.push(at)}const ke=me(Me=ae,qe,vn).call(Me);return Ae(ae,l,Math.max(r.AnnotationEditor.MIN_SIZE,ke[2]-ke[0])),Ae(ae,u,Math.max(r.AnnotationEditor.MIN_SIZE,ke[3]-ke[1])),me(Le=ae,Ue,mn).call(Le,Q,H),ae}serialize(){if(this.isEmpty())return null;const M=this.getRect(0,0),ne=r.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:ne,thickness:this.thickness,opacity:this.opacity,paths:me(this,Ze,er).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,M),pageIndex:this.pageIndex,rect:M,rotation:this.rotation}}};let a=Fe;u=new WeakMap,l=new WeakMap,c=new WeakMap,h=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,g=new WeakMap,v=new WeakMap,y=new WeakMap,x=new WeakMap,R=new WeakMap,k=new WeakMap,m=new WeakMap,b=new WeakMap,I=new WeakSet,Gn=function(M){const ne=this.thickness;this.addCommands({cmd:()=>{this.thickness=M,me(this,oe,wt).call(this)},undo:()=>{this.thickness=ne,me(this,oe,wt).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},S=new WeakSet,zn=function(M){const ne=this.color;this.addCommands({cmd:()=>{this.color=M,me(this,re,mt).call(this)},undo:()=>{this.color=ne,me(this,re,mt).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},E=new WeakSet,$n=function(M){M/=100;const ne=this.opacity;this.addCommands({cmd:()=>{this.opacity=M,me(this,re,mt).call(this)},undo:()=>{this.opacity=ne,me(this,re,mt).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},$=new WeakSet,Hn=function(){const{parentRotation:M,parentDimensions:[ne,he]}=this;switch(M){case 90:return[0,he,he,ne];case 180:return[ne,he,ne,he];case 270:return[ne,0,he,ne];default:return[0,0,ne,he]}},V=new WeakSet,dn=function(){const{ctx:M,color:ne,opacity:he,thickness:ae,parentScale:W,scaleFactor:P}=this;M.lineWidth=ae*W/P,M.lineCap="round",M.lineJoin="round",M.miterLimit=10,M.strokeStyle=`${ne}${(0,o.opacityToHex)(he)}`},G=new WeakSet,Xn=function(M,ne){this.canvas.addEventListener("contextmenu",w(this,c)),this.canvas.addEventListener("pointerleave",w(this,d)),this.canvas.addEventListener("pointermove",w(this,h)),this.canvas.addEventListener("pointerup",w(this,p)),this.canvas.removeEventListener("pointerdown",w(this,f)),this.isEditing=!0,w(this,x)||(Ae(this,x,!0),me(this,Ie,xt).call(this),this.thickness||(this.thickness=Fe._defaultThickness),this.color||(this.color=Fe._defaultColor||r.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Fe._defaultOpacity)),this.currentPath.push([M,ne]),Ae(this,y,!1),me(this,V,dn).call(this),Ae(this,b,()=>{me(this,N,Kn).call(this),w(this,b)&&window.requestAnimationFrame(w(this,b))}),window.requestAnimationFrame(w(this,b))},q=new WeakSet,fn=function(M,ne){const[he,ae]=this.currentPath.at(-1);if(this.currentPath.length>1&&M===he&&ne===ae)return;const W=this.currentPath;let P=w(this,g);if(W.push([M,ne]),Ae(this,y,!0),W.length<=2){P.moveTo(...W[0]),P.lineTo(M,ne);return}W.length===3&&(Ae(this,g,P=new Path2D),P.moveTo(...W[0])),me(this,z,Zn).call(this,P,...W.at(-3),...W.at(-2),M,ne)},J=new WeakSet,Yn=function(){if(this.currentPath.length===0)return;const M=this.currentPath.at(-1);w(this,g).lineTo(...M)},K=new WeakSet,jn=function(M,ne){Ae(this,b,null),M=Math.min(Math.max(M,0),this.canvas.width),ne=Math.min(Math.max(ne,0),this.canvas.height),me(this,q,fn).call(this,M,ne),me(this,J,Yn).call(this);let he;if(this.currentPath.length!==1)he=me(this,U,Qn).call(this);else{const H=[M,ne];he=[[H,H.slice(),H.slice(),H]]}const ae=w(this,g),W=this.currentPath;this.currentPath=[],Ae(this,g,new Path2D);const P=()=>{this.allRawPaths.push(W),this.paths.push(he),this.bezierPath2D.push(ae),this.rebuild()},Q=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(me(this,ie,Bt).call(this),me(this,Ee,Vt).call(this)),me(this,oe,wt).call(this))};this.addCommands({cmd:P,undo:Q,mustExec:!0})},N=new WeakSet,Kn=function(){if(!w(this,y))return;Ae(this,y,!1);const M=Math.ceil(this.thickness*this.parentScale),ne=this.currentPath.slice(-3),he=ne.map(P=>P[0]),ae=ne.map(P=>P[1]);Math.min(...he)-M,Math.max(...he)+M,Math.min(...ae)-M,Math.max(...ae)+M;const{ctx:W}=this;W.save(),W.clearRect(0,0,this.canvas.width,this.canvas.height);for(const P of this.bezierPath2D)W.stroke(P);W.stroke(w(this,g)),W.restore()},z=new WeakSet,Zn=function(M,ne,he,ae,W,P,Q){const H=(ne+ae)/2,te=(he+W)/2,le=(ae+P)/2,xe=(W+Q)/2;M.bezierCurveTo(H+2*(ae-H)/3,te+2*(W-te)/3,le+2*(ae-le)/3,xe+2*(W-xe)/3,le,xe)},U=new WeakSet,Qn=function(){const M=this.currentPath;if(M.length<=2)return[[M[0],M[0],M.at(-1),M.at(-1)]];const ne=[];let he,[ae,W]=M[0];for(he=1;he<M.length-2;he++){const[Pe,We]=M[he],[ke,He]=M[he+1],Me=(Pe+ke)/2,Le=(We+He)/2,ze=[ae+2*(Pe-ae)/3,W+2*(We-W)/3],je=[Me+2*(Pe-Me)/3,Le+2*(We-Le)/3];ne.push([[ae,W],ze,je,[Me,Le]]),[ae,W]=[Me,Le]}const[P,Q]=M[he],[H,te]=M[he+1],le=[ae+2*(P-ae)/3,W+2*(Q-W)/3],xe=[H+2*(P-H)/3,te+2*(Q-te)/3];return ne.push([[ae,W],le,xe,[H,te]]),ne},re=new WeakSet,mt=function(){if(this.isEmpty()){me(this,be,Wt).call(this);return}me(this,V,dn).call(this);const{canvas:M,ctx:ne}=this;ne.setTransform(1,0,0,1,0,0),ne.clearRect(0,0,M.width,M.height),me(this,be,Wt).call(this);for(const he of this.bezierPath2D)ne.stroke(he)},ue=new WeakSet,pn=function(M){this.canvas.removeEventListener("pointerleave",w(this,d)),this.canvas.removeEventListener("pointermove",w(this,h)),this.canvas.removeEventListener("pointerup",w(this,p)),this.canvas.addEventListener("pointerdown",w(this,f)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",w(this,c))},10),me(this,K,jn).call(this,M.offsetX,M.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ie=new WeakSet,Bt=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Fe._l10nPromise.get("editor_ink_canvas_aria_label").then(M=>{var ne;return(ne=this.canvas)==null?void 0:ne.setAttribute("aria-label",M)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Ee=new WeakSet,Vt=function(){Ae(this,R,new ResizeObserver(M=>{const ne=M[0].contentRect;ne.width&&ne.height&&this.setDimensions(ne.width,ne.height)})),w(this,R).observe(this.div)},Ie=new WeakSet,xt=function(){if(!w(this,x))return;const[M,ne]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*M),this.canvas.height=Math.ceil(this.height*ne),me(this,be,Wt).call(this)},Ue=new WeakSet,mn=function(M,ne){const he=me(this,Se,Ut).call(this),ae=(M-he)/w(this,l),W=(ne-he)/w(this,u);this.scaleFactor=Math.min(ae,W)},be=new WeakSet,Wt=function(){const M=me(this,Se,Ut).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+M,this.translationY*this.scaleFactor+M)},Te=new WeakSet,qn=function(M){const ne=new Path2D;for(let he=0,ae=M.length;he<ae;he++){const[W,P,Q,H]=M[he];he===0&&ne.moveTo(...W),ne.bezierCurveTo(P[0],P[1],Q[0],Q[1],H[0],H[1])}return ne},Ve=new WeakSet,gn=function(M,ne,he){const[ae,W,P,Q]=ne;switch(he){case 0:for(let H=0,te=M.length;H<te;H+=2)M[H]+=ae,M[H+1]=Q-M[H+1];break;case 90:for(let H=0,te=M.length;H<te;H+=2){const le=M[H];M[H]=M[H+1]+ae,M[H+1]=le+W}break;case 180:for(let H=0,te=M.length;H<te;H+=2)M[H]=P-M[H],M[H+1]+=W;break;case 270:for(let H=0,te=M.length;H<te;H+=2){const le=M[H];M[H]=P-M[H+1],M[H+1]=Q-le}break;default:throw new Error("Invalid rotation")}return M},Ke=new WeakSet,Jn=function(M,ne,he){const[ae,W,P,Q]=ne;switch(he){case 0:for(let H=0,te=M.length;H<te;H+=2)M[H]-=ae,M[H+1]=Q-M[H+1];break;case 90:for(let H=0,te=M.length;H<te;H+=2){const le=M[H];M[H]=M[H+1]-W,M[H+1]=le-ae}break;case 180:for(let H=0,te=M.length;H<te;H+=2)M[H]=P-M[H],M[H+1]-=W;break;case 270:for(let H=0,te=M.length;H<te;H+=2){const le=M[H];M[H]=Q-M[H+1],M[H+1]=P-le}break;default:throw new Error("Invalid rotation")}return M},Ze=new WeakSet,er=function(M,ne,he,ae){var te,le;const W=[],P=this.thickness/2,Q=M*ne+P,H=M*he+P;for(const xe of this.paths){const Pe=[],We=[];for(let ke=0,He=xe.length;ke<He;ke++){const[Me,Le,ze,je]=xe[ke],Je=M*Me[0]+Q,tt=M*Me[1]+H,at=M*Le[0]+Q,nt=M*Le[1]+H,ct=M*ze[0]+Q,lt=M*ze[1]+H,ht=M*je[0]+Q,dt=M*je[1]+H;ke===0&&(Pe.push(Je,tt),We.push(Je,tt)),Pe.push(at,nt,ct,lt,ht,dt),We.push(at,nt),ke===He-1&&We.push(ht,dt)}W.push({bezier:me(te=Fe,Ve,gn).call(te,Pe,ae,this.rotation),points:me(le=Fe,Ve,gn).call(le,We,ae,this.rotation)})}return W},qe=new WeakSet,vn=function(){let M=1/0,ne=-1/0,he=1/0,ae=-1/0;for(const W of this.paths)for(const[P,Q,H,te]of W){const le=n.Util.bezierBoundingBox(...P,...Q,...H,...te);M=Math.min(M,le[0]),he=Math.min(he,le[1]),ne=Math.max(ne,le[2]),ae=Math.max(ae,le[3])}return[M,he,ne,ae]},Se=new WeakSet,Ut=function(){return w(this,v)?Math.ceil(this.thickness*this.parentScale):0},oe=new WeakSet,wt=function(){let M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isEmpty())return;if(!w(this,v)){me(this,re,mt).call(this);return}const ne=me(this,qe,vn).call(this),he=me(this,Se,Ut).call(this);Ae(this,l,Math.max(r.AnnotationEditor.MIN_SIZE,ne[2]-ne[0])),Ae(this,u,Math.max(r.AnnotationEditor.MIN_SIZE,ne[3]-ne[1]));const ae=Math.ceil(he+w(this,l)*this.scaleFactor),W=Math.ceil(he+w(this,u)*this.scaleFactor),[P,Q]=this.parentDimensions;this.width=ae/P,this.height=W/Q,this.setAspectRatio(ae,W);const H=this.translationX,te=this.translationY;this.translationX=-ne[0],this.translationY=-ne[1],me(this,Ie,xt).call(this),me(this,re,mt).call(this),Ae(this,k,ae),Ae(this,m,W),this.setDims(ae,W);const le=M?he/this.scaleFactor/2:0;this.translate(H-this.translationX-le,te-this.translationY-le)},se(a,Te),se(a,Ve),se(a,Ke),st(a,"_defaultColor",null),st(a,"_defaultOpacity",1),st(a,"_defaultThickness",1),st(a,"_l10nPromise"),st(a,"_type","ink"),e.InkEditor=a},(s,e,t)=>{var u,l,c,h,d,p,f,g,v,yn,x,It,k,tr,b,nr,_,An,T,Gt,L,rr;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0,t(148),t(151);var n=t(163),r=t(1),i=t(167),o=t(197);class a extends n.AnnotationEditor{constructor(j){super({...j,name:"stampEditor"});se(this,v);se(this,x);se(this,k);se(this,b);se(this,_);se(this,T);se(this,L);se(this,u,null);se(this,l,null);se(this,c,null);se(this,h,null);se(this,d,null);se(this,p,null);se(this,f,null);se(this,g,!1);Ae(this,h,j.bitmapUrl)}remove(){var j,G;w(this,l)&&(Ae(this,u,null),this._uiManager.imageManager.deleteId(w(this,l)),(j=w(this,d))==null||j.remove(),Ae(this,d,null),(G=w(this,p))==null||G.disconnect(),Ae(this,p,null)),super.remove()}rebuild(){super.rebuild(),this.div!==null&&(w(this,l)&&me(this,v,yn).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this.div.draggable=!0,this.parent.addUndoableEditor(this),this.div.focus()}isEmpty(){return w(this,c)===null&&w(this,u)===null&&w(this,h)===null}get isResizable(){return!0}render(){if(this.div)return this.div;let j,G;if(this.width&&(j=this.x,G=this.y),super.render(),w(this,u)?me(this,x,It).call(this):(this.div.classList.add("loading"),me(this,v,yn).call(this)),this.width){const[X,q]=this.parentDimensions;this.setAt(j*X,G*q,this.width*X,this.height*q)}return this.div}static deserialize(j,G,X){if(j instanceof o.StampAnnotationElement)return null;const q=super.deserialize(j,G,X),{rect:Z,bitmapUrl:J,bitmapId:ve,isSvg:K}=j;ve&&X.imageManager.isValidId(ve)?Ae(q,l,ve):Ae(q,h,J),Ae(q,g,K);const[O,N]=q.pageDimensions;return q.width=(Z[2]-Z[0])/O,q.height=(Z[3]-Z[1])/N,q}serialize(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.isEmpty())return null;const X={annotationType:r.AnnotationEditorType.STAMP,bitmapId:w(this,l),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:w(this,g)};if(j)return X.bitmapUrl=me(this,T,Gt).call(this,!0),X;if(G===null)return X;G.stamps||(G.stamps=new Map);const q=w(this,g)?(X.rect[2]-X.rect[0])*(X.rect[3]-X.rect[1]):null;if(!G.stamps.has(w(this,l)))G.stamps.set(w(this,l),{area:q,serialized:X}),X.bitmap=me(this,T,Gt).call(this,!1);else if(w(this,g)){const Z=G.stamps.get(w(this,l));q>Z.area&&(Z.area=q,Z.serialized.bitmap.close(),Z.serialized.bitmap=me(this,T,Gt).call(this,!1))}return X}}u=new WeakMap,l=new WeakMap,c=new WeakMap,h=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,g=new WeakMap,v=new WeakSet,yn=function(){if(w(this,l)){this._uiManager.imageManager.getFromId(w(this,l)).then(G=>{if(!G){this.remove();return}Ae(this,u,G.bitmap),me(this,x,It).call(this)});return}if(w(this,h)){const G=w(this,h);Ae(this,h,null),Ae(this,c,this._uiManager.imageManager.getFromUrl(G).then(X=>{if(Ae(this,c,null),!X){this.remove();return}({bitmap:pt(this,u)._,id:pt(this,l)._,isSvg:pt(this,g)._}=X),me(this,x,It).call(this)}));return}const j=document.createElement("input");j.type="file",j.accept="image/*",Ae(this,c,new Promise(G=>{j.addEventListener("change",async()=>{if(Ae(this,c,null),!j.files||j.files.length===0)this.remove();else{const X=await this._uiManager.imageManager.getFromFile(j.files[0]);if(!X){this.remove();return}({bitmap:pt(this,u)._,id:pt(this,l)._,isSvg:pt(this,g)._}=X),me(this,x,It).call(this)}G()}),j.addEventListener("cancel",()=>{Ae(this,c,null),this.remove(),G()})})),j.click()},x=new WeakSet,It=function(){const{div:j}=this;let{width:G,height:X}=w(this,u);const[q,Z]=this.pageDimensions,J=.75;if(this.width)G=this.width*q,X=this.height*Z;else if(G>J*q||X>J*Z){const N=Math.min(J*q/G,J*Z/X);G*=N,X*=N}const[ve,K]=this.parentDimensions;this.setDims(G*ve/q,X*K/Z);const O=Ae(this,d,document.createElement("canvas"));j.append(O),me(this,_,An).call(this,G,X),me(this,L,rr).call(this),j.classList.remove("loading")},k=new WeakSet,tr=function(j,G){const[X,q]=this.parentDimensions;this.width=j/X,this.height=G/q,this.setDims(j,G),this.fixAndSetPosition(),w(this,f)!==null&&clearTimeout(w(this,f)),Ae(this,f,setTimeout(()=>{Ae(this,f,null),me(this,_,An).call(this,j,G)},200))},b=new WeakSet,nr=function(j,G){const{width:X,height:q}=w(this,u);let Z=X,J=q,ve=w(this,u);for(;Z>2*j||J>2*G;){const K=Z,O=J;Z>2*j&&(Z=Z>=16384?Math.floor(Z/2)-1:Math.ceil(Z/2)),J>2*G&&(J=J>=16384?Math.floor(J/2)-1:Math.ceil(J/2));const N=new OffscreenCanvas(Z,J);N.getContext("2d").drawImage(ve,0,0,K,O,0,0,Z,J),ve=N.transferToImageBitmap()}return ve},_=new WeakSet,An=function(j,G){const X=w(this,d);if(!X||X.width===j&&X.height===G)return;X.width=j,X.height=G;const q=w(this,g)?w(this,u):me(this,b,nr).call(this,j,G),Z=X.getContext("2d");Z.filter=this._uiManager.hcmFilter,Z.drawImage(q,0,0,q.width,q.height,0,0,j,G)},T=new WeakSet,Gt=function(j){if(j){if(w(this,g)){const q=this._uiManager.imageManager.getSvgUrl(w(this,l));if(q)return q}const G=document.createElement("canvas");return{width:G.width,height:G.height}=w(this,u),G.getContext("2d").drawImage(w(this,u),0,0),G.toDataURL()}if(w(this,g)){const[G,X]=this.pageDimensions,q=Math.round(this.width*G*i.PixelsPerInch.PDF_TO_CSS_UNITS),Z=Math.round(this.height*X*i.PixelsPerInch.PDF_TO_CSS_UNITS),J=new OffscreenCanvas(q,Z);return J.getContext("2d").drawImage(w(this,u),0,0,w(this,u).width,w(this,u).height,0,0,q,Z),J.transferToImageBitmap()}return structuredClone(w(this,u))},L=new WeakSet,rr=function(){Ae(this,p,new ResizeObserver(j=>{const G=j[0].contentRect;G.width&&G.height&&me(this,k,tr).call(this,G.width,G.height)})),w(this,p).observe(this.div)},st(a,"_type","stamp"),e.StampEditor=a}],__webpack_module_cache__={};function __w_pdfjs_require__(s){var e=__webpack_module_cache__[s];if(e!==void 0)return e.exports;var t=__webpack_module_cache__[s]={exports:{}};return __webpack_modules__[s].call(t.exports,t,t.exports,__w_pdfjs_require__),t.exports}var __webpack_exports__={};return(()=>{var s=__webpack_exports__;Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(s,"AnnotationEditorLayer",{enumerable:!0,get:function(){return i.AnnotationEditorLayer}}),Object.defineProperty(s,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(s,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(s,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return o.AnnotationEditorUIManager}}),Object.defineProperty(s,"AnnotationLayer",{enumerable:!0,get:function(){return a.AnnotationLayer}}),Object.defineProperty(s,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(s,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(s,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(s,"GlobalWorkerOptions",{enumerable:!0,get:function(){return u.GlobalWorkerOptions}}),Object.defineProperty(s,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(s,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(s,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(s,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(s,"PDFDataRangeTransport",{enumerable:!0,get:function(){return t.PDFDataRangeTransport}}),Object.defineProperty(s,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(s,"PDFWorker",{enumerable:!0,get:function(){return t.PDFWorker}}),Object.defineProperty(s,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(s,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(s,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(s,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(s,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(s,"SVGGraphics",{enumerable:!0,get:function(){return t.SVGGraphics}}),Object.defineProperty(s,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(s,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(s,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(s,"XfaLayer",{enumerable:!0,get:function(){return l.XfaLayer}}),Object.defineProperty(s,"build",{enumerable:!0,get:function(){return t.build}}),Object.defineProperty(s,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(s,"getDocument",{enumerable:!0,get:function(){return t.getDocument}}),Object.defineProperty(s,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(s,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(s,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(s,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(s,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(s,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(s,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(s,"renderTextLayer",{enumerable:!0,get:function(){return r.renderTextLayer}}),Object.defineProperty(s,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(s,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(s,"updateTextLayer",{enumerable:!0,get:function(){return r.updateTextLayer}}),Object.defineProperty(s,"version",{enumerable:!0,get:function(){return t.version}});var e=__w_pdfjs_require__(1),t=__w_pdfjs_require__(124),n=__w_pdfjs_require__(167),r=__w_pdfjs_require__(194),i=__w_pdfjs_require__(195),o=__w_pdfjs_require__(164),a=__w_pdfjs_require__(197),u=__w_pdfjs_require__(175),l=__w_pdfjs_require__(200)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;const pdfjsWorkerURL="/acchymns-dev/assets/pdf.worker.min-4b291930.js",_sfc_main$2=defineComponent({__name:"PDFWrapper",props:{src:{}},emits:["error"],setup(s,{emit:e}){const t=s;pdfExports.GlobalWorkerOptions.workerSrc=pdfjsWorkerURL;let n=ref();return onMounted(async()=>{var i;let r;try{r=await pdfExports.getDocument(t.src).promise}catch{e("error");return}for(let o=1;o<=r.numPages;o++){let a=document.createElement("canvas"),u=await r.getPage(o);const l=Capacitor.getPlatform()=="web"?5:window.devicePixelRatio;let c=u.getViewport({scale:l});a.height=c.height,a.width=c.width;let h=a.getContext("2d");if(h===null){e("error");return}try{await u.render({canvasContext:h,viewport:c}).promise,a.style.width="100%";const d=a.toDataURL("image/png"),p=document.createElement("img");p.classList.add("song-img"),p.src=d,(i=n.value)==null||i.appendChild(p)}catch{e("error");return}}}),(r,i)=>(openBlock(),createElementBlock("div",{ref_key:"root",ref:n,class:"container"},null,512))}}),PDFWrapper_vue_vue_type_style_index_0_lang="",PDFWrapper_vue_vue_type_style_index_1_lang="",_withScopeId=s=>(pushScopeId("data-v-1226a89e"),s=s(),popScopeId(),s),_hoisted_1$1={key:0,class:"fallback-container"},_hoisted_2$1=_withScopeId(()=>createBaseVNode("img",{src:_imports_0,class:"wifi-fallback"},null,-1)),_hoisted_3$1=[_hoisted_2$1],_hoisted_4$1=["src"],_sfc_main$1=defineComponent({__name:"SongContainer",props:{book:{},number:{}},setup(s){const e=s;let t=ref(""),n=ref();function r(x,R,k){const m=R+"."+k[x].fileExtension;return`${k[x].srcUrl}/songs/${m}`}let i=ref(""),o=ref(!1);const a=useMediaQuery("(prefers-color-scheme: dark)"),u=useLocalStorage("ACCOptions.overrideSystemTheme",!1),l=useLocalStorage("ACCOptions.overrideDarkMode",!1);let c=useLocalStorage("ACCOptions.songInverted",!1);const h=computed(()=>u.value?l.value:a.value),d=computed(()=>h.value&&c.value);let p=readonly(useLocalStorage("ACCOptions.panzoomEnable",!0)),f;var g=Capacitor.getPlatform()!=="web";onMounted(async()=>{const x=await getAllBookMetaData();if(console.log(x[e.book]),x[e.book]==null){o.value=!0;return}const R=r(e.book,e.number,x);t.value=x[e.book].fileExtension,i.value=R,p.value&&(f=createPanZoom$1(n.value,{beforeWheel:k=>k.shiftKey,maxZoom:3,minZoom:g?1:.25,bounds:!0,boundsPadding:g?1:.5})),g&&setInterval(()=>{y.refresh()},10)});class v{constructor(R){st(this,"_observer");st(this,"_observedNodes");this._observer=R,this._observedNodes=new Set}observe(R){this._observedNodes.add(R),this._observer.observe(R)}unobserve(R){this._observedNodes.delete(R),this._observer.unobserve(R)}disconnect(){this._observedNodes.clear(),this._observer.disconnect()}refresh(){for(let R of this._observedNodes)this._observer.unobserve(R),this._observer.observe(R)}}const y=new v(new IntersectionObserver((x,R)=>{for(const k of x){let m=k.boundingClientRect;k.intersectionRect.height<m.height?f.setVerticalPan(!0):f.setVerticalPan(!1)}},{root:null,rootMargin:"0px",threshold:1}));return onUpdated(async()=>{g&&y.observe(n.value)}),(x,R)=>unref(o)?(openBlock(),createElementBlock("div",_hoisted_1$1,_hoisted_3$1)):(openBlock(),createElementBlock("div",{key:1,ref_key:"panzoom_container",ref:n,class:"panzoom-container"},[unref(t)=="pdf"?(openBlock(),createBlock(_sfc_main$2,{key:0,onError:R[0]||(R[0]=k=>isRef(o)?o.value=!0:o=!0),src:unref(i),class:normalizeClass(["song-img",{"inverted-song":d.value}])},null,8,["src","class"])):unref(t)!==""?(openBlock(),createElementBlock("img",{key:1,onError:R[1]||(R[1]=k=>isRef(o)?o.value=!0:o=!0),src:unref(i),class:normalizeClass(["song-img",{"inverted-song":d.value}])},null,42,_hoisted_4$1)):createCommentVNode("",!0)],512))}}),SongContainer_vue_vue_type_style_index_0_scoped_1226a89e_lang="",SongContainer=_export_sfc(_sfc_main$1,[["__scopeId","data-v-1226a89e"]]),version="14.7.77",createExtendedExponentialRampToValueAutomationEvent=(s,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:s}),createExtendedLinearRampToValueAutomationEvent=(s,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:s}),createSetValueAutomationEvent=(s,e)=>({startTime:e,type:"setValue",value:s}),createSetValueCurveAutomationEvent=(s,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:s}),getTargetValueAtTime=(s,e,{startTime:t,target:n,timeConstant:r})=>n+(e-n)*Math.exp((t-s)/r),isExponentialRampToValueAutomationEvent=s=>s.type==="exponentialRampToValue",isLinearRampToValueAutomationEvent=s=>s.type==="linearRampToValue",isAnyRampToValueAutomationEvent=s=>isExponentialRampToValueAutomationEvent(s)||isLinearRampToValueAutomationEvent(s),isSetValueAutomationEvent=s=>s.type==="setValue",isSetValueCurveAutomationEvent=s=>s.type==="setValueCurve",getValueOfAutomationEventAtIndexAtTime=(s,e,t,n)=>{const r=s[e];return r===void 0?n:isAnyRampToValueAutomationEvent(r)||isSetValueAutomationEvent(r)?r.value:isSetValueCurveAutomationEvent(r)?r.values[r.values.length-1]:getTargetValueAtTime(t,getValueOfAutomationEventAtIndexAtTime(s,e-1,r.startTime,n),r)},getEndTimeAndValueOfPreviousAutomationEvent=(s,e,t,n,r)=>t===void 0?[n.insertTime,r]:isAnyRampToValueAutomationEvent(t)?[t.endTime,t.value]:isSetValueAutomationEvent(t)?[t.startTime,t.value]:isSetValueCurveAutomationEvent(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,getValueOfAutomationEventAtIndexAtTime(s,e-1,t.startTime,r)],isCancelAndHoldAutomationEvent=s=>s.type==="cancelAndHold",isCancelScheduledValuesAutomationEvent=s=>s.type==="cancelScheduledValues",getEventTime=s=>isCancelAndHoldAutomationEvent(s)||isCancelScheduledValuesAutomationEvent(s)?s.cancelTime:isExponentialRampToValueAutomationEvent(s)||isLinearRampToValueAutomationEvent(s)?s.endTime:s.startTime,getExponentialRampValueAtTime=(s,e,t,{endTime:n,value:r})=>t===r?r:0<t&&0<r||t<0&&r<0?t*(r/t)**((s-e)/(n-e)):0,getLinearRampValueAtTime=(s,e,t,{endTime:n,value:r})=>t+(s-e)/(n-e)*(r-t),interpolateValue=(s,e)=>{const t=Math.floor(e),n=Math.ceil(e);return t===n?s[t]:(1-(e-t))*s[t]+(1-(n-e))*s[n]},getValueCurveValueAtTime=(s,{duration:e,startTime:t,values:n})=>{const r=(s-t)/e*(n.length-1);return interpolateValue(n,r)},isSetTargetAutomationEvent=s=>s.type==="setTarget";class AutomationEventList{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=getEventTime(e);if(isCancelAndHoldAutomationEvent(e)||isCancelScheduledValuesAutomationEvent(e)){const n=this._automationEvents.findIndex(i=>isCancelScheduledValuesAutomationEvent(e)&&isSetValueCurveAutomationEvent(i)?i.startTime+i.duration>=t:getEventTime(i)>=t),r=this._automationEvents[n];if(n!==-1&&(this._automationEvents=this._automationEvents.slice(0,n)),isCancelAndHoldAutomationEvent(e)){const i=this._automationEvents[this._automationEvents.length-1];if(r!==void 0&&isAnyRampToValueAutomationEvent(r)){if(i!==void 0&&isSetTargetAutomationEvent(i))throw new Error("The internal list is malformed.");const o=i===void 0?r.insertTime:isSetValueCurveAutomationEvent(i)?i.startTime+i.duration:getEventTime(i),a=i===void 0?this._defaultValue:isSetValueCurveAutomationEvent(i)?i.values[i.values.length-1]:i.value,u=isExponentialRampToValueAutomationEvent(r)?getExponentialRampValueAtTime(t,o,a,r):getLinearRampValueAtTime(t,o,a,r),l=isExponentialRampToValueAutomationEvent(r)?createExtendedExponentialRampToValueAutomationEvent(u,t,this._currenTime):createExtendedLinearRampToValueAutomationEvent(u,t,this._currenTime);this._automationEvents.push(l)}if(i!==void 0&&isSetTargetAutomationEvent(i)&&this._automationEvents.push(createSetValueAutomationEvent(this.getValue(t),t)),i!==void 0&&isSetValueCurveAutomationEvent(i)&&i.startTime+i.duration>t){const o=t-i.startTime,a=(i.values.length-1)/i.duration,u=Math.max(2,1+Math.ceil(o*a)),l=o/(u-1)*a,c=i.values.slice(0,u);if(l<1)for(let h=1;h<u;h+=1){const d=l*h%1;c[h]=i.values[h-1]*(1-d)+i.values[h]*d}this._automationEvents[this._automationEvents.length-1]=createSetValueCurveAutomationEvent(c,i.startTime,o)}}}else{const n=this._automationEvents.findIndex(o=>getEventTime(o)>t),r=n===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[n-1];if(r!==void 0&&isSetValueCurveAutomationEvent(r)&&getEventTime(r)+r.duration>t)return!1;const i=isExponentialRampToValueAutomationEvent(e)?createExtendedExponentialRampToValueAutomationEvent(e.value,e.endTime,this._currenTime):isLinearRampToValueAutomationEvent(e)?createExtendedLinearRampToValueAutomationEvent(e.value,t,this._currenTime):e;if(n===-1)this._automationEvents.push(i);else{if(isSetValueCurveAutomationEvent(e)&&t+e.duration>getEventTime(this._automationEvents[n]))return!1;this._automationEvents.splice(n,0,i)}}return!0}flush(e){const t=this._automationEvents.findIndex(n=>getEventTime(n)>e);if(t>1){const n=this._automationEvents.slice(t-1),r=n[0];isSetTargetAutomationEvent(r)&&n.unshift(createSetValueAutomationEvent(getValueOfAutomationEventAtIndexAtTime(this._automationEvents,t-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=n}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(o=>getEventTime(o)>e),n=this._automationEvents[t],r=(t===-1?this._automationEvents.length:t)-1,i=this._automationEvents[r];if(i!==void 0&&isSetTargetAutomationEvent(i)&&(n===void 0||!isAnyRampToValueAutomationEvent(n)||n.insertTime>e))return getTargetValueAtTime(e,getValueOfAutomationEventAtIndexAtTime(this._automationEvents,r-1,i.startTime,this._defaultValue),i);if(i!==void 0&&isSetValueAutomationEvent(i)&&(n===void 0||!isAnyRampToValueAutomationEvent(n)))return i.value;if(i!==void 0&&isSetValueCurveAutomationEvent(i)&&(n===void 0||!isAnyRampToValueAutomationEvent(n)||i.startTime+i.duration>e))return e<i.startTime+i.duration?getValueCurveValueAtTime(e,i):i.values[i.values.length-1];if(i!==void 0&&isAnyRampToValueAutomationEvent(i)&&(n===void 0||!isAnyRampToValueAutomationEvent(n)))return i.value;if(n!==void 0&&isExponentialRampToValueAutomationEvent(n)){const[o,a]=getEndTimeAndValueOfPreviousAutomationEvent(this._automationEvents,r,i,n,this._defaultValue);return getExponentialRampValueAtTime(e,o,a,n)}if(n!==void 0&&isLinearRampToValueAutomationEvent(n)){const[o,a]=getEndTimeAndValueOfPreviousAutomationEvent(this._automationEvents,r,i,n,this._defaultValue);return getLinearRampValueAtTime(e,o,a,n)}return this._defaultValue}}const createCancelAndHoldAutomationEvent=s=>({cancelTime:s,type:"cancelAndHold"}),createCancelScheduledValuesAutomationEvent=s=>({cancelTime:s,type:"cancelScheduledValues"}),createExponentialRampToValueAutomationEvent=(s,e)=>({endTime:e,type:"exponentialRampToValue",value:s}),createLinearRampToValueAutomationEvent=(s,e)=>({endTime:e,type:"linearRampToValue",value:s}),createSetTargetAutomationEvent=(s,e,t)=>({startTime:e,target:s,timeConstant:t,type:"setTarget"}),createAbortError=()=>new DOMException("","AbortError"),createAddActiveInputConnectionToAudioNode=s=>(e,t,[n,r,i],o)=>{s(e[r],[t,n,i],a=>a[0]===t&&a[1]===n,o)},createAddAudioNodeConnections=s=>(e,t,n)=>{const r=[];for(let i=0;i<n.numberOfInputs;i+=1)r.push(new Set);s.set(e,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},createAddAudioParamConnections=s=>(e,t)=>{s.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},ACTIVE_AUDIO_NODE_STORE=new WeakSet,AUDIO_NODE_CONNECTIONS_STORE=new WeakMap,AUDIO_NODE_STORE=new WeakMap,AUDIO_PARAM_CONNECTIONS_STORE=new WeakMap,AUDIO_PARAM_STORE=new WeakMap,CONTEXT_STORE=new WeakMap,EVENT_LISTENERS=new WeakMap,CYCLE_COUNTERS=new WeakMap,NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS=new WeakMap,NODE_TO_PROCESSOR_MAPS=new WeakMap,handler={construct(){return handler}},isConstructible=s=>{try{const e=new Proxy(s,handler);new e}catch{return!1}return!0},IMPORT_STATEMENT_REGEX=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,splitImportStatements=(s,e)=>{const t=[];let n=s.replace(/^[\s]+/,""),r=n.match(IMPORT_STATEMENT_REGEX);for(;r!==null;){const i=r[1].slice(1,-1),o=r[0].replace(/([\s]+)?;?$/,"").replace(i,new URL(i,e).toString());t.push(o),n=n.slice(r[0].length).replace(/^[\s]+/,""),r=n.match(IMPORT_STATEMENT_REGEX)}return[t.join(";"),n]},verifyParameterDescriptors=s=>{if(s!==void 0&&!Array.isArray(s))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},verifyProcessorCtor=s=>{if(!isConstructible(s))throw new TypeError("The given value for processorCtor should be a constructor.");if(s.prototype===null||typeof s.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},createAddAudioWorkletModule=(s,e,t,n,r,i,o,a,u,l,c,h,d)=>{let p=0;return(f,g,v={credentials:"omit"})=>{const y=c.get(f);if(y!==void 0&&y.has(g))return Promise.resolve();const x=l.get(f);if(x!==void 0){const m=x.get(g);if(m!==void 0)return m}const R=i(f),k=R.audioWorklet===void 0?r(g).then(([m,b])=>{const[I,_]=splitImportStatements(m,b),S=`${I};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${_}
})})(window,'_AWGS')`;return t(S)}).then(()=>{const m=d._AWGS.pop();if(m===void 0)throw new SyntaxError;n(R.currentTime,R.sampleRate,()=>m(class{},void 0,(b,I)=>{if(b.trim()==="")throw e();const _=NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS.get(R);if(_!==void 0){if(_.has(b))throw e();verifyProcessorCtor(I),verifyParameterDescriptors(I.parameterDescriptors),_.set(b,I)}else verifyProcessorCtor(I),verifyParameterDescriptors(I.parameterDescriptors),NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS.set(R,new Map([[b,I]]))},R.sampleRate,void 0,void 0))}):Promise.all([r(g),Promise.resolve(s(h,h))]).then(([[m,b],I])=>{const _=p+1;p=_;const[S,T]=splitImportStatements(m,b),Y=`${S};((AudioWorkletProcessor,registerProcessor)=>{${T}
})(${I?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${I?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${I?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${_}',class extends AudioWorkletProcessor{process(){return !1}})`,V=new Blob([Y],{type:"application/javascript; charset=utf-8"}),j=URL.createObjectURL(V);return R.audioWorklet.addModule(j,v).then(()=>{if(a(R))return R;const G=o(R);return G.audioWorklet.addModule(j,v).then(()=>G)}).then(G=>{if(u===null)throw new SyntaxError;try{new u(G,`__sac${_}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(j))});return x===void 0?l.set(f,new Map([[g,k]])):x.set(g,k),k.then(()=>{const m=c.get(f);m===void 0?c.set(f,new Set([g])):m.add(g)}).finally(()=>{const m=l.get(f);m!==void 0&&m.delete(g)}),k}},getValueForKey=(s,e)=>{const t=s.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},pickElementFromSet=(s,e)=>{const t=Array.from(s).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[n]=t;return s.delete(n),n},deletePassiveInputConnectionToAudioNode=(s,e,t,n)=>{const r=getValueForKey(s,e),i=pickElementFromSet(r,o=>o[0]===t&&o[1]===n);return r.size===0&&s.delete(e),i},getEventListenersOfAudioNode=s=>getValueForKey(EVENT_LISTENERS,s),setInternalStateToActive=s=>{if(ACTIVE_AUDIO_NODE_STORE.has(s))throw new Error("The AudioNode is already stored.");ACTIVE_AUDIO_NODE_STORE.add(s),getEventListenersOfAudioNode(s).forEach(e=>e(!0))},isAudioWorkletNode=s=>"port"in s,setInternalStateToPassive=s=>{if(!ACTIVE_AUDIO_NODE_STORE.has(s))throw new Error("The AudioNode is not stored.");ACTIVE_AUDIO_NODE_STORE.delete(s),getEventListenersOfAudioNode(s).forEach(e=>e(!1))},setInternalStateToPassiveWhenNecessary=(s,e)=>{!isAudioWorkletNode(s)&&e.every(t=>t.size===0)&&setInternalStateToPassive(s)},createAddConnectionToAudioNode=(s,e,t,n,r,i,o,a,u,l,c,h,d)=>{const p=new WeakMap;return(f,g,v,y,x)=>{const{activeInputs:R,passiveInputs:k}=i(g),{outputs:m}=i(f),b=a(f),I=_=>{const S=u(g),T=u(f);if(_){const E=deletePassiveInputConnectionToAudioNode(k,f,v,y);s(R,f,E,!1),!x&&!h(f)&&t(T,S,v,y),d(g)&&setInternalStateToActive(g)}else{const E=n(R,f,v,y);e(k,y,E,!1),!x&&!h(f)&&r(T,S,v,y);const L=o(g);if(L===0)c(g)&&setInternalStateToPassiveWhenNecessary(g,R);else{const $=p.get(g);$!==void 0&&clearTimeout($),p.set(g,setTimeout(()=>{c(g)&&setInternalStateToPassiveWhenNecessary(g,R)},L*1e3))}}};return l(m,[g,v,y],_=>_[0]===g&&_[1]===v&&_[2]===y,!0)?(b.add(I),c(f)?s(R,f,[v,y,I],!0):e(k,y,[f,v,I],!0),!0):!1}},createAddPassiveInputConnectionToAudioNode=s=>(e,t,[n,r,i],o)=>{const a=e.get(n);a===void 0?e.set(n,new Set([[r,t,i]])):s(a,[r,t,i],u=>u[0]===r&&u[1]===t,o)},createAddSilentConnection=s=>(e,t)=>{const n=s(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(n).connect(e.destination);const r=()=>{t.removeEventListener("ended",r),t.disconnect(n),n.disconnect()};t.addEventListener("ended",r)},createAddUnrenderedAudioWorkletNode=s=>(e,t)=>{s(e).add(t)},DEFAULT_OPTIONS$j={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},createAnalyserNodeConstructor=(s,e,t,n,r,i)=>class extends s{constructor(a,u){const l=r(a),c={...DEFAULT_OPTIONS$j,...u},h=n(l,c),d=i(l)?e():null;super(a,!1,h,d),this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const u=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=u,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const u=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=u,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},isOwnedByContext=(s,e)=>s.context===e,createAnalyserNodeRendererFactory=(s,e,t)=>()=>{const n=new WeakMap,r=async(i,o)=>{let a=e(i);if(!isOwnedByContext(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=s(o,l)}return n.set(o,a),await t(i,o,a),a};return{render(i,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},testAudioBufferCopyChannelMethodsOutOfBoundsSupport=s=>{try{s.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},createIndexSizeError=()=>new DOMException("","IndexSizeError"),wrapAudioBufferGetChannelDataMethod=s=>{s.getChannelData=(e=>t=>{try{return e.call(s,t)}catch(n){throw n.code===12?createIndexSizeError():n}})(s.getChannelData)},DEFAULT_OPTIONS$i={numberOfChannels:1},createAudioBufferConstructor=(s,e,t,n,r,i,o,a)=>{let u=null;return class sr{constructor(c){if(r===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:h,numberOfChannels:d,sampleRate:p}={...DEFAULT_OPTIONS$i,...c};u===null&&(u=new r(1,1,44100));const f=n!==null&&e(i,i)?new n({length:h,numberOfChannels:d,sampleRate:p}):u.createBuffer(d,h,p);if(f.numberOfChannels===0)throw t();return typeof f.copyFromChannel!="function"?(o(f),wrapAudioBufferGetChannelDataMethod(f)):e(testAudioBufferCopyChannelMethodsOutOfBoundsSupport,()=>testAudioBufferCopyChannelMethodsOutOfBoundsSupport(f))||a(f),s.add(f),f}static[Symbol.hasInstance](c){return c!==null&&typeof c=="object"&&Object.getPrototypeOf(c)===sr.prototype||s.has(c)}}},MOST_NEGATIVE_SINGLE_FLOAT=-34028234663852886e22,MOST_POSITIVE_SINGLE_FLOAT=-MOST_NEGATIVE_SINGLE_FLOAT,isActiveAudioNode=s=>ACTIVE_AUDIO_NODE_STORE.has(s),DEFAULT_OPTIONS$h={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},createAudioBufferSourceNodeConstructor=(s,e,t,n,r,i,o,a)=>class extends s{constructor(l,c){const h=i(l),d={...DEFAULT_OPTIONS$h,...c},p=r(h,d),f=o(h),g=f?e():null;super(l,!1,p,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=d.buffer!==null,this._nativeAudioBufferSourceNode=p,this._onended=null,this._playbackRate=t(this,f,p.playbackRate,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=c;const h=this._nativeAudioBufferSourceNode.onended;this._onended=h!==null&&h===c?l:h}get playbackRate(){return this._playbackRate}start(l=0,c=0,h){if(this._nativeAudioBufferSourceNode.start(l,c,h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=h===void 0?[l,c]:[l,c,h]),this.context.state!=="closed"){setInternalStateToActive(this);const d=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",d),isActiveAudioNode(this)&&setInternalStateToPassive(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",d)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},createAudioBufferSourceNodeRendererFactory=(s,e,t,n,r)=>()=>{const i=new WeakMap;let o=null,a=null;const u=async(l,c)=>{let h=t(l);const d=isOwnedByContext(h,c);if(!d){const p={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(c,p),o!==null&&h.start(...o),a!==null&&h.stop(a)}return i.set(c,h),d?await s(c,l.playbackRate,h.playbackRate):await n(c,l.playbackRate,h.playbackRate),await r(l,c,h),h};return{set start(l){o=l},set stop(l){a=l},render(l,c){const h=i.get(c);return h!==void 0?Promise.resolve(h):u(l,c)}}},isAudioBufferSourceNode=s=>"playbackRate"in s,isBiquadFilterNode=s=>"frequency"in s&&"gain"in s,isConstantSourceNode=s=>"offset"in s,isGainNode=s=>!("frequency"in s)&&"gain"in s,isOscillatorNode=s=>"detune"in s&&"frequency"in s,isStereoPannerNode=s=>"pan"in s,getAudioNodeConnections=s=>getValueForKey(AUDIO_NODE_CONNECTIONS_STORE,s),getAudioParamConnections=s=>getValueForKey(AUDIO_PARAM_CONNECTIONS_STORE,s),deactivateActiveAudioNodeInputConnections=(s,e)=>{const{activeInputs:t}=getAudioNodeConnections(s);t.forEach(r=>r.forEach(([i])=>{e.includes(s)||deactivateActiveAudioNodeInputConnections(i,[...e,s])}));const n=isAudioBufferSourceNode(s)?[s.playbackRate]:isAudioWorkletNode(s)?Array.from(s.parameters.values()):isBiquadFilterNode(s)?[s.Q,s.detune,s.frequency,s.gain]:isConstantSourceNode(s)?[s.offset]:isGainNode(s)?[s.gain]:isOscillatorNode(s)?[s.detune,s.frequency]:isStereoPannerNode(s)?[s.pan]:[];for(const r of n){const i=getAudioParamConnections(r);i!==void 0&&i.activeInputs.forEach(([o])=>deactivateActiveAudioNodeInputConnections(o,e))}isActiveAudioNode(s)&&setInternalStateToPassive(s)},deactivateAudioGraph=s=>{deactivateActiveAudioNodeInputConnections(s.destination,[])},isValidLatencyHint=s=>s===void 0||typeof s=="number"||typeof s=="string"&&(s==="balanced"||s==="interactive"||s==="playback"),createAudioContextConstructor=(s,e,t,n,r,i,o,a,u)=>class extends s{constructor(c={}){if(u===null)throw new Error("Missing the native AudioContext constructor.");let h;try{h=new u(c)}catch(f){throw f.code===12&&f.message==="sampleRate is not in range"?t():f}if(h===null)throw n();if(!isValidLatencyHint(c.latencyHint))throw new TypeError(`The provided value '${c.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(c.sampleRate!==void 0&&h.sampleRate!==c.sampleRate)throw t();super(h,2);const{latencyHint:d}=c,{sampleRate:p}=h;if(this._baseLatency=typeof h.baseLatency=="number"?h.baseLatency:d==="balanced"?512/p:d==="interactive"||d===void 0?256/p:d==="playback"?1024/p:Math.max(2,Math.min(128,Math.round(d*p/128)))*128/p,this._nativeAudioContext=h,u.name==="webkitAudioContext"?(this._nativeGainNode=h.createGain(),this._nativeOscillatorNode=h.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(h.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,h.state==="running"){this._state="suspended";const f=()=>{this._state==="suspended"&&(this._state=null),h.removeEventListener("statechange",f)};h.addEventListener("statechange",f)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),deactivateAudioGraph(this)}))}createMediaElementSource(c){return new r(this,{mediaElement:c})}createMediaStreamDestination(){return new i(this)}createMediaStreamSource(c){return new o(this,{mediaStream:c})}createMediaStreamTrackSource(c){return new a(this,{mediaStreamTrack:c})}resume(){return this._state==="suspended"?new Promise((c,h)=>{const d=()=>{this._nativeAudioContext.removeEventListener("statechange",d),this._nativeAudioContext.state==="running"?c():this.resume().then(c,h)};this._nativeAudioContext.addEventListener("statechange",d)}):this._nativeAudioContext.resume().catch(c=>{throw c===void 0||c.code===15?e():c})}suspend(){return this._nativeAudioContext.suspend().catch(c=>{throw c===void 0?e():c})}},createAudioDestinationNodeConstructor=(s,e,t,n,r,i,o,a)=>class extends s{constructor(l,c){const h=i(l),d=o(h),p=r(h,c,d),f=d?e(a):null;super(l,!1,p,f),this._isNodeOfNativeOfflineAudioContext=d,this._nativeAudioDestinationNode=p}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},createAudioDestinationNodeRenderer=s=>{const e=new WeakMap,t=async(n,r)=>{const i=r.destination;return e.set(r,i),await s(n,r,i),i};return{render(n,r){const i=e.get(r);return i!==void 0?Promise.resolve(i):t(n,r)}}},createAudioListenerFactory=(s,e,t,n,r,i,o,a)=>(u,l)=>{const c=l.listener,h=()=>{const m=new Float32Array(1),b=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),I=o(l);let _=!1,S=[0,0,-1,0,1,0],T=[0,0,0];const E=()=>{if(_)return;_=!0;const V=n(l,256,9,0);V.onaudioprocess=({inputBuffer:j})=>{const G=[i(j,m,0),i(j,m,1),i(j,m,2),i(j,m,3),i(j,m,4),i(j,m,5)];G.some((q,Z)=>q!==S[Z])&&(c.setOrientation(...G),S=G);const X=[i(j,m,6),i(j,m,7),i(j,m,8)];X.some((q,Z)=>q!==T[Z])&&(c.setPosition(...X),T=X)},b.connect(V)},L=V=>j=>{j!==S[V]&&(S[V]=j,c.setOrientation(...S))},$=V=>j=>{j!==T[V]&&(T[V]=j,c.setPosition(...T))},Y=(V,j,G)=>{const X=t(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:j});X.connect(b,0,V),X.start(),Object.defineProperty(X.offset,"defaultValue",{get(){return j}});const q=s({context:u},I,X.offset,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT);return a(q,"value",Z=>()=>Z.call(q),Z=>J=>{try{Z.call(q,J)}catch(ve){if(ve.code!==9)throw ve}E(),I&&G(J)}),q.cancelAndHoldAtTime=(Z=>I?()=>{throw r()}:(...J)=>{const ve=Z.apply(q,J);return E(),ve})(q.cancelAndHoldAtTime),q.cancelScheduledValues=(Z=>I?()=>{throw r()}:(...J)=>{const ve=Z.apply(q,J);return E(),ve})(q.cancelScheduledValues),q.exponentialRampToValueAtTime=(Z=>I?()=>{throw r()}:(...J)=>{const ve=Z.apply(q,J);return E(),ve})(q.exponentialRampToValueAtTime),q.linearRampToValueAtTime=(Z=>I?()=>{throw r()}:(...J)=>{const ve=Z.apply(q,J);return E(),ve})(q.linearRampToValueAtTime),q.setTargetAtTime=(Z=>I?()=>{throw r()}:(...J)=>{const ve=Z.apply(q,J);return E(),ve})(q.setTargetAtTime),q.setValueAtTime=(Z=>I?()=>{throw r()}:(...J)=>{const ve=Z.apply(q,J);return E(),ve})(q.setValueAtTime),q.setValueCurveAtTime=(Z=>I?()=>{throw r()}:(...J)=>{const ve=Z.apply(q,J);return E(),ve})(q.setValueCurveAtTime),q};return{forwardX:Y(0,0,L(0)),forwardY:Y(1,0,L(1)),forwardZ:Y(2,-1,L(2)),positionX:Y(6,0,$(0)),positionY:Y(7,0,$(1)),positionZ:Y(8,0,$(2)),upX:Y(3,0,L(3)),upY:Y(4,1,L(4)),upZ:Y(5,0,L(5))}},{forwardX:d,forwardY:p,forwardZ:f,positionX:g,positionY:v,positionZ:y,upX:x,upY:R,upZ:k}=c.forwardX===void 0?h():c;return{get forwardX(){return d},get forwardY(){return p},get forwardZ(){return f},get positionX(){return g},get positionY(){return v},get positionZ(){return y},get upX(){return x},get upY(){return R},get upZ(){return k}}},isAudioNode$1=s=>"context"in s,isAudioNodeOutputConnection=s=>isAudioNode$1(s[0]),insertElementInSet=(s,e,t,n)=>{for(const r of s)if(t(r)){if(n)return!1;throw Error("The set contains at least one similar element.")}return s.add(e),!0},addActiveInputConnectionToAudioParam=(s,e,[t,n],r)=>{insertElementInSet(s,[e,t,n],i=>i[0]===e&&i[1]===t,r)},addPassiveInputConnectionToAudioParam=(s,[e,t,n],r)=>{const i=s.get(e);i===void 0?s.set(e,new Set([[t,n]])):insertElementInSet(i,[t,n],o=>o[0]===t,r)},isNativeAudioNodeFaker=s=>"inputs"in s,connectNativeAudioNodeToNativeAudioNode=(s,e,t,n)=>{if(isNativeAudioNodeFaker(e)){const r=e.inputs[n];return s.connect(r,t,0),[r,t,0]}return s.connect(e,t,n),[e,t,n]},deleteActiveInputConnection=(s,e,t)=>{for(const n of s)if(n[0]===e&&n[1]===t)return s.delete(n),n;return null},deleteActiveInputConnectionToAudioParam=(s,e,t)=>pickElementFromSet(s,n=>n[0]===e&&n[1]===t),deleteEventListenerOfAudioNode=(s,e)=>{if(!getEventListenersOfAudioNode(s).delete(e))throw new Error("Missing the expected event listener.")},deletePassiveInputConnectionToAudioParam=(s,e,t)=>{const n=getValueForKey(s,e),r=pickElementFromSet(n,i=>i[0]===t);return n.size===0&&s.delete(e),r},disconnectNativeAudioNodeFromNativeAudioNode=(s,e,t,n)=>{isNativeAudioNodeFaker(e)?s.disconnect(e.inputs[n],t,0):s.disconnect(e,t,n)},getNativeAudioNode=s=>getValueForKey(AUDIO_NODE_STORE,s),getNativeAudioParam=s=>getValueForKey(AUDIO_PARAM_STORE,s),isPartOfACycle=s=>CYCLE_COUNTERS.has(s),isPassiveAudioNode=s=>!ACTIVE_AUDIO_NODE_STORE.has(s),testAudioNodeDisconnectMethodSupport=(s,e)=>new Promise(t=>{if(e!==null)t(!0);else{const n=s.createScriptProcessor(256,1,1),r=s.createGain(),i=s.createBuffer(1,2,44100),o=i.getChannelData(0);o[0]=1,o[1]=1;const a=s.createBufferSource();a.buffer=i,a.loop=!0,a.connect(n).connect(s.destination),a.connect(r),a.disconnect(r),n.onaudioprocess=u=>{const l=u.inputBuffer.getChannelData(0);Array.prototype.some.call(l,c=>c===1)?t(!0):t(!1),a.stop(),n.onaudioprocess=null,a.disconnect(n),n.disconnect(s.destination)},a.start()}}),visitEachAudioNodeOnce=(s,e)=>{const t=new Map;for(const n of s)for(const r of n){const i=t.get(r);t.set(r,i===void 0?1:i+1)}t.forEach((n,r)=>e(r,n))},isNativeAudioNode$1=s=>"context"in s,wrapAudioNodeDisconnectMethod=s=>{const e=new Map;s.connect=(t=>(n,r=0,i=0)=>{const o=isNativeAudioNode$1(n)?t(n,r,i):t(n,r),a=e.get(n);return a===void 0?e.set(n,[{input:i,output:r}]):a.every(u=>u.input!==i||u.output!==r)&&a.push({input:i,output:r}),o})(s.connect.bind(s)),s.disconnect=(t=>(n,r,i)=>{if(t.apply(s),n===void 0)e.clear();else if(typeof n=="number")for(const[o,a]of e){const u=a.filter(l=>l.output!==n);u.length===0?e.delete(o):e.set(o,u)}else if(e.has(n))if(r===void 0)e.delete(n);else{const o=e.get(n);if(o!==void 0){const a=o.filter(u=>u.output!==r&&(u.input!==i||i===void 0));a.length===0?e.delete(n):e.set(n,a)}}for(const[o,a]of e)a.forEach(u=>{isNativeAudioNode$1(o)?s.connect(o,u.output,u.input):s.connect(o,u.output)})})(s.disconnect)},addConnectionToAudioParamOfAudioContext=(s,e,t,n)=>{const{activeInputs:r,passiveInputs:i}=getAudioParamConnections(e),{outputs:o}=getAudioNodeConnections(s),a=getEventListenersOfAudioNode(s),u=l=>{const c=getNativeAudioNode(s),h=getNativeAudioParam(e);if(l){const d=deletePassiveInputConnectionToAudioParam(i,s,t);addActiveInputConnectionToAudioParam(r,s,d,!1),!n&&!isPartOfACycle(s)&&c.connect(h,t)}else{const d=deleteActiveInputConnectionToAudioParam(r,s,t);addPassiveInputConnectionToAudioParam(i,d,!1),!n&&!isPartOfACycle(s)&&c.disconnect(h,t)}};return insertElementInSet(o,[e,t],l=>l[0]===e&&l[1]===t,!0)?(a.add(u),isActiveAudioNode(s)?addActiveInputConnectionToAudioParam(r,s,[t,u],!0):addPassiveInputConnectionToAudioParam(i,[s,t,u],!0),!0):!1},deleteInputConnectionOfAudioNode=(s,e,t,n)=>{const{activeInputs:r,passiveInputs:i}=getAudioNodeConnections(e),o=deleteActiveInputConnection(r[n],s,t);return o===null?[deletePassiveInputConnectionToAudioNode(i,s,t,n)[2],!1]:[o[2],!0]},deleteInputConnectionOfAudioParam=(s,e,t)=>{const{activeInputs:n,passiveInputs:r}=getAudioParamConnections(e),i=deleteActiveInputConnection(n,s,t);return i===null?[deletePassiveInputConnectionToAudioParam(r,s,t)[1],!1]:[i[2],!0]},deleteInputsOfAudioNode=(s,e,t,n,r)=>{const[i,o]=deleteInputConnectionOfAudioNode(s,t,n,r);if(i!==null&&(deleteEventListenerOfAudioNode(s,i),o&&!e&&!isPartOfACycle(s)&&disconnectNativeAudioNodeFromNativeAudioNode(getNativeAudioNode(s),getNativeAudioNode(t),n,r)),isActiveAudioNode(t)){const{activeInputs:a}=getAudioNodeConnections(t);setInternalStateToPassiveWhenNecessary(t,a)}},deleteInputsOfAudioParam=(s,e,t,n)=>{const[r,i]=deleteInputConnectionOfAudioParam(s,t,n);r!==null&&(deleteEventListenerOfAudioNode(s,r),i&&!e&&!isPartOfACycle(s)&&getNativeAudioNode(s).disconnect(getNativeAudioParam(t),n))},deleteAnyConnection=(s,e)=>{const t=getAudioNodeConnections(s),n=[];for(const r of t.outputs)isAudioNodeOutputConnection(r)?deleteInputsOfAudioNode(s,e,...r):deleteInputsOfAudioParam(s,e,...r),n.push(r[0]);return t.outputs.clear(),n},deleteConnectionAtOutput=(s,e,t)=>{const n=getAudioNodeConnections(s),r=[];for(const i of n.outputs)i[1]===t&&(isAudioNodeOutputConnection(i)?deleteInputsOfAudioNode(s,e,...i):deleteInputsOfAudioParam(s,e,...i),r.push(i[0]),n.outputs.delete(i));return r},deleteConnectionToDestination=(s,e,t,n,r)=>{const i=getAudioNodeConnections(s);return Array.from(i.outputs).filter(o=>o[0]===t&&(n===void 0||o[1]===n)&&(r===void 0||o[2]===r)).map(o=>(isAudioNodeOutputConnection(o)?deleteInputsOfAudioNode(s,e,...o):deleteInputsOfAudioParam(s,e,...o),i.outputs.delete(o),o[0]))},createAudioNodeConstructor=(s,e,t,n,r,i,o,a,u,l,c,h,d,p,f,g)=>class extends l{constructor(y,x,R,k){super(R),this._context=y,this._nativeAudioNode=R;const m=c(y);h(m)&&t(testAudioNodeDisconnectMethodSupport,()=>testAudioNodeDisconnectMethodSupport(m,g))!==!0&&wrapAudioNodeDisconnectMethod(R),AUDIO_NODE_STORE.set(this,R),EVENT_LISTENERS.set(this,new Set),y.state!=="closed"&&x&&setInternalStateToActive(this),s(this,k,R)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(y){this._nativeAudioNode.channelCount=y}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(y){this._nativeAudioNode.channelCountMode=y}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(y){this._nativeAudioNode.channelInterpretation=y}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(y,x=0,R=0){if(x<0||x>=this._nativeAudioNode.numberOfOutputs)throw r();const k=c(this._context),m=f(k);if(d(y)||p(y))throw i();if(isAudioNode$1(y)){const _=getNativeAudioNode(y);try{const T=connectNativeAudioNodeToNativeAudioNode(this._nativeAudioNode,_,x,R),E=isPassiveAudioNode(this);(m||E)&&this._nativeAudioNode.disconnect(...T),this.context.state!=="closed"&&!E&&isPassiveAudioNode(y)&&setInternalStateToActive(y)}catch(T){throw T.code===12?i():T}if(e(this,y,x,R,m)){const T=u([this],y);visitEachAudioNodeOnce(T,n(m))}return y}const b=getNativeAudioParam(y);if(b.name==="playbackRate"&&b.maxValue===1024)throw o();try{this._nativeAudioNode.connect(b,x),(m||isPassiveAudioNode(this))&&this._nativeAudioNode.disconnect(b,x)}catch(_){throw _.code===12?i():_}if(addConnectionToAudioParamOfAudioContext(this,y,x,m)){const _=u([this],y);visitEachAudioNodeOnce(_,n(m))}}disconnect(y,x,R){let k;const m=c(this._context),b=f(m);if(y===void 0)k=deleteAnyConnection(this,b);else if(typeof y=="number"){if(y<0||y>=this.numberOfOutputs)throw r();k=deleteConnectionAtOutput(this,b,y)}else{if(x!==void 0&&(x<0||x>=this.numberOfOutputs)||isAudioNode$1(y)&&R!==void 0&&(R<0||R>=y.numberOfInputs))throw r();if(k=deleteConnectionToDestination(this,b,y,x,R),k.length===0)throw i()}for(const I of k){const _=u([this],I);visitEachAudioNodeOnce(_,a)}}},createAudioParamFactory=(s,e,t,n,r,i,o,a,u,l,c,h,d)=>(p,f,g,v=null,y=null)=>{const x=g.value,R=new AutomationEventList(x),k=f?n(R):null,m={get defaultValue(){return x},get maxValue(){return v===null?g.maxValue:v},get minValue(){return y===null?g.minValue:y},get value(){return g.value},set value(b){g.value=b,m.setValueAtTime(b,p.context.currentTime)},cancelAndHoldAtTime(b){if(typeof g.cancelAndHoldAtTime=="function")k===null&&R.flush(p.context.currentTime),R.add(r(b)),g.cancelAndHoldAtTime(b);else{const I=Array.from(R).pop();k===null&&R.flush(p.context.currentTime),R.add(r(b));const _=Array.from(R).pop();g.cancelScheduledValues(b),I!==_&&_!==void 0&&(_.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(_.value,_.endTime):_.type==="linearRampToValue"?g.linearRampToValueAtTime(_.value,_.endTime):_.type==="setValue"?g.setValueAtTime(_.value,_.startTime):_.type==="setValueCurve"&&g.setValueCurveAtTime(_.values,_.startTime,_.duration))}return m},cancelScheduledValues(b){return k===null&&R.flush(p.context.currentTime),R.add(i(b)),g.cancelScheduledValues(b),m},exponentialRampToValueAtTime(b,I){if(b===0)throw new RangeError;if(!Number.isFinite(I)||I<0)throw new RangeError;const _=p.context.currentTime;return k===null&&R.flush(_),Array.from(R).length===0&&(R.add(l(x,_)),g.setValueAtTime(x,_)),R.add(o(b,I)),g.exponentialRampToValueAtTime(b,I),m},linearRampToValueAtTime(b,I){const _=p.context.currentTime;return k===null&&R.flush(_),Array.from(R).length===0&&(R.add(l(x,_)),g.setValueAtTime(x,_)),R.add(a(b,I)),g.linearRampToValueAtTime(b,I),m},setTargetAtTime(b,I,_){return k===null&&R.flush(p.context.currentTime),R.add(u(b,I,_)),g.setTargetAtTime(b,I,_),m},setValueAtTime(b,I){return k===null&&R.flush(p.context.currentTime),R.add(l(b,I)),g.setValueAtTime(b,I),m},setValueCurveAtTime(b,I,_){const S=b instanceof Float32Array?b:new Float32Array(b);if(h!==null&&h.name==="webkitAudioContext"){const T=I+_,E=p.context.sampleRate,L=Math.ceil(I*E),$=Math.floor(T*E),Y=$-L,V=new Float32Array(Y);for(let G=0;G<Y;G+=1){const X=(S.length-1)/_*((L+G)/E-I),q=Math.floor(X),Z=Math.ceil(X);V[G]=q===Z?S[q]:(1-(X-q))*S[q]+(1-(Z-X))*S[Z]}k===null&&R.flush(p.context.currentTime),R.add(c(V,I,_)),g.setValueCurveAtTime(V,I,_);const j=$/E;j<T&&d(m,V[V.length-1],j),d(m,S[S.length-1],T)}else k===null&&R.flush(p.context.currentTime),R.add(c(S,I,_)),g.setValueCurveAtTime(S,I,_);return m}};return t.set(m,g),e.set(m,p),s(m,k),m},createAudioParamRenderer=s=>({replay(e){for(const t of s)if(t.type==="exponentialRampToValue"){const{endTime:n,value:r}=t;e.exponentialRampToValueAtTime(r,n)}else if(t.type==="linearRampToValue"){const{endTime:n,value:r}=t;e.linearRampToValueAtTime(r,n)}else if(t.type==="setTarget"){const{startTime:n,target:r,timeConstant:i}=t;e.setTargetAtTime(r,n,i)}else if(t.type==="setValue"){const{startTime:n,value:r}=t;e.setValueAtTime(r,n)}else if(t.type==="setValueCurve"){const{duration:n,startTime:r,values:i}=t;e.setValueCurveAtTime(i,r,n)}else throw new Error("Can't apply an unknown automation.")}});class ReadOnlyMap{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((n,r)=>e.call(t,n,r,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const DEFAULT_OPTIONS$g={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},createAudioWorkletNodeConstructor=(s,e,t,n,r,i,o,a,u,l,c,h,d,p)=>class extends e{constructor(g,v,y){var x;const R=a(g),k=u(R),m=c({...DEFAULT_OPTIONS$g,...y});d(m);const b=NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS.get(R),I=b==null?void 0:b.get(v),_=k||R.state!=="closed"?R:(x=o(R))!==null&&x!==void 0?x:R,S=r(_,k?null:g.baseLatency,l,v,I,m),T=k?n(v,m,I):null;super(g,!0,S,T);const E=[];S.parameters.forEach(($,Y)=>{const V=t(this,k,$);E.push([Y,V])}),this._nativeAudioWorkletNode=S,this._onprocessorerror=null,this._parameters=new ReadOnlyMap(E),k&&s(R,this);const{activeInputs:L}=i(this);h(S,L)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const v=typeof g=="function"?p(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=v;const y=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=y!==null&&y===v?g:y}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function copyFromChannel(s,e,t,n,r){if(typeof s.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),s.copyFromChannel(e[t],n,r);else{const i=s.getChannelData(n);if(e[t].byteLength===0)e[t]=i.slice(r,r+128);else{const o=new Float32Array(i.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(o)}}}const copyToChannel=(s,e,t,n,r)=>{typeof s.copyToChannel=="function"?e[t].byteLength!==0&&s.copyToChannel(e[t],n,r):e[t].byteLength!==0&&s.getChannelData(n).set(e[t],r)},createNestedArrays=(s,e)=>{const t=[];for(let n=0;n<s;n+=1){const r=[],i=typeof e=="number"?e:e[n];for(let o=0;o<i;o+=1)r.push(new Float32Array(128));t.push(r)}return t},getAudioWorkletProcessor=(s,e)=>{const t=getValueForKey(NODE_TO_PROCESSOR_MAPS,s),n=getNativeAudioNode(e);return getValueForKey(t,n)},processBuffer=async(s,e,t,n,r,i,o)=>{const a=e===null?Math.ceil(s.context.length/128)*128:e.length,u=n.channelCount*n.numberOfInputs,l=r.reduce((v,y)=>v+y,0),c=l===0?null:t.createBuffer(l,a,t.sampleRate);if(i===void 0)throw new Error("Missing the processor constructor.");const h=getAudioNodeConnections(s),d=await getAudioWorkletProcessor(t,s),p=createNestedArrays(n.numberOfInputs,n.channelCount),f=createNestedArrays(n.numberOfOutputs,r),g=Array.from(s.parameters.keys()).reduce((v,y)=>({...v,[y]:new Float32Array(128)}),{});for(let v=0;v<a;v+=128){if(n.numberOfInputs>0&&e!==null)for(let y=0;y<n.numberOfInputs;y+=1)for(let x=0;x<n.channelCount;x+=1)copyFromChannel(e,p[y],x,x,v);i.parameterDescriptors!==void 0&&e!==null&&i.parameterDescriptors.forEach(({name:y},x)=>{copyFromChannel(e,g,y,u+x,v)});for(let y=0;y<n.numberOfInputs;y+=1)for(let x=0;x<r[y];x+=1)f[y][x].byteLength===0&&(f[y][x]=new Float32Array(128));try{const y=p.map((R,k)=>h.activeInputs[k].size===0?[]:R),x=o(v/t.sampleRate,t.sampleRate,()=>d.process(y,f,g));if(c!==null)for(let R=0,k=0;R<n.numberOfOutputs;R+=1){for(let m=0;m<r[R];m+=1)copyToChannel(c,f[R],m,k+m,v);k+=r[R]}if(!x)break}catch(y){s.dispatchEvent(new ErrorEvent("processorerror",{colno:y.colno,filename:y.filename,lineno:y.lineno,message:y.message}));break}}return c},createAudioWorkletNodeRendererFactory=(s,e,t,n,r,i,o,a,u,l,c,h,d,p,f,g)=>(v,y,x)=>{const R=new WeakMap;let k=null;const m=async(b,I)=>{let _=c(b),S=null;const T=isOwnedByContext(_,I),E=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(h===null){const L=E.reduce((j,G)=>j+G,0),$=r(I,{channelCount:Math.max(1,L),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,L)}),Y=[];for(let j=0;j<b.numberOfOutputs;j+=1)Y.push(n(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:E[j]}));const V=o(I,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1});V.connect=e.bind(null,Y),V.disconnect=u.bind(null,Y),S=[$,Y,V]}else T||(_=new h(I,v));if(R.set(I,S===null?_:S[2]),S!==null){if(k===null){if(x===void 0)throw new Error("Missing the processor constructor.");if(d===null)throw new Error("Missing the native OfflineAudioContext constructor.");const G=b.channelCount*b.numberOfInputs,X=x.parameterDescriptors===void 0?0:x.parameterDescriptors.length,q=G+X;k=processBuffer(b,q===0?null:await(async()=>{const J=new d(q,Math.ceil(b.context.length/128)*128,I.sampleRate),ve=[],K=[];for(let F=0;F<y.numberOfInputs;F+=1)ve.push(o(J,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),K.push(r(J,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));const O=await Promise.all(Array.from(b.parameters.values()).map(async F=>{const z=i(J,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:F.value});return await p(J,F,z.offset),z})),N=n(J,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,G+X)});for(let F=0;F<y.numberOfInputs;F+=1){ve[F].connect(K[F]);for(let z=0;z<y.channelCount;z+=1)K[F].connect(N,z,F*y.channelCount+z)}for(const[F,z]of O.entries())z.connect(N,0,G+F),z.start(0);return N.connect(J.destination),await Promise.all(ve.map(F=>f(b,J,F))),g(J)})(),I,y,E,x,l)}const L=await k,$=t(I,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[Y,V,j]=S;L!==null&&($.buffer=L,$.start(0)),$.connect(Y);for(let G=0,X=0;G<b.numberOfOutputs;G+=1){const q=V[G];for(let Z=0;Z<E[G];Z+=1)Y.connect(q,X+Z,Z);X+=E[G]}return j}if(T)for(const[L,$]of b.parameters.entries())await s(I,$,_.parameters.get(L));else for(const[L,$]of b.parameters.entries())await p(I,$,_.parameters.get(L));return await f(b,I,_),_};return{render(b,I){a(I,b);const _=R.get(I);return _!==void 0?Promise.resolve(_):m(b,I)}}},createBaseAudioContextConstructor=(s,e,t,n,r,i,o,a,u,l,c,h,d,p,f,g,v,y,x,R)=>class extends f{constructor(m,b){super(m,b),this._nativeContext=m,this._audioWorklet=s===void 0?void 0:{addModule:(I,_)=>s(this,I,_)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new r(this)}createBuffer(m,b,I){return new t({length:b,numberOfChannels:m,sampleRate:I})}createBufferSource(){return new n(this)}createChannelMerger(m=6){return new i(this,{numberOfInputs:m})}createChannelSplitter(m=6){return new o(this,{numberOfOutputs:m})}createConstantSource(){return new a(this)}createConvolver(){return new u(this)}createDelay(m=1){return new c(this,{maxDelayTime:m})}createDynamicsCompressor(){return new h(this)}createGain(){return new d(this)}createIIRFilter(m,b){return new p(this,{feedback:b,feedforward:m})}createOscillator(){return new g(this)}createPanner(){return new v(this)}createPeriodicWave(m,b,I={disableNormalization:!1}){return new y(this,{...I,imag:b,real:m})}createStereoPanner(){return new x(this)}createWaveShaper(){return new R(this)}decodeAudioData(m,b,I){return l(this._nativeContext,m).then(_=>(typeof b=="function"&&b(_),_),_=>{throw typeof I=="function"&&I(_),_})}},DEFAULT_OPTIONS$f={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},createBiquadFilterNodeConstructor=(s,e,t,n,r,i,o,a)=>class extends s{constructor(l,c){const h=i(l),d={...DEFAULT_OPTIONS$f,...c},p=r(h,d),f=o(h),g=f?t():null;super(l,!1,p,g),this._Q=e(this,f,p.Q,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._detune=e(this,f,p.detune,1200*Math.log2(MOST_POSITIVE_SINGLE_FLOAT),-1200*Math.log2(MOST_POSITIVE_SINGLE_FLOAT)),this._frequency=e(this,f,p.frequency,l.sampleRate/2,0),this._gain=e(this,f,p.gain,40*Math.log10(MOST_POSITIVE_SINGLE_FLOAT),MOST_NEGATIVE_SINGLE_FLOAT),this._nativeBiquadFilterNode=p,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,c,h){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,c,h)}catch(d){throw d.code===11?n():d}if(l.length!==c.length||c.length!==h.length)throw n()}},createBiquadFilterNodeRendererFactory=(s,e,t,n,r)=>()=>{const i=new WeakMap,o=async(a,u)=>{let l=t(a);const c=isOwnedByContext(l,u);if(!c){const h={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(u,h)}return i.set(u,l),c?(await s(u,a.Q,l.Q),await s(u,a.detune,l.detune),await s(u,a.frequency,l.frequency),await s(u,a.gain,l.gain)):(await n(u,a.Q,l.Q),await n(u,a.detune,l.detune),await n(u,a.frequency,l.frequency),await n(u,a.gain,l.gain)),await r(a,u,l),l};return{render(a,u){const l=i.get(u);return l!==void 0?Promise.resolve(l):o(a,u)}}},createCacheTestResult=(s,e)=>(t,n)=>{const r=e.get(t);if(r!==void 0)return r;const i=s.get(t);if(i!==void 0)return i;try{const o=n();return o instanceof Promise?(s.set(t,o),o.catch(()=>!1).then(a=>(s.delete(t),e.set(t,a),a))):(e.set(t,o),o)}catch{return e.set(t,!1),!1}},DEFAULT_OPTIONS$e={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},createChannelMergerNodeConstructor=(s,e,t,n,r)=>class extends s{constructor(o,a){const u=n(o),l={...DEFAULT_OPTIONS$e,...a},c=t(u,l),h=r(u)?e():null;super(o,!1,c,h)}},createChannelMergerNodeRendererFactory=(s,e,t)=>()=>{const n=new WeakMap,r=async(i,o)=>{let a=e(i);if(!isOwnedByContext(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=s(o,l)}return n.set(o,a),await t(i,o,a),a};return{render(i,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},DEFAULT_OPTIONS$d={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},createChannelSplitterNodeConstructor=(s,e,t,n,r,i)=>class extends s{constructor(a,u){const l=n(a),c=i({...DEFAULT_OPTIONS$d,...u}),h=t(l,c),d=r(l)?e():null;super(a,!1,h,d)}},createChannelSplitterNodeRendererFactory=(s,e,t)=>()=>{const n=new WeakMap,r=async(i,o)=>{let a=e(i);if(!isOwnedByContext(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=s(o,l)}return n.set(o,a),await t(i,o,a),a};return{render(i,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},createConnectAudioParam=s=>(e,t,n)=>s(t,e,n),createConnectMultipleOutputs=s=>(e,t,n=0,r=0)=>{const i=e[n];if(i===void 0)throw s();return isNativeAudioNode$1(t)?i.connect(t,0,r):i.connect(t,0)},createConnectedNativeAudioBufferSourceNodeFactory=s=>(e,t)=>{const n=s(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,44100);return n.buffer=r,n.loop=!0,n.connect(t),n.start(),()=>{n.stop(),n.disconnect(t)}},DEFAULT_OPTIONS$c={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},createConstantSourceNodeConstructor=(s,e,t,n,r,i,o)=>class extends s{constructor(u,l){const c=r(u),h={...DEFAULT_OPTIONS$c,...l},d=n(c,h),p=i(c),f=p?t():null;super(u,!1,d,f),this._constantSourceNodeRenderer=f,this._nativeConstantSourceNode=d,this._offset=e(this,p,d.offset,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(u){const l=typeof u=="function"?o(this,u):null;this._nativeConstantSourceNode.onended=l;const c=this._nativeConstantSourceNode.onended;this._onended=c!==null&&c===l?u:c}start(u=0){if(this._nativeConstantSourceNode.start(u),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=u),this.context.state!=="closed"){setInternalStateToActive(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),isActiveAudioNode(this)&&setInternalStateToPassive(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(u=0){this._nativeConstantSourceNode.stop(u),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=u)}},createConstantSourceNodeRendererFactory=(s,e,t,n,r)=>()=>{const i=new WeakMap;let o=null,a=null;const u=async(l,c)=>{let h=t(l);const d=isOwnedByContext(h,c);if(!d){const p={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(c,p),o!==null&&h.start(o),a!==null&&h.stop(a)}return i.set(c,h),d?await s(c,l.offset,h.offset):await n(c,l.offset,h.offset),await r(l,c,h),h};return{set start(l){o=l},set stop(l){a=l},render(l,c){const h=i.get(c);return h!==void 0?Promise.resolve(h):u(l,c)}}},createConvertNumberToUnsignedLong=s=>e=>(s[0]=e,s[0]),DEFAULT_OPTIONS$b={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},createConvolverNodeConstructor=(s,e,t,n,r,i)=>class extends s{constructor(a,u){const l=n(a),c={...DEFAULT_OPTIONS$b,...u},h=t(l,c),p=r(l)?e():null;super(a,!1,h,p),this._isBufferNullified=!1,this._nativeConvolverNode=h,c.buffer!==null&&i(this,c.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const u=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=u.createBuffer(1,1,u.sampleRate),this._isBufferNullified=!0,i(this,0)}else this._isBufferNullified=!1,i(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},createConvolverNodeRendererFactory=(s,e,t)=>()=>{const n=new WeakMap,r=async(i,o)=>{let a=e(i);if(!isOwnedByContext(a,o)){const l={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=s(o,l)}return n.set(o,a),isNativeAudioNodeFaker(a)?await t(i,o,a.inputs[0]):await t(i,o,a),a};return{render(i,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},createCreateNativeOfflineAudioContext=(s,e)=>(t,n,r)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,n,r)}catch(i){throw i.name==="SyntaxError"?s():i}},createDataCloneError=()=>new DOMException("","DataCloneError"),detachArrayBuffer=s=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(n=>{const r=()=>{t.onmessage=null,e.close(),t.close(),n()};t.onmessage=()=>r();try{e.postMessage(s,[s])}catch{}finally{r()}})},createDecodeAudioData=(s,e,t,n,r,i,o,a,u,l,c)=>(h,d)=>{const p=o(h)?h:i(h);if(r.has(d)){const f=t();return Promise.reject(f)}try{r.add(d)}catch{}return e(u,()=>u(p))?p.decodeAudioData(d).then(f=>(detachArrayBuffer(d).catch(()=>{}),e(a,()=>a(f))||c(f),s.add(f),f)):new Promise((f,g)=>{const v=async()=>{try{await detachArrayBuffer(d)}catch{}},y=x=>{g(x),v()};try{p.decodeAudioData(d,x=>{typeof x.copyFromChannel!="function"&&(l(x),wrapAudioBufferGetChannelDataMethod(x)),s.add(x),v().then(()=>f(x))},x=>{y(x===null?n():x)})}catch(x){y(x)}})},createDecrementCycleCounter=(s,e,t,n,r,i,o,a)=>(u,l)=>{const c=e.get(u);if(c===void 0)throw new Error("Missing the expected cycle count.");const h=i(u.context),d=a(h);if(c===l){if(e.delete(u),!d&&o(u)){const p=n(u),{outputs:f}=t(u);for(const g of f)if(isAudioNodeOutputConnection(g)){const v=n(g[0]);s(p,v,g[1],g[2])}else{const v=r(g[0]);p.connect(v,g[1])}}}else e.set(u,c-l)},DEFAULT_OPTIONS$a={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},createDelayNodeConstructor=(s,e,t,n,r,i,o)=>class extends s{constructor(u,l){const c=r(u),h={...DEFAULT_OPTIONS$a,...l},d=n(c,h),p=i(c),f=p?t(h.maxDelayTime):null;super(u,!1,d,f),this._delayTime=e(this,p,d.delayTime),o(this,h.maxDelayTime)}get delayTime(){return this._delayTime}},createDelayNodeRendererFactory=(s,e,t,n,r)=>i=>{const o=new WeakMap,a=async(u,l)=>{let c=t(u);const h=isOwnedByContext(c,l);if(!h){const d={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,delayTime:c.delayTime.value,maxDelayTime:i};c=e(l,d)}return o.set(l,c),h?await s(l,u.delayTime,c.delayTime):await n(l,u.delayTime,c.delayTime),await r(u,l,c),c};return{render(u,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):a(u,l)}}},createDeleteActiveInputConnectionToAudioNode=s=>(e,t,n,r)=>s(e[r],i=>i[0]===t&&i[1]===n),createDeleteUnrenderedAudioWorkletNode=s=>(e,t)=>{s(e).delete(t)},isDelayNode=s=>"delayTime"in s,createDetectCycles=(s,e,t)=>function n(r,i){const o=isAudioNode$1(i)?i:t(s,i);if(isDelayNode(o))return[];if(r[0]===o)return[r];if(r.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map(u=>n([...r,o],u[0])).reduce((u,l)=>u.concat(l),[])},getOutputAudioNodeAtIndex=(s,e,t)=>{const n=e[t];if(n===void 0)throw s();return n},createDisconnectMultipleOutputs=s=>(e,t=void 0,n=void 0,r=0)=>t===void 0?e.forEach(i=>i.disconnect()):typeof t=="number"?getOutputAudioNodeAtIndex(s,e,t).disconnect():isNativeAudioNode$1(t)?n===void 0?e.forEach(i=>i.disconnect(t)):r===void 0?getOutputAudioNodeAtIndex(s,e,n).disconnect(t,0):getOutputAudioNodeAtIndex(s,e,n).disconnect(t,0,r):n===void 0?e.forEach(i=>i.disconnect(t)):getOutputAudioNodeAtIndex(s,e,n).disconnect(t,0),DEFAULT_OPTIONS$9={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},createDynamicsCompressorNodeConstructor=(s,e,t,n,r,i,o,a)=>class extends s{constructor(l,c){const h=i(l),d={...DEFAULT_OPTIONS$9,...c},p=n(h,d),f=o(h),g=f?t():null;super(l,!1,p,g),this._attack=e(this,f,p.attack),this._knee=e(this,f,p.knee),this._nativeDynamicsCompressorNode=p,this._ratio=e(this,f,p.ratio),this._release=e(this,f,p.release),this._threshold=e(this,f,p.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const c=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=c,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const c=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=c,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},createDynamicsCompressorNodeRendererFactory=(s,e,t,n,r)=>()=>{const i=new WeakMap,o=async(a,u)=>{let l=t(a);const c=isOwnedByContext(l,u);if(!c){const h={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(u,h)}return i.set(u,l),c?(await s(u,a.attack,l.attack),await s(u,a.knee,l.knee),await s(u,a.ratio,l.ratio),await s(u,a.release,l.release),await s(u,a.threshold,l.threshold)):(await n(u,a.attack,l.attack),await n(u,a.knee,l.knee),await n(u,a.ratio,l.ratio),await n(u,a.release,l.release),await n(u,a.threshold,l.threshold)),await r(a,u,l),l};return{render(a,u){const l=i.get(u);return l!==void 0?Promise.resolve(l):o(a,u)}}},createEncodingError=()=>new DOMException("","EncodingError"),createEvaluateSource=s=>e=>new Promise((t,n)=>{if(s===null){n(new SyntaxError);return}const r=s.document.head;if(r===null)n(new SyntaxError);else{const i=s.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),u=s.onerror,l=()=>{s.onerror=u,URL.revokeObjectURL(a)};s.onerror=(c,h,d,p,f)=>{if(h===a||h===s.location.href&&d===1&&p===1)return l(),n(f),!1;if(u!==null)return u(c,h,d,p,f)},i.onerror=()=>{l(),n(new SyntaxError)},i.onload=()=>{l(),t()},i.src=a,i.type="module",r.appendChild(i)}}),createEventTargetConstructor=s=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,n,r){if(n!==null){let i=this._listeners.get(n);i===void 0&&(i=s(this,n),typeof n=="function"&&this._listeners.set(n,i)),this._nativeEventTarget.addEventListener(t,i,r)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,n,r){const i=n===null?void 0:this._listeners.get(n);this._nativeEventTarget.removeEventListener(t,i===void 0?null:i,r)}},createExposeCurrentFrameAndCurrentTime=s=>(e,t,n)=>{Object.defineProperties(s,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return n()}finally{s!==null&&(delete s.currentFrame,delete s.currentTime)}},createFetchSource=s=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw s()},DEFAULT_OPTIONS$8={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},createGainNodeConstructor=(s,e,t,n,r,i)=>class extends s{constructor(a,u){const l=r(a),c={...DEFAULT_OPTIONS$8,...u},h=n(l,c),d=i(l),p=d?t():null;super(a,!1,h,p),this._gain=e(this,d,h.gain,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT)}get gain(){return this._gain}},createGainNodeRendererFactory=(s,e,t,n,r)=>()=>{const i=new WeakMap,o=async(a,u)=>{let l=t(a);const c=isOwnedByContext(l,u);if(!c){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(u,h)}return i.set(u,l),c?await s(u,a.gain,l.gain):await n(u,a.gain,l.gain),await r(a,u,l),l};return{render(a,u){const l=i.get(u);return l!==void 0?Promise.resolve(l):o(a,u)}}},createGetActiveAudioWorkletNodeInputs=(s,e)=>t=>e(s,t),createGetAudioNodeRenderer=s=>e=>{const t=s(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},createGetAudioNodeTailTime=s=>e=>{var t;return(t=s.get(e))!==null&&t!==void 0?t:0},createGetAudioParamRenderer=s=>e=>{const t=s(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},createGetBackupOfflineAudioContext=s=>e=>s.get(e),createInvalidStateError=()=>new DOMException("","InvalidStateError"),createGetNativeContext=s=>e=>{const t=s.get(e);if(t===void 0)throw createInvalidStateError();return t},createGetOrCreateBackupOfflineAudioContext=(s,e)=>t=>{let n=s.get(t);if(n!==void 0)return n;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new e(1,1,44100),s.set(t,n),n},createGetUnrenderedAudioWorkletNodes=s=>e=>{const t=s.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},createInvalidAccessError=()=>new DOMException("","InvalidAccessError"),wrapIIRFilterNodeGetFrequencyResponseMethod=s=>{s.getFrequencyResponse=(e=>(t,n,r)=>{if(t.length!==n.length||n.length!==r.length)throw createInvalidAccessError();return e.call(s,t,n,r)})(s.getFrequencyResponse)},DEFAULT_OPTIONS$7={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},createIIRFilterNodeConstructor=(s,e,t,n,r,i)=>class extends s{constructor(a,u){const l=n(a),c=r(l),h={...DEFAULT_OPTIONS$7,...u},d=e(l,c?null:a.baseLatency,h),p=c?t(h.feedback,h.feedforward):null;super(a,!1,d,p),wrapIIRFilterNodeGetFrequencyResponseMethod(d),this._nativeIIRFilterNode=d,i(this,1)}getFrequencyResponse(a,u,l){return this._nativeIIRFilterNode.getFrequencyResponse(a,u,l)}},filterBuffer=(s,e,t,n,r,i,o,a,u,l,c)=>{const h=l.length;let d=a;for(let p=0;p<h;p+=1){let f=t[0]*l[p];for(let g=1;g<r;g+=1){const v=d-g&u-1;f+=t[g]*i[v],f-=s[g]*o[v]}for(let g=r;g<n;g+=1)f+=t[g]*i[d-g&u-1];for(let g=r;g<e;g+=1)f-=s[g]*o[d-g&u-1];i[d]=l[p],o[d]=f,d=d+1&u-1,c[p]=f}return d},filterFullBuffer=(s,e,t,n)=>{const r=t instanceof Float64Array?t:new Float64Array(t),i=n instanceof Float64Array?n:new Float64Array(n),o=r.length,a=i.length,u=Math.min(o,a);if(r[0]!==1){for(let f=0;f<o;f+=1)i[f]/=r[0];for(let f=1;f<a;f+=1)r[f]/=r[0]}const l=32,c=new Float32Array(l),h=new Float32Array(l),d=e.createBuffer(s.numberOfChannels,s.length,s.sampleRate),p=s.numberOfChannels;for(let f=0;f<p;f+=1){const g=s.getChannelData(f),v=d.getChannelData(f);c.fill(0),h.fill(0),filterBuffer(r,o,i,a,u,c,h,0,l,g,v)}return d},createIIRFilterNodeRendererFactory=(s,e,t,n,r)=>(i,o)=>{const a=new WeakMap;let u=null;const l=async(c,h)=>{let d=null,p=e(c);const f=isOwnedByContext(p,h);if(h.createIIRFilter===void 0?d=s(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(p=h.createIIRFilter(o,i)),a.set(h,d===null?p:d),d!==null){if(u===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const v=new t(c.context.destination.channelCount,c.context.length,h.sampleRate);u=(async()=>{await n(c,v,v.destination);const y=await r(v);return filterFullBuffer(y,h,i,o)})()}const g=await u;return d.buffer=g,d.start(0),d}return await n(c,h,p),p};return{render(c,h){const d=a.get(h);return d!==void 0?Promise.resolve(d):l(c,h)}}},createIncrementCycleCounterFactory=(s,e,t,n,r,i)=>o=>(a,u)=>{const l=s.get(a);if(l===void 0){if(!o&&i(a)){const c=n(a),{outputs:h}=t(a);for(const d of h)if(isAudioNodeOutputConnection(d)){const p=n(d[0]);e(c,p,d[1],d[2])}else{const p=r(d[0]);c.disconnect(p,d[1])}}s.set(a,u)}else s.set(a,l+u)},createIsAnyAudioContext=(s,e)=>t=>{const n=s.get(t);return e(n)||e(t)},createIsAnyAudioNode=(s,e)=>t=>s.has(t)||e(t),createIsAnyAudioParam=(s,e)=>t=>s.has(t)||e(t),createIsAnyOfflineAudioContext=(s,e)=>t=>{const n=s.get(t);return e(n)||e(t)},createIsNativeAudioContext=s=>e=>s!==null&&e instanceof s,createIsNativeAudioNode=s=>e=>s!==null&&typeof s.AudioNode=="function"&&e instanceof s.AudioNode,createIsNativeAudioParam=s=>e=>s!==null&&typeof s.AudioParam=="function"&&e instanceof s.AudioParam,createIsNativeContext=(s,e)=>t=>s(t)||e(t),createIsNativeOfflineAudioContext=s=>e=>s!==null&&e instanceof s,createIsSecureContext=s=>s!==null&&s.isSecureContext,createMediaElementAudioSourceNodeConstructor=(s,e,t,n)=>class extends s{constructor(i,o){const a=t(i),u=e(a,o);if(n(a))throw TypeError();super(i,!0,u,null),this._nativeMediaElementAudioSourceNode=u}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},DEFAULT_OPTIONS$6={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},createMediaStreamAudioDestinationNodeConstructor=(s,e,t,n)=>class extends s{constructor(i,o){const a=t(i);if(n(a))throw new TypeError;const u={...DEFAULT_OPTIONS$6,...o},l=e(a,u);super(i,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},createMediaStreamAudioSourceNodeConstructor=(s,e,t,n)=>class extends s{constructor(i,o){const a=t(i),u=e(a,o);if(n(a))throw new TypeError;super(i,!0,u,null),this._nativeMediaStreamAudioSourceNode=u}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},createMediaStreamTrackAudioSourceNodeConstructor=(s,e,t)=>class extends s{constructor(r,i){const o=t(r),a=e(o,i);super(r,!0,a,null)}},createMinimalBaseAudioContextConstructor=(s,e,t,n,r,i)=>class extends t{constructor(a,u){super(a),this._nativeContext=a,CONTEXT_STORE.set(this,a),n(a)&&r.set(a,new Set),this._destination=new s(this,u),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const u=typeof a=="function"?i(this,a):null;this._nativeContext.onstatechange=u;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===u?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},testPromiseSupport=s=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=s.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},createMonitorConnections=(s,e)=>(t,n,r)=>{const i=new Set;return t.connect=(o=>(a,u=0,l=0)=>{const c=i.size===0;if(e(a))return o.call(t,a,u,l),s(i,[a,u,l],h=>h[0]===a&&h[1]===u&&h[2]===l,!0),c&&n(),a;o.call(t,a,u),s(i,[a,u],h=>h[0]===a&&h[1]===u,!0),c&&n()})(t.connect),t.disconnect=(o=>(a,u,l)=>{const c=i.size>0;if(a===void 0)o.apply(t),i.clear();else if(typeof a=="number"){o.call(t,a);for(const d of i)d[1]===a&&i.delete(d)}else{e(a)?o.call(t,a,u,l):o.call(t,a,u);for(const d of i)d[0]===a&&(u===void 0||d[1]===u)&&(l===void 0||d[2]===l)&&i.delete(d)}const h=i.size===0;c&&h&&r()})(t.disconnect),t},assignNativeAudioNodeOption=(s,e,t)=>{const n=e[t];n!==void 0&&n!==s[t]&&(s[t]=n)},assignNativeAudioNodeOptions=(s,e)=>{assignNativeAudioNodeOption(s,e,"channelCount"),assignNativeAudioNodeOption(s,e,"channelCountMode"),assignNativeAudioNodeOption(s,e,"channelInterpretation")},testAnalyserNodeGetFloatTimeDomainDataMethodSupport=s=>typeof s.getFloatTimeDomainData=="function",wrapAnalyserNodeGetFloatTimeDomainDataMethod=s=>{s.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);s.getByteTimeDomainData(t);const n=Math.max(t.length,s.fftSize);for(let r=0;r<n;r+=1)e[r]=(t[r]-128)*.0078125;return e}},createNativeAnalyserNodeFactory=(s,e)=>(t,n)=>{const r=t.createAnalyser();if(assignNativeAudioNodeOptions(r,n),!(n.maxDecibels>n.minDecibels))throw e();return assignNativeAudioNodeOption(r,n,"fftSize"),assignNativeAudioNodeOption(r,n,"maxDecibels"),assignNativeAudioNodeOption(r,n,"minDecibels"),assignNativeAudioNodeOption(r,n,"smoothingTimeConstant"),s(testAnalyserNodeGetFloatTimeDomainDataMethodSupport,()=>testAnalyserNodeGetFloatTimeDomainDataMethodSupport(r))||wrapAnalyserNodeGetFloatTimeDomainDataMethod(r),r},createNativeAudioBufferConstructor=s=>s===null?null:s.hasOwnProperty("AudioBuffer")?s.AudioBuffer:null,assignNativeAudioNodeAudioParamValue=(s,e,t)=>{const n=e[t];n!==void 0&&n!==s[t].value&&(s[t].value=n)},wrapAudioBufferSourceNodeStartMethodConsecutiveCalls=s=>{s.start=(e=>{let t=!1;return(n=0,r=0,i)=>{if(t)throw createInvalidStateError();e.call(s,n,r,i),t=!0}})(s.start)},wrapAudioScheduledSourceNodeStartMethodNegativeParameters=s=>{s.start=(e=>(t=0,n=0,r)=>{if(typeof r=="number"&&r<0||n<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(s,t,n,r)})(s.start)},wrapAudioScheduledSourceNodeStopMethodNegativeParameters=s=>{s.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(s,t)})(s.stop)},createNativeAudioBufferSourceNodeFactory=(s,e,t,n,r,i,o,a,u,l,c)=>(h,d)=>{const p=h.createBufferSource();return assignNativeAudioNodeOptions(p,d),assignNativeAudioNodeAudioParamValue(p,d,"playbackRate"),assignNativeAudioNodeOption(p,d,"buffer"),assignNativeAudioNodeOption(p,d,"loop"),assignNativeAudioNodeOption(p,d,"loopEnd"),assignNativeAudioNodeOption(p,d,"loopStart"),e(t,()=>t(h))||wrapAudioBufferSourceNodeStartMethodConsecutiveCalls(p),e(n,()=>n(h))||u(p),e(r,()=>r(h))||l(p,h),e(i,()=>i(h))||wrapAudioScheduledSourceNodeStartMethodNegativeParameters(p),e(o,()=>o(h))||c(p,h),e(a,()=>a(h))||wrapAudioScheduledSourceNodeStopMethodNegativeParameters(p),s(h,p),p},createNativeAudioContextConstructor=s=>s===null?null:s.hasOwnProperty("AudioContext")?s.AudioContext:s.hasOwnProperty("webkitAudioContext")?s.webkitAudioContext:null,createNativeAudioDestinationNodeFactory=(s,e)=>(t,n,r)=>{const i=t.destination;if(i.channelCount!==n)try{i.channelCount=n}catch{}r&&i.channelCountMode!=="explicit"&&(i.channelCountMode="explicit"),i.maxChannelCount===0&&Object.defineProperty(i,"maxChannelCount",{value:n});const o=s(t,{channelCount:n,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1});return e(o,"channelCount",a=>()=>a.call(o),a=>u=>{a.call(o,u);try{i.channelCount=u}catch(l){if(u>i.maxChannelCount)throw l}}),e(o,"channelCountMode",a=>()=>a.call(o),a=>u=>{a.call(o,u),i.channelCountMode=u}),e(o,"channelInterpretation",a=>()=>a.call(o),a=>u=>{a.call(o,u),i.channelInterpretation=u}),Object.defineProperty(o,"maxChannelCount",{get:()=>i.maxChannelCount}),o.connect(i),o},createNativeAudioWorkletNodeConstructor=s=>s===null?null:s.hasOwnProperty("AudioWorkletNode")?s.AudioWorkletNode:null,testClonabilityOfAudioWorkletNodeOptions=s=>{const{port1:e}=new MessageChannel;try{e.postMessage(s)}finally{e.close()}},createNativeAudioWorkletNodeFactory=(s,e,t,n,r)=>(i,o,a,u,l,c)=>{if(a!==null)try{const h=new a(i,u,c),d=new Map;let p=null;if(Object.defineProperties(h,{channelCount:{get:()=>c.channelCount,set:()=>{throw s()}},channelCountMode:{get:()=>"explicit",set:()=>{throw s()}},onprocessorerror:{get:()=>p,set:f=>{typeof p=="function"&&h.removeEventListener("processorerror",p),p=typeof f=="function"?f:null,typeof p=="function"&&h.addEventListener("processorerror",p)}}}),h.addEventListener=(f=>(...g)=>{if(g[0]==="processorerror"){const v=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(v!==null){const y=d.get(g[1]);y!==void 0?g[1]=y:(g[1]=x=>{x.type==="error"?(Object.defineProperties(x,{type:{value:"processorerror"}}),v(x)):v(new ErrorEvent(g[0],{...x}))},d.set(v,g[1]))}}return f.call(h,"error",g[1],g[2]),f.call(h,...g)})(h.addEventListener),h.removeEventListener=(f=>(...g)=>{if(g[0]==="processorerror"){const v=d.get(g[1]);v!==void 0&&(d.delete(g[1]),g[1]=v)}return f.call(h,"error",g[1],g[2]),f.call(h,g[0],g[1],g[2])})(h.removeEventListener),c.numberOfOutputs!==0){const f=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(f).connect(i.destination),r(h,()=>f.disconnect(),()=>f.connect(i.destination))}return h}catch(h){throw h.code===11?n():h}if(l===void 0)throw n();return testClonabilityOfAudioWorkletNodeOptions(c),e(i,o,l,c)},computeBufferSize=(s,e)=>s===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(s*e))))),cloneAudioWorkletNodeOptions=s=>new Promise((e,t)=>{const{port1:n,port2:r}=new MessageChannel;n.onmessage=({data:i})=>{n.close(),r.close(),e(i)},n.onmessageerror=({data:i})=>{n.close(),r.close(),t(i)},r.postMessage(s)}),createAudioWorkletProcessorPromise=async(s,e)=>{const t=await cloneAudioWorkletNodeOptions(e);return new s(t)},createAudioWorkletProcessor=(s,e,t,n)=>{let r=NODE_TO_PROCESSOR_MAPS.get(s);r===void 0&&(r=new WeakMap,NODE_TO_PROCESSOR_MAPS.set(s,r));const i=createAudioWorkletProcessorPromise(t,n);return r.set(e,i),i},createNativeAudioWorkletNodeFakerFactory=(s,e,t,n,r,i,o,a,u,l,c,h,d)=>(p,f,g,v)=>{if(v.numberOfInputs===0&&v.numberOfOutputs===0)throw u();const y=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(y.some(ie=>ie<1))throw u();if(y.length!==v.numberOfOutputs)throw e();if(v.channelCountMode!=="explicit")throw u();const x=v.channelCount*v.numberOfInputs,R=y.reduce((ie,ge)=>ie+ge,0),k=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(x+k>6||R>6)throw u();const m=new MessageChannel,b=[],I=[];for(let ie=0;ie<v.numberOfInputs;ie+=1)b.push(o(p,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),I.push(r(p,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const _=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:ie,maxValue:ge,minValue:Ee,name:Oe}of g.parameterDescriptors){const Ie=i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:v.parameterData[Oe]!==void 0?v.parameterData[Oe]:ie===void 0?0:ie});Object.defineProperties(Ie.offset,{defaultValue:{get:()=>ie===void 0?0:ie},maxValue:{get:()=>ge===void 0?MOST_POSITIVE_SINGLE_FLOAT:ge},minValue:{get:()=>Ee===void 0?MOST_NEGATIVE_SINGLE_FLOAT:Ee}}),_.push(Ie)}const S=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,x+k)}),T=computeBufferSize(f,p.sampleRate),E=a(p,T,x+k,Math.max(1,R)),L=r(p,{channelCount:Math.max(1,R),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,R)}),$=[];for(let ie=0;ie<v.numberOfOutputs;ie+=1)$.push(n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:y[ie]}));for(let ie=0;ie<v.numberOfInputs;ie+=1){b[ie].connect(I[ie]);for(let ge=0;ge<v.channelCount;ge+=1)I[ie].connect(S,ge,ie*v.channelCount+ge)}const Y=new ReadOnlyMap(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:ie},ge)=>{const Ee=_[ge];return Ee.connect(S,0,x+ge),Ee.start(0),[ie,Ee.offset]}));S.connect(E);let V=v.channelInterpretation,j=null;const G=v.numberOfOutputs===0?[E]:$,X={get bufferSize(){return T},get channelCount(){return v.channelCount},set channelCount(ie){throw t()},get channelCountMode(){return v.channelCountMode},set channelCountMode(ie){throw t()},get channelInterpretation(){return V},set channelInterpretation(ie){for(const ge of b)ge.channelInterpretation=ie;V=ie},get context(){return E.context},get inputs(){return b},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},get onprocessorerror(){return j},set onprocessorerror(ie){typeof j=="function"&&X.removeEventListener("processorerror",j),j=typeof ie=="function"?ie:null,typeof j=="function"&&X.addEventListener("processorerror",j)},get parameters(){return Y},get port(){return m.port2},addEventListener(...ie){return E.addEventListener(ie[0],ie[1],ie[2])},connect:s.bind(null,G),disconnect:l.bind(null,G),dispatchEvent(...ie){return E.dispatchEvent(ie[0])},removeEventListener(...ie){return E.removeEventListener(ie[0],ie[1],ie[2])}},q=new Map;m.port1.addEventListener=(ie=>(...ge)=>{if(ge[0]==="message"){const Ee=typeof ge[1]=="function"?ge[1]:typeof ge[1]=="object"&&ge[1]!==null&&typeof ge[1].handleEvent=="function"?ge[1].handleEvent:null;if(Ee!==null){const Oe=q.get(ge[1]);Oe!==void 0?ge[1]=Oe:(ge[1]=Ie=>{c(p.currentTime,p.sampleRate,()=>Ee(Ie))},q.set(Ee,ge[1]))}}return ie.call(m.port1,ge[0],ge[1],ge[2])})(m.port1.addEventListener),m.port1.removeEventListener=(ie=>(...ge)=>{if(ge[0]==="message"){const Ee=q.get(ge[1]);Ee!==void 0&&(q.delete(ge[1]),ge[1]=Ee)}return ie.call(m.port1,ge[0],ge[1],ge[2])})(m.port1.removeEventListener);let Z=null;Object.defineProperty(m.port1,"onmessage",{get:()=>Z,set:ie=>{typeof Z=="function"&&m.port1.removeEventListener("message",Z),Z=typeof ie=="function"?ie:null,typeof Z=="function"&&(m.port1.addEventListener("message",Z),m.port1.start())}}),g.prototype.port=m.port1;let J=null;createAudioWorkletProcessor(p,X,g,v).then(ie=>J=ie);const K=createNestedArrays(v.numberOfInputs,v.channelCount),O=createNestedArrays(v.numberOfOutputs,y),N=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce((ie,{name:ge})=>({...ie,[ge]:new Float32Array(128)}),{});let F=!0;const z=()=>{v.numberOfOutputs>0&&E.disconnect(L);for(let ie=0,ge=0;ie<v.numberOfOutputs;ie+=1){const Ee=$[ie];for(let Oe=0;Oe<y[ie];Oe+=1)L.disconnect(Ee,ge+Oe,Oe);ge+=y[ie]}},D=new Map;E.onaudioprocess=({inputBuffer:ie,outputBuffer:ge})=>{if(J!==null){const Ee=h(X);for(let Oe=0;Oe<T;Oe+=128){for(let Ie=0;Ie<v.numberOfInputs;Ie+=1)for(let we=0;we<v.channelCount;we+=1)copyFromChannel(ie,K[Ie],we,we,Oe);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:Ie},we)=>{copyFromChannel(ie,N,Ie,x+we,Oe)});for(let Ie=0;Ie<v.numberOfInputs;Ie+=1)for(let we=0;we<y[Ie];we+=1)O[Ie][we].byteLength===0&&(O[Ie][we]=new Float32Array(128));try{const Ie=K.map((Ue,Ne)=>{if(Ee[Ne].size>0)return D.set(Ne,T/128),Ue;const de=D.get(Ne);return de===void 0?[]:(Ue.every(Te=>Te.every(_e=>_e===0))&&(de===1?D.delete(Ne):D.set(Ne,de-1)),Ue)});F=c(p.currentTime+Oe/p.sampleRate,p.sampleRate,()=>J.process(Ie,O,N));for(let Ue=0,Ne=0;Ue<v.numberOfOutputs;Ue+=1){for(let be=0;be<y[Ue];be+=1)copyToChannel(ge,O[Ue],be,Ne+be,Oe);Ne+=y[Ue]}}catch(Ie){F=!1,X.dispatchEvent(new ErrorEvent("processorerror",{colno:Ie.colno,filename:Ie.filename,lineno:Ie.lineno,message:Ie.message}))}if(!F){for(let Ie=0;Ie<v.numberOfInputs;Ie+=1){b[Ie].disconnect(I[Ie]);for(let we=0;we<v.channelCount;we+=1)I[Oe].disconnect(S,we,Ie*v.channelCount+we)}if(g.parameterDescriptors!==void 0){const Ie=g.parameterDescriptors.length;for(let we=0;we<Ie;we+=1){const Ue=_[we];Ue.disconnect(S,0,x+we),Ue.stop()}}S.disconnect(E),E.onaudioprocess=null,U?z():pe();break}}}};let U=!1;const ee=o(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),re=()=>E.connect(ee).connect(p.destination),pe=()=>{E.disconnect(ee),ee.disconnect()},ue=()=>{if(F){pe(),v.numberOfOutputs>0&&E.connect(L);for(let ie=0,ge=0;ie<v.numberOfOutputs;ie+=1){const Ee=$[ie];for(let Oe=0;Oe<y[ie];Oe+=1)L.connect(Ee,ge+Oe,Oe);ge+=y[ie]}}U=!0},ye=()=>{F&&(re(),z()),U=!1};return re(),d(X,ue,ye)},createNativeBiquadFilterNode=(s,e)=>{const t=s.createBiquadFilter();return assignNativeAudioNodeOptions(t,e),assignNativeAudioNodeAudioParamValue(t,e,"Q"),assignNativeAudioNodeAudioParamValue(t,e,"detune"),assignNativeAudioNodeAudioParamValue(t,e,"frequency"),assignNativeAudioNodeAudioParamValue(t,e,"gain"),assignNativeAudioNodeOption(t,e,"type"),t},createNativeChannelMergerNodeFactory=(s,e)=>(t,n)=>{const r=t.createChannelMerger(n.numberOfInputs);return s!==null&&s.name==="webkitAudioContext"&&e(t,r),assignNativeAudioNodeOptions(r,n),r},wrapChannelSplitterNode=s=>{const e=s.numberOfOutputs;Object.defineProperty(s,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw createInvalidStateError()}}),Object.defineProperty(s,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw createInvalidStateError()}}),Object.defineProperty(s,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw createInvalidStateError()}})},createNativeChannelSplitterNode=(s,e)=>{const t=s.createChannelSplitter(e.numberOfOutputs);return assignNativeAudioNodeOptions(t,e),wrapChannelSplitterNode(t),t},createNativeConstantSourceNodeFactory=(s,e,t,n,r)=>(i,o)=>{if(i.createConstantSource===void 0)return t(i,o);const a=i.createConstantSource();return assignNativeAudioNodeOptions(a,o),assignNativeAudioNodeAudioParamValue(a,o,"offset"),e(n,()=>n(i))||wrapAudioScheduledSourceNodeStartMethodNegativeParameters(a),e(r,()=>r(i))||wrapAudioScheduledSourceNodeStopMethodNegativeParameters(a),s(i,a),a},interceptConnections=(s,e)=>(s.connect=e.connect.bind(e),s.disconnect=e.disconnect.bind(e),s),createNativeConstantSourceNodeFakerFactory=(s,e,t,n)=>(r,{offset:i,...o})=>{const a=r.createBuffer(1,2,44100),u=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=t(r,{...o,gain:i}),c=a.getChannelData(0);c[0]=1,c[1]=1,u.buffer=a,u.loop=!0;const h={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(f){l.channelCount=f},get channelCountMode(){return l.channelCountMode},set channelCountMode(f){l.channelCountMode=f},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(f){l.channelInterpretation=f},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return u.onended},set onended(f){u.onended=f},addEventListener(...f){return u.addEventListener(f[0],f[1],f[2])},dispatchEvent(...f){return u.dispatchEvent(f[0])},removeEventListener(...f){return u.removeEventListener(f[0],f[1],f[2])},start(f=0){u.start.call(u,f)},stop(f=0){u.stop.call(u,f)}},d=()=>u.connect(l),p=()=>u.disconnect(l);return s(r,u),n(interceptConnections(h,l),d,p)},createNativeConvolverNodeFactory=(s,e)=>(t,n)=>{const r=t.createConvolver();if(assignNativeAudioNodeOptions(r,n),n.disableNormalization===r.normalize&&(r.normalize=!n.disableNormalization),assignNativeAudioNodeOption(r,n,"buffer"),n.channelCount>2||(e(r,"channelCount",i=>()=>i.call(r),i=>o=>{if(o>2)throw s();return i.call(r,o)}),n.channelCountMode==="max"))throw s();return e(r,"channelCountMode",i=>()=>i.call(r),i=>o=>{if(o==="max")throw s();return i.call(r,o)}),r},createNativeDelayNode=(s,e)=>{const t=s.createDelay(e.maxDelayTime);return assignNativeAudioNodeOptions(t,e),assignNativeAudioNodeAudioParamValue(t,e,"delayTime"),t},createNativeDynamicsCompressorNodeFactory=s=>(e,t)=>{const n=e.createDynamicsCompressor();if(assignNativeAudioNodeOptions(n,t),t.channelCount>2||t.channelCountMode==="max")throw s();return assignNativeAudioNodeAudioParamValue(n,t,"attack"),assignNativeAudioNodeAudioParamValue(n,t,"knee"),assignNativeAudioNodeAudioParamValue(n,t,"ratio"),assignNativeAudioNodeAudioParamValue(n,t,"release"),assignNativeAudioNodeAudioParamValue(n,t,"threshold"),n},createNativeGainNode=(s,e)=>{const t=s.createGain();return assignNativeAudioNodeOptions(t,e),assignNativeAudioNodeAudioParamValue(t,e,"gain"),t},createNativeIIRFilterNodeFactory=s=>(e,t,n)=>{if(e.createIIRFilter===void 0)return s(e,t,n);const r=e.createIIRFilter(n.feedforward,n.feedback);return assignNativeAudioNodeOptions(r,n),r};function divide(s,e){const t=e[0]*e[0]+e[1]*e[1];return[(s[0]*e[0]+s[1]*e[1])/t,(s[1]*e[0]-s[0]*e[1])/t]}function multiply(s,e){return[s[0]*e[0]-s[1]*e[1],s[0]*e[1]+s[1]*e[0]]}function evaluatePolynomial(s,e){let t=[0,0];for(let n=s.length-1;n>=0;n-=1)t=multiply(t,e),t[0]+=s[n];return t}const createNativeIIRFilterNodeFakerFactory=(s,e,t,n)=>(r,i,{channelCount:o,channelCountMode:a,channelInterpretation:u,feedback:l,feedforward:c})=>{const h=computeBufferSize(i,r.sampleRate),d=l instanceof Float64Array?l:new Float64Array(l),p=c instanceof Float64Array?c:new Float64Array(c),f=d.length,g=p.length,v=Math.min(f,g);if(f===0||f>20)throw n();if(d[0]===0)throw e();if(g===0||g>20)throw n();if(p[0]===0)throw e();if(d[0]!==1){for(let _=0;_<g;_+=1)p[_]/=d[0];for(let _=1;_<f;_+=1)d[_]/=d[0]}const y=t(r,h,o,o);y.channelCount=o,y.channelCountMode=a,y.channelInterpretation=u;const x=32,R=[],k=[],m=[];for(let _=0;_<o;_+=1){R.push(0);const S=new Float32Array(x),T=new Float32Array(x);S.fill(0),T.fill(0),k.push(S),m.push(T)}y.onaudioprocess=_=>{const S=_.inputBuffer,T=_.outputBuffer,E=S.numberOfChannels;for(let L=0;L<E;L+=1){const $=S.getChannelData(L),Y=T.getChannelData(L);R[L]=filterBuffer(d,f,p,g,v,k[L],m[L],R[L],x,$,Y)}};const b=r.sampleRate/2;return interceptConnections({get bufferSize(){return h},get channelCount(){return y.channelCount},set channelCount(_){y.channelCount=_},get channelCountMode(){return y.channelCountMode},set channelCountMode(_){y.channelCountMode=_},get channelInterpretation(){return y.channelInterpretation},set channelInterpretation(_){y.channelInterpretation=_},get context(){return y.context},get inputs(){return[y]},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},addEventListener(..._){return y.addEventListener(_[0],_[1],_[2])},dispatchEvent(..._){return y.dispatchEvent(_[0])},getFrequencyResponse(_,S,T){if(_.length!==S.length||S.length!==T.length)throw s();const E=_.length;for(let L=0;L<E;L+=1){const $=-Math.PI*(_[L]/b),Y=[Math.cos($),Math.sin($)],V=evaluatePolynomial(p,Y),j=evaluatePolynomial(d,Y),G=divide(V,j);S[L]=Math.sqrt(G[0]*G[0]+G[1]*G[1]),T[L]=Math.atan2(G[1],G[0])}},removeEventListener(..._){return y.removeEventListener(_[0],_[1],_[2])}},y)},createNativeMediaElementAudioSourceNode=(s,e)=>s.createMediaElementSource(e.mediaElement),createNativeMediaStreamAudioDestinationNode=(s,e)=>{const t=s.createMediaStreamDestination();return assignNativeAudioNodeOptions(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},createNativeMediaStreamAudioSourceNode=(s,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((i,o)=>i.id<o.id?-1:i.id>o.id?1:0);const n=t.slice(0,1),r=s.createMediaStreamSource(new MediaStream(n));return Object.defineProperty(r,"mediaStream",{value:e}),r},createNativeMediaStreamTrackAudioSourceNodeFactory=(s,e)=>(t,{mediaStreamTrack:n})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(n);const r=new MediaStream([n]),i=t.createMediaStreamSource(r);if(n.kind!=="audio")throw s();if(e(t))throw new TypeError;return i},createNativeOfflineAudioContextConstructor=s=>s===null?null:s.hasOwnProperty("OfflineAudioContext")?s.OfflineAudioContext:s.hasOwnProperty("webkitOfflineAudioContext")?s.webkitOfflineAudioContext:null,createNativeOscillatorNodeFactory=(s,e,t,n,r,i)=>(o,a)=>{const u=o.createOscillator();return assignNativeAudioNodeOptions(u,a),assignNativeAudioNodeAudioParamValue(u,a,"detune"),assignNativeAudioNodeAudioParamValue(u,a,"frequency"),a.periodicWave!==void 0?u.setPeriodicWave(a.periodicWave):assignNativeAudioNodeOption(u,a,"type"),e(t,()=>t(o))||wrapAudioScheduledSourceNodeStartMethodNegativeParameters(u),e(n,()=>n(o))||i(u,o),e(r,()=>r(o))||wrapAudioScheduledSourceNodeStopMethodNegativeParameters(u),s(o,u),u},createNativePannerNodeFactory=s=>(e,t)=>{const n=e.createPanner();return n.orientationX===void 0?s(e,t):(assignNativeAudioNodeOptions(n,t),assignNativeAudioNodeAudioParamValue(n,t,"orientationX"),assignNativeAudioNodeAudioParamValue(n,t,"orientationY"),assignNativeAudioNodeAudioParamValue(n,t,"orientationZ"),assignNativeAudioNodeAudioParamValue(n,t,"positionX"),assignNativeAudioNodeAudioParamValue(n,t,"positionY"),assignNativeAudioNodeAudioParamValue(n,t,"positionZ"),assignNativeAudioNodeOption(n,t,"coneInnerAngle"),assignNativeAudioNodeOption(n,t,"coneOuterAngle"),assignNativeAudioNodeOption(n,t,"coneOuterGain"),assignNativeAudioNodeOption(n,t,"distanceModel"),assignNativeAudioNodeOption(n,t,"maxDistance"),assignNativeAudioNodeOption(n,t,"panningModel"),assignNativeAudioNodeOption(n,t,"refDistance"),assignNativeAudioNodeOption(n,t,"rolloffFactor"),n)},createNativePannerNodeFakerFactory=(s,e,t,n,r,i,o,a,u,l)=>(c,{coneInnerAngle:h,coneOuterAngle:d,coneOuterGain:p,distanceModel:f,maxDistance:g,orientationX:v,orientationY:y,orientationZ:x,panningModel:R,positionX:k,positionY:m,positionZ:b,refDistance:I,rolloffFactor:_,...S})=>{const T=c.createPanner();if(S.channelCount>2||S.channelCountMode==="max")throw o();assignNativeAudioNodeOptions(T,S);const E={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},L=t(c,{...E,channelInterpretation:"speakers",numberOfInputs:6}),$=n(c,{...S,gain:1}),Y=n(c,{...E,gain:1}),V=n(c,{...E,gain:0}),j=n(c,{...E,gain:0}),G=n(c,{...E,gain:0}),X=n(c,{...E,gain:0}),q=n(c,{...E,gain:0}),Z=r(c,256,6,1),J=i(c,{...E,curve:new Float32Array([1,1]),oversample:"none"});let ve=[v,y,x],K=[k,m,b];const O=new Float32Array(1);Z.onaudioprocess=({inputBuffer:D})=>{const U=[u(D,O,0),u(D,O,1),u(D,O,2)];U.some((re,pe)=>re!==ve[pe])&&(T.setOrientation(...U),ve=U);const ee=[u(D,O,3),u(D,O,4),u(D,O,5)];ee.some((re,pe)=>re!==K[pe])&&(T.setPosition(...ee),K=ee)},Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(j.gain,"defaultValue",{get:()=>0}),Object.defineProperty(G.gain,"defaultValue",{get:()=>0}),Object.defineProperty(X.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0});const N={get bufferSize(){},get channelCount(){return T.channelCount},set channelCount(D){if(D>2)throw o();$.channelCount=D,T.channelCount=D},get channelCountMode(){return T.channelCountMode},set channelCountMode(D){if(D==="max")throw o();$.channelCountMode=D,T.channelCountMode=D},get channelInterpretation(){return T.channelInterpretation},set channelInterpretation(D){$.channelInterpretation=D,T.channelInterpretation=D},get coneInnerAngle(){return T.coneInnerAngle},set coneInnerAngle(D){T.coneInnerAngle=D},get coneOuterAngle(){return T.coneOuterAngle},set coneOuterAngle(D){T.coneOuterAngle=D},get coneOuterGain(){return T.coneOuterGain},set coneOuterGain(D){if(D<0||D>1)throw e();T.coneOuterGain=D},get context(){return T.context},get distanceModel(){return T.distanceModel},set distanceModel(D){T.distanceModel=D},get inputs(){return[$]},get maxDistance(){return T.maxDistance},set maxDistance(D){if(D<0)throw new RangeError;T.maxDistance=D},get numberOfInputs(){return T.numberOfInputs},get numberOfOutputs(){return T.numberOfOutputs},get orientationX(){return Y.gain},get orientationY(){return V.gain},get orientationZ(){return j.gain},get panningModel(){return T.panningModel},set panningModel(D){T.panningModel=D},get positionX(){return G.gain},get positionY(){return X.gain},get positionZ(){return q.gain},get refDistance(){return T.refDistance},set refDistance(D){if(D<0)throw new RangeError;T.refDistance=D},get rolloffFactor(){return T.rolloffFactor},set rolloffFactor(D){if(D<0)throw new RangeError;T.rolloffFactor=D},addEventListener(...D){return $.addEventListener(D[0],D[1],D[2])},dispatchEvent(...D){return $.dispatchEvent(D[0])},removeEventListener(...D){return $.removeEventListener(D[0],D[1],D[2])}};h!==N.coneInnerAngle&&(N.coneInnerAngle=h),d!==N.coneOuterAngle&&(N.coneOuterAngle=d),p!==N.coneOuterGain&&(N.coneOuterGain=p),f!==N.distanceModel&&(N.distanceModel=f),g!==N.maxDistance&&(N.maxDistance=g),v!==N.orientationX.value&&(N.orientationX.value=v),y!==N.orientationY.value&&(N.orientationY.value=y),x!==N.orientationZ.value&&(N.orientationZ.value=x),R!==N.panningModel&&(N.panningModel=R),k!==N.positionX.value&&(N.positionX.value=k),m!==N.positionY.value&&(N.positionY.value=m),b!==N.positionZ.value&&(N.positionZ.value=b),I!==N.refDistance&&(N.refDistance=I),_!==N.rolloffFactor&&(N.rolloffFactor=_),(ve[0]!==1||ve[1]!==0||ve[2]!==0)&&T.setOrientation(...ve),(K[0]!==0||K[1]!==0||K[2]!==0)&&T.setPosition(...K);const F=()=>{$.connect(T),s($,J,0,0),J.connect(Y).connect(L,0,0),J.connect(V).connect(L,0,1),J.connect(j).connect(L,0,2),J.connect(G).connect(L,0,3),J.connect(X).connect(L,0,4),J.connect(q).connect(L,0,5),L.connect(Z).connect(c.destination)},z=()=>{$.disconnect(T),a($,J,0,0),J.disconnect(Y),Y.disconnect(L),J.disconnect(V),V.disconnect(L),J.disconnect(j),j.disconnect(L),J.disconnect(G),G.disconnect(L),J.disconnect(X),X.disconnect(L),J.disconnect(q),q.disconnect(L),L.disconnect(Z),Z.disconnect(c.destination)};return l(interceptConnections(N,T),F,z)},createNativePeriodicWaveFactory=s=>(e,{disableNormalization:t,imag:n,real:r})=>{const i=n instanceof Float32Array?n:new Float32Array(n),o=r instanceof Float32Array?r:new Float32Array(r),a=e.createPeriodicWave(o,i,{disableNormalization:t});if(Array.from(n).length<2)throw s();return a},createNativeScriptProcessorNode=(s,e,t,n)=>s.createScriptProcessor(e,t,n),createNativeStereoPannerNodeFactory=(s,e)=>(t,n)=>{const r=n.channelCountMode;if(r==="clamped-max")throw e();if(t.createStereoPanner===void 0)return s(t,n);const i=t.createStereoPanner();return assignNativeAudioNodeOptions(i,n),assignNativeAudioNodeAudioParamValue(i,n,"pan"),Object.defineProperty(i,"channelCountMode",{get:()=>r,set:o=>{if(o!==r)throw e()}}),i},createNativeStereoPannerNodeFakerFactory=(s,e,t,n,r,i)=>{const a=new Float32Array([1,1]),u=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},c={...l,oversample:"none"},h=(f,g,v,y)=>{const x=new Float32Array(16385),R=new Float32Array(16385);for(let S=0;S<16385;S+=1){const T=S/16384*u;x[S]=Math.cos(T),R[S]=Math.sin(T)}const k=t(f,{...l,gain:0}),m=n(f,{...c,curve:x}),b=n(f,{...c,curve:a}),I=t(f,{...l,gain:0}),_=n(f,{...c,curve:R});return{connectGraph(){g.connect(k),g.connect(b.inputs===void 0?b:b.inputs[0]),g.connect(I),b.connect(v),v.connect(m.inputs===void 0?m:m.inputs[0]),v.connect(_.inputs===void 0?_:_.inputs[0]),m.connect(k.gain),_.connect(I.gain),k.connect(y,0,0),I.connect(y,0,1)},disconnectGraph(){g.disconnect(k),g.disconnect(b.inputs===void 0?b:b.inputs[0]),g.disconnect(I),b.disconnect(v),v.disconnect(m.inputs===void 0?m:m.inputs[0]),v.disconnect(_.inputs===void 0?_:_.inputs[0]),m.disconnect(k.gain),_.disconnect(I.gain),k.disconnect(y,0,0),I.disconnect(y,0,1)}}},d=(f,g,v,y)=>{const x=new Float32Array(16385),R=new Float32Array(16385),k=new Float32Array(16385),m=new Float32Array(16385),b=Math.floor(16385/2);for(let G=0;G<16385;G+=1)if(G>b){const X=(G-b)/(16384-b)*u;x[G]=Math.cos(X),R[G]=Math.sin(X),k[G]=0,m[G]=1}else{const X=G/(16384-b)*u;x[G]=1,R[G]=0,k[G]=Math.cos(X),m[G]=Math.sin(X)}const I=e(f,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),_=t(f,{...l,gain:0}),S=n(f,{...c,curve:x}),T=t(f,{...l,gain:0}),E=n(f,{...c,curve:R}),L=n(f,{...c,curve:a}),$=t(f,{...l,gain:0}),Y=n(f,{...c,curve:k}),V=t(f,{...l,gain:0}),j=n(f,{...c,curve:m});return{connectGraph(){g.connect(I),g.connect(L.inputs===void 0?L:L.inputs[0]),I.connect(_,0),I.connect(T,0),I.connect($,1),I.connect(V,1),L.connect(v),v.connect(S.inputs===void 0?S:S.inputs[0]),v.connect(E.inputs===void 0?E:E.inputs[0]),v.connect(Y.inputs===void 0?Y:Y.inputs[0]),v.connect(j.inputs===void 0?j:j.inputs[0]),S.connect(_.gain),E.connect(T.gain),Y.connect($.gain),j.connect(V.gain),_.connect(y,0,0),$.connect(y,0,0),T.connect(y,0,1),V.connect(y,0,1)},disconnectGraph(){g.disconnect(I),g.disconnect(L.inputs===void 0?L:L.inputs[0]),I.disconnect(_,0),I.disconnect(T,0),I.disconnect($,1),I.disconnect(V,1),L.disconnect(v),v.disconnect(S.inputs===void 0?S:S.inputs[0]),v.disconnect(E.inputs===void 0?E:E.inputs[0]),v.disconnect(Y.inputs===void 0?Y:Y.inputs[0]),v.disconnect(j.inputs===void 0?j:j.inputs[0]),S.disconnect(_.gain),E.disconnect(T.gain),Y.disconnect($.gain),j.disconnect(V.gain),_.disconnect(y,0,0),$.disconnect(y,0,0),T.disconnect(y,0,1),V.disconnect(y,0,1)}}},p=(f,g,v,y,x)=>{if(g===1)return h(f,v,y,x);if(g===2)return d(f,v,y,x);throw r()};return(f,{channelCount:g,channelCountMode:v,pan:y,...x})=>{if(v==="max")throw r();const R=s(f,{...x,channelCount:1,channelCountMode:v,numberOfInputs:2}),k=t(f,{...x,channelCount:g,channelCountMode:v,gain:1}),m=t(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:y});let{connectGraph:b,disconnectGraph:I}=p(f,g,k,m,R);Object.defineProperty(m.gain,"defaultValue",{get:()=>0}),Object.defineProperty(m.gain,"maxValue",{get:()=>1}),Object.defineProperty(m.gain,"minValue",{get:()=>-1});const _={get bufferSize(){},get channelCount(){return k.channelCount},set channelCount(L){k.channelCount!==L&&(S&&I(),{connectGraph:b,disconnectGraph:I}=p(f,L,k,m,R),S&&b()),k.channelCount=L},get channelCountMode(){return k.channelCountMode},set channelCountMode(L){if(L==="clamped-max"||L==="max")throw r();k.channelCountMode=L},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(L){k.channelInterpretation=L},get context(){return k.context},get inputs(){return[k]},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},get pan(){return m.gain},addEventListener(...L){return k.addEventListener(L[0],L[1],L[2])},dispatchEvent(...L){return k.dispatchEvent(L[0])},removeEventListener(...L){return k.removeEventListener(L[0],L[1],L[2])}};let S=!1;const T=()=>{b(),S=!0},E=()=>{I(),S=!1};return i(interceptConnections(_,R),T,E)}},createNativeWaveShaperNodeFactory=(s,e,t,n,r,i,o)=>(a,u)=>{const l=a.createWaveShaper();if(i!==null&&i.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return t(a,u);assignNativeAudioNodeOptions(l,u);const c=u.curve===null||u.curve instanceof Float32Array?u.curve:new Float32Array(u.curve);if(c!==null&&c.length<2)throw e();assignNativeAudioNodeOption(l,{curve:c},"curve"),assignNativeAudioNodeOption(l,u,"oversample");let h=null,d=!1;return o(l,"curve",g=>()=>g.call(l),g=>v=>(g.call(l,v),d&&(n(v)&&h===null?h=s(a,l):!n(v)&&h!==null&&(h(),h=null)),v)),r(l,()=>{d=!0,n(l.curve)&&(h=s(a,l))},()=>{d=!1,h!==null&&(h(),h=null)})},createNativeWaveShaperNodeFakerFactory=(s,e,t,n,r)=>(i,{curve:o,oversample:a,...u})=>{const l=i.createWaveShaper(),c=i.createWaveShaper();assignNativeAudioNodeOptions(l,u),assignNativeAudioNodeOptions(c,u);const h=t(i,{...u,gain:1}),d=t(i,{...u,gain:-1}),p=t(i,{...u,gain:1}),f=t(i,{...u,gain:-1});let g=null,v=!1,y=null;const x={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(m){h.channelCount=m,d.channelCount=m,l.channelCount=m,p.channelCount=m,c.channelCount=m,f.channelCount=m},get channelCountMode(){return l.channelCountMode},set channelCountMode(m){h.channelCountMode=m,d.channelCountMode=m,l.channelCountMode=m,p.channelCountMode=m,c.channelCountMode=m,f.channelCountMode=m},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(m){h.channelInterpretation=m,d.channelInterpretation=m,l.channelInterpretation=m,p.channelInterpretation=m,c.channelInterpretation=m,f.channelInterpretation=m},get context(){return l.context},get curve(){return y},set curve(m){if(m!==null&&m.length<2)throw e();if(m===null)l.curve=m,c.curve=m;else{const b=m.length,I=new Float32Array(b+2-b%2),_=new Float32Array(b+2-b%2);I[0]=m[0],_[0]=-m[b-1];const S=Math.ceil((b+1)/2),T=(b+1)/2-1;for(let E=1;E<S;E+=1){const L=E/S*T,$=Math.floor(L),Y=Math.ceil(L);I[E]=$===Y?m[$]:(1-(L-$))*m[$]+(1-(Y-L))*m[Y],_[E]=$===Y?-m[b-1-$]:-((1-(L-$))*m[b-1-$])-(1-(Y-L))*m[b-1-Y]}I[S]=b%2===1?m[S-1]:(m[S-2]+m[S-1])/2,l.curve=I,c.curve=_}y=m,v&&(n(y)&&g===null?g=s(i,h):g!==null&&(g(),g=null))},get inputs(){return[h]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(m){l.oversample=m,c.oversample=m},addEventListener(...m){return h.addEventListener(m[0],m[1],m[2])},dispatchEvent(...m){return h.dispatchEvent(m[0])},removeEventListener(...m){return h.removeEventListener(m[0],m[1],m[2])}};o!==null&&(x.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==x.oversample&&(x.oversample=a);const R=()=>{h.connect(l).connect(p),h.connect(d).connect(c).connect(f).connect(p),v=!0,n(y)&&(g=s(i,h))},k=()=>{h.disconnect(l),l.disconnect(p),h.disconnect(d),d.disconnect(c),c.disconnect(f),f.disconnect(p),v=!1,g!==null&&(g(),g=null)};return r(interceptConnections(x,p),R,k)},createNotSupportedError=()=>new DOMException("","NotSupportedError"),DEFAULT_OPTIONS$5={numberOfChannels:1},createOfflineAudioContextConstructor=(s,e,t,n,r)=>class extends s{constructor(o,a,u){let l;if(typeof o=="number"&&a!==void 0&&u!==void 0)l={length:a,numberOfChannels:o,sampleRate:u};else if(typeof o=="object")l=o;else throw new Error("The given parameters are not valid.");const{length:c,numberOfChannels:h,sampleRate:d}={...DEFAULT_OPTIONS$5,...l},p=n(h,c,d);e(testPromiseSupport,()=>testPromiseSupport(p))||p.addEventListener("statechange",(()=>{let f=0;const g=v=>{this._state==="running"&&(f>0?(p.removeEventListener("statechange",g),v.stopImmediatePropagation(),this._waitForThePromiseToSettle(v)):f+=1)};return g})()),super(p,h),this._length=c,this._nativeOfflineAudioContext=p,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,deactivateAudioGraph(this)}))}_waitForThePromiseToSettle(o){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(o):setTimeout(()=>this._waitForThePromiseToSettle(o))}},DEFAULT_OPTIONS$4={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},createOscillatorNodeConstructor=(s,e,t,n,r,i,o)=>class extends s{constructor(u,l){const c=r(u),h={...DEFAULT_OPTIONS$4,...l},d=t(c,h),p=i(c),f=p?n():null,g=u.sampleRate/2;super(u,!1,d,f),this._detune=e(this,p,d.detune,153600,-153600),this._frequency=e(this,p,d.frequency,g,-g),this._nativeOscillatorNode=d,this._onended=null,this._oscillatorNodeRenderer=f,this._oscillatorNodeRenderer!==null&&h.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(u){const l=typeof u=="function"?o(this,u):null;this._nativeOscillatorNode.onended=l;const c=this._nativeOscillatorNode.onended;this._onended=c!==null&&c===l?u:c}get type(){return this._nativeOscillatorNode.type}set type(u){this._nativeOscillatorNode.type=u,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(u){this._nativeOscillatorNode.setPeriodicWave(u),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=u)}start(u=0){if(this._nativeOscillatorNode.start(u),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=u),this.context.state!=="closed"){setInternalStateToActive(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),isActiveAudioNode(this)&&setInternalStateToPassive(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(u=0){this._nativeOscillatorNode.stop(u),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=u)}},createOscillatorNodeRendererFactory=(s,e,t,n,r)=>()=>{const i=new WeakMap;let o=null,a=null,u=null;const l=async(c,h)=>{let d=t(c);const p=isOwnedByContext(d,h);if(!p){const f={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:o===null?void 0:o,type:d.type};d=e(h,f),a!==null&&d.start(a),u!==null&&d.stop(u)}return i.set(h,d),p?(await s(h,c.detune,d.detune),await s(h,c.frequency,d.frequency)):(await n(h,c.detune,d.detune),await n(h,c.frequency,d.frequency)),await r(c,h,d),d};return{set periodicWave(c){o=c},set start(c){a=c},set stop(c){u=c},render(c,h){const d=i.get(h);return d!==void 0?Promise.resolve(d):l(c,h)}}},DEFAULT_OPTIONS$3={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},createPannerNodeConstructor=(s,e,t,n,r,i,o)=>class extends s{constructor(u,l){const c=r(u),h={...DEFAULT_OPTIONS$3,...l},d=t(c,h),p=i(c),f=p?n():null;super(u,!1,d,f),this._nativePannerNode=d,this._orientationX=e(this,p,d.orientationX,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._orientationY=e(this,p,d.orientationY,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._orientationZ=e(this,p,d.orientationZ,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._positionX=e(this,p,d.positionX,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._positionY=e(this,p,d.positionY,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._positionZ=e(this,p,d.positionZ,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(u){this._nativePannerNode.coneInnerAngle=u}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(u){this._nativePannerNode.coneOuterAngle=u}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(u){this._nativePannerNode.coneOuterGain=u}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(u){this._nativePannerNode.distanceModel=u}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(u){this._nativePannerNode.maxDistance=u}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(u){this._nativePannerNode.panningModel=u}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(u){this._nativePannerNode.refDistance=u}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(u){this._nativePannerNode.rolloffFactor=u}},createPannerNodeRendererFactory=(s,e,t,n,r,i,o,a,u,l)=>()=>{const c=new WeakMap;let h=null;const d=async(p,f)=>{let g=null,v=i(p);const y={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation},x={...y,coneInnerAngle:v.coneInnerAngle,coneOuterAngle:v.coneOuterAngle,coneOuterGain:v.coneOuterGain,distanceModel:v.distanceModel,maxDistance:v.maxDistance,panningModel:v.panningModel,refDistance:v.refDistance,rolloffFactor:v.rolloffFactor},R=isOwnedByContext(v,f);if("bufferSize"in v)g=n(f,{...y,gain:1});else if(!R){const k={...x,orientationX:v.orientationX.value,orientationY:v.orientationY.value,orientationZ:v.orientationZ.value,positionX:v.positionX.value,positionY:v.positionY.value,positionZ:v.positionZ.value};v=r(f,k)}if(c.set(f,g===null?v:g),g!==null){if(h===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const E=new o(6,p.context.length,f.sampleRate),L=e(E,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});L.connect(E.destination),h=(async()=>{const $=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map(async(Y,V)=>{const j=t(E,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:V===0?1:0});return await a(E,Y,j.offset),j}));for(let Y=0;Y<6;Y+=1)$[Y].connect(L,0,Y),$[Y].start(0);return l(E)})()}const k=await h,m=n(f,{...y,gain:1});await u(p,f,m);const b=[];for(let E=0;E<k.numberOfChannels;E+=1)b.push(k.getChannelData(E));let I=[b[0][0],b[1][0],b[2][0]],_=[b[3][0],b[4][0],b[5][0]],S=n(f,{...y,gain:1}),T=r(f,{...x,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:_[0],positionY:_[1],positionZ:_[2]});m.connect(S).connect(T.inputs[0]),T.connect(g);for(let E=128;E<k.length;E+=128){const L=[b[0][E],b[1][E],b[2][E]],$=[b[3][E],b[4][E],b[5][E]];if(L.some((Y,V)=>Y!==I[V])||$.some((Y,V)=>Y!==_[V])){I=L,_=$;const Y=E/f.sampleRate;S.gain.setValueAtTime(0,Y),S=n(f,{...y,gain:0}),T=r(f,{...x,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:_[0],positionY:_[1],positionZ:_[2]}),S.gain.setValueAtTime(1,Y),m.connect(S).connect(T.inputs[0]),T.connect(g)}}return g}return R?(await s(f,p.orientationX,v.orientationX),await s(f,p.orientationY,v.orientationY),await s(f,p.orientationZ,v.orientationZ),await s(f,p.positionX,v.positionX),await s(f,p.positionY,v.positionY),await s(f,p.positionZ,v.positionZ)):(await a(f,p.orientationX,v.orientationX),await a(f,p.orientationY,v.orientationY),await a(f,p.orientationZ,v.orientationZ),await a(f,p.positionX,v.positionX),await a(f,p.positionY,v.positionY),await a(f,p.positionZ,v.positionZ)),isNativeAudioNodeFaker(v)?await u(p,f,v.inputs[0]):await u(p,f,v),v};return{render(p,f){const g=c.get(f);return g!==void 0?Promise.resolve(g):d(p,f)}}},DEFAULT_OPTIONS$2={disableNormalization:!1},createPeriodicWaveConstructor=(s,e,t,n)=>class ir{constructor(i,o){const a=e(i),u=n({...DEFAULT_OPTIONS$2,...o}),l=s(a,u);return t.add(l),l}static[Symbol.hasInstance](i){return i!==null&&typeof i=="object"&&Object.getPrototypeOf(i)===ir.prototype||t.has(i)}},createRenderAutomation=(s,e)=>(t,n,r)=>(s(n).replay(r),e(n,t,r)),createRenderInputsOfAudioNode=(s,e,t)=>async(n,r,i)=>{const o=s(n);await Promise.all(o.activeInputs.map((a,u)=>Array.from(a).map(async([l,c])=>{const d=await e(l).render(l,r),p=n.context.destination;!t(l)&&(n!==p||!t(n))&&d.connect(i,c,u)})).reduce((a,u)=>[...a,...u],[]))},createRenderInputsOfAudioParam=(s,e,t)=>async(n,r,i)=>{const o=e(n);await Promise.all(Array.from(o.activeInputs).map(async([a,u])=>{const c=await s(a).render(a,r);t(a)||c.connect(i,u)}))},createRenderNativeOfflineAudioContext=(s,e,t,n)=>r=>s(testPromiseSupport,()=>testPromiseSupport(r))?Promise.resolve(s(n,n)).then(i=>{if(!i){const o=t(r,512,0,1);r.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>r.currentTime,o.connect(r.destination)}return r.startRendering()}):new Promise(i=>{const o=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=a=>{o.disconnect(),i(a.renderedBuffer)},o.connect(r.destination),r.startRendering()}),createSetActiveAudioWorkletNodeInputs=s=>(e,t)=>{s.set(e,t)},createSetAudioNodeTailTime=s=>(e,t)=>s.set(e,t),createStartRendering=(s,e,t,n,r,i,o,a)=>(u,l)=>t(u).render(u,l).then(()=>Promise.all(Array.from(n(l)).map(c=>t(c).render(c,l)))).then(()=>r(l)).then(c=>(typeof c.copyFromChannel!="function"?(o(c),wrapAudioBufferGetChannelDataMethod(c)):e(i,()=>i(c))||a(c),s.add(c),c)),DEFAULT_OPTIONS$1={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},createStereoPannerNodeConstructor=(s,e,t,n,r,i)=>class extends s{constructor(a,u){const l=r(a),c={...DEFAULT_OPTIONS$1,...u},h=t(l,c),d=i(l),p=d?n():null;super(a,!1,h,p),this._pan=e(this,d,h.pan)}get pan(){return this._pan}},createStereoPannerNodeRendererFactory=(s,e,t,n,r)=>()=>{const i=new WeakMap,o=async(a,u)=>{let l=t(a);const c=isOwnedByContext(l,u);if(!c){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(u,h)}return i.set(u,l),c?await s(u,a.pan,l.pan):await n(u,a.pan,l.pan),isNativeAudioNodeFaker(l)?await r(a,u,l.inputs[0]):await r(a,u,l),l};return{render(a,u){const l=i.get(u);return l!==void 0?Promise.resolve(l):o(a,u)}}},createTestAudioBufferConstructorSupport=s=>()=>{if(s===null)return!1;try{new s({length:1,sampleRate:44100})}catch{return!1}return!0},createTestAudioWorkletProcessorPostMessageSupport=(s,e)=>async()=>{if(s===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new e(1,128,44100),r=URL.createObjectURL(t);let i=!1,o=!1;try{await n.audioWorklet.addModule(r);const a=new s(n,"a",{numberOfOutputs:0}),u=n.createOscillator();a.port.onmessage=()=>i=!0,a.onprocessorerror=()=>o=!0,u.connect(a),u.start(0),await n.startRendering()}catch{}finally{URL.revokeObjectURL(r)}return i&&!o},createTestOfflineAudioContextCurrentTimeSupport=(s,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),n=s(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(r=>{t.oncomplete=()=>{n.disconnect(),r(t.currentTime!==0)},t.startRendering()})},createUnknownError=()=>new DOMException("","UnknownError"),DEFAULT_OPTIONS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},createWaveShaperNodeConstructor=(s,e,t,n,r,i,o)=>class extends s{constructor(u,l){const c=r(u),h={...DEFAULT_OPTIONS,...l},d=t(c,h),f=i(c)?n():null;super(u,!0,d,f),this._isCurveNullified=!1,this._nativeWaveShaperNode=d,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(u){if(u===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(u.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=u}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(u){this._nativeWaveShaperNode.oversample=u}},createWaveShaperNodeRendererFactory=(s,e,t)=>()=>{const n=new WeakMap,r=async(i,o)=>{let a=e(i);if(!isOwnedByContext(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=s(o,l)}return n.set(o,a),isNativeAudioNodeFaker(a)?await t(i,o,a.inputs[0]):await t(i,o,a),a};return{render(i,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):r(i,o)}}},createWindow=()=>typeof window>"u"?null:window,createWrapAudioBufferCopyChannelMethods=(s,e)=>t=>{t.copyFromChannel=(n,r,i=0)=>{const o=s(i),a=s(r);if(a>=t.numberOfChannels)throw e();const u=t.length,l=t.getChannelData(a),c=n.length;for(let h=o<0?-o:0;h+o<u&&h<c;h+=1)n[h]=l[h+o]},t.copyToChannel=(n,r,i=0)=>{const o=s(i),a=s(r);if(a>=t.numberOfChannels)throw e();const u=t.length,l=t.getChannelData(a),c=n.length;for(let h=o<0?-o:0;h+o<u&&h<c;h+=1)l[h+o]=n[h]}},createWrapAudioBufferCopyChannelMethodsOutOfBounds=s=>e=>{e.copyFromChannel=(t=>(n,r,i=0)=>{const o=s(i),a=s(r);if(o<e.length)return t.call(e,n,a,o)})(e.copyFromChannel),e.copyToChannel=(t=>(n,r,i=0)=>{const o=s(i),a=s(r);if(o<e.length)return t.call(e,n,a,o)})(e.copyToChannel)},createWrapAudioBufferSourceNodeStopMethodNullifiedBuffer=s=>(e,t)=>{const n=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=n),s(e,"buffer",r=>()=>{const i=r.call(e);return i===n?null:i},r=>i=>r.call(e,i===null?n:i))},createWrapChannelMergerNode=(s,e)=>(t,n)=>{n.channelCount=1,n.channelCountMode="explicit",Object.defineProperty(n,"channelCount",{get:()=>1,set:()=>{throw s()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:()=>{throw s()}});const r=t.createBufferSource();e(n,()=>{const a=n.numberOfInputs;for(let u=0;u<a;u+=1)r.connect(n,0,u)},()=>r.disconnect(n))},getFirstSample=(s,e,t)=>s.copyFromChannel===void 0?s.getChannelData(t)[0]:(s.copyFromChannel(e,t),e[0]),isDCCurve=s=>{if(s===null)return!1;const e=s.length;return e%2!==0?s[Math.floor(e/2)]!==0:s[e/2-1]+s[e/2]!==0},overwriteAccessors=(s,e,t,n)=>{let r=s;for(;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);const{get:i,set:o}=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(s,e,{get:t(i),set:n(o)})},sanitizeAudioWorkletNodeOptions=s=>({...s,outputChannelCount:s.outputChannelCount!==void 0?s.outputChannelCount:s.numberOfInputs===1&&s.numberOfOutputs===1?[s.channelCount]:Array.from({length:s.numberOfOutputs},()=>1)}),sanitizeChannelSplitterOptions=s=>({...s,channelCount:s.numberOfOutputs}),sanitizePeriodicWaveOptions=s=>{const{imag:e,real:t}=s;return e===void 0?t===void 0?{...s,imag:[0,0],real:[0,0]}:{...s,imag:Array.from(t,()=>0),real:t}:t===void 0?{...s,imag:e,real:Array.from(e,()=>0)}:{...s,imag:e,real:t}},setValueAtTimeUntilPossible=(s,e,t)=>{try{s.setValueAtTime(e,t)}catch(n){if(n.code!==9)throw n;setValueAtTimeUntilPossible(s,e,t+1e-7)}},testAudioBufferSourceNodeStartMethodConsecutiveCallsSupport=s=>{const e=s.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},testAudioBufferSourceNodeStartMethodOffsetClampingSupport=s=>{const e=s.createBufferSource(),t=s.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},testAudioBufferSourceNodeStopMethodNullifiedBufferSupport=s=>{const e=s.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},testAudioScheduledSourceNodeStartMethodNegativeParametersSupport=s=>{const e=s.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport=s=>{const e=s.createBuffer(1,1,44100),t=s.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},testAudioScheduledSourceNodeStopMethodNegativeParametersSupport=s=>{const e=s.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},testAudioWorkletNodeOptionsClonability=s=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(s)}finally{e.close(),t.close()}},wrapAudioBufferSourceNodeStartMethodOffsetClamping=s=>{s.start=(e=>(t=0,n=0,r)=>{const i=s.buffer,o=i===null?n:Math.min(i.duration,n);i!==null&&o>i.duration-.5/s.context.sampleRate?e.call(s,t,0,0):e.call(s,t,o,r)})(s.start)},wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls=(s,e)=>{const t=e.createGain();s.connect(t);const n=(r=>()=>{r.call(s,t),s.removeEventListener("ended",n)})(s.disconnect);s.addEventListener("ended",n),interceptConnections(s,t),s.stop=(r=>{let i=!1;return(o=0)=>{if(i)try{r.call(s,o)}catch{t.gain.setValueAtTime(0,o)}else r.call(s,o),i=!0}})(s.stop)},wrapEventListener=(s,e)=>t=>{const n={value:s};return Object.defineProperties(t,{currentTarget:n,target:n}),typeof e=="function"?e.call(s,t):e.handleEvent.call(s,t)},addActiveInputConnectionToAudioNode=createAddActiveInputConnectionToAudioNode(insertElementInSet),addPassiveInputConnectionToAudioNode=createAddPassiveInputConnectionToAudioNode(insertElementInSet),deleteActiveInputConnectionToAudioNode=createDeleteActiveInputConnectionToAudioNode(pickElementFromSet),audioNodeTailTimeStore=new WeakMap,getAudioNodeTailTime=createGetAudioNodeTailTime(audioNodeTailTimeStore),cacheTestResult=createCacheTestResult(new Map,new WeakMap),window$1=createWindow(),createNativeAnalyserNode=createNativeAnalyserNodeFactory(cacheTestResult,createIndexSizeError),getAudioNodeRenderer=createGetAudioNodeRenderer(getAudioNodeConnections),renderInputsOfAudioNode=createRenderInputsOfAudioNode(getAudioNodeConnections,getAudioNodeRenderer,isPartOfACycle),createAnalyserNodeRenderer=createAnalyserNodeRendererFactory(createNativeAnalyserNode,getNativeAudioNode,renderInputsOfAudioNode),getNativeContext=createGetNativeContext(CONTEXT_STORE),nativeOfflineAudioContextConstructor=createNativeOfflineAudioContextConstructor(window$1),isNativeOfflineAudioContext=createIsNativeOfflineAudioContext(nativeOfflineAudioContextConstructor),audioParamAudioNodeStore=new WeakMap,eventTargetConstructor=createEventTargetConstructor(wrapEventListener),nativeAudioContextConstructor=createNativeAudioContextConstructor(window$1),isNativeAudioContext=createIsNativeAudioContext(nativeAudioContextConstructor),isNativeAudioNode=createIsNativeAudioNode(window$1),isNativeAudioParam=createIsNativeAudioParam(window$1),nativeAudioWorkletNodeConstructor=createNativeAudioWorkletNodeConstructor(window$1),audioNodeConstructor=createAudioNodeConstructor(createAddAudioNodeConnections(AUDIO_NODE_CONNECTIONS_STORE),createAddConnectionToAudioNode(addActiveInputConnectionToAudioNode,addPassiveInputConnectionToAudioNode,connectNativeAudioNodeToNativeAudioNode,deleteActiveInputConnectionToAudioNode,disconnectNativeAudioNodeFromNativeAudioNode,getAudioNodeConnections,getAudioNodeTailTime,getEventListenersOfAudioNode,getNativeAudioNode,insertElementInSet,isActiveAudioNode,isPartOfACycle,isPassiveAudioNode),cacheTestResult,createIncrementCycleCounterFactory(CYCLE_COUNTERS,disconnectNativeAudioNodeFromNativeAudioNode,getAudioNodeConnections,getNativeAudioNode,getNativeAudioParam,isActiveAudioNode),createIndexSizeError,createInvalidAccessError,createNotSupportedError,createDecrementCycleCounter(connectNativeAudioNodeToNativeAudioNode,CYCLE_COUNTERS,getAudioNodeConnections,getNativeAudioNode,getNativeAudioParam,getNativeContext,isActiveAudioNode,isNativeOfflineAudioContext),createDetectCycles(audioParamAudioNodeStore,getAudioNodeConnections,getValueForKey),eventTargetConstructor,getNativeContext,isNativeAudioContext,isNativeAudioNode,isNativeAudioParam,isNativeOfflineAudioContext,nativeAudioWorkletNodeConstructor),analyserNodeConstructor=createAnalyserNodeConstructor(audioNodeConstructor,createAnalyserNodeRenderer,createIndexSizeError,createNativeAnalyserNode,getNativeContext,isNativeOfflineAudioContext),audioBufferStore=new WeakSet,nativeAudioBufferConstructor=createNativeAudioBufferConstructor(window$1),convertNumberToUnsignedLong=createConvertNumberToUnsignedLong(new Uint32Array(1)),wrapAudioBufferCopyChannelMethods=createWrapAudioBufferCopyChannelMethods(convertNumberToUnsignedLong,createIndexSizeError),wrapAudioBufferCopyChannelMethodsOutOfBounds=createWrapAudioBufferCopyChannelMethodsOutOfBounds(convertNumberToUnsignedLong),audioBufferConstructor=createAudioBufferConstructor(audioBufferStore,cacheTestResult,createNotSupportedError,nativeAudioBufferConstructor,nativeOfflineAudioContextConstructor,createTestAudioBufferConstructorSupport(nativeAudioBufferConstructor),wrapAudioBufferCopyChannelMethods,wrapAudioBufferCopyChannelMethodsOutOfBounds),addSilentConnection=createAddSilentConnection(createNativeGainNode),renderInputsOfAudioParam=createRenderInputsOfAudioParam(getAudioNodeRenderer,getAudioParamConnections,isPartOfACycle),connectAudioParam=createConnectAudioParam(renderInputsOfAudioParam),createNativeAudioBufferSourceNode=createNativeAudioBufferSourceNodeFactory(addSilentConnection,cacheTestResult,testAudioBufferSourceNodeStartMethodConsecutiveCallsSupport,testAudioBufferSourceNodeStartMethodOffsetClampingSupport,testAudioBufferSourceNodeStopMethodNullifiedBufferSupport,testAudioScheduledSourceNodeStartMethodNegativeParametersSupport,testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport,testAudioScheduledSourceNodeStopMethodNegativeParametersSupport,wrapAudioBufferSourceNodeStartMethodOffsetClamping,createWrapAudioBufferSourceNodeStopMethodNullifiedBuffer(overwriteAccessors),wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls),renderAutomation=createRenderAutomation(createGetAudioParamRenderer(getAudioParamConnections),renderInputsOfAudioParam),createAudioBufferSourceNodeRenderer=createAudioBufferSourceNodeRendererFactory(connectAudioParam,createNativeAudioBufferSourceNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),createAudioParam=createAudioParamFactory(createAddAudioParamConnections(AUDIO_PARAM_CONNECTIONS_STORE),audioParamAudioNodeStore,AUDIO_PARAM_STORE,createAudioParamRenderer,createCancelAndHoldAutomationEvent,createCancelScheduledValuesAutomationEvent,createExponentialRampToValueAutomationEvent,createLinearRampToValueAutomationEvent,createSetTargetAutomationEvent,createSetValueAutomationEvent,createSetValueCurveAutomationEvent,nativeAudioContextConstructor,setValueAtTimeUntilPossible),audioBufferSourceNodeConstructor=createAudioBufferSourceNodeConstructor(audioNodeConstructor,createAudioBufferSourceNodeRenderer,createAudioParam,createInvalidStateError,createNativeAudioBufferSourceNode,getNativeContext,isNativeOfflineAudioContext,wrapEventListener),audioDestinationNodeConstructor=createAudioDestinationNodeConstructor(audioNodeConstructor,createAudioDestinationNodeRenderer,createIndexSizeError,createInvalidStateError,createNativeAudioDestinationNodeFactory(createNativeGainNode,overwriteAccessors),getNativeContext,isNativeOfflineAudioContext,renderInputsOfAudioNode),createBiquadFilterNodeRenderer=createBiquadFilterNodeRendererFactory(connectAudioParam,createNativeBiquadFilterNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),setAudioNodeTailTime=createSetAudioNodeTailTime(audioNodeTailTimeStore),biquadFilterNodeConstructor=createBiquadFilterNodeConstructor(audioNodeConstructor,createAudioParam,createBiquadFilterNodeRenderer,createInvalidAccessError,createNativeBiquadFilterNode,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),monitorConnections=createMonitorConnections(insertElementInSet,isNativeAudioNode),wrapChannelMergerNode=createWrapChannelMergerNode(createInvalidStateError,monitorConnections),createNativeChannelMergerNode=createNativeChannelMergerNodeFactory(nativeAudioContextConstructor,wrapChannelMergerNode),createChannelMergerNodeRenderer=createChannelMergerNodeRendererFactory(createNativeChannelMergerNode,getNativeAudioNode,renderInputsOfAudioNode),channelMergerNodeConstructor=createChannelMergerNodeConstructor(audioNodeConstructor,createChannelMergerNodeRenderer,createNativeChannelMergerNode,getNativeContext,isNativeOfflineAudioContext),createChannelSplitterNodeRenderer=createChannelSplitterNodeRendererFactory(createNativeChannelSplitterNode,getNativeAudioNode,renderInputsOfAudioNode),channelSplitterNodeConstructor=createChannelSplitterNodeConstructor(audioNodeConstructor,createChannelSplitterNodeRenderer,createNativeChannelSplitterNode,getNativeContext,isNativeOfflineAudioContext,sanitizeChannelSplitterOptions),createNativeConstantSourceNodeFaker=createNativeConstantSourceNodeFakerFactory(addSilentConnection,createNativeAudioBufferSourceNode,createNativeGainNode,monitorConnections),createNativeConstantSourceNode=createNativeConstantSourceNodeFactory(addSilentConnection,cacheTestResult,createNativeConstantSourceNodeFaker,testAudioScheduledSourceNodeStartMethodNegativeParametersSupport,testAudioScheduledSourceNodeStopMethodNegativeParametersSupport),createConstantSourceNodeRenderer=createConstantSourceNodeRendererFactory(connectAudioParam,createNativeConstantSourceNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),constantSourceNodeConstructor=createConstantSourceNodeConstructor(audioNodeConstructor,createAudioParam,createConstantSourceNodeRenderer,createNativeConstantSourceNode,getNativeContext,isNativeOfflineAudioContext,wrapEventListener),createNativeConvolverNode=createNativeConvolverNodeFactory(createNotSupportedError,overwriteAccessors),createConvolverNodeRenderer=createConvolverNodeRendererFactory(createNativeConvolverNode,getNativeAudioNode,renderInputsOfAudioNode),convolverNodeConstructor=createConvolverNodeConstructor(audioNodeConstructor,createConvolverNodeRenderer,createNativeConvolverNode,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createDelayNodeRenderer=createDelayNodeRendererFactory(connectAudioParam,createNativeDelayNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),delayNodeConstructor=createDelayNodeConstructor(audioNodeConstructor,createAudioParam,createDelayNodeRenderer,createNativeDelayNode,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createNativeDynamicsCompressorNode=createNativeDynamicsCompressorNodeFactory(createNotSupportedError),createDynamicsCompressorNodeRenderer=createDynamicsCompressorNodeRendererFactory(connectAudioParam,createNativeDynamicsCompressorNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),dynamicsCompressorNodeConstructor=createDynamicsCompressorNodeConstructor(audioNodeConstructor,createAudioParam,createDynamicsCompressorNodeRenderer,createNativeDynamicsCompressorNode,createNotSupportedError,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createGainNodeRenderer=createGainNodeRendererFactory(connectAudioParam,createNativeGainNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),gainNodeConstructor=createGainNodeConstructor(audioNodeConstructor,createAudioParam,createGainNodeRenderer,createNativeGainNode,getNativeContext,isNativeOfflineAudioContext),createNativeIIRFilterNodeFaker=createNativeIIRFilterNodeFakerFactory(createInvalidAccessError,createInvalidStateError,createNativeScriptProcessorNode,createNotSupportedError),renderNativeOfflineAudioContext=createRenderNativeOfflineAudioContext(cacheTestResult,createNativeGainNode,createNativeScriptProcessorNode,createTestOfflineAudioContextCurrentTimeSupport(createNativeGainNode,nativeOfflineAudioContextConstructor)),createIIRFilterNodeRenderer=createIIRFilterNodeRendererFactory(createNativeAudioBufferSourceNode,getNativeAudioNode,nativeOfflineAudioContextConstructor,renderInputsOfAudioNode,renderNativeOfflineAudioContext),createNativeIIRFilterNode=createNativeIIRFilterNodeFactory(createNativeIIRFilterNodeFaker),iIRFilterNodeConstructor=createIIRFilterNodeConstructor(audioNodeConstructor,createNativeIIRFilterNode,createIIRFilterNodeRenderer,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createAudioListener=createAudioListenerFactory(createAudioParam,createNativeChannelMergerNode,createNativeConstantSourceNode,createNativeScriptProcessorNode,createNotSupportedError,getFirstSample,isNativeOfflineAudioContext,overwriteAccessors),unrenderedAudioWorkletNodeStore=new WeakMap,minimalBaseAudioContextConstructor=createMinimalBaseAudioContextConstructor(audioDestinationNodeConstructor,createAudioListener,eventTargetConstructor,isNativeOfflineAudioContext,unrenderedAudioWorkletNodeStore,wrapEventListener),createNativeOscillatorNode=createNativeOscillatorNodeFactory(addSilentConnection,cacheTestResult,testAudioScheduledSourceNodeStartMethodNegativeParametersSupport,testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport,testAudioScheduledSourceNodeStopMethodNegativeParametersSupport,wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls),createOscillatorNodeRenderer=createOscillatorNodeRendererFactory(connectAudioParam,createNativeOscillatorNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),oscillatorNodeConstructor=createOscillatorNodeConstructor(audioNodeConstructor,createAudioParam,createNativeOscillatorNode,createOscillatorNodeRenderer,getNativeContext,isNativeOfflineAudioContext,wrapEventListener),createConnectedNativeAudioBufferSourceNode=createConnectedNativeAudioBufferSourceNodeFactory(createNativeAudioBufferSourceNode),createNativeWaveShaperNodeFaker=createNativeWaveShaperNodeFakerFactory(createConnectedNativeAudioBufferSourceNode,createInvalidStateError,createNativeGainNode,isDCCurve,monitorConnections),createNativeWaveShaperNode=createNativeWaveShaperNodeFactory(createConnectedNativeAudioBufferSourceNode,createInvalidStateError,createNativeWaveShaperNodeFaker,isDCCurve,monitorConnections,nativeAudioContextConstructor,overwriteAccessors),createNativePannerNodeFaker=createNativePannerNodeFakerFactory(connectNativeAudioNodeToNativeAudioNode,createInvalidStateError,createNativeChannelMergerNode,createNativeGainNode,createNativeScriptProcessorNode,createNativeWaveShaperNode,createNotSupportedError,disconnectNativeAudioNodeFromNativeAudioNode,getFirstSample,monitorConnections),createNativePannerNode=createNativePannerNodeFactory(createNativePannerNodeFaker),createPannerNodeRenderer=createPannerNodeRendererFactory(connectAudioParam,createNativeChannelMergerNode,createNativeConstantSourceNode,createNativeGainNode,createNativePannerNode,getNativeAudioNode,nativeOfflineAudioContextConstructor,renderAutomation,renderInputsOfAudioNode,renderNativeOfflineAudioContext),pannerNodeConstructor=createPannerNodeConstructor(audioNodeConstructor,createAudioParam,createNativePannerNode,createPannerNodeRenderer,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createNativePeriodicWave=createNativePeriodicWaveFactory(createIndexSizeError),periodicWaveConstructor=createPeriodicWaveConstructor(createNativePeriodicWave,getNativeContext,new WeakSet,sanitizePeriodicWaveOptions),nativeStereoPannerNodeFakerFactory=createNativeStereoPannerNodeFakerFactory(createNativeChannelMergerNode,createNativeChannelSplitterNode,createNativeGainNode,createNativeWaveShaperNode,createNotSupportedError,monitorConnections),createNativeStereoPannerNode=createNativeStereoPannerNodeFactory(nativeStereoPannerNodeFakerFactory,createNotSupportedError),createStereoPannerNodeRenderer=createStereoPannerNodeRendererFactory(connectAudioParam,createNativeStereoPannerNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),stereoPannerNodeConstructor=createStereoPannerNodeConstructor(audioNodeConstructor,createAudioParam,createNativeStereoPannerNode,createStereoPannerNodeRenderer,getNativeContext,isNativeOfflineAudioContext),createWaveShaperNodeRenderer=createWaveShaperNodeRendererFactory(createNativeWaveShaperNode,getNativeAudioNode,renderInputsOfAudioNode),waveShaperNodeConstructor=createWaveShaperNodeConstructor(audioNodeConstructor,createInvalidStateError,createNativeWaveShaperNode,createWaveShaperNodeRenderer,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),isSecureContext=createIsSecureContext(window$1),exposeCurrentFrameAndCurrentTime=createExposeCurrentFrameAndCurrentTime(window$1),backupOfflineAudioContextStore=new WeakMap,getOrCreateBackupOfflineAudioContext=createGetOrCreateBackupOfflineAudioContext(backupOfflineAudioContextStore,nativeOfflineAudioContextConstructor),addAudioWorkletModule=isSecureContext?createAddAudioWorkletModule(cacheTestResult,createNotSupportedError,createEvaluateSource(window$1),exposeCurrentFrameAndCurrentTime,createFetchSource(createAbortError),getNativeContext,getOrCreateBackupOfflineAudioContext,isNativeOfflineAudioContext,nativeAudioWorkletNodeConstructor,new WeakMap,new WeakMap,createTestAudioWorkletProcessorPostMessageSupport(nativeAudioWorkletNodeConstructor,nativeOfflineAudioContextConstructor),window$1):void 0,isNativeContext=createIsNativeContext(isNativeAudioContext,isNativeOfflineAudioContext),decodeAudioData=createDecodeAudioData(audioBufferStore,cacheTestResult,createDataCloneError,createEncodingError,new WeakSet,getNativeContext,isNativeContext,testAudioBufferCopyChannelMethodsOutOfBoundsSupport,testPromiseSupport,wrapAudioBufferCopyChannelMethods,wrapAudioBufferCopyChannelMethodsOutOfBounds),baseAudioContextConstructor=createBaseAudioContextConstructor(addAudioWorkletModule,analyserNodeConstructor,audioBufferConstructor,audioBufferSourceNodeConstructor,biquadFilterNodeConstructor,channelMergerNodeConstructor,channelSplitterNodeConstructor,constantSourceNodeConstructor,convolverNodeConstructor,decodeAudioData,delayNodeConstructor,dynamicsCompressorNodeConstructor,gainNodeConstructor,iIRFilterNodeConstructor,minimalBaseAudioContextConstructor,oscillatorNodeConstructor,pannerNodeConstructor,periodicWaveConstructor,stereoPannerNodeConstructor,waveShaperNodeConstructor),mediaElementAudioSourceNodeConstructor=createMediaElementAudioSourceNodeConstructor(audioNodeConstructor,createNativeMediaElementAudioSourceNode,getNativeContext,isNativeOfflineAudioContext),mediaStreamAudioDestinationNodeConstructor=createMediaStreamAudioDestinationNodeConstructor(audioNodeConstructor,createNativeMediaStreamAudioDestinationNode,getNativeContext,isNativeOfflineAudioContext),mediaStreamAudioSourceNodeConstructor=createMediaStreamAudioSourceNodeConstructor(audioNodeConstructor,createNativeMediaStreamAudioSourceNode,getNativeContext,isNativeOfflineAudioContext),createNativeMediaStreamTrackAudioSourceNode=createNativeMediaStreamTrackAudioSourceNodeFactory(createInvalidStateError,isNativeOfflineAudioContext),mediaStreamTrackAudioSourceNodeConstructor=createMediaStreamTrackAudioSourceNodeConstructor(audioNodeConstructor,createNativeMediaStreamTrackAudioSourceNode,getNativeContext),audioContextConstructor=createAudioContextConstructor(baseAudioContextConstructor,createInvalidStateError,createNotSupportedError,createUnknownError,mediaElementAudioSourceNodeConstructor,mediaStreamAudioDestinationNodeConstructor,mediaStreamAudioSourceNodeConstructor,mediaStreamTrackAudioSourceNodeConstructor,nativeAudioContextConstructor),getUnrenderedAudioWorkletNodes=createGetUnrenderedAudioWorkletNodes(unrenderedAudioWorkletNodeStore),addUnrenderedAudioWorkletNode=createAddUnrenderedAudioWorkletNode(getUnrenderedAudioWorkletNodes),connectMultipleOutputs=createConnectMultipleOutputs(createIndexSizeError),deleteUnrenderedAudioWorkletNode=createDeleteUnrenderedAudioWorkletNode(getUnrenderedAudioWorkletNodes),disconnectMultipleOutputs=createDisconnectMultipleOutputs(createIndexSizeError),activeAudioWorkletNodeInputsStore=new WeakMap,getActiveAudioWorkletNodeInputs=createGetActiveAudioWorkletNodeInputs(activeAudioWorkletNodeInputsStore,getValueForKey),createNativeAudioWorkletNodeFaker=createNativeAudioWorkletNodeFakerFactory(connectMultipleOutputs,createIndexSizeError,createInvalidStateError,createNativeChannelMergerNode,createNativeChannelSplitterNode,createNativeConstantSourceNode,createNativeGainNode,createNativeScriptProcessorNode,createNotSupportedError,disconnectMultipleOutputs,exposeCurrentFrameAndCurrentTime,getActiveAudioWorkletNodeInputs,monitorConnections),createNativeAudioWorkletNode=createNativeAudioWorkletNodeFactory(createInvalidStateError,createNativeAudioWorkletNodeFaker,createNativeGainNode,createNotSupportedError,monitorConnections),createAudioWorkletNodeRenderer=createAudioWorkletNodeRendererFactory(connectAudioParam,connectMultipleOutputs,createNativeAudioBufferSourceNode,createNativeChannelMergerNode,createNativeChannelSplitterNode,createNativeConstantSourceNode,createNativeGainNode,deleteUnrenderedAudioWorkletNode,disconnectMultipleOutputs,exposeCurrentFrameAndCurrentTime,getNativeAudioNode,nativeAudioWorkletNodeConstructor,nativeOfflineAudioContextConstructor,renderAutomation,renderInputsOfAudioNode,renderNativeOfflineAudioContext),getBackupOfflineAudioContext=createGetBackupOfflineAudioContext(backupOfflineAudioContextStore),setActiveAudioWorkletNodeInputs=createSetActiveAudioWorkletNodeInputs(activeAudioWorkletNodeInputsStore),audioWorkletNodeConstructor=isSecureContext?createAudioWorkletNodeConstructor(addUnrenderedAudioWorkletNode,audioNodeConstructor,createAudioParam,createAudioWorkletNodeRenderer,createNativeAudioWorkletNode,getAudioNodeConnections,getBackupOfflineAudioContext,getNativeContext,isNativeOfflineAudioContext,nativeAudioWorkletNodeConstructor,sanitizeAudioWorkletNodeOptions,setActiveAudioWorkletNodeInputs,testAudioWorkletNodeOptionsClonability,wrapEventListener):void 0,createNativeOfflineAudioContext=createCreateNativeOfflineAudioContext(createNotSupportedError,nativeOfflineAudioContextConstructor),startRendering=createStartRendering(audioBufferStore,cacheTestResult,getAudioNodeRenderer,getUnrenderedAudioWorkletNodes,renderNativeOfflineAudioContext,testAudioBufferCopyChannelMethodsOutOfBoundsSupport,wrapAudioBufferCopyChannelMethods,wrapAudioBufferCopyChannelMethodsOutOfBounds),offlineAudioContextConstructor=createOfflineAudioContextConstructor(baseAudioContextConstructor,cacheTestResult,createInvalidStateError,createNativeOfflineAudioContext,startRendering),isAnyAudioContext=createIsAnyAudioContext(CONTEXT_STORE,isNativeAudioContext),isAnyAudioNode=createIsAnyAudioNode(AUDIO_NODE_STORE,isNativeAudioNode),isAnyAudioParam=createIsAnyAudioParam(AUDIO_PARAM_STORE,isNativeAudioParam),isAnyOfflineAudioContext=createIsAnyOfflineAudioContext(CONTEXT_STORE,isNativeOfflineAudioContext);function assert(s,e){if(!s)throw new Error(e)}function assertRange(s,e,t=1/0){if(!(e<=s&&s<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${s}`)}function assertContextRunning(s){!s.isOffline&&s.state!=="running"&&warn('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let defaultLogger=console;function log(...s){defaultLogger.log(...s)}function warn(...s){defaultLogger.warn(...s)}function isUndef(s){return typeof s>"u"}function isDefined(s){return!isUndef(s)}function isFunction(s){return typeof s=="function"}function isNumber(s){return typeof s=="number"}function isObject(s){return Object.prototype.toString.call(s)==="[object Object]"&&s.constructor===Object}function isBoolean(s){return typeof s=="boolean"}function isArray(s){return Array.isArray(s)}function isString(s){return typeof s=="string"}function isNote(s){return isString(s)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(s)}function createAudioContext(s){return new audioContextConstructor(s)}function createOfflineAudioContext(s,e,t){return new offlineAudioContextConstructor(s,e,t)}const theWindow=typeof self=="object"?self:null,hasAudioContext=theWindow&&(theWindow.hasOwnProperty("AudioContext")||theWindow.hasOwnProperty("webkitAudioContext"));function createAudioWorkletNode(s,e,t){return assert(isDefined(audioWorkletNodeConstructor),"This node only works in a secure context (https or localhost)"),new audioWorkletNodeConstructor(s,e,t)}function __decorate(s,e,t,n){var r=arguments.length,i=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(s,e,t,n);else for(var a=s.length-1;a>=0;a--)(o=s[a])&&(i=(r<3?o(i):r>3?o(e,t,i):o(e,t))||i);return r>3&&i&&Object.defineProperty(e,t,i),i}function __awaiter(s,e,t,n){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(h){o(h)}}function u(c){try{l(n.throw(c))}catch(h){o(h)}}function l(c){c.done?i(c.value):r(c.value).then(a,u)}l((n=n.apply(s,e||[])).next())})}class Ticker{constructor(e,t,n){this._callback=e,this._type=t,this._updateInterval=n,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),n=new Worker(t);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){this._updateInterval=Math.max(e,128/44100),this._type==="worker"&&this._worker.postMessage(Math.max(e*1e3,1))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function isAudioParam(s){return isAnyAudioParam(s)}function isAudioNode(s){return isAnyAudioNode(s)}function isOfflineAudioContext(s){return isAnyOfflineAudioContext(s)}function isAudioContext(s){return isAnyAudioContext(s)}function isAudioBuffer(s){return s instanceof AudioBuffer}function noCopy(s,e){return s==="value"||isAudioParam(e)||isAudioNode(e)||isAudioBuffer(e)}function deepMerge(s,...e){if(!e.length)return s;const t=e.shift();if(isObject(s)&&isObject(t))for(const n in t)noCopy(n,t[n])?s[n]=t[n]:isObject(t[n])?(s[n]||Object.assign(s,{[n]:{}}),deepMerge(s[n],t[n])):Object.assign(s,{[n]:t[n]});return deepMerge(s,...e)}function deepEquals(s,e){return s.length===e.length&&s.every((t,n)=>e[n]===t)}function optionsFromArguments(s,e,t=[],n){const r={},i=Array.from(e);if(isObject(i[0])&&n&&!Reflect.has(i[0],n)&&(Object.keys(i[0]).some(a=>Reflect.has(s,a))||(deepMerge(r,{[n]:i[0]}),t.splice(t.indexOf(n),1),i.shift())),i.length===1&&isObject(i[0]))deepMerge(r,i[0]);else for(let o=0;o<t.length;o++)isDefined(i[o])&&(r[t[o]]=i[o]);return deepMerge(s,r)}function getDefaultsFromInstance(s){return s.constructor.getDefaults()}function defaultArg(s,e){return isUndef(s)?e:s}function omitFromObject(s,e){return e.forEach(t=>{Reflect.has(s,t)&&delete s[t]}),s}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */class Tone{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||theWindow&&this.toString()===theWindow.TONE_DEBUG_CLASS)&&log(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Tone.version=version;const EPSILON=1e-6;function GT(s,e){return s>e+EPSILON}function GTE(s,e){return GT(s,e)||EQ(s,e)}function LT(s,e){return s+EPSILON<e}function EQ(s,e){return Math.abs(s-e)<EPSILON}function clamp(s,e,t){return Math.max(Math.min(s,t),e)}class Timeline extends Tone{constructor(){super(),this.name="Timeline",this._timeline=[];const e=optionsFromArguments(Timeline.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(assert(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const t=this._timeline[this.length-1];assert(GTE(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(e){const t=this._timeline.indexOf(e);return t!==-1&&this._timeline.splice(t,1),this}get(e,t="time"){const n=this._search(e,t);return n!==-1?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){const n=this._search(e,t);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const n=this._search(e);return n-1>=0?this._timeline[n-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(EQ(this._timeline[t].time,e)){for(let n=t;n>=0&&EQ(this._timeline[n].time,e);n--)t=n;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else this._timeline.length===1&&GTE(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(this._timeline.length===0)return-1;let n=0;const r=this._timeline.length;let i=r;if(r>0&&this._timeline[r-1][t]<=e)return r-1;for(;n<i;){let o=Math.floor(n+(i-n)/2);const a=this._timeline[o],u=this._timeline[o+1];if(EQ(a[t],e)){for(let l=o;l<this._timeline.length;l++){const c=this._timeline[l];if(EQ(c[t],e))o=l;else break}return o}else{if(LT(a[t],e)&&GT(u[t],e))return o;GT(a[t],e)?i=o:n=o+1}}return-1}_iterate(e,t=0,n=this._timeline.length-1){this._timeline.slice(t,n+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const n=this._search(e);return n!==-1&&this._iterate(t,0,n),this}forEachAfter(e,t){const n=this._search(e);return this._iterate(t,n+1),this}forEachBetween(e,t,n){let r=this._search(e),i=this._search(t);return r!==-1&&i!==-1?(this._timeline[r].time!==e&&(r+=1),this._timeline[i].time===t&&(i-=1),this._iterate(n,r,i)):r===-1&&this._iterate(n,0,i),this}forEachFrom(e,t){let n=this._search(e);for(;n>=0&&this._timeline[n].time>=e;)n--;return this._iterate(t,n+1),this}forEachAtTime(e,t){const n=this._search(e);if(n!==-1&&EQ(this._timeline[n].time,e)){let r=n;for(let i=n;i>=0&&EQ(this._timeline[i].time,e);i--)r=i;this._iterate(i=>{t(i)},r,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const notifyNewContext=[];function onContextInit(s){notifyNewContext.push(s)}function initializeContext(s){notifyNewContext.forEach(e=>e(s))}const notifyCloseContext=[];function onContextClose(s){notifyCloseContext.push(s)}function closeContext(s){notifyCloseContext.forEach(e=>e(s))}class Emitter extends Tone{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(r=>{isUndef(this._events)&&(this._events={}),this._events.hasOwnProperty(r)||(this._events[r]=[]),this._events[r].push(t)}),this}once(e,t){const n=(...r)=>{t(...r),this.off(e,n)};return this.on(e,n),this}off(e,t){return e.split(/\W+/).forEach(r=>{if(isUndef(this._events)&&(this._events={}),this._events.hasOwnProperty(e))if(isUndef(t))this._events[e]=[];else{const i=this._events[e];for(let o=i.length-1;o>=0;o--)i[o]===t&&i.splice(o,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){const n=this._events[e].slice(0);for(let r=0,i=n.length;r<i;r++)n[r].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const n=Object.getOwnPropertyDescriptor(Emitter.prototype,t);Object.defineProperty(e.prototype,t,n)})}dispose(){return super.dispose(),this._events=void 0,this}}class BaseContext extends Emitter{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Context extends BaseContext{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new Timeline,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const e=optionsFromArguments(Context.getDefaults(),arguments,["context"]);e.context?this._context=e.context:this._context=createAudioContext({latencyHint:e.latencyHint}),this._ticker=new Ticker(this.emit.bind(this,"tick"),e.clockSource,e.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(e.latencyHint),this.lookAhead=e.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(initializeContext(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,n){return this._context.createBuffer(e,t,n)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,n){return this._context.createPeriodicWave(e,t,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return assert(isAudioContext(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return assert(isAudioContext(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return assert(isAudioContext(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){assert(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){assert(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){assert(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){assert(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return createAudioWorkletNode(this.rawContext,e,t)}addAudioWorkletModule(e,t){return __awaiter(this,void 0,void 0,function*(){assert(isDefined(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(t)||this._workletModules.set(t,this.rawContext.audioWorklet.addModule(e)),yield this._workletModules.get(t)})}workletsAreReady(){return __awaiter(this,void 0,void 0,function*(){const e=[];this._workletModules.forEach(t=>e.push(t)),yield Promise.all(e)})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get latencyHint(){return this._latencyHint}_setLatencyHint(e){let t=0;if(this._latencyHint=e,isString(e))switch(e){case"interactive":t=.1;break;case"playback":t=.5;break;case"balanced":t=.25;break}this.lookAhead=t,this.updateInterval=t/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return isAudioContext(this._context)?this._context.resume():Promise.resolve()}close(){return __awaiter(this,void 0,void 0,function*(){isAudioContext(this._context)&&(yield this._context.close()),this._initialized&&closeContext(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),n=t.getChannelData(0);for(let i=0;i<n.length;i++)n[i]=e;const r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=t,r.loop=!0,r.start(0),this._constants.set(e,r),r}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this}_timeoutLoop(){const e=this.now();let t=this._timeouts.peek();for(;this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}setTimeout(e,t){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:n+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const n=++this._timeoutIds,r=()=>{const i=this.now();this._timeouts.add({callback:()=>{e(),r()},id:n,time:i+t})};return r(),n}}class DummyContext extends BaseContext{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,n){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e,t){return __awaiter(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function readOnly(s,e){isArray(e)?e.forEach(t=>readOnly(s,t)):Object.defineProperty(s,e,{enumerable:!0,writable:!1})}function writable(s,e){isArray(e)?e.forEach(t=>writable(s,t)):Object.defineProperty(s,e,{writable:!0})}const noOp=()=>{};class ToneAudioBuffer extends Tone{constructor(){super(),this.name="ToneAudioBuffer",this.onload=noOp;const e=optionsFromArguments(ToneAudioBuffer.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,e.url&&isAudioBuffer(e.url)||e.url instanceof ToneAudioBuffer?this.set(e.url):isString(e.url)&&this.load(e.url).catch(e.onerror)}static getDefaults(){return{onerror:noOp,onload:noOp,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:getContext().sampleRate}set(e){return e instanceof ToneAudioBuffer?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return __awaiter(this,void 0,void 0,function*(){const t=ToneAudioBuffer.load(e).then(n=>{this.set(n),this.onload(this)});ToneAudioBuffer.downloads.push(t);try{yield t}finally{const n=ToneAudioBuffer.downloads.indexOf(t);ToneAudioBuffer.downloads.splice(n,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const t=isArray(e)&&e[0].length>0,n=t?e.length:1,r=t?e[0].length:e.length,i=getContext(),o=i.createBuffer(n,r,i.sampleRate),a=!t&&n===1?[e]:e;for(let u=0;u<n;u++)o.copyToChannel(a[u],u);return this._buffer=o,this}toMono(e){if(isNumber(e))this.fromArray(this.toArray(e));else{let t=new Float32Array(this.length);const n=this.numberOfChannels;for(let r=0;r<n;r++){const i=this.toArray(r);for(let o=0;o<i.length;o++)t[o]+=i[o]}t=t.map(r=>r/n),this.fromArray(t)}return this}toArray(e){if(isNumber(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const t=[];for(let n=0;n<this.numberOfChannels;n++)t[n]=this.getChannelData(n);return t}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){const n=Math.floor(e*this.sampleRate),r=Math.floor(t*this.sampleRate);assert(n<r,"The start time must be less than the end time");const i=r-n,o=getContext().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)o.copyToChannel(this.getChannelData(a).subarray(n,r),a);return new ToneAudioBuffer(o)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new ToneAudioBuffer().fromArray(e)}static fromUrl(e){return __awaiter(this,void 0,void 0,function*(){return yield new ToneAudioBuffer().load(e)})}static load(e){return __awaiter(this,void 0,void 0,function*(){const t=e.match(/\[([^\]\[]+\|.+)\]$/);if(t){const a=t[1].split("|");let u=a[0];for(const l of a)if(ToneAudioBuffer.supportsType(l)){u=l;break}e=e.replace(t[0],u)}const n=ToneAudioBuffer.baseUrl===""||ToneAudioBuffer.baseUrl.endsWith("/")?ToneAudioBuffer.baseUrl:ToneAudioBuffer.baseUrl+"/",r=yield fetch(n+e);if(!r.ok)throw new Error(`could not load url: ${e}`);const i=yield r.arrayBuffer();return yield getContext().decodeAudioData(i)})}static supportsType(e){const t=e.split("."),n=t[t.length-1];return document.createElement("audio").canPlayType("audio/"+n)!==""}static loaded(){return __awaiter(this,void 0,void 0,function*(){for(yield Promise.resolve();ToneAudioBuffer.downloads.length;)yield ToneAudioBuffer.downloads[0]})}}ToneAudioBuffer.baseUrl="";ToneAudioBuffer.downloads=[];class OfflineContext extends Context{constructor(){super({clockSource:"offline",context:isOfflineAudioContext(arguments[0])?arguments[0]:createOfflineAudioContext(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:isOfflineAudioContext(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=isOfflineAudioContext(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return __awaiter(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const n=Math.floor(this.sampleRate/128);e&&t%n===0&&(yield new Promise(r=>setTimeout(r,1)))}})}render(e=!0){return __awaiter(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(e);const t=yield this._context.startRendering();return new ToneAudioBuffer(t)})}close(){return Promise.resolve()}}const dummyContext=new DummyContext;let globalContext=dummyContext;function getContext(){return globalContext===dummyContext&&hasAudioContext&&setContext(new Context),globalContext}function setContext(s){isAudioContext(s)?globalContext=new Context(s):isOfflineAudioContext(s)?globalContext=new OfflineContext(s):globalContext=s}function start(){return globalContext.resume()}if(theWindow&&!theWindow.TONE_SILENCE_LOGGING){const e=` * Tone.js v${version} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function dbToGain(s){return Math.pow(10,s/20)}function gainToDb(s){return 20*(Math.log(s)/Math.LN10)}function intervalToFrequencyRatio(s){return Math.pow(2,s/12)}let A4=440;function getA4(){return A4}function setA4(s){A4=s}function ftom(s){return Math.round(ftomf(s))}function ftomf(s){return 69+12*Math.log2(s/A4)}function mtof(s){return A4*Math.pow(2,(s-69)/12)}class TimeBaseClass extends Tone{constructor(e,t,n){super(),this.defaultUnits="s",this._val=t,this._units=n,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const n=parseInt(e,10),r=t==="."?1.5:1;return n===1?this._beatsToUnits(this._getTimeSignature())*r:this._beatsToUnits(4/n)*r},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(t)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,t,n)=>{let r=0;return e&&e!=="0"&&(r+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(r+=this._beatsToUnits(parseFloat(t))),n&&n!=="0"&&(r+=this._beatsToUnits(parseFloat(n)/4)),r},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof TimeBaseClass&&this.fromType(this._val),isUndef(this._val))return this._noArg();if(isString(this._val)&&isUndef(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(isObject(this._val)){let e=0;for(const t in this._val)if(isDefined(this._val[t])){const n=this._val[t],r=new this.constructor(this.context,t).valueOf()*n;e+=r}return e}if(isDefined(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}else return isString(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class TimeClass extends TimeBaseClass{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new TimeClass(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){const n=new this.constructor(this.context,e).valueOf(),r=this.valueOf(),a=Math.round(r/n)*n-r;return r+a*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let i=1;i<9;i++){const o=Math.pow(2,i);t.push(o+"n."),t.push(o+"n"),t.push(o+"t")}t.push("0");let n=t[0],r=new TimeClass(this.context,t[0]).toSeconds();return t.forEach(i=>{const o=new TimeClass(this.context,i).toSeconds();Math.abs(o-e)<Math.abs(r-e)&&(n=i,r=o)}),n}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const n=Math.floor(t/this._getTimeSignature());let r=t%1*4;t=Math.floor(t)%this._getTimeSignature();const i=r.toString();return i.length>3&&(r=parseFloat(parseFloat(i).toFixed(3))),[n,t,r].join(":")}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.round(t*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return ftom(this.toFrequency())}_now(){return this.context.now()}}class FrequencyClass extends TimeClass{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return getA4()}static set A4(e){setA4(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:FrequencyClass.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(e,t){const r=noteToScaleIndex[e.toLowerCase()]+(parseInt(t,10)+1)*12;return this.defaultUnits==="midi"?r:FrequencyClass.mtof(r)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,n){let r=1;return e&&e!=="0"&&(r*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(r*=this._beatsToUnits(parseFloat(t))),n&&n!=="0"&&(r*=this._beatsToUnits(parseFloat(n)/4)),r}}})}transpose(e){return new FrequencyClass(this.context,this.valueOf()*intervalToFrequencyRatio(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return ftom(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/FrequencyClass.A4);let n=Math.round(12*t)+57;const r=Math.floor(n/12);return r<0&&(n+=-12*r),scaleIndexToNote[n%12]+r.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return mtof(e)}static ftom(e){return ftom(e)}}const noteToScaleIndex={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},scaleIndexToNote=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class TransportTimeClass extends TimeClass{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class ToneWithContext extends Tone{constructor(){super();const e=optionsFromArguments(ToneWithContext.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:getContext()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return new TimeClass(this.context,e).toSeconds()}toFrequency(e){return new FrequencyClass(this.context,e).toFrequency()}toTicks(e){return new TransportTimeClass(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(n=>{isUndef(e[n])&&delete t[n]}),t}get(){const e=getDefaultsFromInstance(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const n=this[t];isDefined(n)&&isDefined(n.value)&&isDefined(n.setValueAtTime)?e[t]=n.value:n instanceof ToneWithContext?e[t]=n._getPartialProperties(e[t]):isArray(n)||isNumber(n)||isString(n)||isBoolean(n)?e[t]=n:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&isDefined(this[t])&&(this[t]&&isDefined(this[t].value)&&isDefined(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof ToneWithContext?this[t].set(e[t]):this[t]=e[t])}),this}}class StateTimeline extends Timeline{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return t!==null?t.state:this._initial}setStateAtTime(e,t,n){return assertRange(t,0),this.add(Object.assign({},n,{state:e,time:t})),this}getLastState(e,t){const n=this._search(t);for(let r=n;r>=0;r--){const i=this._timeline[r];if(i.state===e)return i}}getNextState(e,t){const n=this._search(t);if(n!==-1)for(let r=n;r<this._timeline.length;r++){const i=this._timeline[r];if(i.state===e)return i}}}class Param extends ToneWithContext{constructor(){super(optionsFromArguments(Param.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const e=optionsFromArguments(Param.getDefaults(),arguments,["param","units","convert"]);for(assert(isDefined(e.param)&&(isAudioParam(e.param)||e.param instanceof Param),"param must be an AudioParam");!isAudioParam(e.param);)e.param=e.param._param;this._swappable=isDefined(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new Timeline(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,isDefined(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(ToneWithContext.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return isDefined(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return isDefined(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return isDefined(this.maxValue)&&isDefined(this.minValue)&&assertRange(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?dbToGain(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?gainToDb(e):e}setValueAtTime(e,t){const n=this.toSeconds(t),r=this._fromType(e);return assert(isFinite(r)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(r),this.log(this.units,"setValueAtTime",e,n),this._events.add({time:n,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,n),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),n=this._events.getAfter(t),r=this._events.get(t);let i=this._initialValue;if(r===null)i=this._initialValue;else if(r.type==="setTargetAtTime"&&(n===null||n.type==="setValueAtTime")){const o=this._events.getBefore(r.time);let a;o===null?a=this._initialValue:a=o.value,r.type==="setTargetAtTime"&&(i=this._exponentialApproach(r.time,a,r.value,r.constant,t))}else if(n===null)i=r.value;else if(n.type==="linearRampToValueAtTime"||n.type==="exponentialRampToValueAtTime"){let o=r.value;if(r.type==="setTargetAtTime"){const a=this._events.getBefore(r.time);a===null?o=this._initialValue:o=a.value}n.type==="linearRampToValueAtTime"?i=this._linearInterpolate(r.time,o,n.time,n.value,t):i=this._exponentialInterpolate(r.time,o,n.time,n.value,t)}else i=r.value;return this._toType(i)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(t)===0&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const n=this._fromType(e),r=this.toSeconds(t);return assert(isFinite(n)&&isFinite(r),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(n),this._events.add({time:r,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",e,r),this._param.linearRampToValueAtTime(n,r),this}exponentialRampToValueAtTime(e,t){let n=this._fromType(e);n=EQ(n,0)?this._minOutput:n,this._assertRange(n);const r=this.toSeconds(t);return assert(isFinite(n)&&isFinite(r),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:r,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",e,r),this._param.exponentialRampToValueAtTime(n,r),this}exponentialRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(e,n+this.toSeconds(t)),this}linearRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(e,n+this.toSeconds(t)),this}targetRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(e,n,t),this}exponentialApproachValueAtTime(e,t,n){t=this.toSeconds(t),n=this.toSeconds(n);const r=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(e,t,r),this.cancelAndHoldAtTime(t+n*.9),this.linearRampToValueAtTime(e,t+n),this}setTargetAtTime(e,t,n){const r=this._fromType(e);assert(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(t);return this._assertRange(r),assert(isFinite(r)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:n,time:i,type:"setTargetAtTime",value:r}),this.log(this.units,"setTargetAtTime",e,i,n),this._param.setTargetAtTime(r,i,n),this}setValueCurveAtTime(e,t,n,r=1){n=this.toSeconds(n),t=this.toSeconds(t);const i=this._fromType(e[0])*r;this.setValueAtTime(this._toType(i),t);const o=n/(e.length-1);for(let a=1;a<e.length;a++){const u=this._fromType(e[a])*r;this.linearRampToValueAtTime(this._toType(u),t+a*o)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return assert(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),n=this._fromType(this.getValueAtTime(t));assert(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+n);const r=this._events.get(t),i=this._events.getAfter(t);return r&&EQ(r.time,t)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),i.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(n),t):i.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(n),t)),this._events.add({time:t,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,t),this}rampTo(e,t=.1,n){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,t,n):this.linearRampTo(e,t,n),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const n=this._events.get(t);if(n&&n.type==="setTargetAtTime"){const r=this._events.getAfter(n.time),i=r?r.time:t+2,o=(i-t)/10;for(let a=t;a<i;a+=o)e.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,r=>{r.type==="cancelScheduledValues"?e.cancelScheduledValues(r.time):r.type==="setTargetAtTime"?e.setTargetAtTime(r.value,r.time,r.constant):e[r.type](r.value,r.time)}),this}setParam(e){assert(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,n,r,i){return n+(t-n)*Math.exp(-(i-e)/r)}_linearInterpolate(e,t,n,r,i){return t+(r-t)*((i-e)/(n-e))}_exponentialInterpolate(e,t,n,r,i){return t*Math.pow(r/t,(i-e)/(n-e))}}class ToneAudioNode extends ToneWithContext{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return isDefined(this.input)?isAudioParam(this.input)||this.input instanceof Param?1:this.input.numberOfInputs:0}get numberOfOutputs(){return isDefined(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return isDefined(e)&&(e instanceof ToneAudioNode||isAudioNode(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(n=>{n.channelCount=e.channelCount,n.channelCountMode=e.channelCountMode,n.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();assert(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,n=0){return connect(this,e,t,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return warn("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,n=0){return disconnect(this,e,t,n),this}chain(...e){return connectSeries(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),isDefined(this.input)&&(this.input instanceof ToneAudioNode?this.input.dispose():isAudioNode(this.input)&&this.input.disconnect()),isDefined(this.output)&&(this.output instanceof ToneAudioNode?this.output.dispose():isAudioNode(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function connectSeries(...s){const e=s.shift();s.reduce((t,n)=>(t instanceof ToneAudioNode?t.connect(n):isAudioNode(t)&&connect(t,n),n),e)}function connect(s,e,t=0,n=0){for(assert(isDefined(s),"Cannot connect from undefined node"),assert(isDefined(e),"Cannot connect to undefined node"),(e instanceof ToneAudioNode||isAudioNode(e))&&assert(e.numberOfInputs>0,"Cannot connect to node with no inputs"),assert(s.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof ToneAudioNode||e instanceof Param;)isDefined(e.input)&&(e=e.input);for(;s instanceof ToneAudioNode;)isDefined(s.output)&&(s=s.output);isAudioParam(e)?s.connect(e,t):s.connect(e,t,n)}function disconnect(s,e,t=0,n=0){if(isDefined(e))for(;e instanceof ToneAudioNode;)e=e.input;for(;!isAudioNode(s);)isDefined(s.output)&&(s=s.output);isAudioParam(e)?s.disconnect(e,t):isAudioNode(e)?s.disconnect(e,t,n):s.disconnect()}class Gain extends ToneAudioNode{constructor(){super(optionsFromArguments(Gain.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const e=optionsFromArguments(Gain.getDefaults(),arguments,["gain","units"]);this.gain=new Param({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),readOnly(this,"gain")}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class OneShotSource extends ToneAudioNode{constructor(e){super(e),this.onended=noOp,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Gain({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const n=this.toSeconds(t);return this._startTime!==-1&&n>=this._startTime&&(this._stopTime===-1||n<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:noOp})}_startGain(e,t=1){assert(this._startTime===-1,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=e+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(t,e+n):this._gainNode.gain.exponentialApproachValueAtTime(t,e,n)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){assert(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.context.currentTime),t>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const n=this._curve==="exponential"?t*2:0;this._stopSource(this.now()+n),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==noOp&&(this.onended(this),this.onended=noOp,!this.context.isOffline)){const e=()=>this.dispose();typeof window.requestIdleCallback<"u"?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),assert(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class ToneConstantSource extends OneShotSource{constructor(){super(optionsFromArguments(ToneConstantSource.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const e=optionsFromArguments(ToneConstantSource.getDefaults(),arguments,["offset"]);connect(this._source,this._gainNode),this.offset=new Param({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(OneShotSource.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Signal extends ToneAudioNode{constructor(){super(optionsFromArguments(Signal.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const e=optionsFromArguments(Signal.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new ToneConstantSource({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,n=0){return connectSignal(this,e,t,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,n){return this._param.exponentialRampTo(e,t,n),this}linearRampTo(e,t,n){return this._param.linearRampTo(e,t,n),this}targetRampTo(e,t,n){return this._param.targetRampTo(e,t,n),this}exponentialApproachValueAtTime(e,t,n){return this._param.exponentialApproachValueAtTime(e,t,n),this}setTargetAtTime(e,t,n){return this._param.setTargetAtTime(e,t,n),this}setValueCurveAtTime(e,t,n,r){return this._param.setValueCurveAtTime(e,t,n,r),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,n){return this._param.rampTo(e,t,n),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function connectSignal(s,e,t,n){(e instanceof Param||isAudioParam(e)||e instanceof Signal&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Signal&&(e.overridden=!0)),connect(s,e,t,n)}class TickParam extends Param{constructor(){super(optionsFromArguments(TickParam.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Timeline(1/0),this._multiplier=1;const e=optionsFromArguments(TickParam.getDefaults(),arguments,["value"]);this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Param.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,n){t=this.toSeconds(t),this.setRampPoint(t);const r=this._fromType(e),i=this._events.get(t),o=Math.round(Math.max(1/n,1));for(let a=0;a<=o;a++){const u=n*a+t,l=this._exponentialApproach(i.time,i.value,r,n,u);this.linearRampToValueAtTime(this._toType(l),u)}return this}setValueAtTime(e,t){const n=this.toSeconds(t);super.setValueAtTime(e,t);const r=this._events.get(n),i=this._events.previousEvent(r),o=this._getTicksUntilEvent(i,n);return r.ticks=Math.max(o,0),this}linearRampToValueAtTime(e,t){const n=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const r=this._events.get(n),i=this._events.previousEvent(r),o=this._getTicksUntilEvent(i,n);return r.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const n=this._fromType(e),r=this._events.get(t),i=Math.round(Math.max((t-r.time)*10,1)),o=(t-r.time)/i;for(let a=0;a<=i;a++){const u=o*a+r.time,l=this._exponentialInterpolate(r.time,r.value,t,n,u);this.linearRampToValueAtTime(this._toType(l),u)}return this}_getTicksUntilEvent(e,t){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(isUndef(e.ticks)){const o=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(o,e.time)}const n=this._fromType(this.getValueAtTime(e.time));let r=this._fromType(this.getValueAtTime(t));const i=this._events.get(t);return i&&i.time===t&&i.type==="setValueAtTime"&&(r=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(n+r)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),n=this._events.get(t);return Math.max(this._getTicksUntilEvent(n,t),0)}getDurationOfTicks(e,t){const n=this.toSeconds(t),r=this.getTicksAtTime(t);return this.getTimeOfTick(r+e)-n}getTimeOfTick(e){const t=this._events.get(e,"ticks"),n=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&n&&n.type==="linearRampToValueAtTime"&&t.value!==n.value){const r=this._fromType(this.getValueAtTime(t.time)),o=(this._fromType(this.getValueAtTime(n.time))-r)/(n.time-t.time),a=Math.sqrt(Math.pow(r,2)-2*o*(t.ticks-e)),u=(-r+a)/o,l=(-r-a)/o;return(u>0?u:l)+t.time}else return t?t.value===0?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const n=this.toSeconds(t),r=this.toSeconds(e),i=this.getTicksAtTime(n);return this.getTicksAtTime(n+r)-i}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class TickSignal extends Signal{constructor(){super(optionsFromArguments(TickSignal.getDefaults(),arguments,["value"])),this.name="TickSignal";const e=optionsFromArguments(TickSignal.getDefaults(),arguments,["value"]);this.input=this._param=new TickParam({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(Signal.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class TickSource extends ToneWithContext{constructor(){super(optionsFromArguments(TickSource.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new StateTimeline,this._tickOffset=new Timeline;const e=optionsFromArguments(TickSource.getDefaults(),arguments,["frequency"]);this.frequency=new TickSignal({context:this.context,units:e.units,value:e.frequency}),readOnly(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},ToneWithContext.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const n=this.toSeconds(e);return this._state.getValueAtTime(n)!=="started"&&(this._state.setStateAtTime("started",n),isDefined(t)&&this.setTicksAtTime(t,n)),this}stop(e){const t=this.toSeconds(e);if(this._state.getValueAtTime(t)==="stopped"){const n=this._state.get(t);n&&n.time>0&&(this._tickOffset.cancel(n.time),this._state.cancel(n.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&this._state.setStateAtTime("paused",t),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),n=this._state.getLastState("stopped",t),r={state:"paused",time:t};this._state.add(r);let i=n,o=0;return this._state.forEachBetween(n.time,t+this.sampleTime,a=>{let u=i.time;const l=this._tickOffset.get(a.time);l&&l.time>=i.time&&(o=l.ticks,u=l.time),i.state==="started"&&a.state!=="started"&&(o+=this.frequency.getTicksAtTime(a.time)-this.frequency.getTicksAtTime(u)),i=a}),this._state.remove(r),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),n=this.frequency.timeToTicks(e,t);this.setTicksAtTime(n,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),n={state:"paused",time:e};this._state.add(n);let r=t,i=0;return this._state.forEachBetween(t.time,e+this.sampleTime,o=>{let a=r.time;const u=this._tickOffset.get(o.time);u&&u.time>=r.time&&(i=u.seconds,a=u.time),r.state==="started"&&o.state!=="started"&&(i+=o.time-a),r=o}),this._state.remove(n),i}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){const n=this._tickOffset.get(t),r=this._state.get(t),i=Math.max(n.time,r.time),o=this.frequency.getTicksAtTime(i)+e-n.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(e,t,n){let r=this._state.get(e);this._state.forEachBetween(e,t,o=>{r&&r.state==="started"&&o.state!=="started"&&this.forEachTickBetween(Math.max(r.time,e),o.time-this.sampleTime,n),r=o});let i=null;if(r&&r.state==="started"){const o=Math.max(r.time,e),a=this.frequency.getTicksAtTime(o),u=this.frequency.getTicksAtTime(r.time),l=a-u;let c=Math.ceil(l)-l;c=EQ(c,1)?0:c;let h=this.frequency.getTimeOfTick(a+c);for(;h<t;){try{n(h,Math.round(this.getTicksAtTime(h)))}catch(d){i=d;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class Clock extends ToneWithContext{constructor(){super(optionsFromArguments(Clock.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=noOp,this._lastUpdate=0,this._state=new StateTimeline("stopped"),this._boundLoop=this._loop.bind(this);const e=optionsFromArguments(Clock.getDefaults(),arguments,["callback","frequency"]);this.callback=e.callback,this._tickSource=new TickSource({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,readOnly(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(ToneWithContext.getDefaults(),{callback:noOp,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){assertContextRunning(this.context);const n=this.toSeconds(e);return this.log("start",n),this._state.getValueAtTime(n)!=="started"&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,t),n<this._lastUpdate&&this.emit("start",n,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const n=this.toSeconds(t),r=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(r+e,n)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,n=>{switch(n.state){case"started":const r=this._tickSource.getTicksAtTime(n.time);this.emit("start",n.time,r);break;case"stopped":n.time!==0&&this.emit("stop",n.time);break;case"paused":this.emit("pause",n.time);break}}),this._tickSource.forEachTickBetween(e,t,(n,r)=>{this.callback(n,r)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Emitter.mixin(Clock);class ToneAudioBuffers extends Tone{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=optionsFromArguments(ToneAudioBuffers.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;const n=e.urls[t];this.add(t,n,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:noOp,onload:noOp,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return assert(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,n=noOp,r=noOp){return isString(t)?this._buffers.set(e.toString(),new ToneAudioBuffer(this.baseUrl+t,n,r)):this._buffers.set(e.toString(),new ToneAudioBuffer(t,n,r)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class TicksClass extends TransportTimeClass{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class Draw extends ToneWithContext{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Timeline,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=e;){const t=this._events.shift();t&&e-t.time<=this.expiration&&t.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}onContextInit(s=>{s.draw=new Draw({context:s})});onContextClose(s=>{s.draw.dispose()});class IntervalTimeline extends Tone{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){assert(isDefined(e.time),"Events must have a time property"),assert(isDefined(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new IntervalNode(e.time,e.time+e.duration,e);for(this._root===null?this._root=t:this._root.insert(t),this._length++;t!==null;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(this._root!==null){const t=[];this._root.search(e.time,t);for(const n of t)if(n.event===e){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,t){e.parent!==null?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const t=e.getBalance();let n,r=null;if(t>0)if(e.left.right===null)n=e.left,n.right=e.right,r=n;else{for(n=e.left.right;n.right!==null;)n=n.right;n.parent&&(n.parent.right=n.left,r=n.parent,n.left=e.left,n.right=e.right)}else if(e.right.left===null)n=e.right,n.left=e.left,r=n;else{for(n=e.right.left;n.left!==null;)n=n.left;n.parent&&(n.parent.left=n.right,r=n.parent,n.left=e.left,n.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=n:e.parent.right=n:this._setRoot(n),r&&this._rebalance(r)}e.dispose()}_rotateLeft(e){const t=e.parent,n=e.isLeftChild(),r=e.right;r&&(e.right=r.left,r.left=e),t!==null?n?t.left=r:t.right=r:this._setRoot(r)}_rotateRight(e){const t=e.parent,n=e.isLeftChild(),r=e.left;r&&(e.left=r.right,r.right=e),t!==null?n?t.left=r:t.right=r:this._setRoot(r)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const t=[];if(this._root.search(e,t),t.length>0){let n=t[0];for(let r=1;r<t.length;r++)t[r].low>n.low&&(n=t[r]);return n.event}}return null}forEach(e){if(this._root!==null){const t=[];this._root.traverse(n=>t.push(n)),t.forEach(n=>{n.event&&e(n.event)})}return this}forEachAtTime(e,t){if(this._root!==null){const n=[];this._root.search(e,n),n.forEach(r=>{r.event&&t(r.event)})}return this}forEachFrom(e,t){if(this._root!==null){const n=[];this._root.searchAfter(e,n),n.forEach(r=>{r.event&&t(r.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class IntervalNode{constructor(e,t,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(this.left!==null&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),this.left!==null&&this.left.searchAfter(e,t)),this.right!==null&&this.right.searchAfter(e,t)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Volume extends ToneAudioNode{constructor(){super(optionsFromArguments(Volume.getDefaults(),arguments,["volume"])),this.name="Volume";const e=optionsFromArguments(Volume.getDefaults(),arguments,["volume"]);this.input=this.output=new Gain({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,readOnly(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Destination extends ToneAudioNode{constructor(){super(optionsFromArguments(Destination.getDefaults(),arguments)),this.name="Destination",this.input=new Volume({context:this.context}),this.output=new Gain({context:this.context}),this.volume=this.input.volume;const e=optionsFromArguments(Destination.getDefaults(),arguments);connectSeries(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),connectSeries(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}onContextInit(s=>{s.destination=new Destination({context:s})});onContextClose(s=>{s.destination.dispose()});class TimelineValue extends Tone{constructor(e){super(),this.name="TimelineValue",this._timeline=new Timeline({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}class TransportEvent{constructor(e,t){this.id=TransportEvent._eventId++;const n=Object.assign(TransportEvent.getDefaults(),t);this.transport=e,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:noOp,once:!1,time:0}}invoke(e){this.callback&&(this.callback(e),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}TransportEvent._eventId=0;class TransportRepeatEvent extends TransportEvent{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(TransportRepeatEvent.getDefaults(),t);this.duration=new TicksClass(e.context,n.duration).valueOf(),this._interval=new TicksClass(e.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},TransportEvent.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvents(e){const t=this.transport.getTicksAtTime(e);t>=this.time&&t>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new TicksClass(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const t=this.transport.getTicksAtTime(e);t>this.time&&(this._nextTick=this.time+Math.ceil((t-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new TicksClass(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new TicksClass(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class Transport extends ToneWithContext{constructor(){super(optionsFromArguments(Transport.getDefaults(),arguments)),this.name="Transport",this._loop=new TimelineValue(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Timeline,this._repeatedEvents=new IntervalTimeline,this._syncedSignals=[],this._swingAmount=0;const e=optionsFromArguments(Transport.getDefaults(),arguments);this._ppq=e.ppq,this._clock=new Clock({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),readOnly(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(ToneWithContext.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(this._swingTicks*2)!==0){const n=t%(this._swingTicks*2)/(this._swingTicks*2),r=Math.sin(n*Math.PI)*this._swingAmount;e+=new TicksClass(this.context,this._swingTicks*2/3).toSeconds()*r}this._timeline.forEachAtTime(t,n=>n.invoke(e))}schedule(e,t){const n=new TransportEvent(this,{callback:e,time:new TransportTimeClass(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(e,t,n,r=1/0){const i=new TransportRepeatEvent(this,{callback:e,duration:new TimeClass(this.context,r).toTicks(),interval:new TimeClass(this.context,t).toTicks(),time:new TransportTimeClass(this.context,n).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(e,t){const n=new TransportEvent(this,{callback:e,once:!0,time:new TransportTimeClass(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){const t=this.toTicks(e);return this._timeline.forEachFrom(t,n=>this.clear(n.id)),this._repeatedEvents.forEachFrom(t,n=>this.clear(n.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new TicksClass(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){let n;return isDefined(t)&&(n=this.toTicks(t)),this._clock.start(e,n),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){isArray(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new TimeClass(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new TimeClass(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new TicksClass(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new TicksClass(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),n=this._clock.frequency.timeToTicks(e,t);this.ticks=n}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if(this.state==="started"){const n=this._clock.getTicksAtTime(t),r=this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,t),i=t+r;this.emit("stop",i),this._clock.setTicksAtTime(e,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return Math.round(this._clock.getTicksAtTime(e))}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const t=this.now(),n=this.getTicksAtTime(t),r=e-n%e;return this._clock.nextTickTime(r,t)}}syncSignal(e,t){if(!t){const r=this.now();if(e.getValueAtTime(r)!==0){const o=1/(60/this.bpm.getValueAtTime(r)/this.PPQ);t=e.getValueAtTime(r)/o}else t=0}const n=new Gain(t);return this.bpm.connect(n),n.connect(e._param),this._syncedSignals.push({initial:e.value,ratio:n,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const n=this._syncedSignals[t];n.signal===e&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),writable(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Emitter.mixin(Transport);onContextInit(s=>{s.transport=new Transport({context:s})});onContextClose(s=>{s.transport.dispose()});class Source extends ToneAudioNode{constructor(e){super(e),this.input=void 0,this._state=new StateTimeline("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=noOp,this._syncedStop=noOp,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Volume({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,readOnly(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mute:!1,onstop:noOp,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,n){let r=isUndef(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(r=this._clampToCurrentTime(r),!this._synced&&this._state.getValueAtTime(r)==="started")assert(GT(r,this._state.get(r).time),"Start time must be strictly greater than previous start time"),this._state.cancel(r),this._state.setStateAtTime("started",r),this.log("restart",r),this.restart(r,t,n);else if(this.log("start",r),this._state.setStateAtTime("started",r),this._synced){const i=this._state.get(r);i&&(i.offset=this.toSeconds(defaultArg(t,0)),i.duration=n?this.toSeconds(n):void 0);const o=this.context.transport.schedule(a=>{this._start(a,t,n)},r);this._scheduled.push(o),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>r&&this._syncedStart(this.now(),this.context.transport.seconds)}else assertContextRunning(this.context),this._start(r,t,n);return this}stop(e){let t=isUndef(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),this._state.getValueAtTime(t)==="started"||isDefined(this._state.getNextState("started",t))){if(this.log("stop",t),!this._synced)this._stop(t);else{const n=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(n)}this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,n){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,t,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(t>0){const n=this._state.get(t);if(n&&n.state==="started"&&n.time!==t){const r=t-this.toSeconds(n.time);let i;n.duration&&(i=this.toSeconds(n.duration)-r),this._start(e,this.toSeconds(n.offset)+r,i)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(t)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=noOp,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class ToneBufferSource extends OneShotSource{constructor(){super(optionsFromArguments(ToneBufferSource.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const e=optionsFromArguments(ToneBufferSource.getDefaults(),arguments,["url","onload"]);connect(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Param({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new ToneAudioBuffer(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(OneShotSource.getDefaults(),{url:new ToneAudioBuffer,loop:!1,loopEnd:0,loopStart:0,onload:noOp,onerror:noOp,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,n,r=1){assert(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(e);this._startGain(i,r),this.loop?t=defaultArg(t,this.loopStart):t=defaultArg(t,0);let o=Math.max(this.toSeconds(t),0);if(this.loop){const a=this.toSeconds(this.loopEnd)||this.buffer.duration,u=this.toSeconds(this.loopStart),l=a-u;GTE(o,a)&&(o=(o-u)%l+u),EQ(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,LT(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,o)),isDefined(n)){let a=this.toSeconds(n);a=Math.max(a,0),this.stop(i+a)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function generateWaveform(s,e){return __awaiter(this,void 0,void 0,function*(){const t=e/s.context.sampleRate,n=new OfflineContext(1,t,s.context.sampleRate);return new s.constructor(Object.assign(s.get(),{frequency:2/t,detune:0,context:n})).toDestination().start(0),(yield n.render()).getChannelData(0)})}class ToneOscillatorNode extends OneShotSource{constructor(){super(optionsFromArguments(ToneOscillatorNode.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const e=optionsFromArguments(ToneOscillatorNode.getDefaults(),arguments,["frequency","type"]);connect(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new Param({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new Param({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),readOnly(this,["frequency","detune"])}static getDefaults(){return Object.assign(OneShotSource.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Oscillator extends Source{constructor(){super(optionsFromArguments(Oscillator.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const e=optionsFromArguments(Oscillator.getDefaults(),arguments,["frequency","type"]);this.frequency=new Signal({context:this.context,units:"frequency",value:e.frequency}),readOnly(this,"frequency"),this.detune=new Signal({context:this.context,units:"cents",value:e.detune}),readOnly(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Source.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const t=this.toSeconds(e),n=new ToneOscillatorNode({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){const t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){const t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return Oscillator._periodicWaveCache.find(t=>t.phase===this._phase&&deepEquals(t.partials,this._partials));{const e=Oscillator._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const t=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&t)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const n=this._getCachedPeriodicWave();if(isDefined(n)){const{partials:r,wave:i}=n;this._wave=i,this._partials=r,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[r,i]=this._getRealImaginary(e,this._phase),o=this.context.createPeriodicWave(r,i);this._wave=o,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),Oscillator._periodicWaveCache.push({imag:i,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:r,type:this._type,wave:this._wave}),Oscillator._periodicWaveCache.length>100&&Oscillator._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){assertRange(e,0);let t=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(t=n[1]),this._type!=="custom")e===0?this.type=t:this.type=t+e.toString();else{const r=new Float32Array(e);this._partials.forEach((i,o)=>r[o]=i),this._partials=Array.from(r),this.type=this._type}}_getRealImaginary(e,t){let r=2048;const i=new Float32Array(r),o=new Float32Array(r);let a=1;if(e==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,r=a,this._partials.length===0)return[i,o]}else{const u=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);u?(a=parseInt(u[2],10)+1,this._partialCount=parseInt(u[2],10),e=u[1],a=Math.max(a,2),r=a):this._partialCount=0,this._partials=[]}for(let u=1;u<r;++u){const l=2/(u*Math.PI);let c;switch(e){case"sine":c=u<=a?1:0,this._partials[u-1]=c;break;case"square":c=u&1?2*l:0,this._partials[u-1]=c;break;case"sawtooth":c=l*(u&1?1:-1),this._partials[u-1]=c;break;case"triangle":u&1?c=2*(l*l)*(u-1>>1&1?-1:1):c=0,this._partials[u-1]=c;break;case"custom":c=this._partials[u-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}c!==0?(i[u]=-c*Math.sin(t*u),o[u]=c*Math.cos(t*u)):(i[u]=0,o[u]=0)}return[i,o]}_inverseFFT(e,t,n){let r=0;const i=e.length;for(let o=0;o<i;o++)r+=e[o]*Math.cos(o*n)+t[o]*Math.sin(o*n);return r}getInitialValue(){const[e,t]=this._getRealImaginary(this._type,0);let n=0;const r=Math.PI*2,i=32;for(let o=0;o<i;o++)n=Math.max(this._inverseFFT(e,t,o/i*r),n);return clamp(-this._inverseFFT(e,t,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Oscillator._periodicWaveCache=[];class SignalOperator extends ToneAudioNode{constructor(){super(Object.assign(optionsFromArguments(SignalOperator.getDefaults(),arguments,["context"])))}connect(e,t=0,n=0){return connectSignal(this,e,t,n),this}}class WaveShaper extends SignalOperator{constructor(){super(Object.assign(optionsFromArguments(WaveShaper.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const e=optionsFromArguments(WaveShaper.getDefaults(),arguments,["mapping","length"]);isArray(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):isFunction(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(Signal.getDefaults(),{length:1024})}setMap(e,t=1024){const n=new Float32Array(t);for(let r=0,i=t;r<i;r++){const o=r/(i-1)*2-1;n[r]=e(o,r)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const t=["none","2x","4x"].some(n=>n.includes(e));assert(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class AudioToGain extends SignalOperator{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new WaveShaper({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Multiply extends Signal{constructor(){super(Object.assign(optionsFromArguments(Multiply.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const e=optionsFromArguments(Multiply.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Gain({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Signal.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class AMOscillator extends Source{constructor(){super(optionsFromArguments(AMOscillator.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new AudioToGain({context:this.context}),this._modulationNode=new Gain({context:this.context});const e=optionsFromArguments(AMOscillator.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Oscillator({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Oscillator({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Multiply({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),readOnly(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Oscillator.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class FMOscillator extends Source{constructor(){super(optionsFromArguments(FMOscillator.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Gain({context:this.context,gain:0});const e=optionsFromArguments(FMOscillator.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Oscillator({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new Signal({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new Oscillator({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Multiply({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Multiply({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),readOnly(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Oscillator.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class PulseOscillator extends Source{constructor(){super(optionsFromArguments(PulseOscillator.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Gain({context:this.context,gain:0}),this._thresh=new WaveShaper({context:this.context,mapping:t=>t<=0?-1:1});const e=optionsFromArguments(PulseOscillator.getDefaults(),arguments,["frequency","width"]);this.width=new Signal({context:this.context,units:"audioRange",value:e.width}),this._triangle=new Oscillator({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),readOnly(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Source.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class FatOscillator extends Source{constructor(){super(optionsFromArguments(FatOscillator.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const e=optionsFromArguments(FatOscillator.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Signal({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Signal({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,readOnly(this,["frequency","detune"])}static getDefaults(){return Object.assign(Oscillator.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,n=e/(this._oscillators.length-1);this._forEach((r,i)=>r.detune.value=t+n*i)}}get count(){return this._oscillators.length}set count(e){if(assertRange(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const n=new Oscillator({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:t===0?()=>this.onstop(this):noOp});this.type==="custom"&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[t]=n}this.spread=this._spread,this.state==="started"&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,n)=>t.phase=this._phase+n/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class PWMOscillator extends Source{constructor(){super(optionsFromArguments(PWMOscillator.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Multiply({context:this.context,value:2});const e=optionsFromArguments(PWMOscillator.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new PulseOscillator({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Oscillator({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),readOnly(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Source.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const OmniOscillatorSourceMap={am:AMOscillator,fat:FatOscillator,fm:FMOscillator,oscillator:Oscillator,pulse:PulseOscillator,pwm:PWMOscillator};class OmniOscillator extends Source{constructor(){super(optionsFromArguments(OmniOscillator.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const e=optionsFromArguments(OmniOscillator.getDefaults(),arguments,["frequency","type"]);this.frequency=new Signal({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Signal({context:this.context,units:"cents",value:e.detune}),readOnly(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(Oscillator.getDefaults(),FMOscillator.getDefaults(),AMOscillator.getDefaults(),FatOscillator.getDefaults(),PulseOscillator.getDefaults(),PWMOscillator.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=OmniOscillatorSourceMap[e],n=this.now();if(this._oscillator){const r=this._oscillator;r.stop(n),this.context.setTimeout(()=>r.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(t=this._oscillator.type),e==="fm"?this.type="fm"+t:e==="am"?this.type="am"+t:e==="fat"?this.type="fat"+t:e==="oscillator"?this.type=t:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,t){return e instanceof OmniOscillatorSourceMap[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&isNumber(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&isNumber(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&isString(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){return generateWaveform(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function range(s,e=1/0){const t=new WeakMap;return function(n,r){Reflect.defineProperty(n,r,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){assertRange(i,s,e),t.set(this,i)}})}}function timeRange(s,e=1/0){const t=new WeakMap;return function(n,r){Reflect.defineProperty(n,r,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){assertRange(this.toSeconds(i),s,e),t.set(this,i)}})}}class Player extends Source{constructor(){super(optionsFromArguments(Player.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const e=optionsFromArguments(Player.getDefaults(),arguments,["url","onload"]);this._buffer=new ToneAudioBuffer({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Source.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:noOp,onerror:noOp,playbackRate:1,reverse:!1})}load(e){return __awaiter(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=noOp){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,n){return super.start(e,t,n),this}_start(e,t,n){this._loop?t=defaultArg(t,this._loopStart):t=defaultArg(t,0);const r=this.toSeconds(t),i=n;n=defaultArg(n,Math.max(this._buffer.duration-r,0));let o=this.toSeconds(n);o=o/this._playbackRate,e=this.toSeconds(e);const a=new ToneBufferSource({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+o),this._state.setStateAtTime("stopped",e+o,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&isUndef(i)?a.start(e,r):a.start(e,r,o-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(n=>n.stop(t))}restart(e,t,n){return super.restart(e,t,n),this}_restart(e,t,n){this._stop(e),this._start(e,t,n)}seek(e,t){const n=this.toSeconds(t);if(this._state.getValueAtTime(n)==="started"){const r=this.toSeconds(e);this._stop(n),this._start(n,r)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&assertRange(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&assertRange(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),n=this._state.getNextState("stopped",t);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(r=>r.cancelStop())),this._activeSources.forEach(r=>{r.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}__decorate([timeRange(0)],Player.prototype,"fadeIn",void 0);__decorate([timeRange(0)],Player.prototype,"fadeOut",void 0);class Envelope extends ToneAudioNode{constructor(){super(optionsFromArguments(Envelope.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Signal({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const e=optionsFromArguments(Envelope.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(isString(e))return e;{let n;for(n in EnvelopeCurves)if(EnvelopeCurves[n][t]===e)return n;return e}}_setCurve(e,t,n){if(isString(n)&&Reflect.has(EnvelopeCurves,n)){const r=EnvelopeCurves[n];isObject(r)?e!=="_decayCurve"&&(this[e]=r[t]):this[e]=r}else if(isArray(n)&&e!=="_decayCurve")this[e]=n;else throw new Error("Envelope: invalid curve: "+n)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._decayCurve}set decayCurve(e){assert(["linear","exponential"].some(t=>t===e),`Invalid envelope curve: ${e}`),this._decayCurve=e}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let r=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),o=this.getValueAtTime(e);if(o>0){const a=1/r;r=(1-o)/a}if(r<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(t,r,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(t,r,e);else{this._sig.cancelAndHoldAtTime(e);let a=this._attackCurve;for(let u=1;u<a.length;u++)if(a[u-1]<=o&&o<=a[u]){a=this._attackCurve.slice(u),a[0]=o;break}this._sig.setValueCurveAtTime(a,e,r,t)}if(i&&this.sustain<1){const a=t*this.sustain,u=e+r;this.log("decay",u),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,i+u):this._sig.exponentialApproachValueAtTime(a,u,i)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,n,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,n,e):(assert(isArray(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,n,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,n=1){return t=this.toSeconds(t),this.triggerAttack(t,n),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,n=0){return connectSignal(this,e,t,n),this}asArray(e=1024){return __awaiter(this,void 0,void 0,function*(){const t=e/this.context.sampleRate,n=new OfflineContext(1,t,this.context.sampleRate),r=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=r+this.toSeconds(this.release),o=i*.1,a=i+o,u=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/a,decay:t*this.toSeconds(this.decay)/a,release:t*this.toSeconds(this.release)/a,context:n}));return u._sig.toDestination(),u.triggerAttackRelease(t*(r+o)/a,0),(yield n.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}__decorate([timeRange(0)],Envelope.prototype,"attack",void 0);__decorate([timeRange(0)],Envelope.prototype,"decay",void 0);__decorate([range(0,1)],Envelope.prototype,"sustain",void 0);__decorate([timeRange(0)],Envelope.prototype,"release",void 0);const EnvelopeCurves=(()=>{let e,t;const n=[];for(e=0;e<128;e++)n[e]=Math.sin(e/(128-1)*(Math.PI/2));const r=[],i=6.4;for(e=0;e<128-1;e++){t=e/(128-1);const d=Math.sin(t*(Math.PI*2)*i-Math.PI/2)+1;r[e]=d/10+t*.83}r[128-1]=1;const o=[],a=5;for(e=0;e<128;e++)o[e]=Math.ceil(e/(128-1)*a)/a;const u=[];for(e=0;e<128;e++)t=e/(128-1),u[e]=.5*(1-Math.cos(Math.PI*t));const l=[];for(e=0;e<128;e++){t=e/(128-1);const d=Math.pow(t,3)*4+.2,p=Math.cos(d*Math.PI*2*t);l[e]=Math.abs(p*(1-t))}function c(d){const p=new Array(d.length);for(let f=0;f<d.length;f++)p[f]=1-d[f];return p}function h(d){return d.slice(0).reverse()}return{bounce:{In:c(l),Out:l},cosine:{In:n,Out:h(n)},exponential:"exponential",linear:"linear",ripple:{In:r,Out:c(r)},sine:{In:u,Out:c(u)},step:{In:o,Out:c(o)}}})();class Instrument extends ToneAudioNode{constructor(){super(optionsFromArguments(Instrument.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const e=optionsFromArguments(Instrument.getDefaults(),arguments);this._volume=this.output=new Volume({context:this.context,volume:e.volume}),this.volume=this._volume.volume,readOnly(this,"volume")}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){const n=this["_original_"+e]=this[e];this[e]=(...r)=>{const i=r[t],o=this.context.transport.schedule(a=>{r[t]=a,n.apply(this,r)},i);this._scheduledEvents.push(o)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(e,t,n,r){const i=this.toSeconds(n),o=this.toSeconds(t);return this.triggerAttack(e,i,r),this.triggerRelease(i+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Monophonic extends Instrument{constructor(){super(optionsFromArguments(Monophonic.getDefaults(),arguments));const e=optionsFromArguments(Monophonic.getDefaults(),arguments);this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(Instrument.getDefaults(),{detune:0,onsilence:noOp,portamento:0})}triggerAttack(e,t,n=1){this.log("triggerAttack",e,t,n);const r=this.toSeconds(t);return this._triggerEnvelopeAttack(r,n),this.setNote(e,r),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const n=this.toSeconds(t),r=e instanceof FrequencyClass?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const i=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(r,i,n)}else this.frequency.setValueAtTime(r,n);return this}}__decorate([timeRange(0)],Monophonic.prototype,"portamento",void 0);class AmplitudeEnvelope extends Envelope{constructor(){super(optionsFromArguments(AmplitudeEnvelope.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Gain({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Synth extends Monophonic{constructor(){super(optionsFromArguments(Synth.getDefaults(),arguments)),this.name="Synth";const e=optionsFromArguments(Synth.getDefaults(),arguments);this.oscillator=new OmniOscillator(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new AmplitudeEnvelope(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),readOnly(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Monophonic.getDefaults(),{envelope:Object.assign(omitFromObject(Envelope.getDefaults(),Object.keys(ToneAudioNode.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(omitFromObject(OmniOscillator.getDefaults(),[...Object.keys(Source.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),this.envelope.sustain===0){const n=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+n+r)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class MembraneSynth extends Synth{constructor(){super(optionsFromArguments(MembraneSynth.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const e=optionsFromArguments(MembraneSynth.getDefaults(),arguments);this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,readOnly(this,["oscillator","envelope"])}static getDefaults(){return deepMerge(Monophonic.getDefaults(),Synth.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const n=this.toSeconds(t),r=this.toFrequency(e instanceof FrequencyClass?e.toFrequency():e),i=r*this.octaves;return this.oscillator.frequency.setValueAtTime(i,n),this.oscillator.frequency.exponentialRampToValueAtTime(r,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}__decorate([range(0)],MembraneSynth.prototype,"octaves",void 0);__decorate([timeRange(0)],MembraneSynth.prototype,"pitchDecay",void 0);const workletContext=new Set;function addToWorklet(s){workletContext.add(s)}function registerProcessor(s,e){const t=`registerProcessor("${s}", ${e})`;workletContext.add(t)}const toneAudioWorkletProcessor=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;addToWorklet(toneAudioWorkletProcessor);const singleIOProcess=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;addToWorklet(singleIOProcess);const delayLine=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;addToWorklet(delayLine);const workletName$1="feedback-comb-filter",feedbackCombFilter=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;registerProcessor(workletName$1,feedbackCombFilter);class Sampler extends Instrument{constructor(){super(optionsFromArguments(Sampler.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const e=optionsFromArguments(Sampler.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),t={};Object.keys(e.urls).forEach(n=>{const r=parseInt(n,10);if(assert(isNote(n)||isNumber(r)&&isFinite(r),`url key is neither a note or midi pitch: ${n}`),isNote(n)){const i=new FrequencyClass(this.context,n).toMidi();t[i]=e.urls[n]}else isNumber(r)&&isFinite(r)&&(t[r]=e.urls[r])}),this._buffers=new ToneAudioBuffers({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(Instrument.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:noOp,onerror:noOp,release:.1,urls:{}})}_findClosest(e){let n=0;for(;n<96;){if(this._buffers.has(e+n))return-n;if(this._buffers.has(e-n))return n;n++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,n=1){return this.log("triggerAttack",e,t,n),Array.isArray(e)||(e=[e]),e.forEach(r=>{const i=ftomf(new FrequencyClass(this.context,r).toFrequency()),o=Math.round(i),a=i-o,u=this._findClosest(o),l=o-u,c=this._buffers.get(l),h=intervalToFrequencyRatio(u+a),d=new ToneBufferSource({url:c,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);d.start(t,0,c.duration/h,n),isArray(this._activeSources.get(o))||this._activeSources.set(o,[]),this._activeSources.get(o).push(d),d.onended=()=>{if(this._activeSources&&this._activeSources.has(o)){const p=this._activeSources.get(o),f=p.indexOf(d);f!==-1&&p.splice(f,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(n=>{const r=new FrequencyClass(this.context,n).toMidi();if(this._activeSources.has(r)&&this._activeSources.get(r).length){const i=this._activeSources.get(r);t=this.toSeconds(t),i.forEach(o=>{o.stop(t)}),this._activeSources.set(r,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(n=>{for(;n.length;)n.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,n,r=1){const i=this.toSeconds(n);return this.triggerAttack(e,i,r),isArray(t)?(assert(isArray(e),"notes must be an array when duration is array"),e.forEach((o,a)=>{const u=t[Math.min(a,t.length-1)];this.triggerRelease(o,i+this.toSeconds(u))})):this.triggerRelease(e,i+this.toSeconds(t)),this}add(e,t,n){if(assert(isNote(e)||isFinite(e),`note must be a pitch or midi: ${e}`),isNote(e)){const r=new FrequencyClass(this.context,e).toMidi();this._buffers.add(r,t,n)}else this._buffers.add(e,t,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}__decorate([timeRange(0)],Sampler.prototype,"attack",void 0);__decorate([timeRange(0)],Sampler.prototype,"release",void 0);class Panner extends ToneAudioNode{constructor(){super(Object.assign(optionsFromArguments(Panner.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const e=optionsFromArguments(Panner.getDefaults(),arguments,["pan"]);this.pan=new Param({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",readOnly(this,"pan")}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const workletName="bit-crusher",bitCrusherWorklet=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;registerProcessor(workletName,bitCrusherWorklet);class Solo extends ToneAudioNode{constructor(){super(optionsFromArguments(Solo.getDefaults(),arguments,["solo"])),this.name="Solo";const e=optionsFromArguments(Solo.getDefaults(),arguments,["solo"]);this.input=this.output=new Gain({context:this.context}),Solo._allSolos.has(this.context)||Solo._allSolos.set(this.context,new Set),Solo._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),Solo._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){Solo._soloed.has(this.context)||Solo._soloed.set(this.context,new Set),Solo._soloed.get(this.context).add(this)}_removeSolo(){Solo._soloed.has(this.context)&&Solo._soloed.get(this.context).delete(this)}_isSoloed(){return Solo._soloed.has(this.context)&&Solo._soloed.get(this.context).has(this)}_noSolos(){return!Solo._soloed.has(this.context)||Solo._soloed.has(this.context)&&Solo._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Solo._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Solo._allSolos=new Map;Solo._soloed=new Map;class PanVol extends ToneAudioNode{constructor(){super(optionsFromArguments(PanVol.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const e=optionsFromArguments(PanVol.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Panner({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Volume({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,readOnly(this,["pan","volume"])}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Channel extends ToneAudioNode{constructor(){super(optionsFromArguments(Channel.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const e=optionsFromArguments(Channel.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new Solo({solo:e.solo,context:this.context}),this._panVol=this.output=new PanVol({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),readOnly(this,["pan","volume"])}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return Channel.buses.has(e)||Channel.buses.set(e,new Gain({context:this.context})),Channel.buses.get(e)}send(e,t=0){const n=this._getBus(e),r=new Gain({context:this.context,units:"decibels",gain:t});return this.connect(r),r.connect(n),r}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Channel.buses=new Map;class Listener extends ToneAudioNode{constructor(){super(...arguments),this.name="Listener",this.positionX=new Param({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Param({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Param({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Param({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Param({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Param({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Param({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Param({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Param({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}onContextInit(s=>{s.listener=new Listener({context:s})});onContextClose(s=>{s.listener.dispose()});getContext().transport;getContext().destination;getContext().destination;getContext().listener;getContext().draw;const context=getContext();function loaded(){return ToneAudioBuffer.loaded()}const notes_to_load=["A2","C3","A3","C4","A4","C5"],notes_loaded=Object.fromEntries(notes_to_load.map(s=>[s,!1])),sampler=new Sampler().toDestination();context.lookAhead=.05;for(const s of notes_to_load)fetch(`/acchymns-dev/assets/notes/${s}.mp3`).then(async e=>{const t=URL.createObjectURL(await e.blob());sampler.add(s,t),notes_loaded[s]=!0});const interval=useLocalStorage("ACCOptions.playbackInterval",.25),duration=useLocalStorage("ACCOptions.playbackDuration",2.5),staggered=useLocalStorage("ACCOptions.staggered",!0),isPlaying=ref(!1);let cancel_interval_id;const scheduled_notes_interval_id=[],player={async play(s){if(isPlaying.value)return;if(isPlaying.value=!0,await start(),!Object.values(notes_loaded).every(t=>t)){console.log("Not all notes have been loaded!");return}if(!sampler.loaded){console.log("Sampler hasn't loaded!");return}console.log("attempting to start notes"),console.log(...unref(s)),await loaded();let e;if(staggered.value){for(const[t,n]of unref(s).entries())scheduled_notes_interval_id.push(setTimeout(()=>{sampler.triggerAttack(n)},interval.value*t*1e3));e=duration.value+interval.value*unref(s).length}else sampler.triggerAttack(unref(s)),e=duration.value;cancel_interval_id=setTimeout(()=>{sampler.releaseAll(),isPlaying.value=!1},e*1e3)},stop(){for(const s of scheduled_notes_interval_id)clearTimeout(s);clearTimeout(cancel_interval_id),sampler.releaseAll(),isPlaying.value=!1}};function useNotes(){return{player,isPlaying}}const _hoisted_1={class:"menu"},_hoisted_2={class:"title"},_hoisted_3={class:"title--left"},_hoisted_4={class:"title--center"},_hoisted_5={class:"title--right"},_hoisted_6={key:1,class:"ionicon",src:_imports_2$1},_hoisted_7=createBaseVNode("p",{class:"tooltiptext"},"New! Starting Notes",-1),_hoisted_8=[_hoisted_7],_hoisted_9={class:"w-100",style:{height:"100vh"}},_sfc_main=defineComponent({__name:"SongDisplayView",props:{book:{},number:{}},setup(s){const e=s,t=useRouter(),{player:n,isPlaying:r}=useNotes(),i=ref([]),o=useCapacitorPreferences("bookmarks",[]),a=computed(()=>o.value.findIndex(p=>p.book==e.book&&p.number==e.number)!=-1);async function u(){if(!a.value)o.value.push(e),await Toast.show({text:`#${e.number} added to Bookmarks`});else{const p=o.value.findIndex(f=>f.book==e.book&&f.number==e.number);o.value.splice(p,1),await Toast.show({text:`#${e.number} removed from Bookmarks`})}}onMounted(async()=>{var f;const p=await getSongMetaData(e.book);p!=null&&(i.value=(((f=p[e.number])==null?void 0:f.notes)??[]).reverse())}),onUnmounted(()=>{n.stop()});let l=useLocalStorage("starting_notes_tooltip_complete",!1),c=ref();function h(){n.play(i),d()}function d(){var p,f;(p=c.value)==null||p.classList.add("tooltiphidden"),(f=c.value)==null||f.classList.add("tooltip"),setTimeout(()=>{l.value=!0},1e3)}return(p,f)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createBaseVNode("img",{onClick:f[0]||(f[0]=g=>unref(t).back()),class:"ionicon",src:_imports_0$1})]),createBaseVNode("div",_hoisted_4,[createBaseVNode("h1",null,"#"+toDisplayString(e.number),1)]),createBaseVNode("div",_hoisted_5,[i.value.length!=0?(openBlock(),createElementBlock(Fragment,{key:0},[unref(r)?(openBlock(),createElementBlock("img",_hoisted_6)):(openBlock(),createElementBlock("img",{key:0,onClick:h,class:"ionicon",src:_imports_1})),unref(l)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:2,class:"tooltip",ref_key:"tooltip",ref:c,onClick:f[1]||(f[1]=g=>d())},_hoisted_8,512))],64)):createCommentVNode("",!0),a.value?(openBlock(),createElementBlock("img",{key:1,onClick:f[2]||(f[2]=g=>u()),class:"ionicon",src:_imports_3})):(openBlock(),createElementBlock("img",{key:2,onClick:f[3]||(f[3]=g=>u()),class:"ionicon",src:_imports_2}))])])]),createBaseVNode("div",_hoisted_9,[createVNode(SongContainer,{book:e.book,number:e.number},null,8,["book","number"])])],64))}}),SongDisplayView_vue_vue_type_style_index_0_lang="";export{_sfc_main as default};
