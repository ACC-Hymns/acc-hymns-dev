import{d as S,B as V,$ as T,r as A,c as d,e as t,f as c,D as R,Q as j,j as w,F as f,k as g,l as p,w as r,a0 as y,m as l,h as x,a1 as b,R as v,q as E,s as F,x as L,y as N,A as U}from"./index-830cef8a.js";import{_ as D}from"./chevron-back-outline-3b18af6c.js";import{_ as q}from"./chevron-forward-outline-4fe420c1.js";import{_ as H}from"./add-circle-outline-3c901f23.js";import{_ as M}from"./home-outline-fa9c027b.js";import{_ as O}from"./settings-5944a888.js";import{T as _}from"./index-e084387e.js";import{u as P}from"./navigator-c79b3f68.js";import{u as Q}from"./preferences-e4286513.js";const z="/acchymns-dev/assets/close.svg",o=u=>(E("data-v-1d3e0241"),u=u(),F(),u),G={class:"menu"},J={class:"title"},K=o(()=>t("h1",{class:"title--center"},"Import Books",-1)),W={class:"main-content"},X=o(()=>t("div",{style:{display:"flex","justify-content":"center"}},[t("h5",{style:{margin:"0 auto"}},"The song books below require an internet connection")],-1)),Y={class:"settings"},Z={class:"input-option"},tt=o(()=>t("span",null,"Reference",-1)),et=["disabled"],st=o(()=>t("img",{class:"ionicon",src:q},null,-1)),ot=[st],nt={key:0},it=["onClick"],at=o(()=>t("img",{class:"ionicon ionicon-custom",src:H},null,-1)),ct=[at],lt={key:1},_t={style:{"padding-bottom":"200px"}},rt=["onClick"],dt=o(()=>t("img",{class:"ionicon ionicon-custom",src:z},null,-1)),ut=[dt],mt={class:"nav"},pt=o(()=>t("img",{class:"ionicon nav__icon",src:M},null,-1)),vt=o(()=>t("span",{class:"nav__text"},"Home",-1)),ft=o(()=>t("img",{class:"ionicon nav__icon",src:L},null,-1)),ht=o(()=>t("span",{class:"nav__text"},"Search",-1)),kt=o(()=>t("img",{class:"ionicon nav__icon",src:N},null,-1)),wt=o(()=>t("span",{class:"nav__text"},"Bookmarks",-1)),gt=o(()=>t("img",{class:"ionicon nav__icon--active",src:O},null,-1)),yt=o(()=>t("span",{class:"nav__text"},"Settings",-1)),xt=S({__name:"SettingsImportView",setup(u){const{back:B}=P(),i=Q("externalBooks",[]),h=V(()=>Object.values(T).filter(s=>!i.value.includes(s))),m=A("");async function k(s,n=!0){let e=null;try{const a=new AbortController,$=setTimeout(()=>a.abort(),2e3);e=await fetch(s+"/summary.json",{method:"HEAD",signal:a.signal}),clearTimeout($)}catch(a){if(a.name=="TypeError")return await _.show({text:"Failed to load book!"}),!1;if(a.name!="AbortError")throw a}return e==null||!e.ok||e.status!=200?(await _.show({text:"Failed to load book!"}),!1):i.value.includes(s)?(await _.show({text:"Book already imported!"}),!1):(i.value.push(s),n&&await _.show({text:"Successfully imported book!"}),!0)}async function I(s){if(s in y){const n=y[s];i.value.includes(n)?await _.show({text:`Book (${s}) already imported!`}):await k(n,!1)&&await _.show({text:`Successfully imported book (${s})!`})}else await _.show({text:`Unknown book reference (${s})!`})}function C(s){i.value=i.value.filter(n=>n!=s)}return(s,n)=>(l(),d(f,null,[t("div",G,[t("div",J,[t("img",{onClick:n[0]||(n[0]=e=>c(B)()),class:"ionicon title--left",src:D}),K])]),t("div",W,[X,t("div",Y,[t("div",Z,[tt,R(t("input",{"onUpdate:modelValue":n[1]||(n[1]=e=>m.value=e),type:"text",class:"input-text"},null,512),[[j,m.value,void 0,{trim:!0}]]),t("button",{disabled:m.value.length===0,onClick:n[2]||(n[2]=e=>I(m.value))},ot,8,et)])]),h.value.length!=0?(l(),d("h2",nt,"Available Books")):w("",!0),t("div",null,[(l(!0),d(f,null,g(h.value,e=>(l(),x(b,{key:e,src:e,"with-link":!1},{default:r(()=>[t("button",{onClick:a=>k(e)},ct,8,it)]),_:2},1032,["src"]))),128))]),c(i).length!=0?(l(),d("h2",lt,"Imported Books")):w("",!0),t("div",_t,[(l(!0),d(f,null,g(c(i),e=>(l(),x(b,{key:e,src:e,"with-link":!1},{default:r(()=>[t("button",{onClick:a=>C(e)},ut,8,rt)]),_:2},1032,["src"]))),128))])]),t("nav",mt,[p(c(v),{to:"/",class:"nav__link"},{default:r(()=>[pt,vt]),_:1}),p(c(v),{to:"/search",class:"nav__link"},{default:r(()=>[ft,ht]),_:1}),p(c(v),{to:"/bookmarks",class:"nav__link"},{default:r(()=>[kt,wt]),_:1}),p(c(v),{to:"/settings",class:"nav__link nav__link--active"},{default:r(()=>[gt,yt]),_:1})])],64))}});const Rt=U(xt,[["__scopeId","data-v-1d3e0241"]]);export{Rt as default};
